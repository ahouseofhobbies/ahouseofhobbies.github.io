{"version":3,"sources":["types/phases.ts","factions/metatagger.ts","generic_rules/artifacts.ts","generic_rules/command_abilities.ts","generic_rules/command_traits.ts","generic_rules/core_battalions.ts","generic_rules/core_rules.ts","generic_rules/effects.ts","generic_rules/endless_spells.ts","generic_rules/grand_strategies.ts","generic_rules/incarnates.ts","generic_rules/monstrous_rampages.ts","generic_rules/prayers.ts","generic_rules/realmscapes.ts","generic_rules/scenery.ts","generic_rules/spells.ts","generic_rules/triumphs.ts","generic_rules/manifestations.ts","utils/loadArmy/loadArmyHelpers.ts","utils/env.ts","ducks/army.ts","types/realmscapes.ts","ducks/factionNames.ts","ducks/notes.ts","ducks/realmscape.ts","ducks/selections.ts","ducks/visibility.ts","factions/kharadron_overlords/units.ts","components/helpers/spinner.tsx","utils/plans.ts","components/page/navbar_wrapper.tsx","store/initialAppState.ts","utils/hooks/useWindowSize.tsx","context/useSavedArmies.tsx","components/helpers/suspenseFallbacks.tsx","utils/processReminders.ts","utils/hooks/useGetReminders.tsx","ducks/selectors.ts","utils/mapListToDict.ts","factions/stormcast_eternals/artifacts.ts","factions/stormcast_eternals/battalions.ts","factions/stormcast_eternals/battle_tactics.ts","factions/stormcast_eternals/battle_traits.ts","factions/stormcast_eternals/command_abilities.ts","factions/stormcast_eternals/command_traits.ts","factions/stormcast_eternals/endless_spells.ts","factions/stormcast_eternals/flavors.ts","factions/stormcast_eternals/grand_strategies.ts","factions/stormcast_eternals/monstrous_rampages.ts","factions/stormcast_eternals/mount_traits.ts","factions/stormcast_eternals/prayers.ts","factions/stormcast_eternals/spells.ts","factions/stormcast_eternals/subfactions.ts","factions/stormcast_eternals/index.ts","factions/legions_of_nagash/battle_traits.ts","factions/legions_of_nagash/grand_host_of_nagash/artifacts.ts","factions/legions_of_nagash/grand_host_of_nagash/command_traits.ts","factions/legions_of_nagash/legion_of_blood/artifacts.ts","factions/legions_of_nagash/legion_of_blood/command_traits.ts","factions/legions_of_nagash/legion_of_night/artifacts.ts","factions/legions_of_nagash/legion_of_night/command_traits.ts","factions/legions_of_nagash/legion_of_sacrament/artifacts.ts","factions/legions_of_nagash/legion_of_sacrament/command_traits.ts","factions/legions_of_nagash/soulblight/artifacts.ts","factions/legions_of_nagash/soulblight/command_traits.ts","factions/legions_of_nagash/soulblight/flavors.ts","factions/legions_of_nagash/subfactions.ts","factions/legions_of_nagash/index.ts","utils/localStore.ts","factions/grand_alliances/chaos/artifacts.ts","factions/grand_alliances/chaos/battle_traits.ts","factions/grand_alliances/chaos/command_abilities.ts","factions/grand_alliances/chaos/command_traits.ts","factions/grand_alliances/chaos/units.ts","factions/grand_alliances/chaos/subfactions.ts","factions/grand_alliances/chaos/index.ts","factions/grand_alliances/death/artifacts.ts","factions/grand_alliances/death/battle_traits.ts","factions/grand_alliances/death/command_abilities.ts","factions/grand_alliances/death/command_traits.ts","factions/grand_alliances/death/units.ts","factions/grand_alliances/death/subfactions.ts","factions/grand_alliances/death/index.ts","factions/grand_alliances/destruction/artifacts.ts","factions/grand_alliances/destruction/battle_traits.ts","factions/grand_alliances/destruction/command_abilities.ts","factions/grand_alliances/destruction/command_traits.ts","factions/grand_alliances/destruction/units.ts","factions/grand_alliances/destruction/subfactions.ts","factions/grand_alliances/destruction/index.ts","factions/grand_alliances/order/artifacts.ts","factions/grand_alliances/order/battle_traits.ts","factions/grand_alliances/order/command_traits.ts","factions/grand_alliances/order/unit_groups/bretonnia.ts","factions/grand_alliances/order/unit_groups/duardin.ts","factions/grand_alliances/order/unit_groups/dwarfs.ts","factions/grand_alliances/order/unit_groups/eldritch.ts","factions/grand_alliances/order/unit_groups/high_elves.ts","factions/grand_alliances/order/unit_groups/misc_order.ts","factions/grand_alliances/order/unit_groups/swifthawk_agents.ts","factions/grand_alliances/order/unit_groups/wood_elves.ts","factions/grand_alliances/order/units.ts","factions/grand_alliances/order/subfactions.ts","factions/grand_alliances/order/index.ts","factions/grand_alliances/index.ts","factions/orruk_warclans/rule_sources.ts","factions/orruk_warclans/ironjawz/artifacts.ts","factions/orruk_warclans/ironjawz/battle_tactics.ts","factions/orruk_warclans/ironjawz/battle_traits.ts","factions/orruk_warclans/ironjawz/command_abilities.ts","factions/orruk_warclans/ironjawz/command_traits.ts","factions/orruk_warclans/ironjawz/flavors.ts","factions/orruk_warclans/ironjawz/monstrous_rampages.ts","factions/orruk_warclans/ironjawz/spells.ts","factions/orruk_warclans/ironjawz/units.ts","factions/orruk_warclans/ironjawz/prayers.ts","factions/orruk_warclans/kruleboyz/artifacts.ts","factions/orruk_warclans/kruleboyz/battle_tactics.ts","factions/orruk_warclans/kruleboyz/battle_traits.ts","factions/orruk_warclans/kruleboyz/command_traits.ts","factions/orruk_warclans/kruleboyz/flavors.ts","factions/orruk_warclans/kruleboyz/spells.ts","factions/orruk_warclans/kruleboyz/units.ts","factions/orruk_warclans/battle_tactics.ts","factions/orruk_warclans/mount_traits.ts","factions/orruk_warclans/subfactions.ts","factions/orruk_warclans/index.ts","factions/slaves_to_darkness/rule_sources.ts","factions/slaves_to_darkness/artifacts.ts","factions/slaves_to_darkness/battalions.ts","factions/slaves_to_darkness/battle_tactics.ts","factions/slaves_to_darkness/battle_traits.ts","factions/slaves_to_darkness/command_abilities.ts","factions/slaves_to_darkness/command_traits.ts","factions/slaves_to_darkness/endless_spells.ts","factions/slaves_to_darkness/flavors.ts","factions/slaves_to_darkness/grand_strategies.ts","factions/slaves_to_darkness/prayers.ts","factions/slaves_to_darkness/spells.ts","factions/slaves_to_darkness/units.ts","factions/slaves_to_darkness/subfactions.ts","factions/slaves_to_darkness/index.ts","factions/kharadron_overlords/rule_sources.ts","factions/kharadron_overlords/artifacts.ts","factions/kharadron_overlords/battalions.ts","factions/kharadron_overlords/battle_tactics.ts","factions/kharadron_overlords/battle_traits.ts","factions/kharadron_overlords/command_abilities.ts","factions/kharadron_overlords/command_traits.ts","factions/kharadron_overlords/flavors.ts","factions/kharadron_overlords/grand_strategies.ts","factions/kharadron_overlords/subfactions.ts","factions/kharadron_overlords/index.ts","utils/analytics.ts","types/data.ts","ducks/index.ts","meta/factions.ts","components/page/privateRoute.tsx","utils/handleQueryParams.ts","utils/history.ts","components/App.tsx","serviceWorkerRegistration.ts","index.tsx","utils/installNewWorker.ts","factions/temporaryAdapter.ts","factions/legions_of_nagash/command_abilities.ts","meta/rule_sources.ts","utils/textUtils.ts","factions/nighthaunt/units.ts","api/preferenceApi.ts","factions/legions_of_nagash/spells.ts","theme/dark.ts","theme/light.ts","context/useTheme.tsx","utils/armyUtils.ts","factions/nighthaunt/endless_spells.ts","theme/helperClasses.ts","store/index.tsx","factions/legions_of_nagash/units.ts","utils/subscriptionUtils.ts","context/useSubscription.tsx","factions/beasts_of_chaos/rule_sources.ts","factions/beasts_of_chaos/artifacts.ts","factions/beasts_of_chaos/battle_traits.ts","factions/beasts_of_chaos/battle_tactics.ts","factions/beasts_of_chaos/command_abilities.ts","factions/beasts_of_chaos/command_traits.ts","factions/beasts_of_chaos/endless_spells.ts","factions/beasts_of_chaos/monstrous_rampages.ts","factions/beasts_of_chaos/flavors.ts","factions/beasts_of_chaos/grand_strategies.ts","factions/beasts_of_chaos/scenery.ts","factions/beasts_of_chaos/spells.ts","factions/beasts_of_chaos/units.ts","factions/beasts_of_chaos/subfactions.ts","factions/beasts_of_chaos/index.ts","factions/cities_of_sigmar/rule_sources.ts","factions/cities_of_sigmar/artifacts.ts","factions/cities_of_sigmar/battle_traits.ts","factions/cities_of_sigmar/command_traits.ts","factions/cities_of_sigmar/flavors.ts","factions/cities_of_sigmar/prayers.ts","factions/cities_of_sigmar/spells.ts","factions/cities_of_sigmar/units.ts","factions/cities_of_sigmar/monstrous_rampages.ts","factions/cities_of_sigmar/battalions.ts","factions/cities_of_sigmar/battle_tactics.ts","factions/cities_of_sigmar/grand_strategies.ts","factions/cities_of_sigmar/subfactions.ts","factions/cities_of_sigmar/index.ts","factions/daughters_of_khaine/rule_sources.ts","factions/daughters_of_khaine/artifacts.ts","factions/daughters_of_khaine/battalions.ts","factions/daughters_of_khaine/battle_tactics.ts","factions/daughters_of_khaine/battle_traits.ts","factions/daughters_of_khaine/command_abilities.ts","factions/daughters_of_khaine/command_traits.ts","factions/daughters_of_khaine/endless_spells.ts","factions/daughters_of_khaine/flavors.ts","factions/daughters_of_khaine/grand_strategies.ts","factions/daughters_of_khaine/prayers.ts","factions/daughters_of_khaine/spells.ts","factions/daughters_of_khaine/units.ts","factions/daughters_of_khaine/subfactions.ts","factions/daughters_of_khaine/index.ts","factions/dispossessed/artifacts.ts","factions/dispossessed/battle_traits.ts","factions/dispossessed/command_abilities.ts","factions/dispossessed/command_traits.ts","factions/dispossessed/units.ts","factions/dispossessed/subfactions.ts","factions/dispossessed/index.ts","factions/flesh_eater_courts/rule_sources.ts","factions/flesh_eater_courts/artifacts.ts","factions/flesh_eater_courts/battle_traits.ts","factions/flesh_eater_courts/command_traits.ts","factions/flesh_eater_courts/endless_spells.ts","factions/flesh_eater_courts/flavors.ts","factions/flesh_eater_courts/mount_traits.ts","factions/flesh_eater_courts/scenery.ts","factions/flesh_eater_courts/spells.ts","factions/flesh_eater_courts/units.ts","factions/flesh_eater_courts/monstrous_rampages.ts","factions/flesh_eater_courts/prayers.ts","factions/flesh_eater_courts/grand_strategies.ts","factions/flesh_eater_courts/battle_tactics.ts","factions/flesh_eater_courts/subfactions.ts","factions/flesh_eater_courts/index.ts","factions/fyreslayers/rule_sources.ts","factions/fyreslayers/artifacts.ts","factions/fyreslayers/battle_traits.ts","factions/fyreslayers/battle_tactics.ts","factions/fyreslayers/command_abilities.ts","factions/fyreslayers/command_traits.ts","factions/fyreslayers/endless_spells.ts","factions/fyreslayers/flavors.ts","factions/fyreslayers/grand_strategies.ts","factions/fyreslayers/prayers.ts","factions/fyreslayers/units.ts","factions/fyreslayers/subfactions.ts","factions/fyreslayers/index.ts","factions/gloomspite_gitz/rule_sources.ts","factions/gloomspite_gitz/artifacts.ts","factions/gloomspite_gitz/battalions.ts","factions/gloomspite_gitz/battle_tactics.ts","factions/gloomspite_gitz/battle_traits.ts","factions/gloomspite_gitz/command_abilities.ts","factions/gloomspite_gitz/command_traits.ts","factions/gloomspite_gitz/endless_spells.ts","factions/gloomspite_gitz/monstrous_rampages.ts","factions/gloomspite_gitz/flavors.ts","factions/gloomspite_gitz/grand_strategies.ts","factions/gloomspite_gitz/scenery.ts","factions/gloomspite_gitz/spells.ts","factions/gloomspite_gitz/units.ts","factions/gloomspite_gitz/subfactions.ts","factions/gloomspite_gitz/index.ts","factions/greenskinz/command_abilities.ts","factions/greenskinz/spells.ts","factions/greenskinz/units.ts","factions/greenskinz/subfactions.ts","factions/greenskinz/index.ts","factions/idoneth_deepkin/rule_sources.ts","factions/idoneth_deepkin/artifacts.ts","factions/idoneth_deepkin/battle_traits.ts","factions/idoneth_deepkin/battle_tactics.ts","factions/idoneth_deepkin/command_traits.ts","factions/idoneth_deepkin/flavors.ts","factions/idoneth_deepkin/grand_strategies.ts","factions/idoneth_deepkin/monstrous_rampages.ts","factions/idoneth_deepkin/mount_traits.ts","factions/idoneth_deepkin/scenery.ts","factions/idoneth_deepkin/spells.ts","factions/idoneth_deepkin/units.ts","factions/idoneth_deepkin/subfactions.ts","factions/idoneth_deepkin/index.ts","factions/khorne/rule_sources.ts","factions/khorne/artifacts.ts","factions/khorne/battle_traits.ts","factions/khorne/battle_tactics.ts","factions/khorne/command_abilities.ts","factions/khorne/command_traits.ts","factions/khorne/endless_spells.ts","factions/khorne/flavors.ts","factions/khorne/grand_strategies.ts","factions/khorne/prayers.ts","factions/khorne/scenery.ts","factions/khorne/units.ts","factions/khorne/subfactions.ts","factions/khorne/index.ts","factions/legion_of_azgorh/artifacts.ts","factions/legion_of_azgorh/battle_traits.ts","factions/legion_of_azgorh/command_abilities.ts","factions/legion_of_azgorh/command_traits.ts","factions/legion_of_azgorh/spells.ts","factions/legion_of_azgorh/units.ts","factions/legion_of_azgorh/subfactions.ts","factions/legion_of_azgorh/index.ts","factions/legion_of_grief/artifacts.ts","factions/legion_of_grief/battle_traits.ts","factions/legion_of_grief/command_abilities.ts","factions/legion_of_grief/command_traits.ts","factions/legion_of_grief/spells.ts","factions/legion_of_grief/subfactions.ts","factions/legion_of_grief/index.ts","factions/legion_of_the_first_prince/battle_traits.ts","factions/legion_of_the_first_prince/subfactions.ts","factions/legion_of_the_first_prince/index.ts","factions/lethisian_defenders/artifacts.ts","factions/lethisian_defenders/battle_traits.ts","factions/lethisian_defenders/command_abilities.ts","factions/lethisian_defenders/command_traits.ts","factions/lethisian_defenders/prayers.ts","factions/lethisian_defenders/units.ts","factions/lethisian_defenders/subfactions.ts","factions/lethisian_defenders/index.ts","factions/lumineth_realmlords/rule_sources.ts","factions/lumineth_realmlords/artifacts.ts","factions/lumineth_realmlords/battle_traits.ts","factions/lumineth_realmlords/battle_tactics.ts","factions/lumineth_realmlords/command_abilities.ts","factions/lumineth_realmlords/command_traits.ts","factions/lumineth_realmlords/endless_spells.ts","factions/lumineth_realmlords/flavors.ts","factions/lumineth_realmlords/scenery.ts","factions/lumineth_realmlords/spells.ts","factions/lumineth_realmlords/units.ts","factions/lumineth_realmlords/subfactions.ts","factions/lumineth_realmlords/grand_strategies.ts","factions/lumineth_realmlords/index.ts","factions/sons_of_behemat/units.ts","factions/mega_gargant_mercenaries/units.ts","factions/mega_gargant_mercenaries/subfactions.ts","factions/mega_gargant_mercenaries/index.ts","factions/ogor_mawtribes/units.ts","factions/mercenary_companies/units.ts","factions/mercenary_companies/subfactions.ts","factions/mercenary_companies/index.ts","factions/nighthaunt/rule_sources.ts","factions/nighthaunt/artifacts.ts","factions/nighthaunt/battle_traits.ts","factions/nighthaunt/battle_tactics.ts","factions/nighthaunt/command_abilities.ts","factions/nighthaunt/command_traits.ts","factions/nighthaunt/flavors.ts","factions/nighthaunt/grand_strategies.ts","factions/nighthaunt/spells.ts","factions/nighthaunt/subfactions.ts","factions/nighthaunt/index.ts","factions/nurgle/rule_sources.ts","factions/nurgle/artifacts.ts","factions/nurgle/battalions.ts","factions/nurgle/battle_tactics.ts","factions/nurgle/battle_traits.ts","factions/nurgle/command_abilities.ts","factions/nurgle/command_traits.ts","factions/nurgle/flavors.ts","factions/nurgle/monstrous_rampages.ts","factions/nurgle/grand_strategies.ts","factions/nurgle/scenery.ts","factions/nurgle/spells.ts","factions/nurgle/units.ts","factions/nurgle/subfactions.ts","factions/nurgle/index.ts","factions/ogor_mawtribes/rule_sources.ts","factions/ogor_mawtribes/artifacts.ts","factions/ogor_mawtribes/battalions.ts","factions/ogor_mawtribes/battle_tactics.ts","factions/ogor_mawtribes/battle_traits.ts","factions/ogor_mawtribes/command_abilities.ts","factions/ogor_mawtribes/command_traits.ts","factions/ogor_mawtribes/flavors.ts","factions/ogor_mawtribes/grand_strategies.ts","factions/ogor_mawtribes/monstrous_rampages.ts","factions/ogor_mawtribes/mount_traits.ts","factions/ogor_mawtribes/prayers.ts","factions/ogor_mawtribes/scenery.ts","factions/ogor_mawtribes/spells.ts","factions/ogor_mawtribes/subfactions.ts","factions/ogor_mawtribes/index.ts","factions/ossiarch_bonereapers/battle_traits.ts","factions/ossiarch_bonereapers/rule_sources.ts","factions/ossiarch_bonereapers/battalions.ts","factions/ossiarch_bonereapers/battle_tactics.ts","factions/ossiarch_bonereapers/artifacts.ts","factions/ossiarch_bonereapers/command_abilities.ts","factions/ossiarch_bonereapers/command_traits.ts","factions/ossiarch_bonereapers/endless_spells.ts","factions/ossiarch_bonereapers/flavors.ts","factions/ossiarch_bonereapers/scenery.ts","factions/ossiarch_bonereapers/spells.ts","factions/ossiarch_bonereapers/units.ts","factions/ossiarch_bonereapers/grand_strategies.ts","factions/ossiarch_bonereapers/subfactions.ts","factions/ossiarch_bonereapers/index.ts","factions/seraphon/rule_sources.ts","factions/seraphon/artifacts.ts","factions/seraphon/battalions.ts","factions/seraphon/battle_tactics.ts","factions/seraphon/battle_traits.ts","factions/seraphon/command_abilities.ts","factions/seraphon/command_traits.ts","factions/seraphon/flavors.ts","factions/seraphon/grand_strategies.ts","factions/seraphon/monstrous_rampages.ts","factions/seraphon/scenery.ts","factions/seraphon/spells.ts","factions/seraphon/units.ts","factions/seraphon/subfactions.ts","factions/seraphon/index.ts","factions/skaven/rule_sources.ts","factions/skaven/artifacts.ts","factions/skaven/battle_traits.ts","factions/skaven/battle_tactics.ts","factions/skaven/command_abilities.ts","factions/skaven/command_traits.ts","factions/skaven/endless_spells.ts","factions/skaven/flavors.ts","factions/skaven/grand_strategies.ts","factions/skaven/prayers.ts","factions/skaven/scenery.ts","factions/skaven/spells.ts","factions/skaven/units.ts","factions/skaven/subfactions.ts","factions/skaven/index.ts","factions/slaanesh/battle_traits.ts","factions/slaanesh/rule_sources.ts","factions/slaanesh/artifacts.ts","factions/slaanesh/battalions.ts","factions/slaanesh/battle_tactics.ts","factions/slaanesh/command_traits.ts","factions/slaanesh/flavors.ts","factions/slaanesh/endless_spells.ts","factions/slaanesh/grand_strategies.ts","factions/slaanesh/scenery.ts","factions/slaanesh/spells.ts","factions/slaanesh/units.ts","factions/slaanesh/subfactions.ts","factions/slaanesh/index.ts","factions/sons_of_behemat/rule_sources.ts","factions/sons_of_behemat/artifacts.ts","factions/sons_of_behemat/battalions.ts","factions/sons_of_behemat/battle_tactics.ts","factions/sons_of_behemat/command_traits.ts","factions/sons_of_behemat/flavors.ts","factions/sons_of_behemat/grand_strategies.ts","factions/sons_of_behemat/battle_traits.ts","factions/sons_of_behemat/subfactions.ts","factions/sons_of_behemat/monstrous_rampages.ts","factions/sons_of_behemat/index.ts","factions/soulblight_gravelords/battle_traits.ts","factions/soulblight_gravelords/artifacts.ts","factions/soulblight_gravelords/battle_tactics.ts","factions/soulblight_gravelords/command_traits.ts","factions/soulblight_gravelords/grand_strategies.ts","factions/soulblight_gravelords/flavors.ts","factions/soulblight_gravelords/spells.ts","factions/soulblight_gravelords/units.ts","factions/soulblight_gravelords/subfactions.ts","factions/soulblight_gravelords/index.ts","factions/sylvaneth/rule_sources.ts","factions/sylvaneth/artifacts.ts","factions/sylvaneth/battalions.ts","factions/sylvaneth/battle_tactics.ts","factions/sylvaneth/battle_traits.ts","factions/sylvaneth/command_abilities.ts","factions/sylvaneth/command_traits.ts","factions/sylvaneth/endless_spells.ts","factions/sylvaneth/flavors.ts","factions/sylvaneth/grand_strategies.ts","factions/sylvaneth/monstrous_rampages.ts","factions/sylvaneth/scenery.ts","factions/sylvaneth/spells.ts","factions/sylvaneth/units.ts","factions/sylvaneth/subfactions.ts","factions/sylvaneth/index.ts","factions/tomb_kings/battle_traits.ts","factions/tomb_kings/command_abilities.ts","factions/tomb_kings/spells.ts","factions/tomb_kings/units.ts","factions/tomb_kings/subfactions.ts","factions/tomb_kings/index.ts","factions/tzeentch/rule_sources.ts","factions/tzeentch/artifacts.ts","factions/tzeentch/battalions.ts","factions/tzeentch/battle_tactics.ts","factions/tzeentch/battle_traits.ts","factions/tzeentch/command_traits.ts","factions/tzeentch/endless_spells.ts","factions/tzeentch/flavors.ts","factions/tzeentch/grand_strategies.ts","factions/tzeentch/spells.ts","factions/tzeentch/units.ts","factions/tzeentch/subfactions.ts","factions/tzeentch/index.ts","factions/wanderers/battle_traits.ts","factions/wanderers/artifacts.ts","factions/wanderers/command_abilities.ts","factions/wanderers/command_traits.ts","factions/wanderers/spells.ts","factions/wanderers/units.ts","factions/wanderers/subfactions.ts","factions/wanderers/index.ts","meta/faction_list.ts","meta/alliances.ts","utils/reminderUtils.ts","meta/game_structure.ts","factions/factionClass.ts","api/subscriptionApi.ts","factions/stormcast_eternals/units.ts","factions/stormcast_eternals/rule_sources.ts","utils/getTag.ts","components/input/generic_button.tsx","context/useAppStatus.tsx","utils/getArmy/getAllianceItems.ts","utils/getArmy/getCollection.ts","utils/getArmy/grandAllianceConfig.ts","utils/getArmy/modify.ts","utils/processGame.ts","utils/getArmy/getArmy.ts"],"names":["START_OF_HERO_PHASE","HERO_PHASE","END_OF_HERO_PHASE","START_OF_MOVEMENT_PHASE","MOVEMENT_PHASE","END_OF_MOVEMENT_PHASE","START_OF_SHOOTING_PHASE","SHOOTING_PHASE","END_OF_SHOOTING_PHASE","START_OF_CHARGE_PHASE","CHARGE_PHASE","END_OF_CHARGE_PHASE","START_OF_COMBAT_PHASE","COMBAT_PHASE","END_OF_COMBAT_PHASE","START_OF_BATTLESHOCK_PHASE","BATTLESHOCK_PHASE","END_OF_BATTLESHOCK_PHASE","SAVES_PHASE","WARDS_PHASE","WOUND_ALLOCATION_PHASE","START_OF_SETUP","DURING_SETUP","END_OF_SETUP","START_OF_GAME","DURING_GAME","END_OF_GAME","START_OF_TURN","DURING_TURN","END_OF_TURN","START_OF_ANY_PHASE","DURING_ANY_PHASE","END_OF_ANY_PHASE","START_OF_ROUND","DURING_ROUND","END_OF_ROUND","TURN_ONE_START_OF_TURN","TURN_ONE_START_OF_ROUND","TURN_ONE_DURING_TURN","TURN_ONE_DURING_ROUND","TURN_ONE_START_OF_HERO_PHASE","TURN_ONE_HERO_PHASE","TURN_ONE_END_OF_HERO_PHASE","TURN_ONE_START_OF_MOVEMENT_PHASE","TURN_ONE_MOVEMENT_PHASE","TURN_ONE_END_OF_MOVEMENT_PHASE","TURN_ONE_START_OF_SHOOTING_PHASE","TURN_ONE_SHOOTING_PHASE","TURN_ONE_END_OF_SHOOTING_PHASE","TURN_ONE_START_OF_CHARGE_PHASE","TURN_ONE_CHARGE_PHASE","TURN_ONE_END_OF_CHARGE_PHASE","TURN_ONE_START_OF_COMBAT_PHASE","TURN_ONE_COMBAT_PHASE","TURN_ONE_END_OF_COMBAT_PHASE","TURN_ONE_START_OF_BATTLESHOCK_PHASE","TURN_ONE_BATTLESHOCK_PHASE","TURN_ONE_END_OF_BATTLESHOCK_PHASE","TURN_ONE_END_OF_TURN","TURN_ONE_END_OF_ROUND","TURN_TWO_START_OF_TURN","TURN_TWO_START_OF_ROUND","TURN_TWO_DURING_TURN","TURN_TWO_DURING_ROUND","TURN_TWO_START_OF_HERO_PHASE","TURN_TWO_HERO_PHASE","TURN_TWO_END_OF_HERO_PHASE","TURN_TWO_START_OF_MOVEMENT_PHASE","TURN_TWO_MOVEMENT_PHASE","TURN_TWO_END_OF_MOVEMENT_PHASE","TURN_TWO_START_OF_SHOOTING_PHASE","TURN_TWO_SHOOTING_PHASE","TURN_TWO_END_OF_SHOOTING_PHASE","TURN_TWO_START_OF_CHARGE_PHASE","TURN_TWO_CHARGE_PHASE","TURN_TWO_END_OF_CHARGE_PHASE","TURN_TWO_START_OF_COMBAT_PHASE","TURN_TWO_COMBAT_PHASE","TURN_TWO_END_OF_COMBAT_PHASE","TURN_TWO_START_OF_BATTLESHOCK_PHASE","TURN_TWO_BATTLESHOCK_PHASE","TURN_TWO_END_OF_BATTLESHOCK_PHASE","TURN_TWO_END_OF_TURN","TURN_TWO_END_OF_ROUND","TURN_THREE_START_OF_TURN","TURN_THREE_START_OF_ROUND","TURN_THREE_DURING_TURN","TURN_THREE_DURING_ROUND","TURN_THREE_START_OF_HERO_PHASE","TURN_THREE_HERO_PHASE","TURN_THREE_END_OF_HERO_PHASE","TURN_THREE_START_OF_MOVEMENT_PHASE","TURN_THREE_MOVEMENT_PHASE","TURN_THREE_END_OF_MOVEMENT_PHASE","TURN_THREE_START_OF_SHOOTING_PHASE","TURN_THREE_SHOOTING_PHASE","TURN_THREE_END_OF_SHOOTING_PHASE","TURN_THREE_START_OF_CHARGE_PHASE","TURN_THREE_CHARGE_PHASE","TURN_THREE_END_OF_CHARGE_PHASE","TURN_THREE_START_OF_COMBAT_PHASE","TURN_THREE_COMBAT_PHASE","TURN_THREE_END_OF_COMBAT_PHASE","TURN_THREE_START_OF_BATTLESHOCK_PHASE","TURN_THREE_BATTLESHOCK_PHASE","TURN_THREE_END_OF_BATTLESHOCK_PHASE","TURN_THREE_END_OF_TURN","TURN_THREE_END_OF_ROUND","TURN_FOUR_START_OF_TURN","TURN_FOUR_START_OF_ROUND","TURN_FOUR_DURING_TURN","TURN_FOUR_DURING_ROUND","TURN_FOUR_START_OF_HERO_PHASE","TURN_FOUR_HERO_PHASE","TURN_FOUR_END_OF_HERO_PHASE","TURN_FOUR_START_OF_MOVEMENT_PHASE","TURN_FOUR_MOVEMENT_PHASE","TURN_FOUR_END_OF_MOVEMENT_PHASE","TURN_FOUR_START_OF_SHOOTING_PHASE","TURN_FOUR_SHOOTING_PHASE","TURN_FOUR_END_OF_SHOOTING_PHASE","TURN_FOUR_START_OF_CHARGE_PHASE","TURN_FOUR_CHARGE_PHASE","TURN_FOUR_END_OF_CHARGE_PHASE","TURN_FOUR_START_OF_COMBAT_PHASE","TURN_FOUR_COMBAT_PHASE","TURN_FOUR_END_OF_COMBAT_PHASE","TURN_FOUR_START_OF_BATTLESHOCK_PHASE","TURN_FOUR_BATTLESHOCK_PHASE","TURN_FOUR_END_OF_BATTLESHOCK_PHASE","TURN_FOUR_END_OF_TURN","TURN_FOUR_END_OF_ROUND","TURN_FIVE_START_OF_TURN","TURN_FIVE_START_OF_ROUND","TURN_FIVE_DURING_TURN","TURN_FIVE_DURING_ROUND","TURN_FIVE_START_OF_HERO_PHASE","TURN_FIVE_HERO_PHASE","TURN_FIVE_END_OF_HERO_PHASE","TURN_FIVE_START_OF_MOVEMENT_PHASE","TURN_FIVE_MOVEMENT_PHASE","TURN_FIVE_END_OF_MOVEMENT_PHASE","TURN_FIVE_START_OF_SHOOTING_PHASE","TURN_FIVE_SHOOTING_PHASE","TURN_FIVE_END_OF_SHOOTING_PHASE","TURN_FIVE_START_OF_CHARGE_PHASE","TURN_FIVE_CHARGE_PHASE","TURN_FIVE_END_OF_CHARGE_PHASE","TURN_FIVE_START_OF_COMBAT_PHASE","TURN_FIVE_COMBAT_PHASE","TURN_FIVE_END_OF_COMBAT_PHASE","TURN_FIVE_START_OF_BATTLESHOCK_PHASE","TURN_FIVE_BATTLESHOCK_PHASE","TURN_FIVE_END_OF_BATTLESHOCK_PHASE","TURN_FIVE_END_OF_TURN","TURN_FIVE_END_OF_ROUND","tagAs","obj","tag","Object","keys","reduce","a","key","taggedObj","keyOmitter","keys_to_omit","length","omit","keyPicker","keys_to_pick","pick","console","error","pickEffects","picked","k","concat","effects","GenericArtifacts","GenericCommandAbilities","GenericCommandTraits","meta_rule_sources","CORE_RULES_2021","CoreBattalions","CoreRules","name","desc","when","rule_sources","GenericEffects","DisruptivePresence","shared","Gargant","Terrorgheist","ZombieDragon","CrewedWarMachine","AelvenShield","Dragonfire","Terror","Impassable","Defensible","FactionTerrainSetup","FactionTerrainSetup_Removable","Predatory","Six_Inches","Eight_Inches","Nine_Inches","Twelve_Inches","Two_D6","Three_D6","Linked","Elite","Bonded","InfantryHornblowerEffect","ClanBannerEffect","ArcaniteShieldEffect","WizardOneSpellEffect","WizardTwoSpellsEffect","Summoning_Casting6_Range6_Effect","GHB_2021","Summoning_Casting5_Range8_Effect","GHB_2022","GHB_2022_2023_SEASON_2","Summoning_Casting6_Range8_Effect","ChronomanticCogsEffects","GHB_2023_2024","EmeraldLifeswarmEffects","SoulsnareShacklesEffects","SuffocatingGravetideEffects","GeminidsOfUhlGyshEffects","BurningHeadEffects","QuicksilverSwordsEffects","PurpleSunEffects","BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023","PrismaticPalisadeEffects","MalevolentMaelstromEffects","BATTLESCROLL_ANDTOR_SEPTEMBER_2023","RavenaksGnashingJawsEffects","ERRATA_GHB_JANUARY_2023","AethervoidPendulumEffects","UmbralSpellportalEffects","LauchonTheSoulseekerEffects","SoulscreamBridgeEffects","HorrorghastEffects","EndlessSpells","GenericGrandStrategies","GenericIncarnates","GenericMonstrousRampages","GenericPrayers","Realmscapes","RealmscapesEnum","ANDTOR","BATTLESCROLL_NULLSTONE_CACHE","DefaultScenery","accum","entry","GenericScenery","GenericSpells","GenericTriumphs","GenericManifestations","loadArmyFromLink","async","linkedArmy","PreferenceApi","getLinkedArmy","id","body","addArmyToStore","logEvent","factionName","err","loadedArmy","dispatch","store","factionNamesActions","setFactionName","setSubFactionName","subFactionName","allyFactionNames","armies","map","Army","getArmy","armyActions","updateAllyArmies","selectionActions","setSelections","selections","setAllySelections","allySelections","realmscapeActions","setOriginRealm","origin_realm","setRealmscape","realmscape","setRealmscapeFeature","realmscape_feature","hiddenReminders","visibilityActions","clearReminders","addReminders","notes","notesActions","setNotes","orderedReminders","LocalReminderOrder","setById","makeIdActive","logLoadedArmy","isDev","process","isTest","isProd","STRIPE_KEY","PAYPAL_CLIENT_ID","BASE_URL","SUBSCRIPTION_AUTH_KEY","GITHUB_URL","ROUTES","FAQ","HOME","JOIN","PROFILE","REDEEM","STATS","SUBSCRIBE","GOODBYE","army","createSlice","initialState","DefaultAppState","reducers","deleteAllyArmy","state","action","allyArmies","payload","resetAllArmies","resetAllyArmies","resetArmy","switchAllyArmy","next","prev","nextAllyArmy","updateAllyArmy","forEach","update","updateArmy","actions","SUPPORTED_REALMSCAPES","factionNames","resetNotes","addNote","uniq","addNotes","updateNote","idx","findIndex","x","deleteNote","filter","resetRealmscapeStore","includes","feature","find","realm","resetAllSelections","deleteAllySelection","resetAllySelection","units","battalions","resetAllySelections","resetSelections","resetSideEffects","sideEffects","updateAllyUnits","_state$allySelections","updateAllyBattalions","_state$allySelections2","setFlavors","handleSideEffects","setArtifacts","artifacts","addToSelections","value","slice","values","setBattalions","setBattleTactics","setCommandAbilities","command_abilities","setCoreRules","core_rules","setGrandStrategies","grand_strategies","setEndlessSpells","endless_spells","setScenery","scenery","setSpells","spells","setPrayers","prayers","setCommandTraits","setMountTraits","setMonstrousRampages","setIncarnates","setTriumphs","triumphs","setUnits","setManifestations","manifestations","removeSelections","entries","_ref","v","without","type","_state$selections","sideEffectNames","removedParentEffects","push","e","removedSideEffects","r","sideEffect","visibility","addSelector","selectors","deleteSelector","addAlly","allies","deleteAlly","addReminder","reminders","deleteReminder","addWhen","addWhens","deleteWhen","deleteWhens","clearWhen","Units","Codewright","Skywardens","Endrinriggers","Spinner","variant","size","className","colorClass","light","dark","secondary","style","width","height","sizeClass","_jsx","children","role","GiftedSubscriptionPlans","cost","stripe_dev","stripe_prod","title","SubscriptionPlans","monthly_cost","paypal_dev","paypal_prod","NavbarWrapper","theme","useTheme","isMobile","useWindowSize","navbarStyles","headerClass","headerColor","_jsxs","SUPPORTED_FACTIONS","battle_tactics","command_traits","flavors","incarnates","monstrous_rampages","mount_traits","Artifacts","Battalions","BattleTactics","BattleTraits","CommandAbilities","CommandTraits","Flavors","FlavorType","Game","GrandStrategies","Incarnates","MonstrousRampages","MountTraits","Prayers","Scenery","Spells","SubFaction","Triumphs","Manifestations","windowSize","setWindowSize","useState","undefined","useEffect","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","useMemo","isTinyMobile","saveArmyToS3","preparedArmy","prepareArmyForS3","SavedArmiesContext","React","createContext","SavedArmiesProvider","isOffline","useAppStatus","user","useAuth0","relevantNotes","useGetReminders","isActive","useSubscription","savedArmies","setSavedArmies","savedArmiesPopulated","setSavedArmiesPopulated","setLoadedArmyState","LocalLoadedArmy","get","hasOrderChanges","setHasOrderChanges","setLoadedArmy","useCallback","set","armyHasChanges","currentArmy","noChangesResponse","hasChanges","changedKeys","original","armyName","userName","createdAt","updatedAt","schemaVersion","loaded","getState","current","prepareArmy","sortBy","isEqual","log","loadSavedArmies","LocalSavedArmies","email","res","getUserItems","reverse","saveArmy","createSavedArmy","savedArmy","saveLink","createLink","url","deleteSavedArmy","deleteItem","data","updateItem","updateArmyName","reloadArmy","fullLoadedArmy","LocalUserName","Provider","useSavedArmies","context","useContext","Error","LoadingBtn","text","GenericButton","disabled","OfflineBtn","_ref2","FiWifiOff","LoadingHeader","OfflineHeader","pathname","location","Link","to","link","btn","LoadingBody","containerClass","bgColor","textMuted","LargeSpinner","_ref3","processConditions","game","startVal","arguments","conditionNames","mapListToDict","flatten","conditionsWithMetadata","selectionsKeyToEntryKey","condition","_conditionsWithMetada","getTagFromEntry","processCondition","produce","phase","sortedUniq","getMandatorySelectionsForAllies","item","mandatory","sliceKey","_item$mandatory","mergeParentEffectObjs","_entry","_slice","entryKeyToSelectionsKey","useSelector","selectAllyArmies","selectArmy","selectCurrentArmy","selectNotes","processReminders","_faction$factionBattl","allyData","allyArmy","alliedMandatorySelections","_unit","allAlliedSelections","faction","getFactionFromList","factionBattleTraits","t","hashReminder","titleCase","turnActions","actionTitle","getActionTitle","reminder_ids","flat","linked_hash","selectFactionName","selectSubFactionName","selectFactionNameSlice","selectOriginRealm","selectRealmscape","selectRealmscapeFeature","selectRealmscapeSlice","selectAllyFactionNames","selectAllySelections","selectSelections","selectSideEffects","selectAllies","selectReminders","selectSelectors","selectVisibility","selectWhen","hasSelections","some","names","b","STORMCAST_ETERNALS","subFactions","available","StormcastFaction","Faction","ORDER","SubFactions","BATTLETOME_STORMCAST_ETERNALS","Soulblight","Curseblade","Asylumaticae","Transfix","baseSubFaction","NighthauntUnits","GHoNArtifacts","GHoNCommandTraits","NighthauntEndlessSpells","LegionOfBloodArtifacts","LegionOfBloodCommandTraits","LegionOfNightArtifacts","LegionOfNightCommandTraits","LegionOfSacramentArtifacts","LegionOfSacramentCommandTraits","SoulblightArtifacts","SoulblightCommandTraits","SoulblightFlavors","LegionsOfNagashFaction","LEGIONS_OF_NAGASH","DEATH","LOCAL_LOADED_ARMY_KEY","LOCAL_REDEMPTION_KEY","LOCAL_REMINDER_ORDER","LOCAL_SAVED_ARMIES_KEY","LOCAL_THEME_KEY","LOCAL_USERNAME_KEY","hideNotificationBanner","localStorage","setItem","getNotificationBanner","getItem","LocalRedemptionKey","clear","removeItem","JSON","parse","giftId","userId","stringify","LocalTheme","byId","armyId","_reminders$byId","str","getAll","getWhen","setByWhen","ids","existingData","newData","dataFromId","Chaos","ChaosCommandAbilities","ChaosUnits","CHAOS_GRAND_ALLIANCE","ChaosArtifacts","ChaosCommandTraits","ChaosFaction","CHAOS","Death","DEATH_GRAND_ALLIANCE","DeathArtifacts","DeathCommandAbilities","DeathCommandTraits","DeathUnits","DeathFaction","Destruction","DESTRUCTION_GRAND_ALLIANCE","DestructionCommandAbilities","DestructionUnits","DestructionFaction","DESTRUCTION","Order","OrderUnits","ORDER_GRAND_ALLIANCE","OrderFaction","AvailableOrderUnits","AvailableDestructionUnits","AvailableDeathUnits","AvailableChaosUnits","BATTLETOME_ORRUK_WARCLANS","ERRATA_OCTOBER_2021","ERRATA_DECEMBER_2021","ERRATA_JULY_2022","ERRATA_OCTOBER_2022","BATTLETOME_SUPPLEMENT_IRONJAWZ","IronjawzArtifacts","IronjawzBattleTraits","IronjawzCommandTraits","IronjawzFlavors","IronjawzSpells","IronjawzUnits","IronjawzPrayers","KruleboyzArtifacts","KruleboyzBattleTraits","KruleboyzCommandTraits","Egomaniak","KruleboyzFlavors","KruleboyzSpells","KruleboyzUnits","Gutrippaz","Gobsprakk","Ironjawz","OrrukWarclansBattleTactics","IronjawzBattleTactics","IronjawzCommandAbilities","OrrukWarclansMountTraits","IronjawzMonstrousRampages","Kruleboyz","KruleboyzBattleTactics","OrrukWarclansFaction","ORRUK_WARCLANS","BATTLETOME_SLAVES_TO_DARKNESS","ERRATA_JANUARY_2023","SLAVES_TO_DARKNESS","Varanguard","Eternus","Slaughterbrute","Furies","Raptoryx","battle_traits","SlavesToDarknessFaction","BATTLETOME_KHARADRON_OVERLORDS","ERRATA_JANUARY_2021","ERRATA_JULY_2021","ERRATA_AUGUST_2021","WHITE_DWARF_MAY_2022","ERRATA_MARCH_2023","KHARADRON_OVERLORDS","BOOK_DAWNBRINGERS_BOOK_2","ERRATA_DAWNBRINGERS_BOOK_2","KharadronOverlordsFaction","ReactGA","initialize","gaOptions","siteSpeedSampleRate","logPageView","send","hitType","page","search","logToGA","event","logDownloadEvent","layout","isValidFactionName","category","label","logFactionSwitch","logSubFactionSwitch","subFaction","logAllyFaction","logClick","selectionStore","resetAnalyticsStore","logIndividualSelection","trait","lookup","logFailedImport","logInvalidFactionLookup","logDeprecatedImport","logIgnoredImport","logDisplay","element","logNote","logMigration","version","logSubscription","planTitle","provider","plan","transaction_id","generateUUID","gtag","items","sku","price","quantity","logGiftedSubscription","parseFloat","parseInt","toFixed","allyFactionName","_allySelections","ENTRY_PROPERTIES","SELECTION_TYPES","lowerToUpperLookup","artifact","battalion","battle_tactic","command_ability","command_trait","core_rule","endless_spell","grand_strategy","incarnate","monstrous_rampage","mount_trait","prayer","spell","triumph","unit","Selectors","BEASTS_OF_CHAOS","CITIES_OF_SIGMAR","DAUGHTERS_OF_KHAINE","DISPOSSESSED","FLESH_EATER_COURTS","FYRESLAYERS","GLOOMSPITE_GITZ","GREENSKINZ","IDONETH_DEEPKIN","KHORNE","LEGION_OF_AZGORH","LEGION_OF_GRIEF","LEGION_OF_THE_FIRST_PRINCE","LETHISIAN_DEFENDERS","LUMINETH_REALMLORDS","MEGA_GARGANT_MERCENARIES","MERCENARY_COMPANIES","NIGHTHAUNT","NURGLE","OGOR_MAWTRIBES","OSSIARCH_BONEREAPERS","SERAPHON","SKAVEN","SLAANESH","SONS_OF_BEHEMAT","SOULBLIGHT_GRAVELORDS","SYLVANETH","TOMB_KINGS","TZEENTCH","WANDERERS","PRIMARY_FACTIONS","ProtectedRoute","component","args","Route","withAuthenticationRequired","handleArmyLink","getArmyLink","qs","ignoreQueryPrefix","createBrowserHistory","Goodbye","lazy","Faq","Home","Join","Profile","Redeem","Subscribe","App","handleStripeCheckout","subscribed","canceled","gifted","isString","history","replaceState","document","Router","Suspense","fallback","Switch","path","exact","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","render","PersistGate","loading","persistor","Auth0Provider","domain","clientId","authorizationParams","redirect_uri","origin","onRedirectCallback","appState","replace","returnTo","AppStatusProvider","SubscriptionProvider","ThemeProvider","getElementById","URL","href","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","dispatchEvent","Event","checkValidServiceWorker","serviceWorkerRegistration","BroadcastChannel","postMessage","waitingServiceWorker","waiting","installNewWorker","temporaryAdapter","AlliedUnits","mergeData","subFactionAdapter","getAggregateArmy","flavorType","deepmerge","merged","objs","arr","parentEffectObjConverter","ERRATA_BROKEN_REALMS_TECLIS_MAY_2021","ERRATA_BROKEN_REALMS_TECLIS_JULY_2021","ERRATA_BROKEN_REALMS_MORATHI_JANUARY_2021","ERRATA_BROKEN_REALMS_MORATHI_JULY_2021","ERRATA_WRATH_OF_THE_EVERCHOSEN_JULY_2021","ERRATA_WRATH_OF_THE_EVERCHOSEN_AUGUST_2021","BOOK_BROKEN_REALMS_KRAGNOS","ERRATA_BROKEN_REALMS_KRAGNOS_JULY_2021","ERRATA_BROKEN_REALMS_KRAGNOS_AUGUST_2021","BOOK_BROKEN_REALMS_BELAKOR","ERRATA_BROKEN_REALMS_BELAKOR_AUGUST_2021","ERRATA_BROKEN_REALMS_BELAKOR_JULY_2022","ERRATA_CORE_RULES_JULY_2021","ERRATA_CORE_RULES_SEPTEMBER_2021","ERRATA_CORE_RULES_OCTOBER_2021","ERRATA_CORE_RULES_DECEMBER_2021","ERRATA_CORE_RULES_JULY_2022","ERRATA_CORE_RULES_OCTOBER_2022","ERRATA_CORE_RULES_JANUARY_2023","ERRATA_GHB_SEPTEMBER_2021","ERRATA_GHB_OCTOBER_2022","CROSS_FACTION_HEROES_JULY_2022","ERRATA_SEASON_OF_WAR_THONDIA","BATTLESCROLL_GALLETIAN_CHAMPIONS_JANUARY_2022","BOOK_DAWNBRINGERS_BOOK_1","BOOK_DAWNBRINGERS_BOOK_3","val","startCase","camelCase","stripPunctuation","Array","i","Math","random","toString","join","hashCode","hash","charCodeAt","joinedCond","suffix","Nagash","Chainghasts","Chainrasps","Hexwraiths","api","createErrorFile","request","post","createItem","delete","Quickblood","Beguile","DarkTheme","card","cardBody","cardHeader","dropzone","genericButton","genericButtonBlock","modalConfirmClass","modalDangerClass","modalSuccessClass","noteBorder","profileCardHeader","reminderHeader","reminderHr","secondaryButton","selectTheme","neutral0","neutral10","neutral20","neutral50","neutral80","primary","primary25","primary50","textOpposite","textSecondary","tooltip","LightTheme","ThemeContext","subscription","setTheme","isDark","setIsDark","setLightTheme","setDarkTheme","toggleTheme","Promise","resolve","SubscriptionApi","updateTheme","setThemeFromValue","isLight","armyHasEntries","include","prepared","centerContentClass","rootReducer","combineReducers","armyReducer","factionNamesReducer","notesReducer","realmscapeReducer","selectionsReducer","visibilityReducer","pReducer","persistReducer","storage","migrate","currentVersion","oldVersion","_persist","warn","createStore","__REDUX_DEVTOOLS_EXTENSION__","persistStore","getDeathlyInvocation","numUnits","getFrightfulTouchEffect","weapon","ChaliceOfBloodEffect","TheHungerEffect","FeasterOfSoulsEffect","HeraldsOfTheAccursedOneEffect","StandardBearerEffect","HornblowerEffect","WailOfTheDamnedEffect","CryptSwordEffect","CryptShieldsEffect","Vargheists","Necromancer","Zombies","isSubscriber","isActiveSubscriber","isPaypal","subscriptionStatus","hasActiveGrant","expired","has_grant","hasExpiredGrant","createdBy","SubscriptionContext","isLoading","setSubscription","subscriptionLoading","setSubscriptionLoading","isNotSubscribed","setIsNotSubscribed","createdByPaypal","createdByStripe","isStripe","isCanceled","active","isCanceledSubscriber","isGifted","planId","isGiftedSubscriber","isPending","isPendingSubscriber","isSubscribed","getSubscription","cancelSubscription","subscriptionId","BATTLETOME_BEASTS_OF_CHAOS","ERRATA_APRIL_2023","Allherd","Gavespawn","Darkwalkers","Quakefray","Herdstone","Viletide","Hailstorm","Thunderwave","Devolve","PropagatorOfDevolutionEffect","InfuseWithBestialVigorEffect","BrayhornEffect","BrayStandardBearerEffect","ChampionEffect","DespoilersEffect","BloodgreedEffect","BeneathTheTempestEffect","TzaangorChampionEffect","BabblingStreamOfSecretsEffect","GuidedByThePastEffect","Beastlord","Gors","Ungors","Bestigors","Centigors","Razorgors","Doombull","Bullgors","Ghorgon","Cygor","Jabberslythe","Cockatrice","Chimera","Tzaangors","BeastOfChaosFaction","BATTLETOME_CITIES_OF_SIGMAR","Battlemage","Flagellants","Runelord","Longbeards","Ironbreakers","Irondrakes","Hammerers","Cogsmith","Gyrobomber","Gyrocopters","Sorceress","Dreadspears","Bleakswords","Darkshards","Executioners","Assassin","Kharibdyss","CitiesOfSigmarFaction","BATTLETOME_DAUGHTERS_OF_KHAINE","ERRATA_DECEMBER_2022","Bladewind","DaughtersOfKhaineFaction","Grudgebound","Resolute","Resilient","Siegemaster","Unforgiving","Grudgebearer","ThrongMusiciansAndStandardBearerEffects","RunicIconAndClanBannerEffects","GromrilShieldsEffects","HornblowersEffect","DrummersEffect","DuardinBucklersEffects","IconBearerEffect","ForgeProvenGromrilArmorEffect","CinderblastBombEffect","Unforged","Quarrellers","Thunderers","Warriors","DispossessedFaction","BATTLETOME_FLESH_EATER_COURTS","Cryptguard","LoNUnits","FleshEaterCourtsFaction","BATTLETOME_FYRESLAYERS","Battlesmith","Doomseeker","FyreslayersFaction","BATTLETOME_GLOOMSPITE_GITZ","GROTMAS_GITZ","Loonboss","Gobbapalooza","Squigboss","GloomspiteGitzFaction","WarbossBaseEffects","WaaaghDrummersEffect","TuskerChargeEffect","Orruks","GreenskinzFaction","BATTLETOME_IDONETH_DEEPKIN","Dritchleech","baseSubfaction","IdonethDeepkinFaction","BATTLETOME_KHORNE","Firebrand","Skarbrand","Skulltaker","Karanak","Bloodletters","Bloodcrushers","Bloodsecrator","Slaughterpriest","Skullgrinder","Bloodstoker","Bloodreavers","Wrathmongers","Skullreapers","Khorgoraths","KhorneFaction","LegionOfAzgorh","Contemptuous","Relentless","Grotesque","Fireball","InfernalGuardBaseEffects","TrampleAndGoreEffect","PyrelockPistolEffect","SpiteshieldEffect","CarriageHaulerEffect","SiegeArtilleryEffects","Daemonsmith","LegionOfAzgorhFaction","LegionsOfNagashUnits","LegionOfGriefFaction","LegionOfTheFirstPrinceFaction","allied_units","KharadronUnits","StormcastUnits","IdonethUnits","LethisianDefendersFaction","BATTLETOME_LUMINETH","ERRATA_MAY_2021","Waystone","LuminethRealmlordsFaction","Gatebreaker","Warstomper","SonsOfBehematUnits","MegaGargantMercenariesFaction","Butcher","Firebelly","Gnoblars","Maneaters","Ironblaster","Leadbelchers","Ironguts","Slaughtermaster","Tyrant","BeastsOfChaosUnits","OgorMawtribeUnits","MercenaryCompaniesFaction","BATTLETOME_NIGHTHAUNT","NighthauntFaction","BATTLETOME_NURGLE","ERRATA_JANUARY_2022","Rotigus","Plaguebearers","Nurglings","Nurgle","NurgleFaction","BATTLETOME_OGOR_MAWTRIBES","OgorMawtribesFaction","BATTLETOME_OSSIARCH_BONEREAPERS","Vokmortian","Katakros","OssiarchBonereapersFaction","BATTLETOME_SERAPHON","Skinks","Kroxigor","Stegadon","Terrawings","SeraphonFaction","BATTLETOME_SKAVEN","Stormfiends","Doomwheel","Clanrats","Stormvermin","Clawlord","Plagueclaw","Deathmaster","SkavenFaction","BATTLETOME_SLAANESH","Hellflayer","Fiends","Daemonettes","Seekers","Dexcessa","SlaaneshFaction","BATTLETOME_SONS_OF_BEHEMAT","ERRATA_NOV_2020","ERRATA_MARCH_2021","WHITE_DWARF_AUGUST_2021","SonsOfBehematFaction","Neferata","Kritza","Vargskyr","SoulblightGravelordsFaction","BATTLETOME_SYLVANETH","ERRATA_NOVEMBER_2023","Warsinger","Spellsinger","Treelord","Branchwych","Dryads","Belthanos","SylvanethFaction","getIconBearerEffect","strength","plural","WarsphinxBaseEffects","TombShieldEffect","Necrotect","Ushabti","Warsphinx","Necrosphinx","Carrion","TombKingsFaction","BATTLETOME_TZEENTCH","Magister","TzeentchFaction","Wanderers","Spellweaver","Wayfinder","Waystrider","Waywatcher","WanderersFaction","FactionList","getFactionList","GRAND_ALLIANCE_FACTIONS","getVisibleReminders","hr","split","Phases","constructor","GrandAlliance","flavorLabel","rule_source","isMercenary","AggregateArmy","flavorKeys","subFactionKeys","subFactionKeyMap","subFactionArmies","checkForDataEntryErrors","validSelectionKeys","this","_this$SubFactions$k$a","_this$SubFactions$k","_this$SubFactions$k$m","_this$SubFactions$k2","selection","withAuth","authKey","redeemCoupon","redeemGift","requestGrant","Lorai","Liberators","Aetherwings","Vanquishers","Yndrasta","Praetors","Vindictors","Annihilators","Krondys","Vigilors","props","AppStatusContext","isGameMode","setIsGameMode","setIsOffline","hasNewContent","setHasNewContent","toggleGameMode","setOffline","setContent","updateChannel","ms","promise","method","mode","reject","setTimeout","timeout","poll","isOnline","getAllianceItems","grandAlliance","originalEntries","allianceItems","_FactionList$faction$","_values","sortedUniqBy","getGrandAllianceEndlessSpells","checkEffects","effect","Collection","forceKey","stopped","addToCollection","collection","existingIdx","existingEntry","uniqBy","effectToEntry","isSideEffect","GrandAllianceConfig","modify","modifyArtifacts","alliance","modifyBattalions","u","modifyBattleTactics","modifyCommandAbilities","c","modifyCommandTraits","modifyEndlessSpells","grandAllianceEndlessSpells","GenericEndlessSpells","modifyFlavors","modifyGrandStrategies","modifyIncarnates","modifyMonstrousRampages","modifyMountTraits","modifyPrayers","s","modifyScenery","modifySpells","modifyTriumphs","modifyUnits","alliedUnits","GrandAllianceUnits","modifyManifestations","addProps","entryProp","effectProp","originRealm","types","checkForMandatoryItems","_entry$mandatory","_tag","upperSlice","getCollection","modifyArmy","meta","GrandAllianceEndlessSpells","allEntries","withEntry"],"mappings":"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","file":"static/js/main.b5e11c69.chunk.js","sourcesContent":["// Phases\r\n// Hero\r\ntype THeroPhaseStart = 'START_OF_HERO_PHASE'\r\ntype THeroPhase = 'DURING_HERO_PHASE'\r\ntype THeroPhaseEnd = 'END_OF_HERO_PHASE'\r\n\r\n// Move\r\ntype TMovementPhaseStart = 'START_OF_MOVEMENT_PHASE'\r\ntype TMovementPhase = 'DURING_MOVEMENT_PHASE'\r\ntype TMovementPhaseEnd = 'END_OF_MOVEMENT_PHASE'\r\n\r\n// Shooting\r\ntype TShootingPhaseStart = 'START_OF_SHOOTING_PHASE'\r\ntype TShootingPhase = 'DURING_SHOOTING_PHASE'\r\ntype TShootingPhaseEnd = 'END_OF_SHOOTING_PHASE'\r\n\r\n// Charge\r\ntype TChargePhaseStart = 'START_OF_CHARGE_PHASE'\r\ntype TChargePhase = 'DURING_CHARGE_PHASE'\r\ntype TChargePhaseEnd = 'END_OF_CHARGE_PHASE'\r\n\r\n// Combat\r\ntype TCombatPhaseStart = 'START_OF_COMBAT_PHASE'\r\ntype TCombatPhase = 'DURING_COMBAT_PHASE'\r\ntype TCombatPhaseEnd = 'END_OF_COMBAT_PHASE'\r\n\r\n// Battleshock\r\ntype TBattleshockPhaseStart = 'START_OF_BATTLESHOCK_PHASE'\r\ntype TBattleshockPhase = 'DURING_BATTLESHOCK_PHASE'\r\ntype TBattleshockPhaseEnd = 'END_OF_BATTLESHOCK_PHASE'\r\n\r\n// Global Saves\r\ntype TSavesPhase = 'SAVES'\r\n\r\n// Global Wards\r\ntype TWardsPhase = 'WARDS'\r\n\r\n// Global Wound Allocation\r\ntype TWoundAllocationPhase = 'WOUND_ALLOCATION'\r\n\r\n// Phases Exports\r\nexport const START_OF_HERO_PHASE: THeroPhaseStart = 'START_OF_HERO_PHASE'\r\nexport const HERO_PHASE: THeroPhase = 'DURING_HERO_PHASE'\r\nexport const END_OF_HERO_PHASE: THeroPhaseEnd = 'END_OF_HERO_PHASE'\r\nexport const START_OF_MOVEMENT_PHASE: TMovementPhaseStart = 'START_OF_MOVEMENT_PHASE'\r\nexport const MOVEMENT_PHASE: TMovementPhase = 'DURING_MOVEMENT_PHASE'\r\nexport const END_OF_MOVEMENT_PHASE: TMovementPhaseEnd = 'END_OF_MOVEMENT_PHASE'\r\nexport const START_OF_SHOOTING_PHASE: TShootingPhaseStart = 'START_OF_SHOOTING_PHASE'\r\nexport const SHOOTING_PHASE: TShootingPhase = 'DURING_SHOOTING_PHASE'\r\nexport const END_OF_SHOOTING_PHASE: TShootingPhaseEnd = 'END_OF_SHOOTING_PHASE'\r\nexport const START_OF_CHARGE_PHASE: TChargePhaseStart = 'START_OF_CHARGE_PHASE'\r\nexport const CHARGE_PHASE: TChargePhase = 'DURING_CHARGE_PHASE'\r\nexport const END_OF_CHARGE_PHASE: TChargePhaseEnd = 'END_OF_CHARGE_PHASE'\r\nexport const START_OF_COMBAT_PHASE: TCombatPhaseStart = 'START_OF_COMBAT_PHASE'\r\nexport const COMBAT_PHASE: TCombatPhase = 'DURING_COMBAT_PHASE'\r\nexport const END_OF_COMBAT_PHASE: TCombatPhaseEnd = 'END_OF_COMBAT_PHASE'\r\nexport const START_OF_BATTLESHOCK_PHASE: TBattleshockPhaseStart = 'START_OF_BATTLESHOCK_PHASE'\r\nexport const BATTLESHOCK_PHASE: TBattleshockPhase = 'DURING_BATTLESHOCK_PHASE'\r\nexport const END_OF_BATTLESHOCK_PHASE: TBattleshockPhaseEnd = 'END_OF_BATTLESHOCK_PHASE'\r\n\r\n// Artificial phases that help organize the game better\r\nexport const SAVES_PHASE: TSavesPhase = 'SAVES'\r\nexport const WARDS_PHASE: TWardsPhase = 'WARDS'\r\nexport const WOUND_ALLOCATION_PHASE: TWoundAllocationPhase = 'WOUND_ALLOCATION'\r\n\r\n// Turn Types\r\ntype TSetupStart = 'START_OF_SETUP'\r\ntype TDuringSetup = 'DURING_SETUP'\r\ntype TSetupEnd = 'END_OF_SETUP'\r\ntype TGameStart = 'START_OF_GAME'\r\ntype TGameDuring = 'DURING_GAME'\r\ntype TTurnStart = 'START_OF_TURN'\r\ntype TRoundStart = 'START_OF_ROUND'\r\ntype TTurnDuring = 'DURING_TURN'\r\ntype TRoundDuring = 'DURING_ROUND'\r\ntype TTurnEnd = 'END_OF_TURN'\r\ntype TRoundEnd = 'END_OF_ROUND'\r\ntype TGameEnd = 'END_OF_GAME'\r\ntype TPhaseStartOfAny = 'START_OF_ANY_PHASE'\r\ntype TPhaseDuringAny = 'DURING_ANY_PHASE'\r\ntype TPhaseEndOfAny = 'END_OF_ANY_PHASE'\r\n\r\n// Turn Exports\r\nexport const START_OF_SETUP: TSetupStart = 'START_OF_SETUP'\r\nexport const DURING_SETUP: TDuringSetup = 'DURING_SETUP'\r\nexport const END_OF_SETUP: TSetupEnd = 'END_OF_SETUP'\r\n\r\nexport const START_OF_GAME: TGameStart = 'START_OF_GAME'\r\nexport const DURING_GAME: TGameDuring = 'DURING_GAME'\r\nexport const END_OF_GAME: TGameEnd = 'END_OF_GAME'\r\n\r\nexport const START_OF_TURN: TTurnStart = 'START_OF_TURN'\r\nexport const DURING_TURN: TTurnDuring = 'DURING_TURN'\r\nexport const END_OF_TURN: TTurnEnd = 'END_OF_TURN'\r\n\r\nexport const START_OF_ANY_PHASE: TPhaseStartOfAny = 'START_OF_ANY_PHASE'\r\nexport const DURING_ANY_PHASE: TPhaseDuringAny = 'DURING_ANY_PHASE'\r\nexport const END_OF_ANY_PHASE: TPhaseEndOfAny = 'END_OF_ANY_PHASE'\r\n\r\nexport const START_OF_ROUND: TRoundStart = 'START_OF_ROUND'\r\nexport const DURING_ROUND: TRoundDuring = 'DURING_ROUND'\r\nexport const END_OF_ROUND: TRoundEnd = 'END_OF_ROUND'\r\n\r\n// Specific Turn Phases\r\ntype TTurnOne_START_OF_TURN = 'TURN_ONE_START_OF_TURN'\r\ntype TTurnOne_START_OF_ROUND = 'TURN_ONE_START_OF_ROUND'\r\ntype TTurnOne_DURING_TURN = 'TURN_ONE_DURING_TURN'\r\ntype TTurnOne_DURING_ROUND = 'TURN_ONE_DURING_ROUND'\r\ntype TTurnOne_START_OF_HERO_PHASE = 'TURN_ONE_START_OF_HERO_PHASE'\r\ntype TTurnOne_HERO_PHASE = 'TURN_ONE_DURING_HERO_PHASE'\r\ntype TTurnOne_END_OF_HERO_PHASE = 'TURN_ONE_END_OF_HERO_PHASE'\r\ntype TTurnOne_START_OF_MOVEMENT_PHASE = 'TURN_ONE_START_OF_MOVEMENT_PHASE'\r\ntype TTurnOne_MOVEMENT_PHASE = 'TURN_ONE_DURING_MOVEMENT_PHASE'\r\ntype TTurnOne_END_OF_MOVEMENT_PHASE = 'TURN_ONE_END_OF_MOVEMENT_PHASE'\r\ntype TTurnOne_START_OF_SHOOTING_PHASE = 'TURN_ONE_START_OF_SHOOTING_PHASE'\r\ntype TTurnOne_SHOOTING_PHASE = 'TURN_ONE_DURING_SHOOTING_PHASE'\r\ntype TTurnOne_END_OF_SHOOTING_PHASE = 'TURN_ONE_END_OF_SHOOTING_PHASE'\r\ntype TTurnOne_START_OF_CHARGE_PHASE = 'TURN_ONE_START_OF_CHARGE_PHASE'\r\ntype TTurnOne_CHARGE_PHASE = 'TURN_ONE_DURING_CHARGE_PHASE'\r\ntype TTurnOne_END_OF_CHARGE_PHASE = 'TURN_ONE_END_OF_CHARGE_PHASE'\r\ntype TTurnOne_START_OF_COMBAT_PHASE = 'TURN_ONE_START_OF_COMBAT_PHASE'\r\ntype TTurnOne_COMBAT_PHASE = 'TURN_ONE_DURING_COMBAT_PHASE'\r\ntype TTurnOne_END_OF_COMBAT_PHASE = 'TURN_ONE_END_OF_COMBAT_PHASE'\r\ntype TTurnOne_START_OF_BATTLESHOCK_PHASE = 'TURN_ONE_START_OF_BATTLESHOCK_PHASE'\r\ntype TTurnOne_BATTLESHOCK_PHASE = 'TURN_ONE_DURING_BATTLESHOCK_PHASE'\r\ntype TTurnOne_END_OF_BATTLESHOCK_PHASE = 'TURN_ONE_END_OF_BATTLESHOCK_PHASE'\r\ntype TTurnOne_END_OF_TURN = 'TURN_ONE_END_OF_TURN'\r\ntype TTurnOne_END_OF_ROUND = 'TURN_ONE_END_OF_ROUND'\r\ntype TTurnTwo_START_OF_TURN = 'TURN_TWO_START_OF_TURN'\r\ntype TTurnTwo_START_OF_ROUND = 'TURN_TWO_START_OF_ROUND'\r\ntype TTurnTwo_DURING_TURN = 'TURN_TWO_DURING_TURN'\r\ntype TTurnTwo_DURING_ROUND = 'TURN_TWO_DURING_ROUND'\r\ntype TTurnTwo_START_OF_HERO_PHASE = 'TURN_TWO_START_OF_HERO_PHASE'\r\ntype TTurnTwo_HERO_PHASE = 'TURN_TWO_DURING_HERO_PHASE'\r\ntype TTurnTwo_END_OF_HERO_PHASE = 'TURN_TWO_END_OF_HERO_PHASE'\r\ntype TTurnTwo_START_OF_MOVEMENT_PHASE = 'TURN_TWO_START_OF_MOVEMENT_PHASE'\r\ntype TTurnTwo_MOVEMENT_PHASE = 'TURN_TWO_DURING_MOVEMENT_PHASE'\r\ntype TTurnTwo_END_OF_MOVEMENT_PHASE = 'TURN_TWO_END_OF_MOVEMENT_PHASE'\r\ntype TTurnTwo_START_OF_SHOOTING_PHASE = 'TURN_TWO_START_OF_SHOOTING_PHASE'\r\ntype TTurnTwo_SHOOTING_PHASE = 'TURN_TWO_DURING_SHOOTING_PHASE'\r\ntype TTurnTwo_END_OF_SHOOTING_PHASE = 'TURN_TWO_END_OF_SHOOTING_PHASE'\r\ntype TTurnTwo_START_OF_CHARGE_PHASE = 'TURN_TWO_START_OF_CHARGE_PHASE'\r\ntype TTurnTwo_CHARGE_PHASE = 'TURN_TWO_DURING_CHARGE_PHASE'\r\ntype TTurnTwo_END_OF_CHARGE_PHASE = 'TURN_TWO_END_OF_CHARGE_PHASE'\r\ntype TTurnTwo_START_OF_COMBAT_PHASE = 'TURN_TWO_START_OF_COMBAT_PHASE'\r\ntype TTurnTwo_COMBAT_PHASE = 'TURN_TWO_DURING_COMBAT_PHASE'\r\ntype TTurnTwo_END_OF_COMBAT_PHASE = 'TURN_TWO_END_OF_COMBAT_PHASE'\r\ntype TTurnTwo_START_OF_BATTLESHOCK_PHASE = 'TURN_TWO_START_OF_BATTLESHOCK_PHASE'\r\ntype TTurnTwo_BATTLESHOCK_PHASE = 'TURN_TWO_DURING_BATTLESHOCK_PHASE'\r\ntype TTurnTwo_END_OF_BATTLESHOCK_PHASE = 'TURN_TWO_END_OF_BATTLESHOCK_PHASE'\r\ntype TTurnTwo_END_OF_TURN = 'TURN_TWO_END_OF_TURN'\r\ntype TTurnTwo_END_OF_ROUND = 'TURN_TWO_END_OF_ROUND'\r\ntype TTurnThree_START_OF_TURN = 'TURN_THREE_START_OF_TURN'\r\ntype TTurnThree_START_OF_ROUND = 'TURN_THREE_START_OF_ROUND'\r\ntype TTurnThree_DURING_TURN = 'TURN_THREE_DURING_TURN'\r\ntype TTurnThree_DURING_ROUND = 'TURN_THREE_DURING_ROUND'\r\ntype TTurnThree_START_OF_HERO_PHASE = 'TURN_THREE_START_OF_HERO_PHASE'\r\ntype TTurnThree_HERO_PHASE = 'TURN_THREE_DURING_HERO_PHASE'\r\ntype TTurnThree_END_OF_HERO_PHASE = 'TURN_THREE_END_OF_HERO_PHASE'\r\ntype TTurnThree_START_OF_MOVEMENT_PHASE = 'TURN_THREE_START_OF_MOVEMENT_PHASE'\r\ntype TTurnThree_MOVEMENT_PHASE = 'TURN_THREE_DURING_MOVEMENT_PHASE'\r\ntype TTurnThree_END_OF_MOVEMENT_PHASE = 'TURN_THREE_END_OF_MOVEMENT_PHASE'\r\ntype TTurnThree_START_OF_SHOOTING_PHASE = 'TURN_THREE_START_OF_SHOOTING_PHASE'\r\ntype TTurnThree_SHOOTING_PHASE = 'TURN_THREE_DURING_SHOOTING_PHASE'\r\ntype TTurnThree_END_OF_SHOOTING_PHASE = 'TURN_THREE_END_OF_SHOOTING_PHASE'\r\ntype TTurnThree_START_OF_CHARGE_PHASE = 'TURN_THREE_START_OF_CHARGE_PHASE'\r\ntype TTurnThree_CHARGE_PHASE = 'TURN_THREE_DURING_CHARGE_PHASE'\r\ntype TTurnThree_END_OF_CHARGE_PHASE = 'TURN_THREE_END_OF_CHARGE_PHASE'\r\ntype TTurnThree_START_OF_COMBAT_PHASE = 'TURN_THREE_START_OF_COMBAT_PHASE'\r\ntype TTurnThree_COMBAT_PHASE = 'TURN_THREE_DURING_COMBAT_PHASE'\r\ntype TTurnThree_END_OF_COMBAT_PHASE = 'TURN_THREE_END_OF_COMBAT_PHASE'\r\ntype TTurnThree_START_OF_BATTLESHOCK_PHASE = 'TURN_THREE_START_OF_BATTLESHOCK_PHASE'\r\ntype TTurnThree_BATTLESHOCK_PHASE = 'TURN_THREE_DURING_BATTLESHOCK_PHASE'\r\ntype TTurnThree_END_OF_BATTLESHOCK_PHASE = 'TURN_THREE_END_OF_BATTLESHOCK_PHASE'\r\ntype TTurnThree_END_OF_TURN = 'TURN_THREE_END_OF_TURN'\r\ntype TTurnThree_END_OF_ROUND = 'TURN_THREE_END_OF_ROUND'\r\ntype TTurnFour_START_OF_TURN = 'TURN_FOUR_START_OF_TURN'\r\ntype TTurnFour_START_OF_ROUND = 'TURN_FOUR_START_OF_ROUND'\r\ntype TTurnFour_DURING_TURN = 'TURN_FOUR_DURING_TURN'\r\ntype TTurnFour_DURING_ROUND = 'TURN_FOUR_DURING_ROUND'\r\ntype TTurnFour_START_OF_HERO_PHASE = 'TURN_FOUR_START_OF_HERO_PHASE'\r\ntype TTurnFour_HERO_PHASE = 'TURN_FOUR_DURING_HERO_PHASE'\r\ntype TTurnFour_END_OF_HERO_PHASE = 'TURN_FOUR_END_OF_HERO_PHASE'\r\ntype TTurnFour_START_OF_MOVEMENT_PHASE = 'TURN_FOUR_START_OF_MOVEMENT_PHASE'\r\ntype TTurnFour_MOVEMENT_PHASE = 'TURN_FOUR_DURING_MOVEMENT_PHASE'\r\ntype TTurnFour_END_OF_MOVEMENT_PHASE = 'TURN_FOUR_END_OF_MOVEMENT_PHASE'\r\ntype TTurnFour_START_OF_SHOOTING_PHASE = 'TURN_FOUR_START_OF_SHOOTING_PHASE'\r\ntype TTurnFour_SHOOTING_PHASE = 'TURN_FOUR_DURING_SHOOTING_PHASE'\r\ntype TTurnFour_END_OF_SHOOTING_PHASE = 'TURN_FOUR_END_OF_SHOOTING_PHASE'\r\ntype TTurnFour_START_OF_CHARGE_PHASE = 'TURN_FOUR_START_OF_CHARGE_PHASE'\r\ntype TTurnFour_CHARGE_PHASE = 'TURN_FOUR_DURING_CHARGE_PHASE'\r\ntype TTurnFour_END_OF_CHARGE_PHASE = 'TURN_FOUR_END_OF_CHARGE_PHASE'\r\ntype TTurnFour_START_OF_COMBAT_PHASE = 'TURN_FOUR_START_OF_COMBAT_PHASE'\r\ntype TTurnFour_COMBAT_PHASE = 'TURN_FOUR_DURING_COMBAT_PHASE'\r\ntype TTurnFour_END_OF_COMBAT_PHASE = 'TURN_FOUR_END_OF_COMBAT_PHASE'\r\ntype TTurnFour_START_OF_BATTLESHOCK_PHASE = 'TURN_FOUR_START_OF_BATTLESHOCK_PHASE'\r\ntype TTurnFour_BATTLESHOCK_PHASE = 'TURN_FOUR_DURING_BATTLESHOCK_PHASE'\r\ntype TTurnFour_END_OF_BATTLESHOCK_PHASE = 'TURN_FOUR_END_OF_BATTLESHOCK_PHASE'\r\ntype TTurnFour_END_OF_TURN = 'TURN_FOUR_END_OF_TURN'\r\ntype TTurnFour_END_OF_ROUND = 'TURN_FOUR_END_OF_ROUND'\r\ntype TTurnFive_START_OF_TURN = 'TURN_FIVE_START_OF_TURN'\r\ntype TTurnFive_START_OF_ROUND = 'TURN_FIVE_START_OF_ROUND'\r\ntype TTurnFive_DURING_TURN = 'TURN_FIVE_DURING_TURN'\r\ntype TTurnFive_DURING_ROUND = 'TURN_FIVE_DURING_ROUND'\r\ntype TTurnFive_START_OF_HERO_PHASE = 'TURN_FIVE_START_OF_HERO_PHASE'\r\ntype TTurnFive_HERO_PHASE = 'TURN_FIVE_DURING_HERO_PHASE'\r\ntype TTurnFive_END_OF_HERO_PHASE = 'TURN_FIVE_END_OF_HERO_PHASE'\r\ntype TTurnFive_START_OF_MOVEMENT_PHASE = 'TURN_FIVE_START_OF_MOVEMENT_PHASE'\r\ntype TTurnFive_MOVEMENT_PHASE = 'TURN_FIVE_DURING_MOVEMENT_PHASE'\r\ntype TTurnFive_END_OF_MOVEMENT_PHASE = 'TURN_FIVE_END_OF_MOVEMENT_PHASE'\r\ntype TTurnFive_START_OF_SHOOTING_PHASE = 'TURN_FIVE_START_OF_SHOOTING_PHASE'\r\ntype TTurnFive_SHOOTING_PHASE = 'TURN_FIVE_DURING_SHOOTING_PHASE'\r\ntype TTurnFive_END_OF_SHOOTING_PHASE = 'TURN_FIVE_END_OF_SHOOTING_PHASE'\r\ntype TTurnFive_START_OF_CHARGE_PHASE = 'TURN_FIVE_START_OF_CHARGE_PHASE'\r\ntype TTurnFive_CHARGE_PHASE = 'TURN_FIVE_DURING_CHARGE_PHASE'\r\ntype TTurnFive_END_OF_CHARGE_PHASE = 'TURN_FIVE_END_OF_CHARGE_PHASE'\r\ntype TTurnFive_START_OF_COMBAT_PHASE = 'TURN_FIVE_START_OF_COMBAT_PHASE'\r\ntype TTurnFive_COMBAT_PHASE = 'TURN_FIVE_DURING_COMBAT_PHASE'\r\ntype TTurnFive_END_OF_COMBAT_PHASE = 'TURN_FIVE_END_OF_COMBAT_PHASE'\r\ntype TTurnFive_START_OF_BATTLESHOCK_PHASE = 'TURN_FIVE_START_OF_BATTLESHOCK_PHASE'\r\ntype TTurnFive_BATTLESHOCK_PHASE = 'TURN_FIVE_DURING_BATTLESHOCK_PHASE'\r\ntype TTurnFive_END_OF_BATTLESHOCK_PHASE = 'TURN_FIVE_END_OF_BATTLESHOCK_PHASE'\r\ntype TTurnFive_END_OF_TURN = 'TURN_FIVE_END_OF_TURN'\r\ntype TTurnFive_END_OF_ROUND = 'TURN_FIVE_END_OF_ROUND'\r\n\r\n// Specific Turn Consts\r\nexport const TURN_ONE_START_OF_TURN: TTurnOne_START_OF_TURN = 'TURN_ONE_START_OF_TURN'\r\nexport const TURN_ONE_START_OF_ROUND: TTurnOne_START_OF_ROUND = 'TURN_ONE_START_OF_ROUND'\r\nexport const TURN_ONE_DURING_TURN: TTurnOne_DURING_TURN = 'TURN_ONE_DURING_TURN'\r\nexport const TURN_ONE_DURING_ROUND: TTurnOne_DURING_ROUND = 'TURN_ONE_DURING_ROUND'\r\nexport const TURN_ONE_START_OF_HERO_PHASE: TTurnOne_START_OF_HERO_PHASE = 'TURN_ONE_START_OF_HERO_PHASE'\r\nexport const TURN_ONE_HERO_PHASE: TTurnOne_HERO_PHASE = 'TURN_ONE_DURING_HERO_PHASE'\r\nexport const TURN_ONE_END_OF_HERO_PHASE: TTurnOne_END_OF_HERO_PHASE = 'TURN_ONE_END_OF_HERO_PHASE'\r\nexport const TURN_ONE_START_OF_MOVEMENT_PHASE: TTurnOne_START_OF_MOVEMENT_PHASE =\r\n  'TURN_ONE_START_OF_MOVEMENT_PHASE'\r\nexport const TURN_ONE_MOVEMENT_PHASE: TTurnOne_MOVEMENT_PHASE = 'TURN_ONE_DURING_MOVEMENT_PHASE'\r\nexport const TURN_ONE_END_OF_MOVEMENT_PHASE: TTurnOne_END_OF_MOVEMENT_PHASE = 'TURN_ONE_END_OF_MOVEMENT_PHASE'\r\nexport const TURN_ONE_START_OF_SHOOTING_PHASE: TTurnOne_START_OF_SHOOTING_PHASE =\r\n  'TURN_ONE_START_OF_SHOOTING_PHASE'\r\nexport const TURN_ONE_SHOOTING_PHASE: TTurnOne_SHOOTING_PHASE = 'TURN_ONE_DURING_SHOOTING_PHASE'\r\nexport const TURN_ONE_END_OF_SHOOTING_PHASE: TTurnOne_END_OF_SHOOTING_PHASE = 'TURN_ONE_END_OF_SHOOTING_PHASE'\r\nexport const TURN_ONE_START_OF_CHARGE_PHASE: TTurnOne_START_OF_CHARGE_PHASE = 'TURN_ONE_START_OF_CHARGE_PHASE'\r\nexport const TURN_ONE_CHARGE_PHASE: TTurnOne_CHARGE_PHASE = 'TURN_ONE_DURING_CHARGE_PHASE'\r\nexport const TURN_ONE_END_OF_CHARGE_PHASE: TTurnOne_END_OF_CHARGE_PHASE = 'TURN_ONE_END_OF_CHARGE_PHASE'\r\nexport const TURN_ONE_START_OF_COMBAT_PHASE: TTurnOne_START_OF_COMBAT_PHASE = 'TURN_ONE_START_OF_COMBAT_PHASE'\r\nexport const TURN_ONE_COMBAT_PHASE: TTurnOne_COMBAT_PHASE = 'TURN_ONE_DURING_COMBAT_PHASE'\r\nexport const TURN_ONE_END_OF_COMBAT_PHASE: TTurnOne_END_OF_COMBAT_PHASE = 'TURN_ONE_END_OF_COMBAT_PHASE'\r\nexport const TURN_ONE_START_OF_BATTLESHOCK_PHASE: TTurnOne_START_OF_BATTLESHOCK_PHASE =\r\n  'TURN_ONE_START_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_ONE_BATTLESHOCK_PHASE: TTurnOne_BATTLESHOCK_PHASE = 'TURN_ONE_DURING_BATTLESHOCK_PHASE'\r\nexport const TURN_ONE_END_OF_BATTLESHOCK_PHASE: TTurnOne_END_OF_BATTLESHOCK_PHASE =\r\n  'TURN_ONE_END_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_ONE_END_OF_TURN: TTurnOne_END_OF_TURN = 'TURN_ONE_END_OF_TURN'\r\nexport const TURN_ONE_END_OF_ROUND: TTurnOne_END_OF_ROUND = 'TURN_ONE_END_OF_ROUND'\r\nexport const TURN_TWO_START_OF_TURN: TTurnTwo_START_OF_TURN = 'TURN_TWO_START_OF_TURN'\r\nexport const TURN_TWO_START_OF_ROUND: TTurnTwo_START_OF_ROUND = 'TURN_TWO_START_OF_ROUND'\r\nexport const TURN_TWO_DURING_TURN: TTurnTwo_DURING_TURN = 'TURN_TWO_DURING_TURN'\r\nexport const TURN_TWO_DURING_ROUND: TTurnTwo_DURING_ROUND = 'TURN_TWO_DURING_ROUND'\r\nexport const TURN_TWO_START_OF_HERO_PHASE: TTurnTwo_START_OF_HERO_PHASE = 'TURN_TWO_START_OF_HERO_PHASE'\r\nexport const TURN_TWO_HERO_PHASE: TTurnTwo_HERO_PHASE = 'TURN_TWO_DURING_HERO_PHASE'\r\nexport const TURN_TWO_END_OF_HERO_PHASE: TTurnTwo_END_OF_HERO_PHASE = 'TURN_TWO_END_OF_HERO_PHASE'\r\nexport const TURN_TWO_START_OF_MOVEMENT_PHASE: TTurnTwo_START_OF_MOVEMENT_PHASE =\r\n  'TURN_TWO_START_OF_MOVEMENT_PHASE'\r\nexport const TURN_TWO_MOVEMENT_PHASE: TTurnTwo_MOVEMENT_PHASE = 'TURN_TWO_DURING_MOVEMENT_PHASE'\r\nexport const TURN_TWO_END_OF_MOVEMENT_PHASE: TTurnTwo_END_OF_MOVEMENT_PHASE = 'TURN_TWO_END_OF_MOVEMENT_PHASE'\r\nexport const TURN_TWO_START_OF_SHOOTING_PHASE: TTurnTwo_START_OF_SHOOTING_PHASE =\r\n  'TURN_TWO_START_OF_SHOOTING_PHASE'\r\nexport const TURN_TWO_SHOOTING_PHASE: TTurnTwo_SHOOTING_PHASE = 'TURN_TWO_DURING_SHOOTING_PHASE'\r\nexport const TURN_TWO_END_OF_SHOOTING_PHASE: TTurnTwo_END_OF_SHOOTING_PHASE = 'TURN_TWO_END_OF_SHOOTING_PHASE'\r\nexport const TURN_TWO_START_OF_CHARGE_PHASE: TTurnTwo_START_OF_CHARGE_PHASE = 'TURN_TWO_START_OF_CHARGE_PHASE'\r\nexport const TURN_TWO_CHARGE_PHASE: TTurnTwo_CHARGE_PHASE = 'TURN_TWO_DURING_CHARGE_PHASE'\r\nexport const TURN_TWO_END_OF_CHARGE_PHASE: TTurnTwo_END_OF_CHARGE_PHASE = 'TURN_TWO_END_OF_CHARGE_PHASE'\r\nexport const TURN_TWO_START_OF_COMBAT_PHASE: TTurnTwo_START_OF_COMBAT_PHASE = 'TURN_TWO_START_OF_COMBAT_PHASE'\r\nexport const TURN_TWO_COMBAT_PHASE: TTurnTwo_COMBAT_PHASE = 'TURN_TWO_DURING_COMBAT_PHASE'\r\nexport const TURN_TWO_END_OF_COMBAT_PHASE: TTurnTwo_END_OF_COMBAT_PHASE = 'TURN_TWO_END_OF_COMBAT_PHASE'\r\nexport const TURN_TWO_START_OF_BATTLESHOCK_PHASE: TTurnTwo_START_OF_BATTLESHOCK_PHASE =\r\n  'TURN_TWO_START_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_TWO_BATTLESHOCK_PHASE: TTurnTwo_BATTLESHOCK_PHASE = 'TURN_TWO_DURING_BATTLESHOCK_PHASE'\r\nexport const TURN_TWO_END_OF_BATTLESHOCK_PHASE: TTurnTwo_END_OF_BATTLESHOCK_PHASE =\r\n  'TURN_TWO_END_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_TWO_END_OF_TURN: TTurnTwo_END_OF_TURN = 'TURN_TWO_END_OF_TURN'\r\nexport const TURN_TWO_END_OF_ROUND: TTurnTwo_END_OF_ROUND = 'TURN_TWO_END_OF_ROUND'\r\nexport const TURN_THREE_START_OF_TURN: TTurnThree_START_OF_TURN = 'TURN_THREE_START_OF_TURN'\r\nexport const TURN_THREE_START_OF_ROUND: TTurnThree_START_OF_ROUND = 'TURN_THREE_START_OF_ROUND'\r\nexport const TURN_THREE_DURING_TURN: TTurnThree_DURING_TURN = 'TURN_THREE_DURING_TURN'\r\nexport const TURN_THREE_DURING_ROUND: TTurnThree_DURING_ROUND = 'TURN_THREE_DURING_ROUND'\r\nexport const TURN_THREE_START_OF_HERO_PHASE: TTurnThree_START_OF_HERO_PHASE = 'TURN_THREE_START_OF_HERO_PHASE'\r\nexport const TURN_THREE_HERO_PHASE: TTurnThree_HERO_PHASE = 'TURN_THREE_DURING_HERO_PHASE'\r\nexport const TURN_THREE_END_OF_HERO_PHASE: TTurnThree_END_OF_HERO_PHASE = 'TURN_THREE_END_OF_HERO_PHASE'\r\nexport const TURN_THREE_START_OF_MOVEMENT_PHASE: TTurnThree_START_OF_MOVEMENT_PHASE =\r\n  'TURN_THREE_START_OF_MOVEMENT_PHASE'\r\nexport const TURN_THREE_MOVEMENT_PHASE: TTurnThree_MOVEMENT_PHASE = 'TURN_THREE_DURING_MOVEMENT_PHASE'\r\nexport const TURN_THREE_END_OF_MOVEMENT_PHASE: TTurnThree_END_OF_MOVEMENT_PHASE =\r\n  'TURN_THREE_END_OF_MOVEMENT_PHASE'\r\nexport const TURN_THREE_START_OF_SHOOTING_PHASE: TTurnThree_START_OF_SHOOTING_PHASE =\r\n  'TURN_THREE_START_OF_SHOOTING_PHASE'\r\nexport const TURN_THREE_SHOOTING_PHASE: TTurnThree_SHOOTING_PHASE = 'TURN_THREE_DURING_SHOOTING_PHASE'\r\nexport const TURN_THREE_END_OF_SHOOTING_PHASE: TTurnThree_END_OF_SHOOTING_PHASE =\r\n  'TURN_THREE_END_OF_SHOOTING_PHASE'\r\nexport const TURN_THREE_START_OF_CHARGE_PHASE: TTurnThree_START_OF_CHARGE_PHASE =\r\n  'TURN_THREE_START_OF_CHARGE_PHASE'\r\nexport const TURN_THREE_CHARGE_PHASE: TTurnThree_CHARGE_PHASE = 'TURN_THREE_DURING_CHARGE_PHASE'\r\nexport const TURN_THREE_END_OF_CHARGE_PHASE: TTurnThree_END_OF_CHARGE_PHASE = 'TURN_THREE_END_OF_CHARGE_PHASE'\r\nexport const TURN_THREE_START_OF_COMBAT_PHASE: TTurnThree_START_OF_COMBAT_PHASE =\r\n  'TURN_THREE_START_OF_COMBAT_PHASE'\r\nexport const TURN_THREE_COMBAT_PHASE: TTurnThree_COMBAT_PHASE = 'TURN_THREE_DURING_COMBAT_PHASE'\r\nexport const TURN_THREE_END_OF_COMBAT_PHASE: TTurnThree_END_OF_COMBAT_PHASE = 'TURN_THREE_END_OF_COMBAT_PHASE'\r\nexport const TURN_THREE_START_OF_BATTLESHOCK_PHASE: TTurnThree_START_OF_BATTLESHOCK_PHASE =\r\n  'TURN_THREE_START_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_THREE_BATTLESHOCK_PHASE: TTurnThree_BATTLESHOCK_PHASE =\r\n  'TURN_THREE_DURING_BATTLESHOCK_PHASE'\r\nexport const TURN_THREE_END_OF_BATTLESHOCK_PHASE: TTurnThree_END_OF_BATTLESHOCK_PHASE =\r\n  'TURN_THREE_END_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_THREE_END_OF_TURN: TTurnThree_END_OF_TURN = 'TURN_THREE_END_OF_TURN'\r\nexport const TURN_THREE_END_OF_ROUND: TTurnThree_END_OF_ROUND = 'TURN_THREE_END_OF_ROUND'\r\nexport const TURN_FOUR_START_OF_TURN: TTurnFour_START_OF_TURN = 'TURN_FOUR_START_OF_TURN'\r\nexport const TURN_FOUR_START_OF_ROUND: TTurnFour_START_OF_ROUND = 'TURN_FOUR_START_OF_ROUND'\r\nexport const TURN_FOUR_DURING_TURN: TTurnFour_DURING_TURN = 'TURN_FOUR_DURING_TURN'\r\nexport const TURN_FOUR_DURING_ROUND: TTurnFour_DURING_ROUND = 'TURN_FOUR_DURING_ROUND'\r\nexport const TURN_FOUR_START_OF_HERO_PHASE: TTurnFour_START_OF_HERO_PHASE = 'TURN_FOUR_START_OF_HERO_PHASE'\r\nexport const TURN_FOUR_HERO_PHASE: TTurnFour_HERO_PHASE = 'TURN_FOUR_DURING_HERO_PHASE'\r\nexport const TURN_FOUR_END_OF_HERO_PHASE: TTurnFour_END_OF_HERO_PHASE = 'TURN_FOUR_END_OF_HERO_PHASE'\r\nexport const TURN_FOUR_START_OF_MOVEMENT_PHASE: TTurnFour_START_OF_MOVEMENT_PHASE =\r\n  'TURN_FOUR_START_OF_MOVEMENT_PHASE'\r\nexport const TURN_FOUR_MOVEMENT_PHASE: TTurnFour_MOVEMENT_PHASE = 'TURN_FOUR_DURING_MOVEMENT_PHASE'\r\nexport const TURN_FOUR_END_OF_MOVEMENT_PHASE: TTurnFour_END_OF_MOVEMENT_PHASE =\r\n  'TURN_FOUR_END_OF_MOVEMENT_PHASE'\r\nexport const TURN_FOUR_START_OF_SHOOTING_PHASE: TTurnFour_START_OF_SHOOTING_PHASE =\r\n  'TURN_FOUR_START_OF_SHOOTING_PHASE'\r\nexport const TURN_FOUR_SHOOTING_PHASE: TTurnFour_SHOOTING_PHASE = 'TURN_FOUR_DURING_SHOOTING_PHASE'\r\nexport const TURN_FOUR_END_OF_SHOOTING_PHASE: TTurnFour_END_OF_SHOOTING_PHASE =\r\n  'TURN_FOUR_END_OF_SHOOTING_PHASE'\r\nexport const TURN_FOUR_START_OF_CHARGE_PHASE: TTurnFour_START_OF_CHARGE_PHASE =\r\n  'TURN_FOUR_START_OF_CHARGE_PHASE'\r\nexport const TURN_FOUR_CHARGE_PHASE: TTurnFour_CHARGE_PHASE = 'TURN_FOUR_DURING_CHARGE_PHASE'\r\nexport const TURN_FOUR_END_OF_CHARGE_PHASE: TTurnFour_END_OF_CHARGE_PHASE = 'TURN_FOUR_END_OF_CHARGE_PHASE'\r\nexport const TURN_FOUR_START_OF_COMBAT_PHASE: TTurnFour_START_OF_COMBAT_PHASE =\r\n  'TURN_FOUR_START_OF_COMBAT_PHASE'\r\nexport const TURN_FOUR_COMBAT_PHASE: TTurnFour_COMBAT_PHASE = 'TURN_FOUR_DURING_COMBAT_PHASE'\r\nexport const TURN_FOUR_END_OF_COMBAT_PHASE: TTurnFour_END_OF_COMBAT_PHASE = 'TURN_FOUR_END_OF_COMBAT_PHASE'\r\nexport const TURN_FOUR_START_OF_BATTLESHOCK_PHASE: TTurnFour_START_OF_BATTLESHOCK_PHASE =\r\n  'TURN_FOUR_START_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_FOUR_BATTLESHOCK_PHASE: TTurnFour_BATTLESHOCK_PHASE = 'TURN_FOUR_DURING_BATTLESHOCK_PHASE'\r\nexport const TURN_FOUR_END_OF_BATTLESHOCK_PHASE: TTurnFour_END_OF_BATTLESHOCK_PHASE =\r\n  'TURN_FOUR_END_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_FOUR_END_OF_TURN: TTurnFour_END_OF_TURN = 'TURN_FOUR_END_OF_TURN'\r\nexport const TURN_FOUR_END_OF_ROUND: TTurnFour_END_OF_ROUND = 'TURN_FOUR_END_OF_ROUND'\r\nexport const TURN_FIVE_START_OF_TURN: TTurnFive_START_OF_TURN = 'TURN_FIVE_START_OF_TURN'\r\nexport const TURN_FIVE_START_OF_ROUND: TTurnFive_START_OF_ROUND = 'TURN_FIVE_START_OF_ROUND'\r\nexport const TURN_FIVE_DURING_TURN: TTurnFive_DURING_TURN = 'TURN_FIVE_DURING_TURN'\r\nexport const TURN_FIVE_DURING_ROUND: TTurnFive_DURING_ROUND = 'TURN_FIVE_DURING_ROUND'\r\nexport const TURN_FIVE_START_OF_HERO_PHASE: TTurnFive_START_OF_HERO_PHASE = 'TURN_FIVE_START_OF_HERO_PHASE'\r\nexport const TURN_FIVE_HERO_PHASE: TTurnFive_HERO_PHASE = 'TURN_FIVE_DURING_HERO_PHASE'\r\nexport const TURN_FIVE_END_OF_HERO_PHASE: TTurnFive_END_OF_HERO_PHASE = 'TURN_FIVE_END_OF_HERO_PHASE'\r\nexport const TURN_FIVE_START_OF_MOVEMENT_PHASE: TTurnFive_START_OF_MOVEMENT_PHASE =\r\n  'TURN_FIVE_START_OF_MOVEMENT_PHASE'\r\nexport const TURN_FIVE_MOVEMENT_PHASE: TTurnFive_MOVEMENT_PHASE = 'TURN_FIVE_DURING_MOVEMENT_PHASE'\r\nexport const TURN_FIVE_END_OF_MOVEMENT_PHASE: TTurnFive_END_OF_MOVEMENT_PHASE =\r\n  'TURN_FIVE_END_OF_MOVEMENT_PHASE'\r\nexport const TURN_FIVE_START_OF_SHOOTING_PHASE: TTurnFive_START_OF_SHOOTING_PHASE =\r\n  'TURN_FIVE_START_OF_SHOOTING_PHASE'\r\nexport const TURN_FIVE_SHOOTING_PHASE: TTurnFive_SHOOTING_PHASE = 'TURN_FIVE_DURING_SHOOTING_PHASE'\r\nexport const TURN_FIVE_END_OF_SHOOTING_PHASE: TTurnFive_END_OF_SHOOTING_PHASE =\r\n  'TURN_FIVE_END_OF_SHOOTING_PHASE'\r\nexport const TURN_FIVE_START_OF_CHARGE_PHASE: TTurnFive_START_OF_CHARGE_PHASE =\r\n  'TURN_FIVE_START_OF_CHARGE_PHASE'\r\nexport const TURN_FIVE_CHARGE_PHASE: TTurnFive_CHARGE_PHASE = 'TURN_FIVE_DURING_CHARGE_PHASE'\r\nexport const TURN_FIVE_END_OF_CHARGE_PHASE: TTurnFive_END_OF_CHARGE_PHASE = 'TURN_FIVE_END_OF_CHARGE_PHASE'\r\nexport const TURN_FIVE_START_OF_COMBAT_PHASE: TTurnFive_START_OF_COMBAT_PHASE =\r\n  'TURN_FIVE_START_OF_COMBAT_PHASE'\r\nexport const TURN_FIVE_COMBAT_PHASE: TTurnFive_COMBAT_PHASE = 'TURN_FIVE_DURING_COMBAT_PHASE'\r\nexport const TURN_FIVE_END_OF_COMBAT_PHASE: TTurnFive_END_OF_COMBAT_PHASE = 'TURN_FIVE_END_OF_COMBAT_PHASE'\r\nexport const TURN_FIVE_START_OF_BATTLESHOCK_PHASE: TTurnFive_START_OF_BATTLESHOCK_PHASE =\r\n  'TURN_FIVE_START_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_FIVE_BATTLESHOCK_PHASE: TTurnFive_BATTLESHOCK_PHASE = 'TURN_FIVE_DURING_BATTLESHOCK_PHASE'\r\nexport const TURN_FIVE_END_OF_BATTLESHOCK_PHASE: TTurnFive_END_OF_BATTLESHOCK_PHASE =\r\n  'TURN_FIVE_END_OF_BATTLESHOCK_PHASE'\r\nexport const TURN_FIVE_END_OF_TURN: TTurnFive_END_OF_TURN = 'TURN_FIVE_END_OF_TURN'\r\nexport const TURN_FIVE_END_OF_ROUND: TTurnFive_END_OF_ROUND = 'TURN_FIVE_END_OF_ROUND'\r\n\r\n// When\r\nexport type TTurnWhen =\r\n  | TSetupStart\r\n  | TDuringSetup\r\n  | TSetupEnd\r\n  | TGameStart\r\n  | TGameDuring\r\n  | TTurnStart\r\n  | TRoundStart\r\n  | TTurnEnd\r\n  | TRoundEnd\r\n  | TGameEnd\r\n  | THeroPhaseStart\r\n  | THeroPhase\r\n  | THeroPhaseEnd\r\n  | TMovementPhaseStart\r\n  | TMovementPhase\r\n  | TMovementPhaseEnd\r\n  | TShootingPhaseStart\r\n  | TShootingPhase\r\n  | TShootingPhaseEnd\r\n  | TChargePhaseStart\r\n  | TChargePhase\r\n  | TChargePhaseEnd\r\n  | TCombatPhaseStart\r\n  | TCombatPhase\r\n  | TCombatPhaseEnd\r\n  | TBattleshockPhaseStart\r\n  | TBattleshockPhase\r\n  | TBattleshockPhaseEnd\r\n  | TTurnOne_START_OF_TURN\r\n  | TTurnOne_START_OF_ROUND\r\n  | TTurnOne_DURING_TURN\r\n  | TTurnOne_DURING_ROUND\r\n  | TTurnOne_START_OF_HERO_PHASE\r\n  | TTurnOne_HERO_PHASE\r\n  | TTurnOne_END_OF_HERO_PHASE\r\n  | TTurnOne_START_OF_MOVEMENT_PHASE\r\n  | TTurnOne_MOVEMENT_PHASE\r\n  | TTurnOne_END_OF_MOVEMENT_PHASE\r\n  | TTurnOne_START_OF_SHOOTING_PHASE\r\n  | TTurnOne_SHOOTING_PHASE\r\n  | TTurnOne_END_OF_SHOOTING_PHASE\r\n  | TTurnOne_START_OF_CHARGE_PHASE\r\n  | TTurnOne_CHARGE_PHASE\r\n  | TTurnOne_END_OF_CHARGE_PHASE\r\n  | TTurnOne_START_OF_COMBAT_PHASE\r\n  | TTurnOne_COMBAT_PHASE\r\n  | TTurnOne_END_OF_COMBAT_PHASE\r\n  | TTurnOne_START_OF_BATTLESHOCK_PHASE\r\n  | TTurnOne_BATTLESHOCK_PHASE\r\n  | TTurnOne_END_OF_BATTLESHOCK_PHASE\r\n  | TTurnOne_END_OF_TURN\r\n  | TTurnOne_END_OF_ROUND\r\n  | TTurnTwo_START_OF_TURN\r\n  | TTurnTwo_START_OF_ROUND\r\n  | TTurnTwo_DURING_TURN\r\n  | TTurnTwo_DURING_ROUND\r\n  | TTurnTwo_START_OF_HERO_PHASE\r\n  | TTurnTwo_HERO_PHASE\r\n  | TTurnTwo_END_OF_HERO_PHASE\r\n  | TTurnTwo_START_OF_MOVEMENT_PHASE\r\n  | TTurnTwo_MOVEMENT_PHASE\r\n  | TTurnTwo_END_OF_MOVEMENT_PHASE\r\n  | TTurnTwo_START_OF_SHOOTING_PHASE\r\n  | TTurnTwo_SHOOTING_PHASE\r\n  | TTurnTwo_END_OF_SHOOTING_PHASE\r\n  | TTurnTwo_START_OF_CHARGE_PHASE\r\n  | TTurnTwo_CHARGE_PHASE\r\n  | TTurnTwo_END_OF_CHARGE_PHASE\r\n  | TTurnTwo_START_OF_COMBAT_PHASE\r\n  | TTurnTwo_COMBAT_PHASE\r\n  | TTurnTwo_END_OF_COMBAT_PHASE\r\n  | TTurnTwo_START_OF_BATTLESHOCK_PHASE\r\n  | TTurnTwo_BATTLESHOCK_PHASE\r\n  | TTurnTwo_END_OF_BATTLESHOCK_PHASE\r\n  | TTurnTwo_END_OF_TURN\r\n  | TTurnTwo_END_OF_ROUND\r\n  | TTurnThree_START_OF_TURN\r\n  | TTurnThree_START_OF_ROUND\r\n  | TTurnThree_DURING_TURN\r\n  | TTurnThree_DURING_ROUND\r\n  | TTurnThree_START_OF_HERO_PHASE\r\n  | TTurnThree_HERO_PHASE\r\n  | TTurnThree_END_OF_HERO_PHASE\r\n  | TTurnThree_START_OF_MOVEMENT_PHASE\r\n  | TTurnThree_MOVEMENT_PHASE\r\n  | TTurnThree_END_OF_MOVEMENT_PHASE\r\n  | TTurnThree_START_OF_SHOOTING_PHASE\r\n  | TTurnThree_SHOOTING_PHASE\r\n  | TTurnThree_END_OF_SHOOTING_PHASE\r\n  | TTurnThree_START_OF_CHARGE_PHASE\r\n  | TTurnThree_CHARGE_PHASE\r\n  | TTurnThree_END_OF_CHARGE_PHASE\r\n  | TTurnThree_START_OF_COMBAT_PHASE\r\n  | TTurnThree_COMBAT_PHASE\r\n  | TTurnThree_END_OF_COMBAT_PHASE\r\n  | TTurnThree_START_OF_BATTLESHOCK_PHASE\r\n  | TTurnThree_BATTLESHOCK_PHASE\r\n  | TTurnThree_END_OF_BATTLESHOCK_PHASE\r\n  | TTurnThree_END_OF_TURN\r\n  | TTurnThree_END_OF_ROUND\r\n  | TTurnFour_START_OF_TURN\r\n  | TTurnFour_START_OF_ROUND\r\n  | TTurnFour_DURING_TURN\r\n  | TTurnFour_DURING_ROUND\r\n  | TTurnFour_START_OF_HERO_PHASE\r\n  | TTurnFour_HERO_PHASE\r\n  | TTurnFour_END_OF_HERO_PHASE\r\n  | TTurnFour_START_OF_MOVEMENT_PHASE\r\n  | TTurnFour_MOVEMENT_PHASE\r\n  | TTurnFour_END_OF_MOVEMENT_PHASE\r\n  | TTurnFour_START_OF_SHOOTING_PHASE\r\n  | TTurnFour_SHOOTING_PHASE\r\n  | TTurnFour_END_OF_SHOOTING_PHASE\r\n  | TTurnFour_START_OF_CHARGE_PHASE\r\n  | TTurnFour_CHARGE_PHASE\r\n  | TTurnFour_END_OF_CHARGE_PHASE\r\n  | TTurnFour_START_OF_COMBAT_PHASE\r\n  | TTurnFour_COMBAT_PHASE\r\n  | TTurnFour_END_OF_COMBAT_PHASE\r\n  | TTurnFour_START_OF_BATTLESHOCK_PHASE\r\n  | TTurnFour_BATTLESHOCK_PHASE\r\n  | TTurnFour_END_OF_BATTLESHOCK_PHASE\r\n  | TTurnFour_END_OF_TURN\r\n  | TTurnFour_END_OF_ROUND\r\n  | TTurnFive_START_OF_TURN\r\n  | TTurnFive_START_OF_ROUND\r\n  | TTurnFive_DURING_TURN\r\n  | TTurnFive_DURING_ROUND\r\n  | TTurnFive_START_OF_HERO_PHASE\r\n  | TTurnFive_HERO_PHASE\r\n  | TTurnFive_END_OF_HERO_PHASE\r\n  | TTurnFive_START_OF_MOVEMENT_PHASE\r\n  | TTurnFive_MOVEMENT_PHASE\r\n  | TTurnFive_END_OF_MOVEMENT_PHASE\r\n  | TTurnFive_START_OF_SHOOTING_PHASE\r\n  | TTurnFive_SHOOTING_PHASE\r\n  | TTurnFive_END_OF_SHOOTING_PHASE\r\n  | TTurnFive_START_OF_CHARGE_PHASE\r\n  | TTurnFive_CHARGE_PHASE\r\n  | TTurnFive_END_OF_CHARGE_PHASE\r\n  | TTurnFive_START_OF_COMBAT_PHASE\r\n  | TTurnFive_COMBAT_PHASE\r\n  | TTurnFive_END_OF_COMBAT_PHASE\r\n  | TTurnFive_START_OF_BATTLESHOCK_PHASE\r\n  | TTurnFive_BATTLESHOCK_PHASE\r\n  | TTurnFive_END_OF_BATTLESHOCK_PHASE\r\n  | TTurnFive_END_OF_TURN\r\n  | TTurnFive_END_OF_ROUND\r\n  | TTurnDuring\r\n  | TRoundDuring\r\n  | TSavesPhase\r\n  | TWardsPhase\r\n  | TWoundAllocationPhase\r\n  | TPhaseStartOfAny\r\n  | TPhaseDuringAny\r\n  | TPhaseEndOfAny\r\n","import { omit, pick } from 'lodash'\r\nimport { TEffects, TEntryProperties } from 'types/data'\r\nimport { IItemDescription, TItemDescriptions } from './factionTypes'\r\n\r\n/**\r\n * Adds the given tag to all sub-objects\r\n *\r\n * @param obj\r\n * @param tag\r\n */\r\nexport const tagAs = <\r\n  D extends Record<string, IItemDescription>,\r\n  E extends TEntryProperties,\r\n  F extends D[keyof D]\r\n>(\r\n  obj: D,\r\n  tag: E\r\n) => {\r\n  return Object.keys(obj).reduce((a, key) => {\r\n    const origObj = obj[key]\r\n\r\n    const taggedObj = {\r\n      ...origObj,\r\n      // TODO: We used to tag all sub-effects. I'm not sure we need to anymore, tbh\r\n      // effects: origObj.effects.map(x => ({ ...x, [tag]: true })),\r\n      [tag]: true,\r\n    }\r\n\r\n    // @ts-expect-error\r\n    a[key] = taggedObj\r\n    return a\r\n  }, {} as Record<keyof D, F & Record<E, true>>)\r\n}\r\n\r\n/**\r\n * Returns the `obj` with the `keys` removed.\r\n *\r\n * @param obj\r\n * @param keys_to_omit - The keys to remove from the returned object\r\n *\r\n * @example\r\n *  * keyOmitter({ a: 1, b: 2, c: 3 }, ['a', 'c'])\r\n * // Returns { b: 2 }\r\n *\r\n */\r\nexport const keyOmitter = <T extends object, R extends Extract<keyof T, string>>(\r\n  obj: T,\r\n  keys_to_omit: R[]\r\n) => {\r\n  if (!keys_to_omit.length) return obj\r\n  return omit(obj, ...keys_to_omit)\r\n}\r\n\r\n/**\r\n * Returns the `obj` with **ONLY** the `keys` that you choose.\r\n *\r\n * @param obj\r\n * @param keys_to_pick - The keys you'd like to be returned\r\n *\r\n * @example\r\n * keyPicker({ a: 1, b: 2, c: 3 }, ['a', 'c'])\r\n * // Returns { a: 1, c: 3 }\r\n */\r\nexport const keyPicker = <T extends object, R extends Extract<keyof T, string>>(\r\n  obj: T,\r\n  keys_to_pick: R[]\r\n) => {\r\n  if (!keys_to_pick.length) {\r\n    console.error(\r\n      `Warning: You passed an empty array to keyPicker(). This is usually a mistake - double check your usage, please.`\r\n    )\r\n    return obj\r\n  }\r\n  return pick(obj, ...keys_to_pick)\r\n}\r\n\r\n/**\r\n * Grabs battle traits and basic effects\r\n * @param obj\r\n * @param keys\r\n */\r\nexport const pickEffects = <T extends TItemDescriptions, R extends Extract<keyof T, string>>(\r\n  obj: T,\r\n  keys: R[]\r\n): TEffects[] => {\r\n  const picked = keyPicker(obj, keys)\r\n  return keys.reduce((a, k) => {\r\n    a = a.concat(picked[k].effects)\r\n    return a\r\n  }, [] as TEffects[])\r\n}\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\n// General artifacts from Core Rules 2021\r\nconst GenericArtifacts: TEntry[] = [\r\n /* {\r\n    name: `Amulet of Destiny`,\r\n    effects: [\r\n      {\r\n        name: `Amulet of Destiny`,\r\n        desc: `The bearer has a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021, meta_rule_sources.ERRATA_CORE_RULES_DECEMBER_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Vial of Manticore Venom`,\r\n    effects: [\r\n      {\r\n        name: `Vial of Manticore Venom`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Add 1 to wound rolls for attacks made with that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Arcane Tome`,\r\n    effects: [\r\n      {\r\n        name: `Arcane Tome`,\r\n        desc: `HERO that does not have the WIZARD, PRIEST or KHORNE keyword. The bearer becomes a WIZARD that can only cast Arcane Bolt, Mystic Shield and spells to summon endless spells on your army roster. They can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.CORE_RULES_2021,\r\n          meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Seed of Rebirth`,\r\n    effects: [\r\n      {\r\n        name: `Seed of Rebirth`,\r\n        desc: `You can reroll heroic recovery rolls for the bearer.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // GHB 2022-23 Season 2 Artifacts\r\n  {\r\n    name: `Tuskhelm`,\r\n    effects: [\r\n      {\r\n        name: `Tuskhelm`,\r\n        desc: `After the bearer makes a charge move, you can pick 1 enemy unit within 1\" of the bearer. If you do so, roll a number of dice equal to the unmodified charge roll for that charge move. For each 4+, the target suffers 1 mortal wound. If the bearer already has an ability with an effect that triggers after they make a charge move, you must pick which effect applies (you cannot use both).`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Nightflyer Cloak`,\r\n    effects: [\r\n      {\r\n        name: `Nightflyer Cloak`,\r\n        desc: `During deployment, instead of setting up the bearer on the battlefield, you can place them to one side and say that they are set up in ambush as a reserve unit. At the end of your movement phase, you can set up the bearer on the battlefield, within 1\" of a friendly Battleline unit and more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n      {\r\n        name: `Nightflyer Cloak`,\r\n        desc: `At the end of your movement phase, you can set up the bearer on the battlefield, within 1\" of a friendly Battleline unit and more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Gryph-feather Charm`,\r\n    effects: [\r\n      {\r\n        name: `Gryph-feather Charm`,\r\n        desc: `The bearer has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  }, */\r\n]\r\n\r\nexport default GenericArtifacts\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n} from 'types/phases'\r\n\r\n// General command abilities from Core Rules 2021\r\nconst GenericCommandAbilities: TEntry[] = [\r\n/*  {\r\n    name: `Rally`,\r\n    effects: [\r\n      {\r\n        name: `Rally`,\r\n        desc: `You can use this command ability at the start of the hero phase. The unit that receives the command must be more than 3\" from all enemy units. Roll 1 dice for each slain model from that unit. For each 6, you can return 1 slain model to that unit. You can only return models to that unit that have a combined Wounds characteristic of 10 or less. For example, if the unit that received the command has a Wounds characteristic of 2, you can return a maximum of 5 models to that unit. You can only return models to that unit that have a combined Wounds characteristic of 10 or less. For example, if the unit that received the command has a Wounds characteristic of 2, you can return a maximum of 5 models to that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.CORE_RULES_2021,\r\n          meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'At The Double',\r\n    effects: [\r\n      {\r\n        name: `At The Double`,\r\n        desc: `You can use this command ability after you declare that a friendly unit will run. That unit must receive the command. The run roll is not made for that unit. Instead, 6\" is added to that unit's Move characteristic in that phase. The unit is still considered to have run.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Redeploy',\r\n    effects: [\r\n      {\r\n        name: `Redeploy`,\r\n        desc: `You can use this command ability in the enemy movement phase after an enemy unit finishes a normal move, run or retreat. The unit that receives the command must be within 9\" of that enemy unit and more than 3\" from all enemy units. You can make a D6\" move with the unit that receives the command, but it must finish the move more than 3\" from all enemy units and cannot shoot later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Forward To Victory',\r\n    effects: [\r\n      {\r\n        name: `Forward To Victory`,\r\n        desc: `You can use this command ability after you make a charge roll for a friendly unit. That unit must receive the command. You can reroll the charge roll for that unit.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Unleash Hell',\r\n    effects: [\r\n      {\r\n        name: `Unleash Hell`,\r\n        desc: `You can use this command ability after an enemy unit finishes a charge move. The unit that receives the command must be within 6\" of that enemy unit and more than 3\" from all other enemy units. Models in the unit that receives the command that are within 6\" of the target unit can shoot in that phase, but when they do so, you must subtract 1 from hit rolls for their attacks and they can only target the unit that made the charge move.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021, meta_rule_sources.ERRATA_CORE_RULES_DECEMBER_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'All-out Attack',\r\n    effects: [\r\n      {\r\n        name: `All-out Attack`,\r\n        desc: `You can use this command ability when you pick a friendly unit to shoot in your shooting phase or fight in the combat phase. That unit must receive the command. Add 1 to hit rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'All-out Defence',\r\n    effects: [\r\n      {\r\n        name: `All-out Defence`,\r\n        desc: `You can use this command ability when a friendly unit is picked as the target of an attack in the shooting or combat phase. That unit must receive the command. Add 1 to save rolls for attacks that target that unit until the end of that phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Inspiring Presence',\r\n    effects: [\r\n      {\r\n        name: `Inspiring Presence`,\r\n        desc: `You can use this command ability at the start of the battleshock phase. The unit that receives the command does not have to take battleshock tests in that phase.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, */\r\n]\r\nexport default GenericCommandAbilities\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { CHARGE_PHASE, DURING_GAME, HERO_PHASE, MOVEMENT_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\n// General command traits from Core Rules 2021\r\nconst GenericCommandTraits: TEntry[] = [\r\n  /* {\r\n    name: `Battle-lust`,\r\n    effects: [\r\n      {\r\n        name: `Battle-lust`,\r\n        desc: `You can reroll run rolls and charge rolls for this general.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Skilled Leader`,\r\n    effects: [\r\n      {\r\n        name: `Skilled Leader`,\r\n        desc: `If this general is on the battlefield at the start of your hero phase, roll a dice. On a 5+, you receive 1 extra command point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `High Priest`,\r\n    effects: [\r\n      {\r\n        name: `High Priest`,\r\n        desc: `You can reroll chanting rolls for this general.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Heroic Stature`,\r\n    effects: [\r\n      {\r\n        name: `Heroic Stature`,\r\n        desc: `Add 1 to this general's Wounds characteristic.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Master of Magic`,\r\n    effects: [\r\n      {\r\n        name: `Master of Magic`,\r\n        desc: `Once per hero phase, you can reroll 1 casting roll, dispelling roll or unbinding roll for this general.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, */\r\n] \r\nexport default GenericCommandTraits\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n} from 'types/phases'\r\nimport { OneDropDeploymentEffect } from './core_rules'\r\n\r\nexport const ExpertBattalionEffect = {\r\n  name: `Expert`,\r\n  desc: `Once per battle, 1 unit from this battalion can receive the All-out Attack or All-out Defence command without the command being issued and without a command point being spent.`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true, \r\n}\r\nexport const MagnificentBattalionEffect = {\r\n  name: `Magnificent`,\r\n  desc: `When you pick enhancements for your army (see 27.3), you can pick 1 extra enhancement.`,\r\n  when: [START_OF_SETUP],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true,\r\n}\r\nexport const SlayersBattalionEffect = {\r\n  name: `Slayers`,\r\n  desc: `Once per battle, 1 unit from this battalion can receive the All-out Attack or Unleash Hell command without the command being issued and without a command point being spent.`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE, CHARGE_PHASE],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true,\r\n}\r\nexport const StrategistsBattalionEffect = {\r\n  name: `Strategists`,\r\n  desc: `Once per battle, when you receive command points at the start of your hero phase, you can receive 1 extra command point.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true,\r\n}\r\nexport const SwiftBattalionEffect = {\r\n  name: `Swift`,\r\n  desc: `Once per battle, 1 unit from this battalion can receive the At the Double or Forward to Victory command without the command being issued and without a command point being spent.`,\r\n  when: [MOVEMENT_PHASE],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true,\r\n}\r\n\r\n// Core battalions from Core Rules 2021\r\nconst CoreBattalions: TEntry[] = [\r\n /* {\r\n    name: 'Warlord',\r\n    effects: [StrategistsBattalionEffect, MagnificentBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Battle Regiment',\r\n    effects: [OneDropDeploymentEffect],\r\n  },\r\n  {\r\n    name: 'Grand Battery',\r\n    effects: [SlayersBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Vanguard',\r\n    effects: [SwiftBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Linebreaker',\r\n    effects: [ExpertBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Command Entourage',\r\n    effects: [StrategistsBattalionEffect, MagnificentBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Command Entourage - Magnificent',\r\n    effects: [MagnificentBattalionEffect],\r\n  },\r\n  {\r\n    name: 'Command Entourage - Strategists',\r\n    effects: [StrategistsBattalionEffect],\r\n  },\r\n\r\n  // GHB 2021 Battalions\r\n  {\r\n    name: 'Alpha-Beast Pack',\r\n    effects: [\r\n      {\r\n        name: `Scent Tracking`,\r\n        desc: `After armies have been set up but before the first battle round begins, you can make a normal move of up to D6\" with each unit in this battalion.`,\r\n        when: [END_OF_SETUP],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Hunters of the Heartlands',\r\n    effects: [\r\n      {\r\n        name: `Expert Underdogs`,\r\n        desc: `Units from this battalion cannot be picked when your opponent carries out a monstrous rampage.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // GHB 2022 Battalions\r\n  {\r\n    name: 'Expert Conquerors',\r\n    effects: [\r\n      {\r\n        name: `Dominant Force`,\r\n        desc: `GALLETIAN VETERANS units only. Each model in this battalion counts as 3 models for the purposes of contesting objectives.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2022],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Bounty Hunters',\r\n    effects: [\r\n      {\r\n        name: `Headhunters`,\r\n        desc: `If the target of an attack made with a melee weapon by a model in this battalion is a GALLETIAN VETERANS unit, add 1 to the Damage characteristic of that weapon for that attack.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // GHB 2022-23 (Season 2) Battalions\r\n  {\r\n    name: 'Galletian Command',\r\n    effects: [\r\n      {\r\n        name: `United in Purpose`,\r\n        desc: `The Infantry unit in this battalion is the Sworn Bodyguard of the GALLETIAN CHAMPION in this battalion. In the combat phase, when you pick the GALLETIAN CHAMPION in this battalion to fight for the first time in that phase, if the Sworn Bodyguard in this battalion is wholly within 6\" of that GALLETIAN CHAMPION and has not yet fought in that phase, the GALLETIAN CHAMPION and the Sworn Bodyguard can fight one after the other in the order of your choice.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Galletian Sharpshooters',\r\n    effects: [\r\n      {\r\n        name: `Focus on Your Mark`,\r\n        desc: `Attacks made with missile weapons by units in this battalion are not prevented from targeting enemy GALLETIAN CHAMPIONS that are within 1\" of any enemy Battleline units (see 'The Key to Victory', pg 12).`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Galletian Veterans',\r\n    effects: [\r\n      {\r\n        name: `The Bonds of Battle`,\r\n        desc: `When a model in this battalion makes an attack with a melee weapon, you can target an enemy unit within 1/2\" of another model from the attacking unit instead of using the weapon's Range characteristic for that attack. If you do so, the attacking model must be within 1/2\" of another model from its own unit that is within 1/2\" of the target.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // GHB 2023-24\r\n  {\r\n    name: 'Andtorian Acolytes',\r\n    effects: [\r\n      {\r\n        name: `Coordinated Augmentation`,\r\n        desc: `At the start of the hero phase, if there are 2 or more friendly ANDTORIAN LOCUS units in this battalion on the battlefield, roll a dice. On a 3+, you gain 1 primal magic dice.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'Wizard-finders of Andtor',\r\n    effects: [\r\n      {\r\n        name: `Magic Hunters`,\r\n        desc: `Each time a unit in this battalion is affected by a spell cast by an enemy unit or the abilities of an endless spell summoned by an enemy unit, you can roll a dice. On a 5+, ignore the effect of that spell or the effects of that endless spell's abilities on this unit. \r\n        \r\n        Each time a unit in this battalion is picked to fight, you can say that it will go on a wizard hunt. If you do so, pick 1 melee weapon profile on that unit's warscroll. Until the end of that phase, add 1 to the Attacks characteristic of that melee weapon, but all of the attacks that unit makes in that phase must target an enemy WIZARD.`,\r\n        when: [COMBAT_PHASE, HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024, meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n    ],\r\n  },*/\r\n]\r\n\r\nexport default CoreBattalions\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_ROUND,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SETUP,\r\n  TURN_ONE_START_OF_TURN,\r\n  WOUND_ALLOCATION_PHASE,\r\n  START_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  WARDS_PHASE\r\n} from 'types/phases'\r\n\r\nexport const OneDropDeploymentEffect = {\r\n  name: `26.2.1 - One Drop Deployment`,\r\n  desc: `If a core battalion has the Unified icon, then after you set up a unit from the battalion, you must set up all of the other units from the battalion, one after the other, and you are not allowed to set up units that are not part of the battalion until all of the units in the battalion have been set up. In addition, if the set-up instructions for a battle say that the players must alternate setting up units one at a time, then after you set up a unit from the battalion, you must set up all of the other units from the battalion, one after the other, before your opponent is allowed to set up another unit.`,\r\n  when: [DURING_SETUP],\r\n  rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n  shared: true,\r\n}\r\n\r\nconst CoreRules: TEntry[] = [\r\n  /* {\r\n    name: 'Unit Coherency',\r\n    effects: [\r\n      {\r\n        name: `1.3.3 - Unit Coherency`,\r\n        desc: `Units must be set up and finish every move as a single coherent group. A unit with 2 to 6 models is coherent if each model in the unit is within 1\" horizontally and 6\" vertically of at least 1 other model in the unit. A unit with more than 6 models is coherent if each model in the unit is within 1\" horizontally and 6\" vertically of at least 2 other models in the unit. If a friendly unit is not coherent at the end of a turn or after you set it up, you must remove models in the unit from play, one at a time, until it is coherent.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [\r\n          meta_rule_sources.CORE_RULES_2021,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Predatory Endless Spells',\r\n    effects: [\r\n      {\r\n        name: `19.5 - Predatory Endless Spells`,\r\n        desc: `Predatory endless spells are moved at the end of the hero phase. If either player has any abilities that can be used at the end of the hero phase, they must be used after all predatory endless spells have been moved.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `19.5.1 - Predatory Endless Spell Control`,\r\n        desc: `Before moving predatory endless spells, you must first determine which are controlled and which are wild. A predatory endless spell within 30\" of the model that summoned it is controlled by that model. A WIZARD can control 1 predatory endless spell per hero phase. If there is more than 1 predatory endless spell that a friendly WIZARD could control, you must pick which they will control. Predatory endless spells that are not controlled are wild.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `19.5.2 - Moving Predatory Endless Spells`,\r\n        desc: `After determining control of predatory endless spells, the player whose turn is taking place moves all of the predatory endless spells controlled by friendly WIZARDS. Their opponent then does the same. Once all controlled predatory endless spells have been moved, the players alternate picking 1 wild predatory endless spell to move, starting with the player whose turn is taking place, until all of the wild predatory endless spells have been moved. A player must pick a wild predatory endless spell to move if any are eligible to do so and cannot pick a wild predatory endless spell that has already moved in that phase.\r\n  \r\n      When a player picks a predatory endless spell to move, they are considered to be the commanding player of that predatory endless spell until the start of the next hero phase. All other endless spells are under the command of the player that summoned them.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  {\r\n    name: 'Core Rules 4.0',\r\n    effects: [\r\n      {\r\n        name: `Tactical Gambit - Once Per Battle Round`,\r\n        desc: `You cannot use this ability if you went second in the previous battle round and chose to go first in the current battle round. \r\n        Effect: Pick 1 battle tactic that you have not yet attempted. You can attempt to complete that battle tactic this turn. `,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Activate Place of Power`,\r\n        desc: `Declare: Pick a friendly Hero within 3\" of any Places of Power to use this ability. \r\n        Effect: Roll a dice. On a 1, inflict D3 mortal damage on that Hero. On a 2+: \r\n         If that Hero is a Wizard or Priest, add 1 to casting rolls or chanting rolls for that Hero this turn. \r\n         If that Hero is not a Wizard or Priest, they can use the Unbind or Banish Manifestation ability this turn as if they had Wizard (1). `,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Rally`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: Make 6 rally rolls of D6. For each 4+, you receive 1 rally point. Rally points can be spent in the following ways: \r\n         For each rally point spent, Heal (1) that unit. \r\n         You can spend a number of rally points equal to the Health characteristic of that unit to return a slain model to that unit. \r\n        You can spend the rally points in any combination of the above. Unspent rally points are then lost. `,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Musician - Passive`,\r\n        desc: `Effect: While this unit contains any musicians, if it uses the Rally command, you can make one additional rally roll of D6. `,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Banish Manifestation`,\r\n        desc: `Declare: Pick a friendly Wizard or Priest to use this ability, pick a manifestation within 30\" of them to be the target, then make a banishment roll of 2D6. \r\n        Effect: If the banishment roll equals or exceeds the banishment value listed on the manifestations warscroll, it is banished and removed from play. You cannot pick the same manifestation as the target of this ability more than once per turn.  `,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Unbind - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Used By: A friendly Wizard within 30\" of the enemy Wizard casting the spell. \r\n        Effect: Make an unbinding roll of 2D6. If the roll exceeds the casting roll for the spell, then the spell is unbound and its effect is not resolved. This reaction cannot be used more than once per casting roll.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Magical Intervention`,\r\n        desc: `Declare: Pick a friendly Wizard or Priest to use this ability. \r\n        Effect: That friendly unit can use a Spell or Prayer ability (as appropriate) as if it were your hero phase. If you do so, subtract 1 from casting rolls or chanting rolls made as part of that ability.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Normal Move`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: That unit can move a distance up to its Move characteristic. That unit cannot move into combat during any part of that move.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Run`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: Make a run roll of D6. That unit can move a distance up to its Move characteristic added to the run roll. That unit cannot move into combat during any part of that move.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Retreat`,\r\n        desc: `Declare: Pick a friendly unit that is in combat to use this ability. \r\n        Effect: Inflict D3 mortal damage on that unit. That unit can move a distance up to its Move characteristic. That unit can move through the combat ranges of any enemy units but cannot end that move within an enemy units combat range.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - At the Double - Reaction: You declared a Run ability`,\r\n        desc: `Used By: The unit using that Run ability. \r\n        Effect: Do not make a run roll as part of that Run ability. Instead, add 6\" to that units Move characteristic to determine the distance each model in that unit can move as part of that Run ability.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Redeploy`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: Each model in that unit can move up to D6\". That move cannot pass through or end within the combat range of an enemy unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Fly - Passive`,\r\n        desc: `Effect: As this unit moves, it ignores other models, terrain features and the combat ranges of enemy units. It cannot end its move in combat unless specified in the ability that allowed it to move. Ignore any vertical distance moved for this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Shoot`,\r\n        desc: `Declare: Pick a friendly unit that has not used a Run or Retreat ability this turn to use this ability. Then, pick one or more enemy units as the target(s) of that units attacks (see 16.0). \r\n        Effect: Resolve shooting attacks against the target unit(s).`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Covering Fire`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: Resolve shooting attacks for that unit, but all of the attacks must target the nearest visible enemy unit and you must subtract 1 from the hit rolls for those attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Charge`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat and has not used a Run or Retreat ability this turn to use this ability. Then, make a charge roll of 2D6. \r\n        Effect: That unit can move a distance up to the value of the charge roll. That unit can move through the combat ranges of any enemy units and must end that move within \" of a visible enemy unit. If it does so, the unit using this ability has charged.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Forward to Victory - You declared a Charge ability`,\r\n        desc: `Used By: The unit using that Charge ability. \r\n        Effect: You can re-roll the charge roll.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability(2) - Counter-Charge`,\r\n        desc: `Declare: Pick a friendly unit that is not in combat to use this ability. \r\n        Effect: That unit can use a Charge ability as if it were your charge phase.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Fight`,\r\n        desc: `Declare: Pick a friendly unit that is in combat or that charged this turn to use this ability. That unit can make a pilein move (see 15.4). Then, if that unit is in combat, you must pick one or more enemy units as the target(s) of that units attacks (see 16.0). \r\n        Effect: Resolve combat attacks against the target unit(s).`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Champion - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of weapons used by champions in this unit.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Standard Bearer - Passive`,\r\n        desc: `Effect: While this unit contains any standard bearers, add 1 to this units control score.`,\r\n        when: [END_OF_TURN],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - Power Through`,\r\n        desc: `Declare: Pick a friendly unit that charged this turn to use this ability, then you must pick an enemy unit in combat with it to be the target. The target must have a lower Health characteristic than the unit using this ability. \r\n        Effect: Inflict D3 mortal damage on the target. Then, the unit using this ability can move a distance up to its Move characteristic. It can pass through and end that move within the combat ranges of enemy units that were in combat with it at the start of the move, but not those of other enemy units. It does not have to end the move in combat. `,\r\n        when: [END_OF_TURN],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - All Out Attack - Reaction: You declared an Attack ability`,\r\n        desc: `Used By: The unit using that Attack ability. \r\n        Effect: Add 1 to hit rolls for attacks made as part of that Attack ability. This also affects weapons that have the Companion weapon ability.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Command Ability - All Out Defense - Reaction: Opponent declared an Attack ability`,\r\n        desc: `Used By: A unit targeted by that Attack ability. \r\n        Effect: Add 1 to save rolls for that unit in this phase. `,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Ward Save - Passive`,\r\n        desc: `Effect: In step 1 of the damage sequence (see 18.0), make a ward roll of D6 for each damage point in this units damage pool. If the roll equals or exceeds this units ward value, remove that damage point from the damage pool.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Guarded Hero - Passive`,\r\n        desc: `Effect: If this Hero is within the combat range of a friendly unit that is not a Hero:  Subtract 1 from hit rolls for shooting attacks that target this Hero.  If this Hero is Infantry, they cannot be picked as the target of shooting attacks made by units more than 12\" from them.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  /* {\r\n    name: 'Generals Handbook 24',\r\n    effects: [\r\n      {\r\n        name: `Honour Guard - Special Assignment`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Pick 1 of the following weapon abilities:\r\n         Anti-Infantry(+1 Rend)\r\n         Anti-Cavalry(+1 Rend)\r\n         Anti-Monster(+1 Rend)\r\n         Anti-War Machine(+1 Rend)\r\n         Anti-Beast(+1 Rend)\r\n        In any turn in which the honour guard charged, that unit's melee weapons have the weapons ability you picked. This has no effect on Companion weapons.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Honour Guard - Priority Target`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Add 1 to hit rolls and wound rolls for attacks made by the honour guard that target any units in the enemy general's regiment.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Honour Guard - Bodyguard`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Subtract 1 from the Attacks characteristic of enemy units' melee weapons while they are in combat with your general if both of the following are true:\r\n         The honour guard is wholly within 6\" of your general.\r\n         The honour guard did not charge this turn`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      }, \r\n    ], \r\n  }, */\r\n\r\n  /*{\r\n    name: 'Endless Spells',\r\n    effects: [\r\n      {\r\n        name: `19.3.1 - Summoning Endless Spells`,\r\n        desc: `In your hero phase, you can attempt to summon 1 endless spell with each friendly WIZARD. When the spell used to summon an endless spell is successfully cast and not unbound, the endless spell is set up on the battlefield as described on its warscroll. If any restrictions make it impossible to set up the endless spell, the casting attempt is unsuccessful.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `19.3.2 - Dispelling Endless Spells`,\r\n        desc: `At the start of the hero phase, each player can attempt to dispel 1 endless spell with each friendly WIZARD and friendly PRIEST. The player whose turn is taking place makes all of their dispelling attempts first. If a WIZARD attempts to dispel an endless spell, they can attempt to cast or unbind 1 fewer spell in that hero phase. If a PRIEST attempts to dispel an endless spell, they can chant 1 fewer prayer in that hero phase. The same player cannot attempt to dispel the same endless spell more than once per phase.\r\n\r\n        To attempt to dispel an endless spell, pick 1 endless spell that is within 30\" of a friendly WIZARD or friendly PRIEST and that is visible to them. Then make a dispelling roll by rolling 2D6. If the roll is greater than the casting value of that endless spell, it is dispelled and removed from play. An endless spell cannot be summoned again in the turn that it is removed from play.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `19.3.3 - Removing Endless Spells`,\r\n        desc: `An endless spell remains in play until it is removed from play. An endless spell is removed from play if:\r\n\r\n        a) The endless spell is dispelled.\r\n        b) The endless spell touches the edge of the battlefield after it is moved.\r\n        c) A method on the endless spell's warscroll is used to remove it from play.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, \r\n\r\n  {\r\n    name: 'Priests and Prayers',\r\n    effects: [\r\n      {\r\n        name: `20.0 - Priests`,\r\n        desc: `A unit with the PRIEST keyword on its warscroll is a PRIEST. Each friendly PRIEST can chant 1 prayer that they know in your hero phase. All PRIESTS know the Bless and Smite prayers. In addition, a PRIEST knows all prayers on their warscroll and on the warscrolls of invocations (see 20.3) in the same army as them.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `20.1 - Chanting Prayers`,\r\n        desc: `In your hero phase, you can chant prayers with friendly PRIESTS. You cannot chant the same prayer more than once in the same hero phase, even with a different PRIEST. In order to chant a prayer, pick a friendly PRIEST, say which of the prayers that they know will be chanted, and then make a chanting roll by rolling a dice. If the chanting roll is equal to or greater than the answer value of the prayer, the prayer is answered.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `20.1.1 - Divine Wrath`,\r\n        desc: `On an unmodified chanting roll of 1, the chanting PRIEST suffers divine wrath. The prayer is not answered and the chanting PRIEST suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Invocations',\r\n    effects: [\r\n      {\r\n        name: `20.3 - Invocations`,\r\n        desc: `An invocation is a divine entity that is summoned to the battlefield by chanting the prayer on its invocation warscroll (see 24.0). Unless noted otherwise, an invocation cannot be attacked or be affected by abilities. You can move models across or through an invocation as if it were not there, but you cannot finish a model's move on an invocation. Invocations are under the command of the player who summoned them. After an invocation is removed from play (see 20.3.3), it can be summoned again if the prayer on its warscroll is successfully chanted in a different hero phase (it cannot be set up in the turn in which it is removed).`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021, meta_rule_sources.ERRATA_CORE_RULES_OCTOBER_2022],\r\n      },\r\n      {\r\n        name: `20.3.1 - Summoning Invocations`,\r\n        desc: `In your hero phase, you can attempt to summon 1 invocation with each friendly PRIEST. When the prayer used to summon the invocation is answered, the invocation is set up on the battlefield as described on its warscroll. If any restrictions make it impossible to set up the invocation, then the prayer is not answered.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `20.3.2 - Banishing Invocations`,\r\n        desc: `At the start of your hero phase, you can attempt to banish 1 invocation with each friendly PRIEST instead of chanting a prayer with that PRIEST in that hero phase. The same player cannot attempt to banish the same invocation more than once per phase.\r\n\r\n        To attempt to banish an invocation, pick 1 invocation within 48\" of a friendly PRIEST that is visible to them. Then make a banishment roll by rolling a dice. If the roll is greater than the answer value of that invocation, it is banished and removed from play. An invocation cannot be summoned again in the turn that it is removed from play.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `20.3.3 - Removing Invocations`,\r\n        desc: `An invocation remains in play until it is removed from play. An invocation is removed from play if:\r\n\r\n        a) The invocation is banished.\r\n        b) The invocation touches the edge of the battlefield after it is moved.\r\n        c) A method on the invocation's warscroll or in an allegiance ability is used to remove it from play`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Miscasts',\r\n    effects: [\r\n      {\r\n        name: `19.1.1 - Miscasts`,\r\n        desc: `On an unmodified casting roll of 2, the spell is miscast. The spell is not successfully cast, the caster suffers D3 mortal wounds, and the caster cannot attempt to cast any more spells in that hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Priority Roll',\r\n    effects: [\r\n      {\r\n        name: `4.1 - The Priority Roll`,\r\n        desc: `At the start of each battle round, the players must roll off. This is called the priority roll. The winner has priority in that battle round and must decide who will take the first turn and who will take the second turn. In the event of a tied priority roll, do not roll off again. Instead, if it is the first battle round, the player who finished deploying their army first has priority. Otherwise, the player who went first in the previous battle round has priority.`,\r\n        when: [START_OF_ROUND],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Simultaneous Effects',\r\n    effects: [\r\n      {\r\n        name: `1.6.2 - Simultaneous Effects`,\r\n        desc: `If the effects of two or more abilities would be applied at the same time in a turn, the player whose turn is taking place applies the effects of their abilities first, one at a time, in the order they desire. Their opponent then does the same. If the effects of two or more abilities would be applied at the same time other than during a turn, the players roll off and the winner applies the effects of their abilities first, one at a time, in the order they desire. Their opponent then does the same.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Dice Roll Modifiers',\r\n    effects: [\r\n      {\r\n        name: `1.5.5 - Dice Roll Modifiers`,\r\n        desc: `Sometimes a modifier will apply to a dice roll. Modifiers are applied after rerolls. Rules that refer to an unmodified roll are referring to the dice roll after rerolls have been made but before modifiers are applied. If a rule instructs you to pick or change a roll, do so after rerolls are made but before modifiers are applied.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Command Points',\r\n    effects: [\r\n      {\r\n        name: `4.1.1 - Starting Command Points`,\r\n        desc: `After determining who will take which turn, the player who will take the first turn receives 1 command point (see 6.0) and the player who will take the second turn receives 2 command points.`,\r\n        when: [TURN_ONE_START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `6.0 - Command Points`,\r\n        desc: `Command points allow you to use command abilities. You receive command points at the start of the battle round after priority is determined (see 4.1). In addition, if your general is on the battlefield at the start of the hero phase, you receive 1 command point. At the end of the battle round (see 16.0), any command points that have not been used are lost.`,\r\n        when: [START_OF_ROUND],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `6.0 - Command Points`,\r\n        desc: `If your general is on the battlefield at the start of the hero phase, you receive 1 command point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `6.0 - Command Points`,\r\n        desc: `At the end of the battle round (see 16.0), any command points that have not been used are lost.`,\r\n        when: [END_OF_ROUND],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `6.1 - Using Command Abilities`,\r\n        desc: `To use a command ability, you must spend 1 command point, pick 1 friendly model to issue the command, and pick 1 friendly unit to receive the command. Unless noted otherwise, the models that can issue commands and the units they can issue them to are as follows:\r\n\r\n        - Unit champions can issue commands to their own unit (see 22.3.2).\r\n        - Heroes can issue commands to units that are wholly within 12\" of them.\r\n        - Generals can issue commands to units that are wholly within 18\" of them.\r\n        - Totems can issue commands to units that are wholly within 18\" of them.\r\n\r\n        Each command ability will say when it can be used and what effect it has on the unit that receives it.\r\n        \r\n        A model cannot issue more than 1 command in the same phase and a unit cannot receive more than 1 command in the same phase. In addition, you cannot use the same command ability more than once in the same phase (even for different units).`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Hero Phase',\r\n    effects: [\r\n      {\r\n        name: `7.0 - Hero Phase`,\r\n        desc: `At the start of the hero phase, starting with the player whose turn is taking place, each player can pick 1 HERO to perform a heroic action (see 7.1), and each player receives 1 command point if their general is on the battlefield (see 6.0).`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `7.0 - Hero Phase`,\r\n        desc: `In your hero phase, you can use friendly WIZARDS to attempt to cast spells (see 19.0), friendly PRIESTS to chant prayers and attempt to banish invocations (see 20.0), and both to attempt to dispel endless spells (19.3). In the enemy hero phase you can use friendly WIZARDS to attempt to unbind spells (see 19.2).`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Heroic Actions',\r\n    effects: [\r\n      {\r\n        name: `7.1 - Heroes and Heroic Actions`,\r\n        desc: `A unit with the HERO keyword on its warscroll is a HERO. At the start of the hero phase, you can carry out 1 heroic action with 1 friendly HERO. The effect of the heroic action is treated in the same way as the effect of an ability for rules purposes (see 1.6).`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Heroic Leadership`,\r\n        desc: `Pick 1 friendly HERO and roll a dice. Add 2 to the roll if your general has been slain. On a 4+, you receive 1 command point that can only be spent during that turn to allow that HERO to issue a command.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Heroic Willpower`,\r\n        desc: `Pick 1 friendly HERO that is not a WIZARD. If it is the enemy hero phase, that HERO can attempt to unbind 1 spell in that phase as if they were a WIZARD. If it is your hero phase, that HERO can attempt to dispel 1 endless spell in that phase as if they were a WIZARD (you can still only attempt to unbind or dispel the same spell or endless spell once in the same phase).`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Their Finest Hour`,\r\n        desc: `Pick 1 friendly HERO. Add 1 to wound rolls for attacks made by that HERO until the end of that turn, and add 1 to save rolls for attacks that target that HERO until the end of that turn. You cannot carry out this heroic action with the same HERO more than once in the same battle.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Heroic Recovery`,\r\n        desc: `Pick 1 friendly HERO more than 3\" from all enemy units and make a heroic recovery roll by rolling 2D6. If the roll is less than or equal to that HERO'S Bravery characteristic, you can heal up to D3 wounds allocated to that HERO.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021, meta_rule_sources.ERRATA_CORE_RULES_DECEMBER_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Monstrous Rampages',\r\n    monstrous_rampage: true,\r\n    effects: [\r\n      {\r\n        name: `21.1 - Monstrous Rampages`,\r\n        desc: `At the end of the charge phase, each player can carry out 1 monstrous rampage with each friendly MONSTER. The player whose turn is taking place carries out all of their monstrous rampages first. The same player cannot carry out the same monstrous rampage more than once per phase. The effect of the monstrous rampage is treated in the same way as the effect of an ability for rules purposes (see 1.6).`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Look Out, Sir!',\r\n    effects: [\r\n      {\r\n        name: `10.1.2 - Look Out, Sir!`,\r\n        desc: `You must subtract 1 from the hit roll (see 13.3) for an attack made with a missile weapon if the target is an enemy HERO within 3\" of an enemy unit that has 3 or more models. If that Hero does not have a mount (with the exception of companions), it also cannot be targeted by attacks made with missile weapons if the attacking model is more than 12\" away from them. The Look Out, Sir! rule does not apply if the enemy HERO has a Wounds characteristic of 10 or more.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.CORE_RULES_2021,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Strike-First and Strike-Last Effects',\r\n    effects: [\r\n      {\r\n        name: `12.4 - Strike-First and Strike-Last Effects`,\r\n        desc: `Some abilities have an effect that allows a unit to fight at either the start or the end of the combat phase. These effects are called strike- first effects and strike-last effects respectively. The rules in sections 1.6.1-1.6.3 do not apply to these effects: use the rules here instead.\r\n        \r\n        If a strike-first effect applies to any units, those units fight before all other units fight. If a strike-last effect applies to any units, those units fight after all other units fight.\r\n        \r\n        If a strike-first effect applies to units from both players' armies, the players alternate fighting with those units, starting with the player whose turn it is. Similarly, if a strike-last effect applies to units from both players' armies, the players alternate fighting with those units, starting with the player whose turn it is. If a strike-first effect and a strike-last effect apply to the same unit at the same time, then they cancel each other out and neither effect applies to that unit.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `12.5 - Strike-First and Strike-Last Sequencing`,\r\n        desc: `1. Start of combat phase abilities are used\r\n        2. Units with strike-first effects attack\r\n        3. Units without strike-first/strike-last effects attack \r\n        4. Units with strike-last effects attack\r\n        5. End of combat phase abilities are used`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Battleshock Tests',\r\n    effects: [\r\n      {\r\n        name: `15.1 - Battleshock Tests`,\r\n        desc: `You must make a battleshock roll for each friendly unit that has to take a battleshock test. To make a battleshock roll, roll a dice and add the number of models in the unit that were slain in that turn to the roll. If the battleshock roll is greater than the unit's Bravery characteristic, the battleshock test has been failed. If the test is failed, for each point by which the battleshock roll exceeds the unit's Bravery characteristic, 1 model in that unit must flee. You decide which models flee. A model that flees is removed from play.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'One Drop Deployment',\r\n    effects: [OneDropDeploymentEffect],\r\n  },\r\n\r\n  {\r\n    name: 'Wandering Endless Spells',\r\n    effects: [\r\n      {\r\n        name: `Wandering Endless Spells`,\r\n        desc: `Wandering endless spells work differently to normal predatory endless spells. They are activated after all predatory endless spells on the battlefield have been moved. The players alternate picking 1 wandering endless spell to activate, starting with the player who has the second turn. Unless otherwise stated, any effects and abilities on their warscrolls can be used as normal and are resolved by the player activating that wandering endless spell.\r\n\r\n        Each wandering endless spell can be activated once per turn. To do so, roll a D3 and consult the behaviour table on page 67 of Soul Wars: Wrath of the Everchosen. The behaviour table has 3 columns, each with 6 results. The distance between the wandering endless spell and the closest enemy models determines which column you use. Each roll on the behaviour table has a corresponding action that the wandering endless spell will perform. The action is resolved before the next wandering endless spell is activated`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.ERRATA_WRATH_OF_THE_EVERCHOSEN_JULY_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Wards',\r\n    effects: [\r\n      {\r\n        name: `14.3 - Wards`,\r\n        desc: `Some abilities allow you to roll a dice to negate a wound or mortal wound. Abilities of this type are referred to as wards, and the dice roll is referred to as a ward roll. Unless stated otherwise, the ward roll is made before the wound is allocated to the model in question. Up to 1 ward roll can be made for each wound or mortal wound. If the ward roll is successful, the wound or mortal wound is negated and has no effect on the model.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021, meta_rule_sources.ERRATA_CORE_RULES_OCTOBER_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Incarnates',\r\n    incarnate: true,\r\n    effects: [\r\n      {\r\n        name: `Bonding`,\r\n        desc: `An incarnate must be bonded to a HERO in the army it is part of. Bonding an incarnate to a HERO is a unique enhancement. Record which HERO the incarnate is bonded to on your army roster. A HERO cannot be bonded to more than 1 incarnate, and an incarnate cannot be bonded to more than 1 HERO.\r\n\r\n        An army that includes an incarnate cannot include any other allied units. However, an incarnate can included in an army even if its points cost exceeds the maximum number of points that you can spend on allies in the battlepack you are using.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Wild Form`,\r\n        desc: `If the HERO an incarnate is bonded to is slain, the incarnate reverts to its wild form. An incarnate in its wild form remains part of your army, but it treats other units in your army as enemy units, and other units in your army treat it as an enemy unit. In addition, special rules apply to an incarnate in its wild form, as described on its warscroll.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Incarnate States`,\r\n        desc: `Incarnates have states. Each state has a level and a domination range, as shown on the State table on its warscroll. Incarnates start a battle at 2 (primal state).\r\n\r\n        Under certain circumstances, an incarnate's level can go up or down. When this happens, their state changes to that of their new level. For example, if an incarnate's level went up from 2 to 3, it would go from a primal state to an empowered state. An incarnate can never go above a level of 3 and is removed from play when it reaches a level 0.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Damage`,\r\n        desc: `Wounds are allocated to incarnates in the same way as they are to any other model. However, because an incarnate does not have a Wounds characteristic, it cannot be slain. An incarnate is treated as having a Wounds characteristic of 18 for all rules purposes other than determining if it is slain. If an incarnate is affected by an ability that slays the target without any wounds or mortal wounds being allocated, then the level of the incarnate goes down by 1 instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Damage`,\r\n        desc: `In the battleshock phase. if any wounds are allocated to an incarnate, its commanding player rolls 3D6. If the roll is less than or equal to the number of wounds allocated to the incarnate, its level is reduced by 1. Then all of the wounds allocated to the incarnate are healed.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  // {\r\n  //   name: 'PLACEHOLDER',\r\n  //   effects: [\r\n  //     {\r\n  //       name: `PLACEHOLDER`,\r\n  //       desc: ``,\r\n  //       when: [],\r\n  //     },\r\n  //   ],\r\n  // },\r\n]\r\n\r\nexport default CoreRules\r\n","import {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SETUP,\r\n  TURN_ONE_START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\n// This file is useful when storing abilities for units that we'd like to re-use\r\nconst GenericEffects = {\r\n  // e.g. all mercenaries share the \"Disruptive Presence\" effect, so we'll store it here.\r\n  DisruptivePresence: {\r\n    name: `Disruptive Presence`,\r\n    desc: `If your army includes any MERCENARY units, at the start of your hero phase in the first battle round, you do not receive 1 command point for your general being on the battlefield.`,\r\n    when: [TURN_ONE_START_OF_HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  // We re-use this Timber! a lot as well, so we stuck it here!\r\n  Gargant: [\r\n    {\r\n      name: `Timber!`,\r\n      desc: `If this model is slain, before removing the model from the battlefield, the players must roll off. The winner picks a point on the battlefield 3\" from the slain model. Each unit within 2\" of that point that is not a Gargant or a Mega-Gargant suffers D3 mortal wounds. The slain model is then removed from the battlefield.`,\r\n      when: [WOUND_ALLOCATION_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n  // You get the point\r\n  Terrorgheist: [\r\n    {\r\n      name: `Death Shriek`,\r\n      desc: `Do not use the attack sequence for an attack made with this unit's Death Shriek. Instead, roll a dice and add the Death Shriek value shown on this unit's damage table. If the total is higher than the target unit's Bravery characteristic, the target unit suffers a number of mortal wounds equal to the difference between its Bravery characteristic and the total.`,\r\n      when: [SHOOTING_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Gaping Maw`,\r\n      desc: `If the unmodified hit roll for an attack made with this unit's Fanged Maw is 6, the target suffers 6 mortal wounds and the attack sequence ends (do not make a wound or save roll).`,\r\n      when: [COMBAT_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Infested`,\r\n      desc: `If this unit is destroyed, before it is removed from play, each enemy unit within 3\" of this unit suffers D3 mortal wounds.`,\r\n      when: [WOUND_ALLOCATION_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n  ZombieDragon: [\r\n    {\r\n      name: `Terror`,\r\n      desc: `Enemy units cannot receive the Inspiring Presence command while they are within 3\" of any friendly units with this ability.`,\r\n      when: [BATTLESHOCK_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Loathsome Descent`,\r\n      desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is circling high above as a reserve unit.`,\r\n      when: [DURING_SETUP],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Loathsome Descent`,\r\n      desc: `If you set this unit up in reserve, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n      when: [END_OF_MOVEMENT_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n  CrewedWarMachine: (name: 'Duardin Artillery' | 'Crewed Artillery' | 'Crewed War Machine') => [\r\n    {\r\n      name,\r\n      desc: `This unit can only move if its Crew are within 1\" of the war machine at the start of the movement phase.`,\r\n      when: [START_OF_MOVEMENT_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name,\r\n      desc: `If this war machine's Crew are within 1\" of the war machine in the shooting phase, they can fire the war machine.`,\r\n      when: [SHOOTING_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name,\r\n      desc: `The war machine cannot make charge moves.`,\r\n      when: [CHARGE_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name,\r\n      desc: `The war machine does not need to take battleshock tests and is unaffected by any attack or ability that uses Bravery.`,\r\n      when: [BATTLESHOCK_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name,\r\n      desc: `The Crew are in cover while they are within 1\" of their war machine.`,\r\n      when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n  AelvenShield: {\r\n    name: `Aelven Shield`,\r\n    desc: `You can reroll save rolls of 1 for a unit with Aelven Shields. You can reroll failed save rolls of 1 or 2 for this unit in the shooting phase.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n  Dragonfire: {\r\n    name: `Dragonfire`,\r\n    desc: `A Dragon can unleash a blast of Dragonfire in your shooting phase. When it does so, pick a visible unit within 12\" and roll a D6; on a 1 or 2 that unit suffers a mortal wound, on a 3 or 4 that unit suffers D3 mortal wounds, and on a 5 or 6 that unit suffers D6 mortal wounds.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  Terror: {\r\n    name: `Terror`,\r\n    desc: `Subtract 1 from the Bravery characteristic of enemy units if they are within 3\" of any friendly units with this ability.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n  Impassable: {\r\n    name: `Impassable`,\r\n    desc: `You cannot move a model over this terrain feature unless it can fly, and you cannot move a model onto this terrain feature or set up a model on this terrain feature (even if it can fly).`,\r\n    when: [DURING_GAME],\r\n    shared: true,\r\n  },\r\n  Defensible: {\r\n    name: `Defensible`,\r\n    desc: `This terrain feature is a defensible terrain feature that can be garrisoned by 1 HERO with a Wounds characteristic of 8 or less.`,\r\n    when: [DURING_GAME],\r\n    shared: true,\r\n  },\r\n  FactionTerrainSetup: {\r\n    name: `Setup`,\r\n    desc: `After territories are determined, you can set up this faction terrain feature wholly within your territory and more than 3\" from all objectives and other terrain features. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.`,\r\n    when: [START_OF_SETUP],\r\n    shared: true,\r\n  },\r\n  FactionTerrainSetup_Removable: {\r\n    name: `Setup`,\r\n    desc: `After territories are determined, you can set up this faction terrain feature wholly within your territory and more than 3\" from all objectives and other terrain features. If these restrictions mean you cannot set up this faction terrain feature, you can remove 1 terrain feature that is wholly or partially within your territory and attempt to set up this faction terrain feature again. If it is still impossible to set up this faction terrain feature, then it is not used. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.`,\r\n    when: [START_OF_SETUP],\r\n    shared: true,\r\n  },\r\n  Predatory: {\r\n    Six_Inches: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 8\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n    Eight_Inches: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 8\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n    Nine_Inches: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 9\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n    Twelve_Inches: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 12\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n    Two_D6: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 2D6\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n    Three_D6: {\r\n      name: `Predatory`,\r\n      desc: `This endless spell is a predatory endless spell. It can be moved up to 3D6\" and can fly.`,\r\n      when: [END_OF_HERO_PHASE],\r\n      shared: true,\r\n    },\r\n  },\r\n  Linked: {\r\n    name: `Linked`,\r\n    desc: `If the model that summoned this endless spell is removed from play, then this endless spell is removed from play.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n  Elite: {\r\n    name: `Elite`,\r\n    desc: `Models in this unit can issue commands to their own unit.`,\r\n    when: [DURING_GAME],\r\n    shared: true,\r\n  },\r\n  Bonded: [\r\n    {\r\n      name: `Bonded`,\r\n      desc: `This endless spell is bonded to the model that summoned it. A bonded endless spell is always controlled by the model to which it is bonded. A model cannot be bonded to more than one endless spell at the same time and cannot attempt to summon other endless spells while it is bonded. If the model that summoned this endless spell is removed from play, then this endless spell is removed from play.`,\r\n      when: [DURING_GAME],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Bonded`,\r\n      desc: `If the model that summoned this endless spell is removed from play, then this endless spell is removed from play.`,\r\n      when: [WOUND_ALLOCATION_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n  InfantryHornblowerEffect: {\r\n    name: `Hornblower`,\r\n    desc: `Reroll dice rolls of 1 when determining how far this unit can run or charge while it includes any Hornblowers.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  ClanBannerEffect: {\r\n    name: `Clan Banner`,\r\n    desc: `If you fail a battleshock test for a unit that has any Clan Banners, halve the number of models that flee (rounding up).`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n  ArcaniteShieldEffect: {\r\n    name: `Arcanite Shield`,\r\n    desc: `A model that has an Arcanite Shield has a ward of 6+.`,\r\n    when: [WARDS_PHASE],\r\n    shared: true,\r\n  },\r\n  WizardOneSpellEffect: {\r\n    name: `Wizard`,\r\n    desc: `This unit can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  WizardTwoSpellsEffect: {\r\n    name: `Wizard`,\r\n    desc: `This unit can attempt to cast 2 spells in your hero phase and attempt to unbind 2 spells in the enemy hero phase.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n}\r\n\r\nexport default GenericEffects\r\n","import { GenericEffects } from 'generic_rules'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  DURING_GAME,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Summoning_Casting6_Range6_Effect = {\r\n  name: `Summoning`,\r\n  desc: `Casting value of 6 and range of 6\". Set up the endless spell wholly within range of the caster.`,\r\n  when: [HERO_PHASE],\r\n  rule_sources: [meta_rule_sources.GHB_2021],\r\n  shared: true,\r\n}\r\nconst Summoning_Casting5_Range8_Effect = {\r\n  name: `Summoning`,\r\n  desc: `Casting value of 5 and range of 8\". Set up the endless spell wholly within range of the caster.`,\r\n  when: [HERO_PHASE],\r\n  rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  shared: true,\r\n}\r\nconst Summoning_Casting6_Range8_Effect = {\r\n  name: `Summoning`,\r\n  desc: `Casting value of 6 and range of 8\". Set up the endless spell wholly within range of the caster.`,\r\n  when: [HERO_PHASE],\r\n  rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  shared: true,\r\n}\r\n\r\nexport const ChronomanticCogsEffects = [\r\n  Summoning_Casting6_Range6_Effect,\r\n  {\r\n    name: `Mechanisms of Time`,\r\n    desc: `When you set up this endless spell, you must decide if it is increasing or decreasing the flow of time.\r\n\r\n    If it is increasing the flow of time, players can reroll charge rolls for friendly units while they are wholly within 12\" of any endless spells with this ability.\r\n    \r\n    If it is decreasing the flow of time, players can attempt to cast either Arcane Bolt or Mystic Shield in their hero phase with a friendly WIZARD wholly within 6\" of this endless spell without counting that spell towards the number of spells that WIZARD can attempt to cast in that phase. In addition, subtract 1 from hit rolls for shooting attacks that target WIZARD\r\n    HEROES while they are wholly within 6\" of any endless spells with this ability.\r\n    \r\n    If a player has any friendly WIZARDS within 6\" of this endless spell at the start of their hero phase, they can change whether this endless spell is increasing or decreasing the flow of time.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const EmeraldLifeswarmEffects = [\r\n  Summoning_Casting6_Range6_Effect,\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `Bounteous Healing`,\r\n    desc: `After this endless spell has moved, the commanding player can pick 1 unit within 3\" of it. They can heal up to D3 wounds allocated to that unit or, if no wounds are allocated to it, they can return a number of slain models to that unit that have a combined Wounds characteristic of D3 or less.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n]\r\nexport const SoulsnareShacklesEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 7 and a range of 8\". Set up the parts of the endless spell wholly within 3\" of each other and wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Bound for the Great Oubliette`,\r\n    desc: `At the start of the movement phase, roll a dice for each unit within 6\" of this endless spell. Subtract the result from that unit's Move characteristic (to a minimum of 0) until the end of that phase. In addition, if a unit's Move characteristic is reduced to 0 by this ability, that unit suffers D3 mortal wounds.`,\r\n    when: [START_OF_MOVEMENT_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const SuffocatingGravetideEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 6 and a range of 8\". If successfully cast, set up the endless spell wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  GenericEffects.Predatory.Twelve_Inches,\r\n  {\r\n    name: `Pulled to the Grave`,\r\n    desc: `After this endless spell has moved, for each unit that has any models it passed across, roll a number of dice equal to the number of models in that unit. For each 5+, that unit suffers 1 mortal wound.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const GeminidsOfUhlGyshEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 6 and a range of 8\". If successfully cast, set up the parts of the endless spell within 6\" of each other and wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n  {\r\n    name: `Predatory`,\r\n    desc: `Can move up to 8\" and can fly. The parts of this endless spell must remain within 6\" of each other.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n  {\r\n    name: `Tendrils of Shadow and Light`,\r\n    desc: `After this endless spell has moved, roll a dice for each unit that has any models that it passed across, and each other unit that is within 1\" of it at the end of its move. On a 2+, that unit cannot issue or receive commands until the start of the next hero phase.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const BurningHeadEffects = [\r\n  Summoning_Casting6_Range8_Effect,\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `Flaming Skull`,\r\n    desc: `After this endless spell has moved, the commanding player can pick 1 enemy unit within 1\" of this endless spell and roll a dice. On a 2+, this endless spell is treated as part of that enemy unit until either that unit is destroyed or the endless spell is dispelled, at which point the endless spell is removed from play. While this endless spell is part of a unit, at the end of each movement phase, roll a dice. On a 2+, the unit that this endless spell is part of suffers D3 mortal wounds. After this endless spell causes any mortal wounds with this ability, it is removed from play.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const QuicksilverSwordsEffects = [\r\n  Summoning_Casting6_Range6_Effect,\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `Dancing Blades`,\r\n    desc: `After this endless spell has moved, you can pick 1 unit that has any models it passed across and roll 12 dice. For each 5+, that unit suffers 1 mortal wound. In addition, mortal wounds caused by this ability cannot be negated.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n  {\r\n    name: `Dancing Blades`,\r\n    desc: `Mortal wounds caused by this ability cannot be negated.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n]\r\nexport const PurpleSunEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 8 and range of 8\". Set up the endless spell wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `End Given Form`,\r\n    desc: `Subtract 1 from save rolls for attacks that target units within 6\" of this endless spell.`,\r\n    when: [SAVES_PHASE],\r\n    rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  },\r\n  {\r\n    name: `End Given Form`,\r\n    desc: `Roll a dice for each unit within 1\" of this endless spell after this endless spell has moved. On a 1, that unit has been touched by the Purple Sun's rays. If that unit has a Wounds characteristic of 9 or less, 1 model in that unit is slain. Otherwise, that unit suffers D6+6 mortal wounds.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n    ],\r\n  },\r\n]\r\nexport const PrismaticPalisadeEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 7 and range of 18\". Set up the endless spell wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Blinding Light`,\r\n    desc: `Units within 6After this endless spell is set up and at the start of each subsequent hero phase, roll a dice for each unit within 6\" of this endless spell. On a 3+, that unit cannot make shooting attacks in that turn. Add 3\" to the range of this ability at the start of each battle round after the turn in which this endless spell was summoned\" of this endless spell cannot make shooting attacks. Add 3\" to the range of this ability at the start of each battle round after the turn it was summoned.`,\r\n    when: [SHOOTING_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const MalevolentMaelstromEffects = [\r\n  Summoning_Casting5_Range8_Effect,\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `Morbid Detonation`,\r\n    desc: `After this endless spell is summoned, place a D6 beside it with the '1' facing up. Each time a spell is successfully cast by a unit within 12\" of this endless spell and not unbound, after the effects of the spell have been resolved, increase the value of the dice beside this endless spell by 1 (to a maximum of 6). In addition, each time a model is slain within 12\" of this endless spell, increase the value of the dice beside this endless spell by 1 (to a maximum of 6).\r\n    \r\n    At the end of a phase in which the dice beside this endless spell reaches '6', this endless spell is removed from play.\r\n    \r\n    When this endless spell is removed from play, if the dice beside it is a 6, this endless spell explodes. When it explodes, each unit within 12\" of this endless spell suffers D3 mortal wounds. Wizard Heroes suffer 3 mortal wounds instead of D3.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n      meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n    ],\r\n  },\r\n]\r\nexport const RavenaksGnashingJawsEffects = [\r\n  Summoning_Casting6_Range8_Effect,\r\n  {\r\n    name: `Predatory`,\r\n    desc: `This endless spell is a predatory endless spell. It can be moved up to 3D6\" and can fly. You can reroll the dice that determines how far this endless spell can move if it was summoned in the same turn.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Ravening Hunger`,\r\n    desc: `After this endless spell has moved, pick 1 unit that has any models it passed across or that is within 1\" of it at the end of its move and roll a dice. On a 2+, if the roll for this endless spell's move was greater than that unit's Move characteristic, that unit suffers a number of mortal wounds equal to the difference between that unit's Move characteristic (rounded up if necessary) and the roll for this endless spell's move.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.ERRATA_GHB_JANUARY_2023,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\n\r\nexport const AethervoidPendulumEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 6 and a range of 8\". If successfully cast, set up the endless spell wholly within range of the caster. When this endless spell is set up, pivot the model so that the tip of the pendulum blade is pointing in the direction you wish the endless spell to move.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Predatory`,\r\n    desc: `This endless spell is a predatory endless spell. It can be moved up to 8\" and can fly. When you move this endless spell, it must move in a straight line in the direction the tip of the pendulum blade is pointing or in the opposite direction to the direction in which the tip of the pendulum blade is poiting.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Scything Blade`,\r\n    desc: `After this endless spell has moved, roll a dice for each unit that has any models that it passed across, and each other unit that is within 1\" of it at the end of its move. On a 2+, that unit suffers D6 mortal wounds.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const UmbralSpellportalEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 5 and range of 18\". If successfully cast, set up 1 part of this spell within 1\" of the caster, then set up the other part wholly within the range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Arcane Passage`,\r\n    desc: `Once per turn, if a WIZARD successfully casts a spell within 1\" of this endless spell, the range, visibility and effect of that spell can be measured from 1 part of this endless spell instead of the caster, and that part endless spell is considered to be the caster of the spell for the purposes of unbinding. Spells that summon endless spells do not benefit from this effect.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Arcane Passage`,\r\n    desc: `Once per turn, if a predatory endless spell starts a move within 6\" of this endless spell, instead of making a move with it, the commanding player can remove that predatory endless spell from the battlefield and set it up again anywhere within 6\" of the other part of this endless spell. An endless spell set up in this manner does not count as having moved but cannot move until the next hero phase.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n      meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n    ],\r\n  },\r\n]\r\nexport const LauchonTheSoulseekerEffects = [\r\n  Summoning_Casting6_Range6_Effect,\r\n  {\r\n    name: `Predatory`,\r\n    desc: `Can move up to 18\" and can fly.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Soul Price`,\r\n    desc: `Before the commanding player moves this endless spell, they can pick 1 friendly WIZARD wholly within 3\" of this endless spell. Remove that WIZARD from the battlefield. After this endless spell has moved, set that WIZARD up again wholly within 3\" of this endless spell and more than 9\" from all enemy units. After that WIZARD has been set up, it suffers 1 mortal wound. That WIZARD can make a normal move or run in the following movement phase.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const SoulscreamBridgeEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 6 and range of 18\". If successfully cast, set up 1 part of this endless spell within 1\" of the caster, then set up the other part of the endless spell wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Deathly Passage`,\r\n    desc: `At the start of the movement phase, the player whose turn is taking place can remove 1 friendly unit that is wholly within 6\" of a part of this endless spell from the battlefield and set it up again wholly within 6\" of the other part of this endless spell and more than 9\" from all enemy units.\r\n\r\n    A unit cannot be removed and set up again in this way more than once per phase. A unit removed and set up again in this way cannot make a normal move or run in the same phase and cannot issue or receive commands until the start of that player's next hero phase.`,\r\n    when: [START_OF_MOVEMENT_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const HorrorghastEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 5 and a range of 12\". If successfully cast, set up the endless spell wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  GenericEffects.Predatory.Eight_Inches,\r\n  {\r\n    name: `Prey on Fear`,\r\n    desc: `Units within 12\" of this endless spell cannot receive commands in the battleshock phase. In addition, if a unit fails a battleshock test within 12\" of this endless spell, add D3 to the number of models that flee.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\nexport const ShardsOfValagharrEffects = [\r\n  {\r\n    name: `Summoning`,\r\n    desc: `Casting value of 5 and range of 18\". Set up the parts of the endless spell wholly within 8\" of each other and wholly within range of the caster.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  {\r\n    name: `Predatory`,\r\n    desc: `This endless spell is a predatory endless spell. When you pick this endless spell to move, remove 1 of its parts from the battlefield and set it up again wholly within 8\" of its other part.`,\r\n    when: [END_OF_HERO_PHASE],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n  // this effect was remove entirely in GHB 2023 - 2024\r\n  // {\r\n  //   name: `Ensnaring Soul-drain`,\r\n  //   desc: `After this endless spell has moved, draw a straight line between the closest points of each part of this endless spell. Each unit passed across by this line is ensnared until the end of that turn. Halve the Move characteristic of a unit that is ensnared.`,\r\n  //   when: [END_OF_HERO_PHASE],\r\n  //   rule_sources: [meta_rule_sources.GHB_2022, meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  // },\r\n  {\r\n    name: `Ensnaring Soul-drain`,\r\n    desc: `While they are within 6\" of any endless spells with this ability, units cannot fly or be removed from the battlefield with an effect that would allow it to be set up again in the same turn. In addition, units cannot be setup within 6\" of this endless spell.`,\r\n    when: [DURING_GAME],\r\n    rule_sources: [\r\n      meta_rule_sources.GHB_2022,\r\n      meta_rule_sources.GHB_2022_2023_SEASON_2,\r\n      meta_rule_sources.GHB_2023_2024,\r\n    ],\r\n  },\r\n]\r\n\r\nconst EndlessSpells: TEntry[] = [\r\n  // Removed in AoS 3.0\r\n  // {\r\n  //   name: `Balewind Vortex`,\r\n  //   effects: [\r\n  //     ...BalewindVortexEffects,\r\n  //     {\r\n  //       name: `Summon Balewind Vortex`,\r\n  //       desc: `Casting value of 6. WIZARDS with a Wounds characteristic of 9 or more, that are part of a unit of two or more models, are already on a Balewind Vortex, or happen to be Morathi-Khaine, cannot attempt to cast this spell. Set up a Balewind Vortex model within 1\" of the caster and more than 3\" from any enemy models, and then place the caster on the upper platform.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  {\r\n    name: `Emerald Lifeswanm`,\r\n    effects: [...EmeraldLifeswarmEffects],\r\n  },\r\n  {\r\n    name: `Geminids of Uhl-Gysh`,\r\n    effects: [...GeminidsOfUhlGyshEffects],\r\n  },\r\n  {\r\n    name: `Malevolent Maelstrom`,\r\n    effects: [...MalevolentMaelstromEffects],\r\n  },\r\n  {\r\n    name: `Prismatic Palisade`,\r\n    effects: [...PrismaticPalisadeEffects],\r\n  },\r\n  {\r\n    name: `Purple Sun of Shyish`,\r\n    effects: [...PurpleSunEffects],\r\n  },\r\n  {\r\n    name: `Quicksilver Swords`,\r\n    effects: [...QuicksilverSwordsEffects],\r\n  },\r\n  {\r\n    name: `Ravenak's Gnashing Jaws`,\r\n    effects: [...RavenaksGnashingJawsEffects],\r\n  },\r\n  {\r\n    name: `Soulsnare Shackles`,\r\n    effects: [...SoulsnareShacklesEffects],\r\n  },\r\n  {\r\n    name: `Suffocating Gravetide`,\r\n    effects: [...SuffocatingGravetideEffects],\r\n  },\r\n  {\r\n    name: `The Burning Head`,\r\n    effects: [...BurningHeadEffects],\r\n  },\r\n  {\r\n    name: `Umbral Spellportal`,\r\n    effects: [...UmbralSpellportalEffects],\r\n  },\r\n  {\r\n    name: `Aethervoid Pendulum`,\r\n    effects: [...AethervoidPendulumEffects],\r\n  },\r\n  {\r\n    name: `Chronomantic Cogs`,\r\n    effects: [...ChronomanticCogsEffects],\r\n  },\r\n  {\r\n    name: `Soulscream Bridge`,\r\n    effects: [...SoulscreamBridgeEffects],\r\n  },\r\n  {\r\n    name: `Shards of Valagharr`,\r\n    effects: [...ShardsOfValagharrEffects],\r\n  },\r\n  {\r\n    name: `Lauchon the Soulseeker`,\r\n    effects: [...LauchonTheSoulseekerEffects],\r\n  },\r\n  {\r\n    name: `Horrorghast`,\r\n    effects: [...HorrorghastEffects],\r\n  },\r\n]\r\n\r\nexport default EndlessSpells\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\n// General grand strategies\r\nconst GenericGrandStrategies: TEntry[] = [\r\n /* {\r\n    name: `Sever the Head`,\r\n    effects: [\r\n      {\r\n        name: `Sever the Head`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no HEROES from your opponent's starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Hold the Line`,\r\n    effects: [\r\n      {\r\n        name: `Hold the Line`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any Battleline units from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Vendetta`,\r\n    effects: [\r\n      {\r\n        name: `Vendetta`,\r\n        desc: `When the battle ends, you complete this grand strategy if the model chosen to be your opponent's general has been slain and the model chosen to be your general has not been slain.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Dominating Presence`,\r\n    effects: [\r\n      {\r\n        name: `Dominating Presence`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are more units from your starting army on the battlefield than there are units from your opponent's starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Beast Master`,\r\n    effects: [\r\n      {\r\n        name: `Beast Master`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any MONSTERS from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Prized Sorcery`,\r\n    effects: [\r\n      {\r\n        name: `Prized Sorcery`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any WIZARDS from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Pillars of Belief`,\r\n    effects: [\r\n      {\r\n        name: `Pillars of Belief`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any PRIESTS from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Predator's Domain`,\r\n    effects: [\r\n      {\r\n        name: `Predator's Domain`,\r\n        desc: `When the battle ends, you complete this grand strategy if you control more terrain features than your opponent.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // GHB 2022 Grand Strategies\r\n  // {\r\n  //   name: `No Place for the Weak`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `No Place for the Weak`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are no Battleline units from your opponent's starting army on the battlefield.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Tame the Land`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Tame the Land`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if you control all of the objectives on the battlefield that are wholly outside your territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Defend What's Ours`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Defend What's Ours`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are no enemy units wholly within your territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Take What's Theirs`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Take What's Theirs`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are more friendly units than enemy units wholly within your opponent's territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Demonstration of Strength`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Demonstration of Strength`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are 3 or more GALLETIAN VETERANS units from your starting army on the battlefield.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Show of Dominance`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Show of Dominance`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are any friendly GALLETIAN VETERANS units in each quarter of the battlefield.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022],\r\n  //     },\r\n  //   ],\r\n  // },\r\n\r\n  // GHB 2022-23 Season 2 Grand Strategies\r\n  // {\r\n  //   name: `Tame the Land`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Tame the Land`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if you control all of the objectives on the battlefield that are wholly outside your territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Defend What's Ours`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Defend What's Ours`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are no enemy units wholly within your territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Take What's Theirs`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Take What's Theirs`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are more friendly than enemy units wholly within enemy territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Stake a Claim`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Stake a Claim`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if 3 or more friendly GALLETIAN CHAMPIONS are wholly within enemy territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `Survivor's Instinct`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Survivor's Instinct`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if the model picked to be your general is a GALLETIAN CHAMPION and that model is contesting an objective wholly outside your territory.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: `The Day is Ours!`,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `The Day is Ours!`,\r\n  //       desc: `When the battle ends, you complete this grand strategy if there are more friendly GALLETIAN CHAMPIONS from your starting army than GALLETIAN CHAMPIONS from your opponent's starting army on the battlefield.`,\r\n  //       when: [END_OF_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n\r\n  // GHB 2023-24 Season 2 Grand Strategies\r\n  {\r\n    name: `Control the Nexus`,\r\n    effects: [\r\n      {\r\n        name: `Control the Nexus`,\r\n        desc: `When the battle ends, you complete this grand strategy if 2 or more friendly WIZARD units are wholly within 6\" of the centre of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Spellcasting Savant`,\r\n    effects: [\r\n      {\r\n        name: `Spellcasting Savant`,\r\n        desc: `When the battle ends, you complete this grand strategy if the model picked to be your general is an ANDTORIAN LOCUS and that unit has not been slain.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Slaughter of Sorcery`,\r\n    effects: [\r\n      {\r\n        name: `Slaughter of Sorcery`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no WIZARD units on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Barren Icescape`,\r\n    effects: [\r\n      {\r\n        name: `Barren Icescape`,\r\n        desc: `When the battle ends, you complete this grand strategy if all enemy units that have artefacts of power are destroyed and there are no enemy units within 6\" of the centre of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Overshadow`,\r\n    effects: [\r\n      {\r\n        name: `Overshadow`,\r\n        desc: `When the battle ends, you complete this grand strategy if all enemy Battleline units from your opponent's starting army are destroyed and there is at least 1 friendly Battleline unit from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Magic Made Manifest`,\r\n    effects: [\r\n      {\r\n        name: `Magic Made Manifest`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 2 or more endless spells or INCARNATES on the battlefield that are controlled by or bonded to friendly units.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n    ],\r\n  },*/\r\n] \r\n\r\nexport default GenericGrandStrategies\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst GenericIncarnates: TEntry[] = [\r\n /* {\r\n    name: `Krondspine Incarnate of Ghur`,\r\n    effects: [\r\n      {\r\n        name: `Bonding`,\r\n        desc: `This incarnate can only receive commands issued by the HERO it is bonded to.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bonding`,\r\n        desc: `If the All-out Attack command is received by this incarnate, the command is also received by all friendly units that are wholly within domination range of this incarnate, that are within 3\" of an enemy unit, and that have not already received a command in that phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bonding`,\r\n        desc: `Add 1 to casting dispelling and unbinding rolls for a WIZARD that is within domination range of an incarnate they are bonded to.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n\r\n      {\r\n        name: `Empowerment`,\r\n        desc: `If a MONSTER is slain by wounds inflicted by this incarnate's attacks, increase this incarnate's level by 1.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n\r\n      {\r\n        name: `Wild Form`,\r\n        desc: `Add 1 to hit rolls for attacks made by this incarnate while it is in its wild form. This incarnate can run and still charge in the same turn while it is in its wild form. If this incarnate is in its wild form, is within 12\" of another unit or an endless spell, and is not within 3\" of another unit at the start of your charge phase, it must attempt a charge and must make a charge move if it is possible for it to do so.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.ERRATA_SEASON_OF_WAR_THONDIA],\r\n      },\r\n\r\n      {\r\n        name: `Inflamed Savagery`,\r\n        desc: `The following effects apply to all units that are wholly within domination range of this incarnate: \r\n        \r\n        - The unit's command player can reroll run rolls and charge rolls for the unit.\r\n        - The unit cannot retreat.\r\n        - If the unit is a WIZARD that is not bonded to this incarnate, subtract 1 from casting, dispelling, and unbinding rolls for that WIZARD.`,\r\n        when: [DURING_GAME],\r\n      },\r\n\r\n      {\r\n        name: `Arcane Predator`,\r\n        desc: `In your charge phase if this incarnate is within 12\" of an endless spell that summoned by an enemy WIZARD, it can attempt a charge, and it can make a charge move as long that charge move finishes within 1/2\" of an enemy model or endless spell that was summoned by an enemy WIZARD.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Predator`,\r\n        desc: `This incarnate can carry out the Devour Endless Spell monstrous rampage instead of any other monstrous rampage it can carry out.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Devour Endless Spell`,\r\n        desc: `Pick 1 endless spell that was summoned by an enemy WIZARD and that is within 3\" of this incarnate, and roll 2D6. Add this incarnate's level to the roll. If the roll is greater than the casting value of the spell used to summon that endless spell, that endless spell is dispelled and the level of this incarnate is increased by 1. On any other roll, the level of this incarnate is reduced by 1.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        monstrous_rampage: true,\r\n      },\r\n    ],\r\n  }, */\r\n]\r\n\r\nexport default GenericIncarnates\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst GenericMonstrousRampages: TEntry[] = [\r\n /* {\r\n    name: 'Roar',\r\n    effects: [\r\n      {\r\n        name: `Roar`,\r\n        desc: `Pick 1 enemy unit within 3\" of this model and roll a dice. On a 3+, that unit cannot issue or receive commands in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Stomp`,\r\n    effects: [\r\n      {\r\n        name: `Stomp`,\r\n        desc: `Pick 1 enemy unit within 3\" of this model that is not a MONSTER and roll a dice. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Titanic Duel`,\r\n    effects: [\r\n      {\r\n        name: `Titanic Duel`,\r\n        desc: `Pick 1 enemy MONSTER within 3\" of this model. Add 1 to hit rolls for attacks made by this model that target that enemy MONSTER until the end of the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Smash To Rubble`,\r\n    effects: [\r\n      {\r\n        name: `Smash To Rubble`,\r\n        desc: `Pick 1 faction terrain feature or defensible terrain feature within 3\" of this model and roll a dice. On a 3+, the terrain feature is demolished if it was defensible (see 17.2.3), and the scenery rules on its warscroll cannot be used for the rest of the battle if it was a faction terrain feature.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },*/\r\n]\r\nexport default GenericMonstrousRampages\r\n","// Prayers go here\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst GenericPrayers: TEntry[] = [\r\n  // Core Prayers\r\n  /*{\r\n    name: `Bless`,\r\n    effects: [\r\n      {\r\n        name: `Bless`,\r\n        desc: `Answer value of 4 and range of 12\". If answered, pick 1 friendly unit wholly within range and visible to the chanter. Until the start of your next hero phase, that unit has a ward of 6+.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Smite`,\r\n    effects: [\r\n      {\r\n        name: `Smite`,\r\n        desc: `Answer value of 2 and range of 48\". If answered, pick 1 enemy Priest within range and visible to the chanter. That enemy Priest suffers 1 mortal wound. If the chanting roll was 6 or more, that enemy Priest suffers D3 mortal wounds instead of 1.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Guidance',\r\n    effects: [\r\n      {\r\n        name: `Guidance`,\r\n        desc: `Answer value of 5. If answered, you receive 1 command point.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Heal',\r\n    effects: [\r\n      {\r\n        name: `Heal`,\r\n        desc: `Answer value of 3 and range of 12\". If answered, pick 1 friendly model within range and visible to the chanter. You can heal up to D3 wounds allocated to that model.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n\r\n  {\r\n    name: 'Curse',\r\n    effects: [\r\n      {\r\n        name: `Curse`,\r\n        desc: `Answer value of 4 and range of 9\". If answered, pick 1 enemy unit within range and visible to the chanter. Until your next hero phase, if the unmodified hit roll for an attack that targets that unit is 6, that unit suffers 1 mortal wound in addition to any normal damage.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, */\r\n] \r\n\r\nexport default GenericPrayers\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { DURING_GAME, HERO_PHASE, START_OF_HERO_PHASE, START_OF_ROUND, DURING_SETUP, START_OF_TURN } from 'types/phases'\r\nimport { RealmscapesEnum } from 'types/realmscapes'\r\n\r\n// Realmscapes and their various effects/spells etc.\r\nconst Realmscapes: TEntry[] = [\r\n  // {\r\n  //   name: RealmscapesEnum.GHUR,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Predators and Prey`,\r\n  //       desc: `Once per battle round, you score 1 additional victory point if any enemy MONSTERS were slain in that battle round.`,\r\n  //       when: [END_OF_ROUND],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Seismic Shift`,\r\n  //       desc: `At the start of the third battle round, after the players roll off to determine who has the first turn, the player taking the second turn in that battle round can pick 1 objective marker on the battlefield and remove it from play.`,\r\n  //       when: [TURN_THREE_START_OF_ROUND],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Feral Roar`,\r\n  //       desc: `You can use this command ability at the start of the combat phase. The unit that receives that command must be a MONSTER. Until the end of that phase, when you look up a value on that unit's damage table, it is treated as if it has suffered 0 wounds.`,\r\n  //       when: [START_OF_COMBAT_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //       command_ability: true,\r\n  //     },\r\n  //     {\r\n  //       name: `Metamorphosis`,\r\n  //       desc: `Casting value of 5 and range of 12\". Pick 1 friendly HERO that is not a MONSTER and that is within range and visible to the caster. That HERO gains the MONSTER keyword until your next hero phase.`,\r\n  //       when: [HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //       spell: true,\r\n  //     },\r\n\r\n  //     // Battle Tactics\r\n  //     {\r\n  //       name: `Battle Tactics`,\r\n  //       desc: `At the start of your hero phase, you must pick 1 battle tactic. You must reveal your choice to your opponent, and if your battle tactics instructs you to pick something, you must tell your opponent what you pick. You have until the end of that turn to complete the battle tactic. You cannot pick the same battle tactic more than once per battle.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Broken Ranks`,\r\n  //       desc: `When you reveal this battle tactic, pick 1 Battleline unit from your opponent's starting army on the battlefield. You complete this battle tactic if that unit is destroyed during this turn. If that unit was destroyed by an attack made by a friendly MONSTER or an ability of a friendly MONSTER, score 1 additional victory point.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Conquer`,\r\n  //       desc: `When you reveal this battle tactic, pick 1 objective marker on the battlefield that your opponent controls. You complete this battle tactic if you control that objective marker at the end of this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Slay the Warlord`,\r\n  //       desc: `You complete this battle tactic if the model chosen to be your opponent's general is slain during this turn. If that model was destroyed by an attack made by a friendly MONSTER or an ability of a friendly MONSTER, score 1 additional victory point.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Ferocious Advance`,\r\n  //       desc: `When you reveal this battle tactic, pick 3 different units from your starting army on the battlefield. You complete this battle tactic if all of the units your picked run in the following movement phase and finish that run within 3\" of each other. If all 3 of those units are MONSTERS, score 1 additional victory point.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Bring It Down!`,\r\n  //       desc: `When you reveal this battle tactic, pick 1 enemy MONSTER on the battlefield. You complete this battle tactic if that unit is destroyed during this turn. If that enemy MONSTER was destroyed by an attack made by a friendly MONSTER or an ability of a friendly MONSTER, score 1 additional victory point.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Aggressive Expansion`,\r\n  //       desc: `When you reveal this battle tactic, pick 2 objective markers on the battlefield that are not wholly within your territory. You complete this battle tactic if you control both objective markers at the end of this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Monstrous Takeover`,\r\n  //       desc: `When you reveal this battle tactic, pick 1 MONSTER from your starting army on the battlefield. You complete this battle tactic if that MONSTER is contesting an objective marker that you control at the end of this turn, and that objective marker is not contested by an enemy MONSTER.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Savage Spearhead`,\r\n  //       desc: `You complete this battle tactic if there are 2 or more units from your starting army wholly within your opponent's territory at the end of this turn. If 2 or more of those units are MONSTERS, score 1 additional victory point.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2021],\r\n  //     },\r\n  //   ],\r\n  // },\r\n\r\n  // {\r\n  //   name: RealmscapesEnum.GALLET,\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Galletian Champions`,\r\n  //       desc: `HEROES with a Wounds characteristic of less than 10, that do not have a mount (with the exception of companions) and that are not Unique gain the GALLETIAN CHAMPION keyword.`,\r\n  //       when: [DURING_SETUP],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2, meta_rule_sources.ERRATA_GHB_JANUARY_2023],\r\n  //     },\r\n  //     {\r\n  //       name: `The Key to Victory`,\r\n  //       desc: `Friendly GALLETIAN CHAMPIONS cannot be picked as the target of attacks made with missile weapons while they are within 1\" of any friendly Battleline units.`,\r\n  //       when: [SHOOTING_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Desperate Action`,\r\n  //       desc: `If you are taking the second turn in the current battle round, at the start of your hero phase, you can pick 1 friendly GALLETIAN CHAMPION on the battlefield to carry out 2 different heroic actions in that phase instead of 1.`,\r\n  //       when: [TURN_TWO_START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Strike at the Opening (Heroic Action)`,\r\n  //       desc: `Pick 1 friendly GALLETIAN CHAMPION within 3\" of an enemy unit. That HERO can fight if it has not already fought in that phase. However, that HERO cannot fight again in that phase and the strike-last effect applies to that HERO until the end of the turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Lead by Example (Heroic Action)`,\r\n  //       desc: `Pick 1 friendly GALLETIAN CHAMPION that has a Sworn Bodyguard unit (pg 14) and that has just carried out the 'Strike at the Opening' heroic action. If that Sworn Bodyguard unit is wholly within 6\" of that GALLETIAN CHAMPION and within 3\" of an enemy unit, that Sworn Bodyguard unit can fight if it has not already fought in that phase. However, that unit cannot fight again in that phase and the strike-last effect applies to that unit until the end of the turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Grinding Teeth of Gallet`,\r\n  //       desc: `Casting value of 6 and a range of 12\". Pick 1 objective within range and visible to the caster. Then, roll a dice for each unit within 6\" of that objective. On a 4+, that unit suffers D6 mortal wounds. All Wizards know this spell in addition to any others that they know.`,\r\n  //       when: [HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //       spell: true,\r\n  //     },\r\n  //     {\r\n  //       name: `No Retreat, No Surrender`,\r\n  //       desc: `You can use this command ability at the start of the combat phase. The unit that receives the command must be a friendly unit that is not a HERO or MONSTER, that did not charge in the same turn, and that is within 3\" of an enemy unit. That unit cannot make pile-in moves in that phase, but add 1 to the Attacks characteristic of melee weapons used by that unit until the end of that phase (excluding those of its mounts, if it has any). Each player can use this command ability in addition to any others that they can use.`,\r\n  //       when: [START_OF_COMBAT_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //       command_ability: true,\r\n  //     },\r\n  //     {\r\n  //       name: `The Prize of Gallet - Victory Points`,\r\n  //       desc: `Each player scores victory points at the end of each of their turns as follows:\r\n\r\n  //       - Score 1 victory point if you control at least one activated objective.\r\n  //       - Score 1 victory point if you control two or more activated objectives.\r\n  //       - Score 1 victory point if you control more activated objectives than your opponent.\r\n  //       - Score 2 victory points if you completed the battle tactic you picked that turn.`,\r\n  //       when: [END_OF_TURN],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n\r\n  //     // Aspect of the Champion\r\n  //     {\r\n  //       name: `Tunnel Master (Aspect of the Champion)`,\r\n  //       desc: `Once per battle, instead of picking this GALLETIAN CHAMPION to make a normal move, you can remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n  //       when: [MOVEMENT_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Fuelled by Ghurish Rage (Aspect of the Champion)`,\r\n  //       desc: `Once per battle, before you allocate a wound or mortal wound to this GALLETIAN CHAMPION and that wound or mortal wound would cause it to be slain, you can roll a dice. On a 3+, that wound or mortal wound is negated, you can heal up to D3 wounds allocated to it and any wounds that currently remain to be allocated to it are negated.`,\r\n  //       when: [WOUND_ALLOCATION_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Stubborn as a Rhinox (Aspect of the Champion)`,\r\n  //       desc: `This GALLETIAN CHAMPION counts as 10 models for the purposes of contesting objectives while there are no enemy GALLETIAN CHAMPIONS contesting the same objective.`,\r\n  //       when: [DURING_GAME],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Leadership of the Alpha (Aspect of the Champion)`,\r\n  //       desc: `Once per battle, this GALLETIAN CHAMPION can issue one of the following commands up to 3 times in the same phase: Rally, All-out Attack, All-out Defence or Redeploy. If it does so, no command point is spent the second and third times this GALLETIAN CHAMPION issues that command in that phase.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n\r\n  //     // Battle tactics\r\n  //     {\r\n  //       name: `Battle Tactics`,\r\n  //       desc: `At the start of your hero phase, you must pick 1 battle tactic from the list below. You must reveal your choice to your opponent, and if your battle tactic instructs you to pick something, you must tell your opponent what you pick. You have until the end of that turn to complete the battle tactic. You cannot pick the same battle tactic more than once per battle.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Gaining Momentum`,\r\n  //       desc: `Pick 1 enemy unit on the battlefield. You complete this battle tactic if that unit is destroyed during this turn and you control more objectives than your opponent at the end of this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: An Eye for an Eye`,\r\n  //       desc: `You complete this battle tactic if 1 or more friendly units were destroyed in the previous turn and 1 or more enemy units are destroyed during this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Desecrate their Lands`,\r\n  //       desc: `Pick 1 terrain feature or faction terrain feature that is partially or wholly within enemy territory. You complete this battle tactic if you control that terrain feature at the end of this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: This One's Mine!`,\r\n  //       desc: `Pick 1 enemy unit on the battlefield. You complete this battle tactic if that unit is destroyed during this turn by an attack made by the model picked to be your general.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: A Matter of Honour`,\r\n  //       desc: `Pick 1 enemy GALLETIAN CHAMPION or Sworn Bodyguard unit on the battlefield. You complete this battle tactic if that unit is destroyed during this turn by an attack made by a friendly GALLETIAN CHAMPION or Sworn Bodyguard unit.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Lead the Assault`,\r\n  //       desc: `You complete this battle tactic if at least 2 of the objectives you control are in enemy territory and are each contested by any friendly GALLETIAN CHAMPIONS.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: United Offence`,\r\n  //       desc: `Pick 1 objective controlled by your opponent. You complete this battle tactic if you control that objective and 2 or more friendly GALLETIAN CHAMPIONS are contesting that objective at the end of this turn.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //     {\r\n  //       name: `Battle Tactic: Cunning Manoeuvre`,\r\n  //       desc: `Pick 1 friendly GALLETIAN CHAMPION on the battlefield that is more than 3\" from all enemy units. You complete this battle tactic if, at the end of the turn, that GALLETIAN CHAMPION is more than 3\" from all enemy units and is contesting an objective you control that is wholly outside your territory.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //       rule_sources: [meta_rule_sources.GHB_2022_2023_SEASON_2],\r\n  //     },\r\n  //   ],\r\n  // },\r\n\r\n  {\r\n    name: RealmscapesEnum.ANDTOR,\r\n    effects: [\r\n      {\r\n        name: `Honour Guard - Special Assignment`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Pick 1 of the following weapon abilities:\r\n         Anti-Infantry(+1 Rend)\r\n         Anti-Cavalry(+1 Rend)\r\n         Anti-Monster(+1 Rend)\r\n         Anti-War Machine(+1 Rend)\r\n         Anti-Beast(+1 Rend)\r\n        In any turn in which the honour guard charged, that unit's melee weapons have the weapons ability you picked. This has no effect on Companion weapons.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Honour Guard - Priority Target`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Add 1 to hit rolls and wound rolls for attacks made by the honour guard that target any units in the enemy general's regiment.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: `Honour Guard - Bodyguard`,\r\n        desc: `Declare: Pick a friendly unit in your general's regiment that is not your gerneral to be the honour gurard. You can pick a unit in reserve. If you use this ability, you cannot use any other Honour Guard abilities.\r\n        Effect: Subtract 1 from the Attacks characteristic of enemy units' melee weapons while they are in combat with your general if both of the following are true:\r\n         The honour guard is wholly within 6\" of your general.\r\n         The honour guard did not charge this turn`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      }, \r\n\r\n      /* Command Traits\r\n      {\r\n        name: `Shaman of the Chilled Lands`,\r\n        desc: `This general knows all of the spells from the Lore of Primal Frost.`,\r\n        when: [HERO_PHASE],\r\n        command_trait: true,\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Eye of the Blizzard`,\r\n        desc: `At the start of your hero phase, if this general is on the battlefield, roll a dice. On a 5+, you gain 1 primal magic dice.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        command_trait: true,\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Chilled to the Bone`,\r\n        desc: `Once per battle, if this general suffers a miscast or primal miscast, you can roll a dice. On a 3+, this general can ignore the effects of that miscast or primal miscast.`,\r\n        when: [HERO_PHASE],\r\n        command_trait: true,\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Eater of Magic`,\r\n        desc: `Each time this general successfully unbinds a spell, roll a dice. On a 5+, the caster no longer knows that spell and may not cast it again for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n        command_trait: true,\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },*/\r\n\r\n      // Battle tactics\r\n      {\r\n        name: `Battle Tactic: Do Not Waver`,\r\n        desc: `You complete this battle tactic at the end of your turn if 2 or more friendly units fought this turn and no friendly units were destroyed this turn`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic: Slay the Entourage`,\r\n        desc: `Pick a unit in the enemy general's regiment. You complete this battle tactic if that unit is destroyed this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic: Attack on Two Fronts`,\r\n        desc: `You complete this battle tactic at the end of the turn if you control 2 or more objectives that you did not control at the start of your turn and a least 1 of those objectives was controlled by your opponent at the start of your turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic: Take their Land`,\r\n        desc: `Pick a terrain feature wholly or partially within enemy territory and wholly outside friendly territory. You complete this battle tactic if you control that terrain feature at the end of your turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic: Seize the Center`,\r\n        desc: `You complete this battle tactic at the end of your turn if 2 or more friendly units are within 3\" of the center of the battlefiled and are not in combat.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic: Take the Flanks`,\r\n        desc: `You complete this battle tactic at the end of your turn if you have at least 1 friendly unit within 6\" of each short battlefield edge, none of those units are wholly within friendly territory, and none of those units were set up this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic (ORDER): Reclaim the Realms`,\r\n        desc: `You complete this battle tactic at the end of your turn if there are 1 or more friendly units wholly within each quarter of the battlefield and more than 6\" from all enemy units.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic (ORDER): Slay the Tyrants`,\r\n        desc: `You complete this battle tactic at the end of your turn if an enemy hero was slain this turn by a combat attack made by a friendly unit.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Battle Tactic (CHAOS): Offering of Carnage`,\r\n        desc: `You complete this battle tactic at the end of your turn if 2 or more enemy units were destroyed this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Battle Tactic (CHAOS): Ordained Charge`,\r\n        desc: `Pick an objective controlled by you opponent. You complete this battle tactic at the end of your turn if 2 or more frinedly units charged this turn, 1 or more of those units are contesting that onjective, and you control that objective.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Battle Tactic (DEATH): Marked for the Grave`,\r\n        desc: `Pick a non-hero enemy unit that has not had any models slain this battle. If there are no non-hero enemy units on the battlefield, you can pick any enemy unit. You complete this battle tactic at the end of your turn if that unit is destroyed this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Battle Tactic (DEATH): Inevitable Demise`,\r\n        desc: `You complete this battle tactic at the end of your turn if 2 or more friendly units are wholly within enemy territory and more than 9\" from all enemy units, and none of those units were set up this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Battle Tactic (DESTRUCTION): Time to Get Stuck In!`,\r\n        desc: `Pick 3 friendly units that are not in combat and are wholly wihtin friendly territory. You complete this battle tactic at the end of your turn if each of those units is wholly outside your territory and used a fight abilty this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Battle Tactic (DESTRUCTION): The Kunnin' Approach`,\r\n        desc: `Pick an enemy unit that is in combat and pick a friendly unit that is not in combat. You complete this battle tactic at the end of your turn if that friendly unit was in combat with that enemy unit this turn and that enemy unit was destroyed this turn.`,\r\n        when: [START_OF_TURN],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n\r\n      /* Nullstone Adornments\r\n      {\r\n        name: `Hand-carved Nullstone Icon`,\r\n        desc: `The bearer can attempt to unbind 1 spell or attempt to dispel 1 endless spell in the enemy hero phase in the same manner as a WIZARD. Each time the bearer successfully unbinds a spell or dispels an endless spell using this ability, the bearer can attempt to unbind 1 additional spell in that phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Pouch of Nulldust`,\r\n        desc: `Once per battle, at the start of the hero phase, you can say that the bearer will use their Pouch of Nulldust. If you do so, until the end of that phase, unmodified casting rolls that include a double 1, double 2 or double 3 are treated as miscasts or, if a primal magic dice was rolled as part of the casting roll, as primal miscasts. In addition, roll a dice for each endless spell on the battlefield. On a 5+, that endless spell is dispelled.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n      {\r\n        name: `Polished Nullstone Pebble`,\r\n        desc: `When this unit is picked as the target of a spell or the abilities of an endless spell, you can roll a dice. On a 4+, the caster must pick another unit within 3\" of this unit and within range of that spell or endless spell's abilities to be the target. If, when picking another unit, there are no other units within 3\" of this unit and within range, ignore the effect of that spell or the effects of that endless spell's abilities on this unit instead.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n      },\r\n\r\n      // Spells\r\n      {\r\n        name: `Hoarfrost`,\r\n        desc: `Hoarfrost is a spell that has a casting value of 8 and a range of 12\". If successfully cast, pick 1 friendly unit wholly within range and visible to the caster. Pick 1 melee weapon profile on that unit's warscroll and roll a D3. Change the To Hit, To Wound or Rend characteristic of that melee weapon to match the result until the start of your next hero phase. For example, if the result was 2, you could change either the To Hit characteristic to 2+, the To Wound characteristic to 2+ or the Rend characteristic to -2.\r\n        \r\n        Designer's Note: An unmodified hit roll or wound roll of 1 always fails.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024],\r\n        spell: true,\r\n      },\r\n      {\r\n        name: `Rupture`,\r\n        desc: `Rupture is a spell that has a casting value of 10 and a range of 18\". If successfully cast, resolve 1 of the following effects:\r\n\r\n        - Pick 1 enemy Incarnate within range and visible to the caster. Inflict D3 mortal wounds on the unit bonded to that Incarnate. Then, that Incarnate immediately loses a power level (to a minimum of 1) and becomes wild.\r\n       \r\n        - Pick 1 predatory endless spell within range and visible to the caster that was summoned by an enemy Wizard. Inflict D3 mortal wounds on that enemy Wizard. Then, that endless spell is dispelled.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024, meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n        spell: true,\r\n      },\r\n      {\r\n        name: `Merciless Blizzard`,\r\n        desc: `Casting value of 12 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. That unit suffers 4D6 mortal wounds, but for each roll of 1, the caster also suffers D3 mortal wounds that cannot be negated. The range of this spell cannot be modified and must be measured from the caster, even if an ability would allow you to measure it from elsewhere. This spell cannot be cast by a unit that was set up or moved earlier in this phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.GHB_2023_2024, meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n        spell: true,\r\n      }, */\r\n    ],\r\n  },\r\n]\r\n\r\nexport default Realmscapes\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEffects, TEntry } from 'types/data'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SETUP,\r\n  TURN_ONE_START_OF_ROUND,\r\n} from 'types/phases'\r\nimport { ARCANE, DAMNED, DEADLY, INSPIRING, MYSTICAL, SINISTER, TSceneryEffects } from 'types/terrain'\r\n\r\n// Default scenery effects for most games and custom scenery.\r\nconst DefaultScenery: TEntry[] = [\r\n /* {\r\n    name: DAMNED,\r\n    effects: [\r\n      {\r\n        name: DAMNED,\r\n        desc: `In your hero phase, you can pick 1 friendly unit within 1\" of any terrain features with this rule. That unit suffers D3 mortal wounds but you can add 1 to hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: ARCANE,\r\n    effects: [\r\n      {\r\n        name: ARCANE,\r\n        desc: `Add 1 to casting, dispelling and unbinding rolls for models while they are within 1\" of any terrain features with this rule.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: INSPIRING,\r\n    effects: [\r\n      {\r\n        name: INSPIRING,\r\n        desc: `Add 1 to the Bravery characteristic of units while they are wholly within 1\" of any terrain features with this rule.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: DEADLY,\r\n    effects: [\r\n      {\r\n        name: DEADLY,\r\n        desc: `Each time a unit is set up or finishes a normal move, run, retreat or charge move within 1\" of any terrain features with this rule, roll a dice. On a 1, that unit suffers D3 mortal wounds.`,\r\n        when: [DURING_SETUP, MOVEMENT_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: MYSTICAL,\r\n    effects: [\r\n      {\r\n        name: MYSTICAL,\r\n        desc: `Add 1 to chanting and banishment rolls for models while they are within 1\" of any terrain features with this rule.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n      {\r\n        name: MYSTICAL,\r\n        desc: `Models have a 6+ ward while they are within 1\" of any terrain features with this rule.`,\r\n        when: [SAVES_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: SINISTER,\r\n    effects: [\r\n      {\r\n        name: SINISTER,\r\n        desc: `Subtract 1 from the Bravery characteristic of units while they are wholly within 1\" of any terrain features with this rule.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ], \r\n  }, */\r\n\r\n  // TODO: Are these rules still relevant in AoS 3.0?\r\n  // {\r\n  //   name: OVERGROWN,\r\n  //   effects: [\r\n  //     {\r\n  //       name: OVERGROWN,\r\n  //       desc: `Units are not visible if a 1mm imaginary line drawn from the closest points of two models crosses more than 1\" of this terrain. Does not apply if either unit can fly.`,\r\n  //       when: [DURING_GAME],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: ENTANGLING,\r\n  //   effects: [\r\n  //     {\r\n  //       name: ENTANGLING,\r\n  //       desc: `Subtract 2 from run and charge rolls (to a minimum of 0) for units that are within 1\" of this terrain.`,\r\n  //       when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: VOLCANIC,\r\n  //   effects: [\r\n  //     {\r\n  //       name: VOLCANIC,\r\n  //       desc: `Roll a D6 for each instance of this terrain. On a 6, each unit within 1\" of that terrain feature suffers D3 mortal wounds.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: COMMANDING,\r\n  //   effects: [\r\n  //     {\r\n  //       name: COMMANDING,\r\n  //       desc: `If your general and no enemy general are within 1\" of this terrain, add 1 to the number of command points you receive.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: HEALING,\r\n  //   effects: [\r\n  //     {\r\n  //       name: HEALING,\r\n  //       desc: `Roll a D6 for each friendly unit within 1\" of any Healing terrain. On a 6 you can heal D3 wounds to that unit.`,\r\n  //       when: [START_OF_HERO_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: NULLIFICATION,\r\n  //   effects: [\r\n  //     {\r\n  //       name: NULLIFICATION,\r\n  //       desc: `If a hero is within 1\" of this terrain it can attempt to unbind 1 spell. WIZARDS get this unbind in addition to any others they have.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: NULLIFICATION,\r\n  //       desc: `If an endless spell is set up or finishes a move within 1\" of this terrain it is dispelled. Any effects from the spell are applied before the model is removed.`,\r\n  //       when: [DURING_GAME],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: OBSTACLE,\r\n  //   effects: [\r\n  //     {\r\n  //       name: OBSTACLE,\r\n  //       desc: `If a unit has all of its models within 1\" of this terrain is targeted for a shooting attack, the unit receives cover if the attacking model is closer to the terrain than the targeted unit.`,\r\n  //       when: [SHOOTING_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   name: GARRISONS,\r\n  //   effects: [\r\n  //     {\r\n  //       name: GARRISONS,\r\n  //       desc: `Units can be set up as a garrison if this terrain is wholly within your territory.\r\n\r\n  //              The models garrisoning this terrain feature must have a combined wounds characteristic of 30 or less.`,\r\n  //       when: [DURING_SETUP],\r\n  //     },\r\n  //     {\r\n  //       name: GARRISONS,\r\n  //       desc: `A unit that is wholly within 6\" of this terrain and no enemy models within 3\" of this terrain may garrison instead of moving.\r\n\r\n  //              A unit may exit the terrain if it can be set up wholly within 6\" of the terrain and more than 3\" from enemy models. This counts as the unit's move.\r\n\r\n  //              The models garrisoning this terrain feature must have a combined wounds characteristic of 30 or less.`,\r\n  //       when: [MOVEMENT_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: GARRISONS,\r\n  //       desc: `A garrisoned unit is assumed to be in cover. In addition, subtract 1 from hit rolls against a garrisoned unit.\r\n\r\n  //             Models cannot finish any move onto this terrain feature.`,\r\n  //       when: [DURING_GAME],\r\n  //     },\r\n  //   ],\r\n  // },\r\n]\r\n\r\nexport const SceneryEffectLookup = DefaultScenery.reduce((accum, entry: TEntry) => {\r\n  accum[entry.name as TSceneryEffects] = entry.effects\r\n  return accum\r\n}, {} as Record<TSceneryEffects, TEffects[]>)\r\n\r\n// Penumbral is now a scenery type.\r\nconst PenumbralEffects: TEffects[] = [\r\n /* {\r\n    name: `Repercussions of the Necroquake`,\r\n    desc: `After determining who has the first turn, roll a D6 to determine the function of all Penumbral terrain features for the duration of the battle:\r\n\r\n      1-3: Orrery of Obfuscation.\r\n      4-6: Orrery of Illumination`,\r\n    when: [TURN_ONE_START_OF_ROUND],\r\n  },\r\n  {\r\n    name: `Orrery of Obfuscation`,\r\n    desc: `Reroll save rolls of 1 for units wholly within 12\" any Penumbral terrain features.`,\r\n    when: [SAVES_PHASE],\r\n  },\r\n  {\r\n    name: `Orrery of Illumination`,\r\n    desc: `At the start of your hero phase, you receive 1 extra command point if any friendly HEROES are within 12\" of any Penumbral terrain features.`,\r\n    when: [START_OF_HERO_PHASE],\r\n  },\r\n  {\r\n    name: `Deteriorating State`,\r\n    desc: `Applies from start of Round 2 onwards. Roll a D6. On a 5-6, the currently active Orrey function on all Penumbral terrain features switches to the other option.`,\r\n    when: [START_OF_ROUND],\r\n  },*/\r\n\r\n]\r\n// Faction scenery available to all armies and all other official models potentially a part of each battle.\r\nconst OfficialScenery: TEntry[] = [\r\n /* {\r\n    name: `Penumbral Engine`,\r\n    effects: [\r\n      {\r\n        name: `Penumbral Engine`,\r\n        desc: `After territories have been chosen, but before armies have been set up, you can set up this model wholly within your territory. It must be more than 12\" from enemy territory, at least 3\" away from other terrain features, and at least 1\" away from any objectives. If both players can place a terrain features at this time, roll off to see who places first.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      ...PenumbralEffects,\r\n    ],\r\n  },\r\n  {\r\n    name: `Arcane Ruin`,\r\n    effects: [\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n      ...SceneryEffectLookup[ARCANE],\r\n    ],\r\n  },\r\n  {\r\n    name: `Azyrite Ruins`,\r\n    effects: [\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Baleful Realmgate`,\r\n    effects: [\r\n      {\r\n        name: `Spirit Journey`,\r\n        desc: `You may remove a unit wholly within 6\" of this terrain and set it up wholly within 6\" of another Baleful Realmgate. This can only be activated if a priest or wizard is within 6\" of the starting gate.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Barbed Venomgorse`,\r\n    effects: [\r\n      {\r\n        name: `Barbed Venomgorse`,\r\n        desc: `This terrain consists of 3 models each set up within 1\" of at least one other model from the group.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      ...SceneryEffectLookup[DEADLY],\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Citadel Wood`,\r\n    effects: [\r\n      // ...SceneryEffectLookup[OVERGROWN],\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Dragonfate Dais`,\r\n    effects: [\r\n      ...SceneryEffectLookup[DAMNED],\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Enduring Stormvault`,\r\n    effects: [\r\n      {\r\n        name: `Rune-locked Vault`,\r\n        desc: `1 friendly HERO within 1\" of this terrain feature can roll a D6. On a 1, the HERO suffers D3 mortal wounds. On a 2-5, no effect. On a 6 roll a D3 to determine the effect:\r\n\r\n               1 - Add 1 to the damage characteristic of one of the HERO's melee weapons for the remainder of the battle.\r\n               2 - HERO can attempt to cast 1 arcane bolt spell as if it were a wizard. This counts as 1 extra spell on wizards.\r\n               3 - Immeadiately set up an endless spell wholly within 12\" of the HERO as if they had cast it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Hallowed Stormthrone`,\r\n    effects: [\r\n      {\r\n        name: `Bastion of Order`,\r\n        desc: `Order units treat this terrain as Inspiring. Chaos, Destruction, and Death units treat this terrain feature as Sinister.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Consecrated Ground`,\r\n        desc: `Roll a D6 for each endless spell within 6\" of this terrain feature. On a 6 the endless spell is immediately dispelled.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Consecrated Ground`,\r\n        desc: `Roll a D6 each time a unit wholly within this terrain feature is affected by a spell or endless spell. On a 6+ ignore the effects of that spell on the unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n\r\n      ...SceneryEffectLookup[INSPIRING],\r\n      ...SceneryEffectLookup[SINISTER],\r\n    ],\r\n  },\r\n  {\r\n    name: `Magewrath Throne`,\r\n    effects: [\r\n      // ...SceneryEffectLookup[COMMANDING],\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Numinous Occulum`,\r\n    effects: [\r\n      ...SceneryEffectLookup[MYSTICAL],\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Ophidian Archway`,\r\n    effects: [\r\n      ...SceneryEffectLookup[SINISTER],\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Penumbral Stormvault`,\r\n    effects: [\r\n      ...PenumbralEffects,\r\n      {\r\n        name: `Grand Dais of Sigmar`,\r\n        desc: `Order units wholly within 6\" of this terrain feature do not take battleshock tests.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Grand Dais of Sigmar`,\r\n        desc: `Chaos, Death, and Destruction generals within 1\" of this terrain feature generate 1 additional command point. This does not take effect if any enemy units are within 1\" of this terrain feature.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Shardwrack Spines`,\r\n    effects: [\r\n      {\r\n        name: `Shardwrack Spines`,\r\n        desc: `This terrain consists of 2-5 models with all model's bases touching at least one other model's base from the group.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      ...SceneryEffectLookup[DEADLY],\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Shattered Temple`,\r\n    effects: [\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n\r\n      ...SceneryEffectLookup[DEADLY],\r\n      ...SceneryEffectLookup[ARCANE],\r\n    ],\r\n  },\r\n  {\r\n    name: `Sigmarite Dais`,\r\n    effects: [\r\n      {\r\n        name: `Bastion of Order`,\r\n        desc: `Order units treat this terrain as Inspiring. All other grand alliances treat this terrain as Sinister.`,\r\n        when: [DURING_GAME],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n\r\n      ...SceneryEffectLookup[INSPIRING],\r\n      ...SceneryEffectLookup[SINISTER],\r\n    ],\r\n  },\r\n  {\r\n    name: `Sigmarite Mausoleum`,\r\n    effects: [\r\n      {\r\n        name: `Sigmarite Mausoleum`,\r\n        desc: `This terrain consists of 3-6 crypt models, 1-2 statue models, 1-2 gate models, and 7-14 wall section models. All model's bases must be touching at least two other model's bases from the group.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Domain of the Dead`,\r\n        desc: `This terrain is treated as an additional gravesite as specified in Battletome: Legions of Nagash.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      // ...SceneryEffectLookup[GARRISONS],\r\n    ],\r\n  },\r\n  {\r\n    name: `Timeworn Ruin`,\r\n    effects: [\r\n      {\r\n        name: `Timeworn Ruin`,\r\n        desc: `This terrain consists of 10 Timeworn Ruin models with each model being set up within 1\" of at least one other model from the group.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n\r\n      ...SceneryEffectLookup[DEADLY],\r\n    ],\r\n  },\r\n  {\r\n    name: `Walls and Fences`,\r\n    effects: [\r\n      {\r\n        name: `Walls and Fences`,\r\n        desc: `This terrain feature consists of 2-10 wall and/or fence models and is set up with all model's bases touching at least one other model's base from the group.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n\r\n      // ...SceneryEffectLookup[OBSTACLE]\r\n    ],\r\n  },\r\n  {\r\n    name: `Warscryer Citadel`,\r\n    effects: [\r\n      {\r\n        name: `Celestium Construct`,\r\n        desc: `If any heroes from your army are garrisoning this terrain you can roll a D6. On a 2+, add 1 to the number of command points you receive this phase. On a 1, subtract 1 from the number of command points your receive instead.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Domed Arcanoscope`,\r\n        desc: `If any heroes from your army are garrisoning this terrain with a domed arcanoscope, one of them can attempt to unbind 1 spell. WIZARDS get this unbind in addition to any others they have.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Crenellated Battlements`,\r\n        desc: `A model with a wounds characteristic of 10+ cannot garrison this terrain unless the terrain has crenellated battlements.\r\n\r\n               If this terrain has crenellated battlements, it can be garrisoned by a single monster that can fly in addition to the other models that can garrison it.`,\r\n        when: [DURING_SETUP, MOVEMENT_PHASE],\r\n      },\r\n      // ...SceneryEffectLookup[GARRISONS],\r\n    ],\r\n  }, */\r\n\r\n] \r\n\r\n\r\n// Combine all scenery rules into generic scenery export for use by any army.\r\nconst GenericScenery: TEntry[] = [...DefaultScenery, ...OfficialScenery]\r\n\r\nexport default GenericScenery\r\n","// Spells go here\r\nimport { TEntry } from 'types/data'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst GenericSpells: TEntry[] = [\r\n  // Core Spells\r\n /* {\r\n    name: `Arcane Bolt`,\r\n    effects: [\r\n      {\r\n        name: `Arcane Bolt`,\r\n        desc: `Casting value of 5 and range of 12\". If successfully cast, at the start of any 1 phase before your next hero phase, you can pick 1 enemy unit within range and visible to the caster. That unit suffers 1 mortal wound. If that unit is within 3\" of the caster, it suffers D3 mortal wounds instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Mystic Shield`,\r\n    effects: [\r\n      {\r\n        name: `Mystic Shield`,\r\n        desc: `Casting value of 5 and range of 12\". Pick 1 friendly unit wholly within range and visible to the caster. Add 1 to save rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Enhancements\r\n  {\r\n    name: `Flaming Weapon`,\r\n    effects: [\r\n      {\r\n        name: `Flaming Weapon`,\r\n        desc: `Casting value of 4. Pick 1 of the caster's melee weapons. Add 1 to Damage characteristic of that weapon until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Levitate`,\r\n    effects: [\r\n      {\r\n        name: `Levitate`,\r\n        desc: `Casting value of 8 and range of 18\". Pick 1 friendly unit wholly within range and visible to the caster. That unit can fly until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Ghost-mist`,\r\n    effects: [\r\n      {\r\n        name: `Ghost-mist`,\r\n        desc: `Casting value of 5 and range of 6\". Pick 1 terrain feature within range and visible to the caster. Until your next hero phase, visibility between 2 models is blocked if a straight line 1mm wide drawn between the closest points of the 2 models passes across more than 3\" of that terrain feature. This effect does not block visibility to or from models with a Wounds characteristic of 10 or more.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n]\r\n\r\nexport default GenericSpells\r\n","import meta_rule_sources from 'meta/rule_sources'\r\nimport { TEntry } from 'types/data'\r\nimport { BATTLESHOCK_PHASE, CHARGE_PHASE, COMBAT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\n// General triumphs available from Core Rules 2021\r\nconst GenericTriumphs: TEntry[] = [\r\n /* {\r\n    name: `Inspired`,\r\n    effects: [\r\n      {\r\n        name: `Inspired`,\r\n        desc: `Once per battle, after you pick a friendly unit to shoot or fight, you can say that it is inspired. If you do so, add 1 to wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Bloodthirsty`,\r\n    effects: [\r\n      {\r\n        name: `Bloodthirsty`,\r\n        desc: `Once per battle, after you make a charge roll for a friendly unit, you can say that it is bloodthirsty. If you do so, you can reroll that charge roll.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Indomitable`,\r\n    effects: [\r\n      {\r\n        name: `Indomitable`,\r\n        desc: `Once per battle, after you take a battleshock test for a friendly unit, you can say it is indomitable. If you do so, no models from that unit will flee in that battleshock phase.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n        rule_sources: [meta_rule_sources.CORE_RULES_2021],\r\n      },\r\n    ],\r\n  }, */\r\n]\r\n\r\nexport default GenericTriumphs\r\n","// Manifestations go here\r\nimport { TEntry } from 'types/data'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, END_OF_TURN, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst GenericManifestations: TEntry[] = [\r\n  // Core Manifestations\r\n  {\r\n    name: `Forbidden Power`,\r\n    effects: [\r\n      {\r\n        name: `Summon Shards of Valagharr: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Shards of Valagharr endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Shards of Valagharr endless spell wholly within 18\" of the caster and visible to them. A Shards of Valagharr endless spell has 2 parts that must be set up within 9\" of each other.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shards of Valagharr - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and both its parts are removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Shards of Valagharr - PHantasmal Translocation`,\r\n        desc: `Effect: Pick a part of this Manifestation, remove it from the battlefield and set it up again on the battlefield wholly within 9\" of the other part.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Shards of Valagharr - Ensnaring Soul-Drain - Passive`,\r\n        desc: `Effect: Each time an enemy unit uses a Move ability while it is within 6\" of any parts of this Manifestation, the effects of the Fly ability do not apply to that unit. Enemy units cannot be set up within 6\" of either part of this Manifestation.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Lauchon the Soulseeker: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Lauchon the Soulseeker on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Lauchon the Soulseeker wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lauchon the Soulseeker - Traverse the Tides of Death`,\r\n        desc: `Declare: Pick a friendly Infantry Wizard Hero within 3\" of this Manifestation to be the target. \r\n        Effect: This Manifestation can move a distance up to its Move characteristic. It can pass through models during that move. Then, remove the target from the battlefield and set them up again on the battlefield within 3\" of this Manifestation and not in combat. Then, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Horrorghast: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Horrorghast on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Horrorghast wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Horrorghast - Harbinger of Horror`,\r\n        desc: `Declare: Pick an enemy unit that was targeted by this Manifestations shooting attacks this phase to be the target. \r\n        Effect: Roll a dice. If the roll is less than the number of models in the target unit that were slain this phase, the target cannot use commands for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Soulscream Bridge: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Soulscream Bridge on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Soulscream Bridge wholly within 18\" of the caster and visible to them. A Soulscream Bridge has 2 parts that must be set up within 9\" of each other.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Soulscream Bridge - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and both its parts are removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Soulscream Bridge - Deathly Passage`,\r\n        desc: `Declare: Pick a friendly unit wholly within 6\" of one part of this Manifestation to be the target. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield wholly within 6\" of the other part of this Manifestation and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Aetherwrought Mercinaries`,\r\n    effects: [\r\n      {\r\n        name: `Summon Chronomantic Cogs: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Chronomantic Cogs endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Chronomantic Cogs endless spell wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Chronomantic Cogs - Mechanisms of Time - Once Per Turn`,\r\n        desc: `Effect: If there are any friendly Wizards within 3\" of this Manifestation, pick 1 of the following effects: \r\n        Increase Time Flow: Until the start of your next turn, you can re-roll charge rolls for friendly units while they are wholly within 12\" of this Manifestation. \r\n        Decrease Time Flow: Until the start of your next turn, subtract 1 from hit rolls for attacks that target friendly Wizards while they are wholly within 12\" of this Manifestation.`,\r\n        when: [HERO_PHASE, SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Quicksilver Swords: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Quicksilver Swords endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Quicksilver Swords endless spell wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Quicksilver Swords - Dancing Blades - Passive`,\r\n        desc: `Effect: Ward rolls cannot be made for damage points inflicted by this Manifestations attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Aethervoid Pendulum: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Aethervoid Pendulum on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up an Aethervoid Pendulum wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Aethervoid Pendulum - The Pendulum Swings - Passive`,\r\n        desc: `Effect: This Manifestation cannot use Charge or Fight abilities. In addition, when this Manifestation moves, it must move in a straight line either in the direction in which the tip of the pendulum blade is pointing or in the opposite direction to the direction in which the tip of the pendulum blade is pointing.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Aethervoid Pendulum - Scything Blade`,\r\n        desc: `Effect: This Manifestation can move a distance up to its Move characteristic. It can pass through models during that move. Then, pick up to 3 enemy units that this Manifestation passed across during that move to be the targets. Roll a D6 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Primal Energy`,\r\n    effects: [\r\n      {\r\n        name: `Summon Burning Head: Casting value of 5`,\r\n        desc: `Declare: If there is not a friendly The Burning Head on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up The Burning Head wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Head - Burning Up - Passive`,\r\n        desc: `Effect: Each time this Manifestation uses a Shoot ability, after that ability has been resolved, allocate 1 damage point to this Manifestation (ward rolls cannot be made for that damage point).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Emerald Lifeswarm: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Emerald Lifeswarm on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up an Emerald Lifeswarm wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Emerald Lifeswarm - Restored Vigour`,\r\n        desc: `Effect: Heal (3) this Manifestation.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Emerald Lifeswarm - Bounteous Healing`,\r\n        desc: `Declare: Pick a friendly unit within 3\" of this Manifestation to be the target. \r\n        Effect: Heal (3) the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Ravenak's Gnashing Jaws: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Ravenaks Gnashing Jaws endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Ravenaks Gnashing Jaws endless spell wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ravenak's Gnashing Jaws - Ravening Hunger`,\r\n        desc: `Declare: If this Manifestation charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll 10 dice. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Ravenak's Gnashing Jaws - Wild Form - Passive`,\r\n        desc: `Effect: Each time this Manifestation is targeted by the Banish Manifestation ability, if it would be banished, it is not banished. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Twilit Sorceries`,\r\n    effects: [\r\n      {\r\n        name: `Summon Umbral Spellportal: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Umbral Spellportal on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up an Umbral Spellportal wholly within 18\" of the caster and visible to them. An Umbral Spellportal has 2 parts that must be set up within 9\" of each other.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Umbral Spellportal - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and both its parts are removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Umbral Spellportal - Arcane Passage`,\r\n        desc: `Declare: Pick a friendly Wizard within 3\" of this Manifestation to be the target. \r\n        Effect: The next time the target uses a non-Summon Spell ability this phase, add 1 to the casting value of that spell. When picking targets for that spell, you can measure range and visibility from either part of this Manifestation instead of from the caster, and your opponent can measure range and visibility to either part of this Manifestation instead of to the caster for the purposes of the Unbind ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Geminids of Uhl-Gysh: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Geminids of UhlGysh endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Geminids of Uhl-Gysh endless spell wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Geminids of Uhl-Gysh - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and both its parts are removed from play. \r\n        Each time this Manifestation moves, both its parts must end within 9\" of each other. \r\n        Each part of this Manifestation is armed with Tendrils of Light and Shadow.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Geminids of Uhl-Gysh - Tendrils of Shadow and Light - Passive`,\r\n        desc: `Effect: Enemy units cannot use commands while they are within 3\" of either part of this Manifestation.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Primsmatic Palisade: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Prismatic Palisade on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Prismatic Palisade wholly within 18\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Primsmatic Palisade - Blinding Light - Passive`,\r\n        desc: `Effect: This Manifestation cannot be targeted by shooting attacks. In addition, a unit cannot be targeted by shooting attacks if it is impossible to draw a straight line from a model in the attacking unit to a model in the target unit without that line passing across this Manifestation.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Morbid Conjuration`,\r\n    effects: [\r\n      {\r\n        name: `Summon Purple Sun of Shyish: Casting value of 8`,\r\n        desc: `Declare: If there is not a friendly Purple Sun of Shyish on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Purple Sun of Shyish wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Purple Sun of Shyish - End Given Form`,\r\n        desc: `Effect: This Manifestation can move a distance up to its Move characteristic. It can pass through models during that move. Then, pick up to 3 enemy units that this Manifestation passed across during that move to be the targets. Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Purple Sun of Shyish - Pull of the Nadir - Passive`,\r\n        desc: `Effect: Subtract 1 from save rolls for enemy units while they are within 3\" of this Manifestation.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Purple Sun of Shyish - Wild Form - Passive`,\r\n        desc: `Effect: Each time this Manifestation is targeted by the Banish Manifestation ability, if it would be banished, it is not banished. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Suffocating Gravetide: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Suffocating Gravetide on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Suffocating Gravetide wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Suffocating Gravetide - Pulled to the Grave`,\r\n        desc: `Effect: This Manifestation can move a distance up to its Move characteristic. It can pass through models during that move. Then, you can pick an enemy unit that this Manifestation passed across during that move to be the target. Roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Malevolent Maelstrom: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Malevolent Maelstrom on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Malevolent Maelstrom wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Malevolent Maelstrom - Necrotic Vortex - Passive`,\r\n        desc: `Effect: Give this Manifestation 1 maelstrom point:  Each time this Manifestation is set up.  Each time a unit successfully casts a spell while it is within 12\" of this Manifestation.  Each time a model is slain within 12\" of this Manifestation. This Manifestation can have a maximum of 6 maelstrom points at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Malevolent Maelstrom - Morbid Detonation`,\r\n        desc: `Declare: If this Manifestation has 6 maelstrom points, pick each unit (friendly and enemy) within 9\" of it to be the targets. \r\n        Effect: Roll a dice for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Then, this Manifestation is destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Soulsnare Shackles: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Soulsnare Shackles endless spell on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Soulsnare Shackles endless spell wholly within 18\" of the caster and visible to them. A Soulsnare Shackles endless spell has 3 parts that must each be set up within 3\" of at least 1 other part.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Soulsnare Shackles - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and all its parts are removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Soulsnare Shackles - Bound for the Great Oubliette`,\r\n        desc: `Declare: For each part of this Manifestation, you can pick an enemy unit within 3\" of that part to be the targets. You cannot pick the same unit to be the target of this ability more than once per turn. \r\n        Effect: Roll a D3 for each target. On a 2+:  Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Subtract a number of inches equal to the roll from the targets Move characteristic for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Krondspine Incarnate of Ghur`,\r\n    effects: [\r\n      {\r\n        name: `Summon Krondspine Incarnate of Ghur: Casting value of 8`,\r\n        desc: `Declare: If there is not a friendly Krondspine Incarnate of Ghur on the battlefield, pick a friendly Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Krondspine Incarnate of Ghur wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Krondspine Incarnate of Ghur - Devourer of Magics`,\r\n        desc: `Effect: If this Manifestation destroyed any enemy Manifestations this turn, Heal (6) this Manifestation.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Krondspine Incarnate of Ghur - Wild Form - Passive`,\r\n        desc: `Effect: Each time this Manifestation is targeted by the Banish Manifestation ability, if it would be banished, it is not banished. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Krondspine Incarnate of Ghur - Arcane Predator - Passive`,\r\n        desc: `Effect: You can add 1 to the number of dice rolled when making charge rolls for this Manifestation, to a maximum of 3, while it is within 18\" of any enemy Manifestations, but if you do so, it must end the charge move within 1/2\" of an enemy Manifestation.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Daughters of Khaine`,\r\n    effects: [\r\n      {\r\n        name: `Summon Bladewind: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Bladewind on the battlefield, pick a friendly Daughters of Khaine Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Bladewind wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bladewind - Unnatural Edge`,\r\n        desc: `Declare: If this Manifestation charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 3+, ignore positive modifiers to save rolls for the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Bloodwrack Viper: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Bloodwrack Viper on the battlefield, pick a friendly Daughters of Khaine Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Bloodwrack Viper wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodwrack Viper - Crushing Coils - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry Hero in combat with this Manifestation to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Heart of Fury: Chant value of 5`,\r\n        desc: `Declare: If there is not a friendly Heart of Fury on the battlefield, pick a friendly Daughters of Khaine Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Heart of Fury wholly within 9\" of the chanter and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heart of Fury - Locus of the Murder God - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for combat attacks that target friendly Daughters of Khaine Infantry units while they are wholly within 12\" of this Manifestation.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Fyreslayers`,\r\n    effects: [\r\n      {\r\n        name: `Summon Runic Fyrewall: Chant value of 4`,\r\n        desc: `Declare: If there is not a friendly Runic Fyrewall on the battlefield, pick a friendly Fyreslayers Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Runic Fyrewall wholly within 12\" of the chanter and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runic Fyrewall - Roaring Rune-Fire - Enemy Movement Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 6\" of this Manifestation to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+:  Inflict an amount of mortal damage on the target equal to the roll.  Subtract 3 from the targets control score for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Molten Infernoth: Chant value of 6`,\r\n        desc: `Declare: If there is not a friendly Molten Infernoth on the battlefield, pick a friendly Fyreslayers Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Molten Infernoth wholly within 12\" of the chanter, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Molten Infernoth - Flamescarred`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by this Manifestations attacks to be the target. \r\n        Effect: Subtract 1 from wound rolls for the targets combat attacks until the end of your next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Zharrgron Flame-Spitter: Chant value of 4`,\r\n        desc: `Declare: If there is not a friendly Zharrgron Flame-spitter on the battlefield, pick a friendly Fyreslayers Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Zharrgron Flame-spitter wholly within 12\" of the chanter and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Zharrgron Flame-Spitter - Magma Blast - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this Manifestations shooting attacks if the target unit has 10 or more models. Add 1 to hit rolls and wound rolls instead if the target unit has 15 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Lumineth Realmlords`,\r\n    effects: [\r\n      {\r\n        name: `Summon Sanctum of Amyntok: Casting value of 4`,\r\n        desc: `Declare: If there is not a friendly Sanctum of Amyntok on the battlefield, pick a friendly Lumineth Realm-lords Wizard to cast this spell, pick a visible friendly Lumineth Realm-lords Infantry Hero wholly within 12\" of them and more than 3\" from all other units and terrain features to be the target, then make a casting roll of 2D6. \r\n        Effect: Set up a Sanctum of Amyntok within the targets combat range, visible to the caster and not in combat. A Sanctum of Amyntok has 3 parts that must be set up touching each other so that they form a ring with the target inside`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sanctum of Amyntok - Sigil of Yngra - Passive`,\r\n        desc: `Effect: While the unit that was picked to be the target of the Summon Sanctum of Amyntok ability is inside the ring formed by this Manifestation:  \r\n        That unit has Ward (4+).  \r\n        If that unit is a Wizard, add 1 to that units power level.  \r\n        Instead of measuring range or visibility to that unit, measure to this Manifestation instead.  \r\n        This Manifestation cannot be picked to be the target of abilities other than Banish abilities.  \r\n        If that unit uses a Move ability, makes a pile-in move or is removed from the battlefield, this Manifestation is removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Hyshian Twinstones: Casting value of 5`,\r\n        desc: `Declare: If there is not a friendly Hyshian Twinstones endless spell on the battlefield, pick a friendly Lumineth Realm-lords Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Hyshian Twinstones endless spell wholly within 6\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hyshian Twinstones - Reservoir of Power - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Lumineth Realm-lords units while they are wholly within 6\" of this Manifestation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Rune of Petrification: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Rune of Petrication on the battlefield, pick a friendly Lumineth Realm-lords Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Rune of Petrication wholly within 18\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Petrification - Turn to Stone`,\r\n        desc: `Declare: Pick each enemy unit within 6\" of this Manifestation to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If a target has 3 mortal damage inflicted on it by this ability, it has Strike-last for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Hedonites of Slaanesh`,\r\n    effects: [\r\n      {\r\n        name: `Summon Mesmerising Mirror: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Mesmerising Mirror on the battlefield, pick a friendly Hedonites of Slaanesh Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Mesmerising Mirror wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mesmerising Mirror - Irresistible Lure - Reaction: Opponent declared a Move ability for a unit wholly within 12\" of this Manifestation`,\r\n        desc: `Effect: If that enemy unit does not end the move closer to this Manifestation than it was at the start of the move, inflict D3 mortal damage on it aer the Move ability has been resolved.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mesmerising Mirror - Gaze Not Into It's Depths`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this Manifestation to be the target. \r\n        Effect: Inflict D3 mortal damage on the target. Then, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Wheels of Excruciation: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Wheels of Excruciation endless spell on the battlefield, pick a friendly Hedonites of Slaanesh Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Wheels of Excruciation endless spell wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wheels of Excruciation - Exquisite Agony`,\r\n        desc: `Declare: Pick up to 3 enemy units that this Manifestation passed across this turn to be the targets. \r\n        Effect: Roll 6 dice for each target. For each roll that is less than the targets Save characteristic, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Dreadful Visage: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Dreadful Visage on the battlefield, pick a friendly Hedonites of Slaanesh Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Dreadful Visage wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadful Visage - Flensing Tongues`,\r\n        desc: `Declare: Pick an enemy unit in combat with this Manifestation to be the target. \r\n        Effect: Roll 6 dice. For each 4+, inflict 1 mortal damage on the target. If any models are slain by this ability, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Stormcast Eternals`,\r\n    effects: [\r\n      {\r\n        name: `Summon Dais Arcanum: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Dais Arcanum on the battlefield, pick a friendly Stormcast Eternals Wizard to cast this spell, pick a friendly Stormcast Eternals Infantry Hero that does not have Fly and is wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Set up a Dais Arcanum within \" of the target, visible to the caster and not in combat. Then, remove the target from the battlefield and place it on the platform of that Dais Arcanum.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dais Arcanum - Arcane Enhancement - Passive`,\r\n        desc: `Effect: While the unit that was picked to be the target of the Summon Dais Arcanum ability is on the platform of this Manifestation:  \r\n        That unit has Ward (5+).  \r\n        If that unit is a Wizard, add 1 to that units power level.  \r\n        That unit cannot use Move abilities and remains on this Manifestation each time it moves.  \r\n        Instead of measuring range or visibility to that unit, measure to this Manifestation instead.  \r\n        This Manifestation cannot be picked to be the target of abilities other than Banish abilities. \r\n        If this Manifestation is banished, before removing it from the battlefield, set up the unit on its platform on the battlefield within 3\" of it. That unit can only be set up in combat with units it was already in combat with when this Manifestation was banished. If it is not possible to set up that unit, it is destroyed. \r\n        If the unit on the platform is destroyed, immediately remove this Manifestation from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Celestian Vortex: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Celestian Vortex on the battlefield, pick a friendly Stormcast Eternals Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Celestian Vortex wholly within 18\" of the caster and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Celestian Vortex - Tornado of Magic - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks made by enemy units while they are within 12\" of this Manifestation.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Everblaze Comet: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Everblaze Comet on the battlefield, pick a friendly Stormcast Eternals Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up an Everblaze Comet wholly within 18\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Everblaze Comet - Burning Vengeance`,\r\n        desc: `Declare: If this Manifestation was summoned this phase, pick any number of enemy units within 6\" of it to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Everblaze Comet - Arcane Disruption - Passive`,\r\n        desc: `Effect: Subtract 1 from casting rolls for enemy Wizards while they are within 12\" of this Manifestation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Sylvaneth`,\r\n    effects: [\r\n      {\r\n        name: `Summon Spiteswarm Hive: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Spiteswarm Hive on the battlefield, pick a friendly Sylvaneth Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Spiteswarm Hive wholly within 9\" of the caster, visible to them and more than 3\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spiteswarm Hive - The Hive Nourishes`,\r\n        desc: `Declare: Pick a visible friendly Sylvaneth unit within 3\" of this Manifestation to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply to the target for the rest of the turn: \r\n        Vital Venoms: Add 1 to run rolls and charge rolls for the target. \r\n        Shielding Swarm: The target has Ward (6+).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Gladewyrm: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Gladewyrm on the battlefield, pick a friendly Sylvaneth Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Gladewyrm wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Gladewyrm - Burrow Below`,\r\n        desc: `Effect: If this Manifestation is not in combat, remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy non-Wizard units and more than 3\" from all enemy Wizards.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gladewyrm - Feed on Eldritch Energy`,\r\n        desc: `Declare: Pick an enemy Wizard in combat with this Manifestation to be the target. \r\n        Effect: Subtract 1 from casting rolls, unbinding rolls and banishment rolls for the target until the end of your next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Vengeful Skullroot: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Vengeful Skullroot on the battlefield, pick a friendly Sylvaneth Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Vengeful Skullroot wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Vengeful Skullroot - Vengeful Terrors`,\r\n        desc: `Declare: Pick an enemy unit within 3\" of this Manifestation to be the target. \r\n        Effect: Subtract an amount from the targets control score equal to the number of friendly units that have been destroyed this battle (not including Manifestations or Faction Terrain).`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Blades of Khorne`,\r\n    effects: [\r\n      {\r\n        name: `Summon Bleeding Icon: Chant value of 4`,\r\n        desc: `Declare: If there is not a friendly Bleeding Icon on the battlefield, pick a friendly Blades of Khorne Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Bleeding Icon wholly within 12\" of the chanter and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bleeding Icon - Sigil of Doom - Reaction: Opponent declared a command for a unit within 8\" of this Manifestation`,\r\n        desc: `Effect: Roll 2D6. On an 8+, that command has no effect, it still counts as having been used and the command points spent to use it are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Wrath-Axe: Chant value of 4`,\r\n        desc: `Declare: If there is not a friendly Wrath-axe on the battlefield, pick a friendly Blades of Khorne Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Wrath-axe wholly within 12\" of the chanter, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wrath-Axe - Hatred's Edge`,\r\n        desc: `Declare: Pick up to 3 enemy units that this Manifestation passed across this turn to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Hexgorger Skulls: Chant value of 4`,\r\n        desc: `Declare: If there is not a friendly Hexgorger Skulls invocation on the battlefield, pick a friendly Blades of Khorne Priest to chant this prayer, then make a chanting roll of D6. \r\n        Effect: Set up a Hexgorger Skulls invocation wholly within 12\" of the chanter, visible to them and more than 9\" from all enemy units. A Hexgorger Skulls invocation has 2 parts that must be set up within 8\" of each other.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hexgorger Skulls - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and both its parts are removed from play. \r\n        Each time this Manifestation moves, both its parts must end within 8\" of each other. \r\n        Each part of this Manifestation is armed with a Stream of Molten Blood.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hexgorger Skulls - Hexgorgers - Passive`,\r\n        desc: `Effect: For each part of this Manifestation that is within 8\" of a Wizard (friendly or enemy), subtract 1 from casting rolls for that Wizard.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Disciples of Tzeentch`,\r\n    effects: [\r\n      {\r\n        name: `Summon Tome of Eyes: Casting value of 5`,\r\n        desc: `Declare: If there is not a friendly Tome of Eyes on the battlefield, pick a friendly Disciples of Tzeentch Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Tome of Eyes wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Tome of Eyes - Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Burning Sigil of Tzeentch: Casting value of 5`,\r\n        desc: `Declare: If there is not a friendly Burning Sigil of Tzeentch on the battlefield, pick a friendly Disciples of Tzeentch Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Burning Sigil of Tzeentch wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Burning SIgil of Tzeentch - Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Daemonic Simulacrum: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Daemonic Simulacrum on the battlefield, pick a friendly Disciples of Tzeentch Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Daemonic Simulacrum wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Daemonic Simulacrum - Manifested Jaws - Passive`,\r\n        desc: `Effect: While this Manifestations attacks target a Wizard, add a number equal to that Wizards power level to the Damage characteristic of this units Snapping Jaws.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Skaven`,\r\n    effects: [\r\n      {\r\n        name: `Summon Warp Lightning Vortex: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Warp Lightning Vortex on the battlefield, pick a friendly Skaven Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up the first part of the Warp Lightning Vortex within 18\" of the caster and visible to them, then set up the second and third parts exactly 7\" from the first part and exactly 7\" from each other so that they form a triangle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warp Lightning Vortex - Multiple Parts - Passive`,\r\n        desc: `Effect: When a number of damage points equal to this Manifestations Health characteristic are allocated to it, this Manifestation is destroyed and all its parts are removed from play.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Warp Lightning Vortex - Warp Lightning Bolts`,\r\n        desc: `Declare: If this Manifestation was not set up this turn, pick each enemy unit within 6\" of this Manifestation to be the targets. \r\n        Effect: Roll a dice for each target. On a 4+, inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warp Lightning Vortex - Warp Vortex - Passive`,\r\n        desc: `Effect: Subtract 2 from run rolls and charge rolls for enemy units while they are within 6\" of this Manifestation. In addition, if an enemy unit passes across this Manifestation, inflict D3 mortal damage on that enemy unit after the Move ability has been resolved.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Vermintide: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Vermintide on the battlefield, pick a friendly Skaven Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Vermintide wholly within 13\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Vermintide - More-More Rats`,\r\n        desc: `Effect: Heal (D6) this Manifestation.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Bell of Doom: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Bell of Doom on the battlefield, pick a friendly Skaven Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Bell of Doom wholly within 13\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bell of Doom - Toll of Doom - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for attacks that target friendly Skaven Infantry units while they are wholly within 13\" of this Manifestation.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Slaves to Darkness`,\r\n    effects: [\r\n      {\r\n        name: `Summon Darkfire Daemonrift: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Darkre Daemonrift on the battlefield, pick a friendly Slaves to Darkness Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Darkre Daemonrift wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Darkfire Daemonrift - Fuelled by Sorcery - Passive`,\r\n        desc: `Effect: Each time a spell is successfully cast by a unit within 12\" of this Manifestation, give this Manifestation 1 ruinous energy point, to a maximum of 6. \r\n        Each time this Manifestation uses a Shoot ability, add 1 to the Attacks characteristic of its Darkre Torrent for each ruinous energy point it has. \r\n        If this Manifestation is removed from play, all of its ruinous energy points are lost.`,\r\n        when: [HERO_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Eightfold Doom-Sigil: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Eightfold Doom-Sigil on the battlefield, pick a friendly Slaves to Darkness Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up an Eightfold Doom-Sigil wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Eightfold Doom-Sigil - Empowered by Atrocity - Passive`,\r\n        desc: `Effect: If 2 or more units (friendly or enemy) were destroyed this turn, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Slaves to Darkness units while they are wholly within 12\" of this Manifestation.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Realmscourge Rupture: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Realmscourge Rupture on the battlefield, pick a friendly Slaves to Darkness Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Realmscourge Rupture wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Realmscourge Rupture - Debilitating Shockwave`,\r\n        desc: `Declare: If this Manifestation charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target. If any models in the target unit are slain by this ability, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Flesh-Eater Courts`,\r\n    effects: [\r\n      {\r\n        name: `Summon Chalice of Ushoran: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Chalice of Ushoran on the battlefield, pick a friendly Flesh-eater Courts Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Chalice of Ushoran wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Chalice of Ushoran - Fill the Chalice - Passive`,\r\n        desc: `Effect: Each time a model (friendly or enemy) is slain within 12\" of this Manifestation, give this Manifestation a blood point, to a maximum of 6.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Chalice of Ushoran - Overflowing Gore`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts unit wholly within 18\" of this Manifestation to be the target. \r\n        Effect: Add the number of blood points this Manifestation has to the targets control score for the rest of the turn. Then, reset this Manifestations blood points to 0.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Cadaverous Barricade: Casting value of 5`,\r\n        desc: `Declare: If there is not a friendly Cadaverous Barricade on the battlefield, pick a friendly Flesh-eater Courts Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Cadaverous Barricade wholly within 18\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cadaverous Barricade - Grasping Hands - Passive`,\r\n        desc: `Effect: Enemy units cannot use Run or Retreat abilities while they are within this Manifestations combat range. \r\n        In addition, if an enemy unit is picked to use a Move ability while it is within this Manifestations combat range, halve that units Move characteristic (rounding up) for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Corpsemare Stampede: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Corpsemare Stampede on the battlefield, pick a friendly Flesh-eater Courts Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Corpsemare Stampede wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Corpsemare Stampede - Trampled Underfoot`,\r\n        desc: `Effect: This Manifestation can move a distance up to its Move characteristic. This Manifestation can pass through models and the combat ranges of enemy units, but it cannot end that move in combat. \r\n        Then, pick up to 3 enemy units that this Manifestation passed across during that move to be the targets. Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Nighthaunt`,\r\n    effects: [\r\n      {\r\n        name: `Summon Mortalis Terminexus: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Mortalis Terminexus on the battlefield, pick a friendly Nighthaunt Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Mortalis Terminexus wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortalis Terminexus - Keeper of Mortality`,\r\n        desc: `Declare: Pick a visible friendly Nighthaunt unit within 3\" of this Manifestation to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects:  \r\n        Add 1 to run rolls and charge rolls for target for the rest of the turn.  \r\n        Heal (3) the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Shyish Reaper: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Shyish Reaper on the battlefield, pick a friendly Nighthaunt Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Shyish Reaper wholly within 9\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shyish Reaper - Soul Reaper - Passive`,\r\n        desc: `Effect: Add 2 to the Attacks characteristic of this Manifestations Almighty Reap if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Vault of Souls: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Vault of Souls on the battlefield, pick a friendly Nighthaunt Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Vault of Souls wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Vault of Souls - Siphon Souls - Passive`,\r\n        desc: `Effect: Each time a model (friendly or enemy) is slain within 12\" of this Manifestation, give this Manifestation a soul point, to a maximum of 6.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Vault of Souls - Soul Eruption`,\r\n        desc: `Declare: If this Manifestation has 6 soul points, pick any number of enemy units within 6\" of this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, inflict an amount of mortal damage on the target equal to the roll. Then, reset this Manifestations soul points to 0.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Ossiarch Bonereapers`,\r\n    effects: [\r\n      {\r\n        name: `Summon Soulsteal Carrion: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Soulstealer Carrion on the battlefield, pick a friendly Ossiarch Bonereapers Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Soulstealer Carrion wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Soulsteal Carrion - Aviarch Sentry - Passive`,\r\n        desc: `Effect: Subtract 5 from the control scores of enemy Infantry units while they are within 6\" of this Manifestation.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Nightmare Predator: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Nightmare Predator on the battlefield, pick a friendly Ossiarch Bonereapers Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Nightmare Predator wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Nightmare Predator - Death Incarnate`,\r\n        desc: `Effect: If this Manifestation was destroyed or banished this turn and the unit that summoned it is on the battlefield, roll a dice. On a 4+, set up this Manifestation again, wholly within 12\" of the unit that summoned it and more than 9\" from all enemy units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Summon Bone-Tithe Shrieker: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Bone-tithe Shrieker on the battlefield, pick a friendly Ossiarch Bonereapers Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Bone-tithe Shrieker wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bone-Tithe Shrieker - No Escape - Passive`,\r\n        desc: `Effect: Subtract 1 from ward rolls for enemy units while they are within 12\" of this Manifestation.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: `Gloomspite Gitz`,\r\n    effects: [\r\n      {\r\n        name: `Summon Scuttletide: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Scuttletide on the battlefield, pick a friendly Gloomspite Gitz Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Scuttletide wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scuttletide - Wall Crawler - Passive`,\r\n        desc: `Effect: This Manifestation can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Scuttletide - Endless Terrors - Passive`,\r\n        desc: `Effect: This unit has Ward (4+) while it is wholly within 12\" of any friendly Arachnarok units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Mork's Mighty Mushroom: Casting value of 6`,\r\n        desc: `Declare: If there is not a friendly Morks Mighty Mushroom on the battlefield, pick a friendly Gloomspite Gitz Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Morks Mighty Mushroom wholly within 12\" of the caster and visible to them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mork's Mighty Mushroom - Mutating Spores`,\r\n        desc: `Declare: Pick up to 3 enemy units within 6\" of this Manifestation to be the targets. \r\n        Effect: For each target, roll a number of dice equal to the number of models in that unit that are within 6\" of this Manifestation. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Malevolent Moon: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Malevolent Moon on the battlefield, pick a friendly Gloomspite Gitz Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Malevolent Moon wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Malevolent Moon - Lurid Light - Passive`,\r\n        desc: `Effect: Friendly Gloomspite Gitz units are under the light of the Bad Moon while they are wholly within 12\" of this Manifestation.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Scrapskuttle's Arachnacauldron: Casting value of 7`,\r\n        desc: `Declare: If there is not a friendly Scrapskuttles Arachnacauldron on the battlefield, pick a friendly Gloomspite Gitz Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set up a Scrapskuttles Arachnacauldron wholly within 12\" of the caster, visible to them and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scrapskuttle's Arachnacauldron - Blessings of the Cauldron`,\r\n        desc: `Declare: Pick a friendly Gloomspite Gitz Wizard within 1\" of this Manifestation to be the target. \r\n        Effect: Add 1 to the targets power level until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n]\r\n\r\nexport default GenericManifestations","import { PreferenceApi } from 'api/preferenceApi'\r\nimport {\r\n  armyActions,\r\n  factionNamesActions,\r\n  notesActions,\r\n  realmscapeActions,\r\n  selectionActions,\r\n  visibilityActions,\r\n} from 'ducks'\r\nimport { store } from 'store'\r\nimport { IArmy } from 'types/army'\r\nimport { TLoadedArmy } from 'types/import'\r\nimport { ILinkedArmy, ISavedArmyFromApi } from 'types/savedArmy'\r\nimport { logEvent, logLoadedArmy } from 'utils/analytics'\r\nimport { getArmy } from 'utils/getArmy/getArmy'\r\nimport { LocalReminderOrder } from 'utils/localStore'\r\n\r\nexport const loadArmyFromLink = async (id: string) => {\r\n  try {\r\n    const res = await PreferenceApi.getLinkedArmy(id)\r\n    const linkedArmy = res.body as ILinkedArmy\r\n\r\n    if (!linkedArmy) return\r\n\r\n    addArmyToStore(linkedArmy)\r\n\r\n    logEvent(`LoadArmyLink-${id}`)\r\n    logEvent(`LoadArmyFromLink-${linkedArmy.factionName}`)\r\n  } catch (err) {\r\n    console.error(err)\r\n  }\r\n}\r\n\r\nexport const addArmyToStore = (loadedArmy: TLoadedArmy) => {\r\n  try {\r\n    const { dispatch } = store\r\n\r\n    dispatch(factionNamesActions.setFactionName(loadedArmy.factionName))\r\n    dispatch(factionNamesActions.setSubFactionName(loadedArmy.subFactionName))\r\n\r\n    // Add Ally Game data to the store\r\n    if (loadedArmy.allyFactionNames.length) {\r\n      const armies = loadedArmy.allyFactionNames.map(factionName => {\r\n        const Army = getArmy(factionName) as IArmy\r\n        return { factionName, Army }\r\n      })\r\n      dispatch(armyActions.updateAllyArmies(armies))\r\n    }\r\n\r\n    // Add our unit selections to the store\r\n    dispatch(selectionActions.setSelections(loadedArmy.selections))\r\n\r\n    // Add our allied unit selections to the store\r\n    dispatch(selectionActions.setAllySelections(loadedArmy.allySelections))\r\n\r\n    // Add Realm info to the store\r\n    dispatch(realmscapeActions.setOriginRealm(loadedArmy.origin_realm || null))\r\n    dispatch(realmscapeActions.setRealmscape(loadedArmy.realmscape || null))\r\n    dispatch(realmscapeActions.setRealmscapeFeature(loadedArmy.realmscape_feature || null))\r\n\r\n    // Hide any reminders necessary\r\n    if (loadedArmy.hiddenReminders) {\r\n      dispatch(visibilityActions.clearReminders())\r\n      dispatch(visibilityActions.addReminders(loadedArmy.hiddenReminders))\r\n    }\r\n\r\n    loadedArmy = loadedArmy as ISavedArmyFromApi\r\n\r\n    // Add notes if necessary\r\n    if (loadedArmy.notes) {\r\n      dispatch(notesActions.setNotes(loadedArmy.notes))\r\n    }\r\n\r\n    // Re-organize reminder ordering if needed\r\n    if ((loadedArmy as ISavedArmyFromApi).orderedReminders && (loadedArmy as ISavedArmyFromApi).id) {\r\n      LocalReminderOrder.setById(loadedArmy.id, loadedArmy.orderedReminders)\r\n      LocalReminderOrder.makeIdActive(loadedArmy.id)\r\n    }\r\n\r\n    // Log our army to GA\r\n    logLoadedArmy(loadedArmy)\r\n  } catch (err) {\r\n    console.error(err)\r\n  }\r\n}\r\n","/**\r\n * There is a special built-in environment variable called NODE_ENV.\r\n *\r\n * When you run `yarn start`, it is always equal to 'development',\r\n * when you run `yarn test` it is always equal to 'test',\r\n * and when you run `yarn build` to make a production bundle,\r\n * it is always equal to 'production'.\r\n *\r\n * You cannot override NODE_ENV manually.\r\n */\r\nexport const isDev = process.env.NODE_ENV === 'development'\r\nexport const isTest = process.env.NODE_ENV === 'test'\r\nexport const isProd = process.env.NODE_ENV === 'production'\r\n\r\nexport const STRIPE_KEY = isProd\r\n  ? 'pk_live_wFgX8L9sjPz6S9eLxfd4c0sR00beXWRLyZ'\r\n  : 'pk_test_ZqzFFxNXK1SD7PANrrk6cVmE00SokPm82b'\r\n\r\nexport const PAYPAL_CLIENT_ID = isProd\r\n  ? 'AfLnIE4o2jXPWtGItGIxptUDHTHfWIJS53doOYvAM2Y3-04croyYfZPxT_JR2oRAaavF14oYNtCe7IKw'\r\n  : 'AUdnPSV280IH8pjveo62IzfQJgfFo0MoJ9w-zouTipgjAethtmcvHFjV8DXCCqoti4WHdbjhMNnwn9oa'\r\n\r\nexport const BASE_URL = isProd ? `https://aosreminders.com` : `http://localhost:3000`\r\n\r\nexport const SUBSCRIPTION_AUTH_KEY = 'b5bef450-e624-11e9-81b4-2a2ae2dbcce4'\r\n\r\nexport const GITHUB_URL = '//github.com/daviseford/aos-reminders'\r\n\r\nexport const ROUTES = {\r\n  FAQ: '/faq',\r\n  HOME: '/',\r\n  JOIN: '/join',\r\n  PROFILE: '/profile',\r\n  REDEEM: '/redeem',\r\n  STATS: '/stats',\r\n  SUBSCRIBE: '/subscribe',\r\n  GOODBYE: '/goodbye',\r\n}\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { IArmy } from 'types/army'\r\nimport { getArmy } from 'utils/getArmy/getArmy'\r\n\r\nconst army = createSlice({\r\n  name: 'army',\r\n  initialState: DefaultAppState.army,\r\n  reducers: {\r\n    deleteAllyArmy: (state, action: PayloadAction<TSupportedFaction>) => {\r\n      delete state.allyArmies[action.payload]\r\n    },\r\n    resetAllArmies: () => DefaultAppState.army,\r\n    resetAllyArmies: state => {\r\n      state.allyArmies = DefaultAppState.army.allyArmies\r\n    },\r\n    resetArmy: state => {\r\n      state.army = DefaultAppState.army.army\r\n    },\r\n    switchAllyArmy: (state, action: PayloadAction<{ next: TSupportedFaction; prev: TSupportedFaction }>) => {\r\n      const { next, prev } = action.payload\r\n      delete state.allyArmies[prev]\r\n      const nextAllyArmy = getArmy(next)\r\n      if (nextAllyArmy) state.allyArmies[next] = nextAllyArmy\r\n    },\r\n    updateAllyArmy: (state, action: PayloadAction<{ factionName: TSupportedFaction; Army: IArmy }>) => {\r\n      const { factionName, Army } = action.payload\r\n      state.allyArmies[factionName] = Army\r\n    },\r\n    updateAllyArmies: (state, action: PayloadAction<{ factionName: TSupportedFaction; Army: IArmy }[]>) => {\r\n      action.payload.forEach(update => {\r\n        const { factionName, Army } = update\r\n        state.allyArmies[factionName] = Army\r\n      })\r\n    },\r\n    updateArmy: (state, action: PayloadAction<IArmy>) => {\r\n      state.army = action.payload\r\n    },\r\n  },\r\n})\r\n\r\nexport const armyActions = army.actions\r\nexport default army.reducer\r\n","export enum RealmscapesEnum {\r\n  // GALLET = 'Gallet',\r\n  // GHUR = 'Ghur',\r\n  ANDTOR = 'Season 24',\r\n}\r\n\r\nexport const SUPPORTED_REALMSCAPES: RealmscapesEnum[] = [\r\n  // RealmscapesEnum.GALLET,\r\n  // RealmscapesEnum.GHUR,\r\n  RealmscapesEnum.ANDTOR,\r\n]\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { IFactionNameStore } from 'types/store'\r\n\r\nconst factionNames = createSlice({\r\n  name: 'factionNames',\r\n  initialState: DefaultAppState.factionNames,\r\n  reducers: {\r\n    setFactionName: (state, action: PayloadAction<IFactionNameStore['factionName']>) => {\r\n      state.factionName = action.payload\r\n    },\r\n    setSubFactionName: (state, action: PayloadAction<IFactionNameStore['subFactionName']>) => {\r\n      state.subFactionName = action.payload\r\n    },\r\n  },\r\n})\r\n\r\nexport const factionNamesActions = factionNames.actions\r\nexport default factionNames.reducer\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport { uniq } from 'lodash'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { INote } from 'types/notes'\r\n\r\nconst notes = createSlice({\r\n  name: 'notes',\r\n  initialState: DefaultAppState.notes,\r\n  reducers: {\r\n    resetNotes: () => DefaultAppState.notes,\r\n    addNote: (state, action: PayloadAction<INote>) => {\r\n      state.notes = uniq([...state.notes, action.payload])\r\n    },\r\n    addNotes: (state, action: PayloadAction<INote[]>) => {\r\n      state.notes = uniq([...state.notes, ...action.payload])\r\n    },\r\n    setNotes: (state, action: PayloadAction<INote[]>) => {\r\n      state.notes = action.payload\r\n    },\r\n    updateNote: (state, action: PayloadAction<INote>) => {\r\n      const idx = state.notes.findIndex(x => x.id === action.payload.id)\r\n      state.notes[idx] = action.payload\r\n    },\r\n    deleteNote: (state, action: PayloadAction<string>) => {\r\n      state.notes = state.notes.filter(x => x.id !== action.payload)\r\n    },\r\n  },\r\n})\r\n\r\nexport const notesActions = notes.actions\r\nexport default notes.reducer\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { RealmscapesEnum, SUPPORTED_REALMSCAPES } from 'types/realmscapes'\r\n\r\nconst getRealmscapeFromFeature = (feature: string): RealmscapesEnum | null => {\r\n  return SUPPORTED_REALMSCAPES.find(realm => feature.includes(realm)) || null\r\n}\r\n\r\nconst realmscape = createSlice({\r\n  name: 'General\\' Handbook',\r\n  initialState: DefaultAppState.realmscape,\r\n  reducers: {\r\n    resetRealmscapeStore: () => DefaultAppState.realmscape,\r\n\r\n    setOriginRealm: (state, action: PayloadAction<RealmscapesEnum | null>) => {\r\n      state.origin_realm = action.payload\r\n    },\r\n\r\n    setRealmscape: (state, action: PayloadAction<RealmscapesEnum | null>) => {\r\n      const realmscape = action.payload\r\n      let realmscape_feature = state.realmscape_feature\r\n      if (realmscape && realmscape_feature && !realmscape_feature.includes(realmscape)) {\r\n        state.realmscape_feature = null // Reset the realmscape_feature\r\n      }\r\n      state.realmscape = realmscape\r\n    },\r\n\r\n    setRealmscapeFeature: (state, action: PayloadAction<string | null>) => {\r\n      if (!state.realmscape && action.payload) {\r\n        state.realmscape = getRealmscapeFromFeature(action.payload)\r\n      }\r\n      state.realmscape_feature = action.payload\r\n    },\r\n  },\r\n})\r\n\r\nexport const realmscapeActions = realmscape.actions\r\nexport default realmscape.reducer\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport { uniq, without } from 'lodash'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { TSelectionTypes } from 'types/selections'\r\nimport { IStore, TAllySelectionStore } from 'types/store'\r\n\r\ntype TAddToSelectionsAction = {\r\n  payload: {\r\n    value: string // Hermdar Lodge\r\n    values: string[] // ['Tyrant Slayer']\r\n    slice: TSelectionTypes // e.g. artifacts, spells, etc\r\n  }\r\n}\r\n\r\nconst selections = createSlice({\r\n  name: 'selections',\r\n  initialState: DefaultAppState.selections,\r\n  reducers: {\r\n    resetAllSelections: () => DefaultAppState.selections,\r\n    deleteAllySelection: (state, action: PayloadAction<TSupportedFaction>) => {\r\n      delete state.allySelections[action.payload]\r\n    },\r\n    resetAllySelection: (state, action: PayloadAction<TSupportedFaction>) => {\r\n      state.allySelections[action.payload] = { units: [], battalions: [] }\r\n    },\r\n    resetAllySelections: state => {\r\n      state.allySelections = DefaultAppState.selections.allySelections\r\n    },\r\n    resetSelections: state => {\r\n      state.selections = DefaultAppState.selections.selections\r\n    },\r\n    resetSideEffects: state => {\r\n      state.sideEffects = DefaultAppState.selections.sideEffects\r\n    },\r\n    updateAllyUnits: (state, action: PayloadAction<{ factionName: TSupportedFaction; units: string[] }>) => {\r\n      const { factionName, units } = action.payload\r\n      const battalions = state.allySelections[factionName]?.battalions || []\r\n      state.allySelections[factionName] = { battalions, units }\r\n    },\r\n    updateAllyBattalions: (\r\n      state,\r\n      action: PayloadAction<{ factionName: TSupportedFaction; battalions: string[] }>\r\n    ) => {\r\n      const { factionName, battalions } = action.payload\r\n      const units = state.allySelections[factionName]?.units || []\r\n      state.allySelections[factionName] = { battalions, units }\r\n    },\r\n    setAllySelections: (state, action: PayloadAction<TAllySelectionStore>) => {\r\n      state.allySelections = action.payload\r\n    },\r\n    setFlavors: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'flavors')\r\n    },\r\n    setArtifacts: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.artifacts = action.payload\r\n    },\r\n\r\n    /**\r\n     * Non destructive way to add to selections\r\n     * @param state\r\n     * @param action\r\n     */\r\n    addToSelections: (state, action: TAddToSelectionsAction) => {\r\n      const { value, slice, values } = action.payload\r\n      state.selections[slice] = uniq((state.selections[slice] || []).concat(values))\r\n      state.sideEffects[value] = { ...state.sideEffects[value], [slice]: values }\r\n    },\r\n\r\n    setBattalions: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'battalions')\r\n    },\r\n    setBattleTactics: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'battle_tactics')\r\n    },\r\n    setCommandAbilities: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.command_abilities = action.payload\r\n    },\r\n    setCoreRules: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.core_rules = action.payload\r\n    },\r\n    setGrandStrategies: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.grand_strategies = action.payload\r\n    },\r\n    setEndlessSpells: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.endless_spells = action.payload\r\n    },\r\n    setScenery: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.scenery = action.payload\r\n    },\r\n    setSelections: (state, action) => {\r\n      state.selections = action.payload\r\n    },\r\n    setSpells: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.spells = action.payload\r\n    },\r\n    setPrayers: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.prayers = action.payload\r\n    },\r\n    setCommandTraits: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'command_traits')\r\n    },\r\n    setMountTraits: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'mount_traits')\r\n    },\r\n    setMonstrousRampages: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'monstrous_rampages')\r\n    },\r\n    setIncarnates: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'incarnates')\r\n    },\r\n    setTriumphs: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.triumphs = action.payload\r\n    },\r\n    setUnits: (state, action: PayloadAction<string[]>) => {\r\n      handleSideEffects(state, action.payload, 'units')\r\n    },\r\n    setManifestations: (state, action: PayloadAction<string[]>) => {\r\n      state.selections.manifestations = action.payload\r\n    },\r\n\r\n\r\n    /**\r\n     * Given an array of strings, removes those strings from every selection field\r\n     * @param state\r\n     * @param action\r\n     */\r\n    removeSelections: (state, action: PayloadAction<string[]>) => {\r\n      Object.entries(state.selections).forEach(([k, v]) => {\r\n        state.selections[k as TSelectionTypes] = without(v, ...action.payload)\r\n      })\r\n    },\r\n  },\r\n})\r\n\r\nexport const selectionActions = selections.actions\r\nexport default selections.reducer\r\n\r\nconst handleSideEffects = (state: IStore['selections'], payload: string[], type: TSelectionTypes) => {\r\n  const sideEffectNames = Object.keys(state.sideEffects)\r\n\r\n  if (!state.selections?.[type]) {\r\n    console.error(\r\n      `Invalid slice passed to handleSideEffects: ${type}. This usually means that you've committed a typo during data entry.`\r\n    )\r\n    state.selections[type] = [] // assign a default value\r\n  }\r\n\r\n  const removedParentEffects = state.selections[type]\r\n    .reduce((a, v) => {\r\n      if (sideEffectNames.includes(v)) a.push(v)\r\n      return a\r\n    }, [] as string[])\r\n    .filter(e => !payload.includes(e))\r\n\r\n  let removedSideEffects: string[] = []\r\n\r\n  removedParentEffects.forEach(r => {\r\n    const sideEffect = state.sideEffects[r]\r\n    const slices = Object.keys(sideEffect) as TSelectionTypes[]\r\n    slices.forEach(slice => {\r\n      state.selections[slice] = without(state.selections[slice], ...sideEffect[slice])\r\n      removedSideEffects = removedSideEffects.concat(sideEffect[slice]) // Store for later reference\r\n    })\r\n  })\r\n\r\n  // We don't want to re-add side effects that we just removed\r\n  state.selections[type] = payload.filter(x => !removedSideEffects.includes(x))\r\n}\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\nimport { uniq, without } from 'lodash'\r\nimport DefaultAppState from 'store/initialAppState'\r\n\r\nconst visibility = createSlice({\r\n  name: 'visibility',\r\n  initialState: DefaultAppState.visibility,\r\n  reducers: {\r\n    addSelector: (state, action: PayloadAction<string>) => {\r\n      state.selectors = uniq([...state.selectors, action.payload])\r\n    },\r\n    deleteSelector: (state, action: PayloadAction<string>) => {\r\n      state.selectors = without(state.selectors, action.payload)\r\n    },\r\n    addAlly: (state, action: PayloadAction<string>) => {\r\n      state.allies = uniq([...state.allies, action.payload])\r\n    },\r\n    deleteAlly: (state, action: PayloadAction<string>) => {\r\n      state.allies = without(state.allies, action.payload)\r\n    },\r\n    addReminder: (state, action: PayloadAction<string>) => {\r\n      state.reminders = uniq([...state.reminders, action.payload])\r\n    },\r\n    addReminders: (state, action: PayloadAction<string[]>) => {\r\n      state.reminders = uniq([...state.reminders, ...action.payload])\r\n    },\r\n    deleteReminder: (state, action: PayloadAction<string>) => {\r\n      state.reminders = without(state.reminders, action.payload)\r\n    },\r\n    addWhen: (state, action: PayloadAction<string>) => {\r\n      state.when = uniq([...state.when, action.payload])\r\n    },\r\n    addWhens: (state, action: PayloadAction<string[]>) => {\r\n      state.when = uniq([...state.when, ...action.payload])\r\n    },\r\n    deleteWhen: (state, action: PayloadAction<string>) => {\r\n      state.when = without(state.when, action.payload)\r\n    },\r\n    deleteWhens: (state, action: PayloadAction<string[]>) => {\r\n      state.when = without(state.when, ...action.payload)\r\n    },\r\n    clearWhen: state => {\r\n      state.when = DefaultAppState.visibility.when\r\n    },\r\n    clearReminders: state => {\r\n      state.reminders = DefaultAppState.visibility.reminders\r\n    },\r\n  },\r\n})\r\n\r\nexport const visibilityActions = visibility.actions\r\nexport default visibility.reducer\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SETUP,\r\n  START_OF_SHOOTING_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst EmbarkingDeployEffect = {\r\n /* name: `Embarking (Deployment)`,\r\n  desc: `During deployment, instead of setting up a SKYFARER unit on the battlefield, you can say that it is embarked in a friendly TRANSPORT VESSEL that is already on the battlefield.`,\r\n  when: [DURING_SETUP],\r\n  shared: true, */\r\n} \r\nconst EmbarkingEffect = {\r\n/*  name: `Embarking`,\r\n  desc: `In the movement phase, if a friendly SKYFARER unit finishes a move wholly within 3\" of a friendly TRANSPORT VESSEL and both of those units are more than 3\" from all enemy units, you can say that the TRANSPORT VESSEL will embark that SKYFARER unit.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true, */\r\n}\r\nconst EmbarkedEffect = {\r\n  /*name: `Embarked`,\r\n  desc: `Embarked units are still treated as being on the battlefield. Range and visiblity is measured to and from the TRANSPORT VESSEL in which the unit is embarked.\r\n\r\n  For the purposes of visibilty, models in an embarked unit are treated as models that can fly.\r\n\r\n  Embarked units are in cover. In addition, subtract 1 from hit rolls for attackes that target embarked units.\r\n\r\n  Models in an embarked unit cannot contest objectives.\r\n\r\n  Embarked units cannot move. However when a TRASNPORT VESSEL finished any type of move, all units embarked in it are considered to have made the same type of move.`,\r\n  when: [DURING_GAME],\r\n  shared: true, */\r\n}\r\nconst DisembarkEffect = {\r\n /* name: `Disembarking`,\r\n  desc: `In your movement phase, if a friendly SKYFARER unit is embarked in a TRANSPORT VESSEL that has not yet moved in that phase, you can say that the SKYFARER unit will disembark. If you do so, set up that SKYFARER unit wholly within 3\" of that TRANSPORT VESSEL and more than 3\" from all enemy units. A unit disembarks in this way can still move in the same turn.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,*/\r\n}\r\nconst DisembarkFromDestroyedVessel = {\r\n /* name: `Disembarking from a Destroyed Vessel`,\r\n  desc: `If a friendly TRANSPORT VESSEL is destroyed, before removing it from play, roll a number of dice equal to the number of models embarked in it. For each roll of 1, 1 embarked model is slain (you choose which models are slain). Then, all units embarked in that TRANSPORT VESSEL must immediately disembark before it is removed from play.\r\n\r\n  When a unit disembarks, if a model cannot be set up wholly within 3\" of the TRANSPORT VESSEL in which it is embared and more than 3\" from all enemy units, it is slain.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true, */\r\n}\r\nconst FlyingTransportEffect = {\r\n /* name: `Flying Transport`,\r\n  desc: `This model can fly. In addition, up to 12 (22 for Ironclad) SKYFARER models can be embarked in it. If this unit is part of an army that is not a Kharadron Overlords army, it can still use the Sky-fleets battle trait (Embark/Disembark rules).`,\r\n  when: [DURING_GAME],\r\n  shared: true, */\r\n}\r\nconst SkyCannonEffect = {\r\n /* name: `Sky Cannon`,\r\n  desc: `Before attacking with a Sky Cannon, choose either the Shrapnel or Shell missile weapon characteristics for that shooting attack.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\nconst AetherKhemistEffects = [\r\n /* {\r\n    name: `Aetheric Augmentation`,\r\n    desc: `At the start of your shooting phase, if this unit is not embarked, you can pick 1 friendly SKYFARERS unit that is not embarked and is wholly within 12\" of this unit. Improve the Rend characteristic of that unit's missile weapons by 1 until the end of that phase. That same unit cannot be affects by this ability more than once per phase.`,\r\n    when: [SHOOTING_PHASE],\r\n    rule_sources: [rule_sources.BATTLETOME_KHARADRON_OVERLORDS, rule_sources.ERRATA_MARCH_2023],\r\n  },\r\n  {\r\n    name: `Atmospheric Isolation`,\r\n    desc: `Subtract 1 from hit rolls for attacks made by enemy models while they are within 3\" of any friendly units with this ability that are not embarked.`,\r\n    when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  }, */\r\n]\r\nconst SkyhookEffect = {\r\n/*  name: `Skyhook`,\r\n  desc: `The Damage characteristic of this unit's Skyhook or Light Skyhook is 3 if the target of the attack is a MONSTER.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,*/\r\n}\r\nconst ShipSkyhookEffect = {\r\n/*  name: `Skyvessel Skyhook`,\r\n  desc: `The Damage characters of this unit's Great Skyhook or Heavy Skyhook is 6 if that target is a MONSTER. In addition, if an attack is made with this unit's Great/Heavy Skyhook scores a hit on a MONSTER, if that MONSTER is not slain, after that attack has been resovled, roll a dice. On a 4+, that MONSTER is snagged until the end of the turn. While a MONSTER is snagged, it cannot carry out monstrous rampages. A MONSTER cannot be snagged more than once in the same turn.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,*/\r\n}\r\nconst GrapnelLauncherEffect = {\r\n /* name: `Grapnel Launcher`,\r\n  desc: `While this unit includes any models armed with a grapnel launcher, once per battle, at the end of your movement phase, you can say this unit will reel itself twoards an object. If you do so, pick a point on the battlefield within 15\" of this unit and on a terrain feature. Then, remove this unit from the battlefield and set it up again wholly within 3\" of that point and more than 9\" from all enemy units.`,\r\n  when: [END_OF_MOVEMENT_PHASE],\r\n  shared: true,*/\r\n}\r\nconst BulwarksOfIron = {\r\n/*  name: `Bulwarks of Iron`,\r\n  desc: `This unit counts as 5 models for the purposes of contesting objectives.`,\r\n  when: [DURING_GAME],\r\n  shared: true,*/\r\n}\r\nconst BombRacksEffect = {\r\n /* name: `Bomb Racks`,\r\n  desc: `After this unit finishes a normal move or a run, you can pick 1 enemy unit that this unit passed across and roll a number of dice equal to the Bomb Racks value shown on this unit's damage table. For each 4+, that enemy unit suffers 1 mortal wound. This ability has no effect on units that can fly.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,*/\r\n}\r\nconst EndrinmasterHealEffect = (val: '3' | 'D3') => ({\r\n /* name: `Endrinmaster`,\r\n  desc: `At the start of your hero phase, you can pick 1 friendly SKYVESSEL within 1\" of this model. Heal up to ${val} wounds allocated to that SKYVESSEL.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,*/\r\n})\r\nconst DrillEffect = (nVal: 'Cannon' | 'Launcher', rVal: '5+' | '6') => ({\r\n /* name: `Drill ${nVal}`,\r\n  desc: `If the unmodified hit roll for an attack made with a Drill ${nVal} is ${rVal}, that attack causes 3 mortal wounds to the target and the attack sequence ends.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true, */\r\n})\r\n\r\nconst Units = {\r\n  Codewright: {\r\n    effects: [\r\n      {\r\n        name: `Advisory Role - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 visible friendly Kharadron Overlords units to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, pick 1 of the following effects to apply to that target for the rest of the turn: \r\n        Seek New Prospects: Add 2 to the targets control score. \r\n        Dont Argue With the Wind: Add 1 to run rolls and charge rolls for the target. \r\n        Theres No Trading With Some People: No mortal damage is inflicted on the target by Retreat abilities.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Endrinmaster with Dirigible Suit': {\r\n    effects: [\r\n      {\r\n        name: `By Grungi, I Have My Eye On You! - Passive`,\r\n        desc: `Effect: Add 1 to field repairs rolls for friendly Endrinriggers units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Endrinmaster`,\r\n        desc: `Declare: Pick a friendly Skyvessel within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, Heal (3) the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  EndrinmasterHealEffect('3'),\r\n    ],\r\n  },\r\n  'Endrinmaster with Endrinharness': {\r\n    effects: [\r\n      {\r\n        name: `'Aye Aye, Captain! - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Skyvessel within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, for the rest of the turn:  \r\n        The target can use a Retreat or Run ability and still use Shoot abilities later in the turn.  \r\n        No mortal damage is inflicted on the target by Retreat abilities.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Endrinmaster`,\r\n        desc: `Declare: Pick a friendly Skyvessel within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, Heal (3) the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // EndrinmasterHealEffect('3'),\r\n    ],\r\n  },\r\n  'Aether-Khemist': {\r\n    effects: [\r\n      //...AetherKhemistEffects],\r\n      {\r\n        name: `Aetheric Augmentation - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Kharadron Overlords Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to the Rend characteristic of the targets ranged weapons for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Atmospheric Isolation`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from hit rolls for the targets combat attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n    },\r\n /* 'Bjorgen Thundrik': {\r\n    effects: [\r\n      {\r\n        name: `Toxic Gases`,\r\n        desc: `Once per battle, at the start of the combat phase, you can say this unit will release toxic gases. If you do so, for each enemy unit within 6\" of this unit, roll a number of dice equal to the number of models in that unit that are within 6\" of this unit. For each 5+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Paymaster`,\r\n        desc: `Once per turn, this unit can issue a command to a friendly THUNDRIK's PROFITEERS unit without a command point being spent.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"Thundrik's Profiteers\": {\r\n    effects: [\r\n      {\r\n        name: `Khazgan Drakkskewer`,\r\n        desc: `Khazgan Drakkskewer has a Wounds characteristic of 3. In addition, Khazgan Drakkskewer can fly.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Protect the Boss`,\r\n        desc: `While this unit is wholly within 3\" of a friendly BJORGEN THUNDRIK, he has a ward of 4+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Aetheric Navigator': {\r\n    effects: [\r\n      {\r\n        name: `Aethersight - Passive`,\r\n        desc: `Effect: This unit can use Unbind abilities as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Read the Winds - Once Per Turn`,\r\n        desc: `Declare: Roll 6 dice. For each 1, pick a visible enemy unit within 18\" of this unit to be an enemy target. For each 6, pick a visible friendly Skyvessel within 18\" of this unit to be a friendly target. \r\n        Effect: Inflict D3 mortal damage on each enemy target. If any damage points are allocated to an enemy target by this ability, halve its Move characteristic until the start of your next turn. \r\n        Add 3\" to the Move characteristic of each friendly target until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Arkanaut Admiral': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Bring Every Gun to Bear', 'Command the Skies'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `The Admiral's Flagship - Once Per Battle`,\r\n        desc: `Declare: Pick an Arkanaut Ironclad or Arkanaut Frigate in this units regiment to be the target. \r\n        Effect: For the rest of the battle, each time the target uses the All-out Attack command while this unit is wholly within 12\" of it, no command points are spent.`,\r\n        when: [DURING_SETUP, SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Always Take What You Are Owed`,\r\n        desc: `Declare: Pick a friendly Arkanaut Company unit wholly within 12\" of this unit to be the target. \r\n        Effect: Add D6 to the targets control score until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bring Every Gun to Bear! - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Skyvessel wholly within 24\" of this unit that is not in combat to be the target. \r\n        Effect: Add 1 to the Attacks characteristic of the targets ranged weapons for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grundstok Thunderers': {\r\n    effects: [\r\n      {\r\n        name: `Hold This Position!`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, this units ranged weapons have Shoot in Combat for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Brokk Grungsson, Lord-Magnate of Barak-Nar': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Command the Fleet'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Moustache-mounted Aetherblasters`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `First Rule of Grungsson`,\r\n        desc: `Declare: Pick up to 2 other friendly Skyfarer units within this units combat range to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Command the Fleet - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 visible friendly Skyvessels wholly within 24\" of this unit that are not in combat to be the targets. \r\n        Effect: Each target can use a Run ability and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Skywardens: {\r\n    effects: [\r\n      {\r\n        name: `Timed Charges`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  Inflict an amount of mortal damage on the target equal to the roll.  \r\n        This unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    //  SkyhookEffect,\r\n     // GrapnelLauncherEffect,\r\n    ],\r\n  },\r\n  Endrinriggers: {\r\n    effects: [\r\n      {\r\n        name: `Emergency Field Repairs`,\r\n        desc: `Declare: Pick a friendly Skyvessel within this units combat range to be the target. \r\n        Effect: Make a field repairs roll of D6 for each model in this unit. For each 4-5, Heal (1) the target. For each 6, Heal (2) the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // DrillEffect('Launcher', '6'),\r\n    //  SkyhookEffect,\r\n     // GrapnelLauncherEffect,\r\n    ],\r\n  },\r\n  'Arkanaut Company': {\r\n    effects: [\r\n      {\r\n        name: `Glory-seekers - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this units attacks that target an enemy unit contesting an objective.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // SkyhookEffect,\r\n    ],\r\n  },\r\n  'Grundstok Gunhauler': {\r\n    effects: [\r\n      {\r\n        name: `Transport Capacity - Passive`,\r\n        desc: `Effect: This unit can transport 1 friendly Kharadron Overlords Infantry unit with a model count of up to 5 (see Battle Traits).`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Escort Vessel - Passive`,\r\n        desc: `Effect: While any friendly Arkanaut Ironclads or Arkanaut Frigates are within this units combat range, both this unit and those friendly units have Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Light Bomb Racks`,\r\n        desc: `Declare: Pick an enemy unit that does not have Fly and that this unit passed across this phase to be the target. \r\n        Effect: Roll 4 dice. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     /* BombRacksEffect,\r\n      EmbarkedEffect,\r\n      EmbarkingDeployEffect,\r\n      EmbarkingEffect,\r\n      DisembarkEffect,\r\n      DisembarkFromDestroyedVessel,\r\n      DrillEffect('Cannon', '5+'),\r\n      SkyCannonEffect, */\r\n    ],\r\n  },\r\n  'Arkanaut Frigate': {\r\n    effects: [\r\n      {\r\n        name: `Assault Boat`,\r\n        desc: `Declare: This unit cannot use this ability if it is in combat or has used a Run or Retreat ability this turn. Pick a number of units up to its Transport Capacity that are wholly within 6\" of it and that have not charged this turn to be the targets. Then, make a charge roll of 2D6. \r\n        Effect: Remove the targets from the battlefield. Then, this unit can move a distance up to the value of the charge roll and must end the move within 1/2\" of a visible enemy unit. Then, set up the targets wholly within this units combat range. The targets can be set up in combat and have Strike-first for the rest of the turn. This unit and the targets have charged.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Transport Capacity - Passive`,\r\n        desc: `Effect: This unit can transport up to 2 friendly Kharadron Overlords Infantry units with a combined model count of up to 12 (see Battle Traits).`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Aethershot Carbines is 2.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Medium Bomb Racks`,\r\n        desc: `Declare: Pick an enemy unit that does not have Fly and that this unit passed across this phase to be the target. \r\n        Effect: Roll 6 dice. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    /*  BulwarksOfIron,\r\n      BombRacksEffect,\r\n      FlyingTransportEffect,\r\n      EmbarkedEffect,\r\n      EmbarkingDeployEffect,\r\n      EmbarkingEffect,\r\n      DisembarkEffect,\r\n      DisembarkFromDestroyedVessel,\r\n      ShipSkyhookEffect,\r\n      SkyCannonEffect, */\r\n    ],\r\n  },\r\n  'Arkanaut Ironclad': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Aethershot Carbines is 4.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Heavy Bomb Racks`,\r\n        desc: `Declare: Pick an enemy unit that does not have Fly and that this unit passed across this phase to be the target. \r\n        Effect: Roll 10 dice. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Transport Capacity - Passive`,\r\n        desc: `Effect: This unit can transport up to 3 friendly Kharadron Overlords Infantry units with a combined model count of up to 22 (see Battle Traits).`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Great Endrinworks`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the battle: \r\n        Magnicent Omniscope: Add 2\" to this units Move characteristic. \r\n        Collapsible Compartments: Add 1 to the total number of units and 10 to the total number of models this unit can transport. \r\n        Aetheric Repulsion Field: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [DURING_SETUP],\r\n      },\r\n     /* BulwarksOfIron,\r\n      BombRacksEffect,\r\n      FlyingTransportEffect,\r\n      EmbarkedEffect,\r\n      EmbarkingDeployEffect,\r\n      EmbarkingEffect,\r\n      DisembarkEffect,\r\n      DisembarkFromDestroyedVessel,\r\n      ShipSkyhookEffect,\r\n      SkyCannonEffect, */\r\n    ],\r\n  },\r\n  'Drekki Flynt': {\r\n    effects: [\r\n      {\r\n        name: `Captain of the Aelsling`,\r\n        desc: `Declare: Pick a friendly Arkanaut Frigate in this units regiment to be the target. \r\n        Effect: The target has the Aelsling keyword. Add 1 to the Damage characteristic of the targets melee weapons for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `She Can Handle It! - Passive`,\r\n        desc: `Effect: You can re-roll run rolls and charge rolls for the Aelsling while this unit is within its combat range.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n\r\n      {\r\n        name: `Auxiliary Skyhook`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Fjori`s Flamebearers': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import React from 'react'\r\n\r\ninterface ISpinnerProps {\r\n  variant?: 'light' | 'dark' | 'secondary' | 'light-gray'\r\n  size?: 'large' | 'normal' | 'small'\r\n  className?: string\r\n}\r\n\r\nconst Spinner = ({ variant = 'dark', size = 'normal', className = '' }: ISpinnerProps) => {\r\n  const colorClass = {\r\n    light: 'text-light',\r\n    dark: 'text-dark',\r\n    secondary: 'text-secondary',\r\n    'light-gray': 'text-light-gray',\r\n  }[variant]\r\n\r\n  const style = size === 'large' ? { width: '3.5rem', height: '3.5rem' } : {}\r\n  const sizeClass = size === 'normal' || size === 'large' ? `` : `spinner-border-sm`\r\n\r\n  return (\r\n    <div className={`d-flex justify-content-center ${className}`}>\r\n      <div className={`spinner-border ${colorClass} ${sizeClass}`} style={style} role=\"status\">\r\n        <span className=\"sr-only\">Loading...</span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Spinner\r\n","export interface IGiftedSubscriptionPlans {\r\n  cost: string\r\n  stripe_dev: string // stripe plan ID in test mode\r\n  stripe_prod: string // stripe plan ID in prod\r\n  title: string\r\n}\r\n\r\nexport interface ISubscriptionPlan extends IGiftedSubscriptionPlans {\r\n  paypal_dev: string // paypal plan ID in sandbox mode\r\n  paypal_prod: string // paypal plan ID in prod\r\n  monthly_cost: string\r\n  sale?: boolean\r\n  discount_pct?: number\r\n}\r\n\r\nexport const GiftedSubscriptionPlans: IGiftedSubscriptionPlans[] = [\r\n  {\r\n    cost: '0.99',\r\n    stripe_dev: 'price_1HmJnuCx8OcHZ9hn9y2JGcDo',\r\n    stripe_prod: 'price_1HmKTgCx8OcHZ9hnRLRJrBPc',\r\n    title: '1 Month',\r\n  },\r\n  {\r\n    cost: '2.67',\r\n    stripe_dev: 'price_1HmKRCCx8OcHZ9hn6vTZs16V',\r\n    stripe_prod: 'price_1HmKTgCx8OcHZ9hnfUPSwgvw',\r\n    title: '3 Months',\r\n  },\r\n  {\r\n    cost: '9.49',\r\n    stripe_dev: 'price_1HmKRCCx8OcHZ9hnHd9mOh0Z',\r\n    stripe_prod: 'price_1HmKTfCx8OcHZ9hn8tunKnFb',\r\n    title: '1 Year',\r\n  },\r\n]\r\n\r\nexport const SubscriptionPlans: ISubscriptionPlan[] = [\r\n  {\r\n    cost: '1.99',\r\n    monthly_cost: '1.99',\r\n    paypal_dev: 'P-54G67667NT497912UL5TBTBQ',\r\n    paypal_prod: 'P-992593310M0717908L5TJ5ZA',\r\n    stripe_dev: 'plan_FkxFLAaT1qDsha',\r\n    stripe_prod: 'plan_FkxAvHwfImy1WU',\r\n    title: '1 Month',\r\n  },\r\n  {\r\n    cost: '4.47',\r\n    monthly_cost: '1.49',\r\n    paypal_dev: 'P-8HN142814F897112NL5TBTVA',\r\n    paypal_prod: 'P-4SP611027V911981YL5TJ6CY',\r\n    stripe_dev: 'plan_FkxFWSZADnJp1G',\r\n    stripe_prod: 'plan_FkxCFxAtQuXdSm',\r\n    title: '3 Months',\r\n  },\r\n  {\r\n    cost: '11.88',\r\n    monthly_cost: '0.99',\r\n    paypal_dev: 'P-7YT370523H1387633L5TCFHI',\r\n    paypal_prod: 'P-7W029230206518920L5TJ6GI',\r\n    stripe_dev: 'plan_FkxGRttbVwtLzD',\r\n    stripe_prod: 'plan_FkxDFaZM1vCkMF',\r\n    title: '1 Year',\r\n  },\r\n]\r\n","import { useTheme } from 'context/useTheme'\r\nimport React from 'react'\r\nimport { navbarStyles } from 'theme/helperClasses'\r\nimport useWindowSize from 'utils/hooks/useWindowSize'\r\n\r\nconst NavbarWrapper = ({ children }) => {\r\n  const { theme } = useTheme()\r\n  const { isMobile } = useWindowSize()\r\n\r\n  return (\r\n    <header className={`${navbarStyles.headerClass} ${theme.headerColor}`}>\r\n      <div className={`row d-flex w-${isMobile ? 100 : 75}`}>\r\n        <div className=\"flex-grow-1\"> </div>\r\n        <div>{children}</div>\r\n      </div>\r\n    </header>\r\n  )\r\n}\r\n\r\nexport default NavbarWrapper\r\n","import { SUPPORTED_FACTIONS } from 'meta/factions'\r\nimport { Game } from 'meta/game_structure'\r\nimport { IStore } from 'types/store'\r\n\r\nconst DefaultAppState: IStore = {\r\n  factionNames: {\r\n    factionName: SUPPORTED_FACTIONS[0],\r\n    subFactionName: '', // TODO: Can we fetch this?\r\n  },\r\n  selections: {\r\n    selections: {\r\n      artifacts: [],\r\n      battalions: [],\r\n      battle_tactics: [],\r\n      command_abilities: [],\r\n      command_traits: [],\r\n      core_rules: [],\r\n      endless_spells: [],\r\n      flavors: [],\r\n      grand_strategies: [],\r\n      incarnates: [],\r\n      monstrous_rampages: [],\r\n      mount_traits: [],\r\n      prayers: [],\r\n      scenery: [],\r\n      spells: [],\r\n      triumphs: [],\r\n      units: [],\r\n      manifestations: [],\r\n    },\r\n    allySelections: {},\r\n    sideEffects: {},\r\n  },\r\n  army: {\r\n    army: {\r\n      Artifacts: [],\r\n      Battalions: [],\r\n      BattleTactics: [],\r\n      BattleTraits: [],\r\n      CommandAbilities: [],\r\n      CommandTraits: [],\r\n      CoreRules: [],\r\n      EndlessSpells: [],\r\n      Flavors: [],\r\n      FlavorType: '',\r\n      Game: Game,\r\n      GrandStrategies: [],\r\n      Incarnates: [],\r\n      MonstrousRampages: [],\r\n      MountTraits: [],\r\n      Prayers: [],\r\n      Scenery: [],\r\n      Spells: [],\r\n      SubFaction: {\r\n        name: '',\r\n        effects: [],\r\n      },\r\n      Triumphs: [],\r\n      Units: [],\r\n      Manifestations: [],\r\n    },\r\n    allyArmies: {},\r\n  },\r\n  realmscape: {\r\n    origin_realm: null,\r\n    realmscape: null,\r\n    realmscape_feature: null,\r\n  },\r\n  notes: { notes: [] },\r\n  visibility: {\r\n    allies: [],\r\n    reminders: [],\r\n    selectors: [],\r\n    when: [],\r\n  },\r\n}\r\n\r\nexport default DefaultAppState\r\n","import { useEffect, useMemo, useState } from 'react'\r\n\r\ntype TState = { width?: number; height?: number }\r\n\r\n/**\r\n * This hook helps us track the window dimensions of our user's browser\r\n */\r\nconst useWindowSize = () => {\r\n  const [windowSize, setWindowSize] = useState<TState>({ width: undefined, height: undefined })\r\n\r\n  useEffect(() => {\r\n    // Handler to call on window resize\r\n    const handleResize = () => {\r\n      // Set window width/height to state\r\n      setWindowSize({\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n      })\r\n    }\r\n\r\n    // Add event listener\r\n    window.addEventListener('resize', handleResize)\r\n\r\n    // Call handler right away so state gets updated with initial window size\r\n    handleResize()\r\n\r\n    // Remove event listener on cleanup\r\n    return () => window.removeEventListener('resize', handleResize)\r\n  }, []) // Empty array ensures that effect is only run on mount\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      width: windowSize.width,\r\n      height: windowSize.height,\r\n      isTinyMobile: windowSize.width ? windowSize.width <= 335 : false,\r\n      isMobile: windowSize.width ? windowSize.width <= 480 : false,\r\n    }),\r\n    [windowSize.width, windowSize.height]\r\n  )\r\n\r\n  return value\r\n}\r\n\r\nexport default useWindowSize\r\n","import { useAuth0 } from '@auth0/auth0-react'\r\nimport { PreferenceApi } from 'api/preferenceApi'\r\nimport { useAppStatus } from 'context/useAppStatus'\r\nimport { useSubscription } from 'context/useSubscription'\r\nimport { isEqual, sortBy } from 'lodash'\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport { store } from 'store'\r\nimport { ICurrentArmy } from 'types/army'\r\nimport { IImportedArmy } from 'types/import'\r\nimport { ISavedArmy, ISavedArmyFromApi } from 'types/savedArmy'\r\nimport { logEvent } from 'utils/analytics'\r\nimport { prepareArmy, prepareArmyForS3 } from 'utils/armyUtils'\r\nimport { isDev } from 'utils/env'\r\nimport useGetReminders from 'utils/hooks/useGetReminders'\r\nimport { addArmyToStore } from 'utils/loadArmy/loadArmyHelpers'\r\nimport { LocalLoadedArmy, LocalReminderOrder, LocalSavedArmies, LocalUserName } from 'utils/localStore'\r\n\r\ntype TLoadedArmy = { id: string; armyName: string } | null\r\ntype THasChanges = (currentArmy: ICurrentArmy) => { hasChanges: boolean; changedKeys: string[] }\r\n\r\ninterface ISavedArmiesContext {\r\n  armyHasChanges: THasChanges\r\n  deleteSavedArmy: (id: string) => Promise<void>\r\n  loadedArmy: TLoadedArmy | null\r\n  loadSavedArmies: () => Promise<void>\r\n  reloadArmy: () => void\r\n  saveArmy: (army: ISavedArmy) => Promise<void>\r\n  saveArmyToS3: (army: IImportedArmy | ISavedArmy | ICurrentArmy) => Promise<void>\r\n  savedArmies: ISavedArmyFromApi[]\r\n  saveLink: (army: ISavedArmy) => Promise<string | null>\r\n  setLoadedArmy: (army: TLoadedArmy) => void\r\n  setHasOrderChanges: (hasChanged: boolean) => void\r\n  updateArmy: (id: string, data: Record<string, any>) => Promise<void>\r\n  updateArmyName: (id: string, armyName: string) => Promise<void>\r\n}\r\n\r\nconst saveArmyToS3 = async (army: IImportedArmy | ISavedArmy | ICurrentArmy) => {\r\n  try {\r\n    const preparedArmy = prepareArmyForS3(army)\r\n    await PreferenceApi.saveArmyToS3(preparedArmy)\r\n  } catch (err) {\r\n    console.error(err)\r\n  }\r\n}\r\n\r\nconst SavedArmiesContext = React.createContext<ISavedArmiesContext | void>(undefined)\r\n\r\nconst SavedArmiesProvider = ({ children }: React.PropsWithChildren<{}>) => {\r\n  const { isOffline } = useAppStatus()\r\n  const { user } = useAuth0()\r\n  const { relevantNotes } = useGetReminders()\r\n  const { isActive } = useSubscription()\r\n  const [savedArmies, setSavedArmies] = useState<ISavedArmyFromApi[]>([])\r\n  const [savedArmiesPopulated, setSavedArmiesPopulated] = useState(false)\r\n  const [loadedArmy, setLoadedArmyState] = useState<TLoadedArmy>(LocalLoadedArmy.get())\r\n  const [hasOrderChanges, setHasOrderChanges] = useState(false)\r\n\r\n  const setLoadedArmy = useCallback((army: TLoadedArmy) => {\r\n    LocalLoadedArmy.set(army)\r\n    setLoadedArmyState(army)\r\n    if (army?.id) LocalReminderOrder.makeIdActive(army.id)\r\n  }, [])\r\n\r\n  const armyHasChanges: THasChanges = useCallback(\r\n    currentArmy => {\r\n      const noChangesResponse = { hasChanges: false, changedKeys: [] }\r\n      if (!loadedArmy || !currentArmy || !savedArmiesPopulated) return noChangesResponse\r\n\r\n      const original = savedArmies.find(x => x.id === loadedArmy.id) as ISavedArmyFromApi\r\n      if (!original) {\r\n        setLoadedArmy(null)\r\n        return noChangesResponse\r\n      }\r\n\r\n      const { id, armyName, userName, createdAt, updatedAt, schemaVersion, ...loaded } = original\r\n\r\n      const hiddenReminders = store.getState().visibility.reminders\r\n      const current = prepareArmy(\r\n        { ...currentArmy, hiddenReminders, armyName, notes: relevantNotes },\r\n        'update'\r\n      ) as ISavedArmy\r\n\r\n      // This fixes an issue where the names are not in exactly the same order\r\n      loaded.allyFactionNames = sortBy(loaded.allyFactionNames || [])\r\n      current.allyFactionNames = sortBy(current.allyFactionNames || [])\r\n\r\n      // Since origin_realm was introduced later, sometimes it's undefined in saved armies\r\n      loaded.origin_realm = loaded.origin_realm || null\r\n\r\n      // Have we updated our reminder ordering?\r\n      loaded.orderedReminders = loaded.orderedReminders || LocalReminderOrder.get(loadedArmy.id)\r\n\r\n      const changedKeys = Object.keys(current).reduce((a, key) => {\r\n        if (!isEqual(current[key as keyof ISavedArmy], loaded[key as keyof typeof loaded])) a.push(key)\r\n        return a\r\n      }, [] as string[])\r\n\r\n      if (changedKeys.length && isDev) console.log('Changed keys are: ', changedKeys)\r\n      if (hasOrderChanges && isDev) console.log(`hasOrderChanges: ${hasOrderChanges}`)\r\n\r\n      return { hasChanges: changedKeys.length > 0 || hasOrderChanges, changedKeys }\r\n    },\r\n    [hasOrderChanges, loadedArmy, relevantNotes, savedArmies, savedArmiesPopulated, setLoadedArmy]\r\n  )\r\n\r\n  const loadSavedArmies = useCallback(async () => {\r\n    if (isOffline) {\r\n      setSavedArmiesPopulated(true)\r\n      return setSavedArmies(LocalSavedArmies.get()) // If we're offline, fetch any saved armies from localStorage\r\n    }\r\n    if (!user?.email) {\r\n      setSavedArmiesPopulated(false)\r\n      return setSavedArmies([])\r\n    }\r\n\r\n    try {\r\n      const res = await PreferenceApi.getUserItems(user?.email)\r\n      const savedArmies = sortBy(res.body as ISavedArmyFromApi[], 'createdAt').reverse()\r\n      setSavedArmies(savedArmies)\r\n      LocalSavedArmies.set(savedArmies)\r\n      savedArmies.forEach(a => LocalReminderOrder.setById(a.id, a.orderedReminders))\r\n      setSavedArmiesPopulated(true)\r\n    } catch (err) {\r\n      console.error(err)\r\n      setSavedArmiesPopulated(false)\r\n    }\r\n  }, [user, isOffline])\r\n\r\n  const saveArmy = useCallback(\r\n    async (savedArmy: ISavedArmy) => {\r\n      try {\r\n        if (!user?.email) return\r\n        setHasOrderChanges(false)\r\n        const { body } = await PreferenceApi.createSavedArmy({ userName: user?.email, ...savedArmy })\r\n        saveArmyToS3(savedArmy)\r\n        await loadSavedArmies()\r\n        setLoadedArmy({ id: body.id, armyName: body.armyName })\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    [user, loadSavedArmies, setLoadedArmy]\r\n  )\r\n\r\n  const saveLink = useCallback(async (savedArmy: ISavedArmy) => {\r\n    try {\r\n      const { body } = await PreferenceApi.createLink(savedArmy)\r\n      saveArmyToS3(savedArmy)\r\n      return body.url\r\n    } catch (err) {\r\n      console.error(err)\r\n      return null\r\n    }\r\n  }, [])\r\n\r\n  const deleteSavedArmy = useCallback(\r\n    async (id: string) => {\r\n      try {\r\n        if (!user?.email) return\r\n        await PreferenceApi.deleteItem(id, user.email)\r\n        if (loadedArmy && loadedArmy.id === id) setLoadedArmy(null)\r\n        await loadSavedArmies()\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    [loadSavedArmies, user, loadedArmy, setLoadedArmy]\r\n  )\r\n\r\n  const updateArmy = useCallback(\r\n    async (id: string, data: Record<string, any>) => {\r\n      try {\r\n        if (!user?.email) return\r\n        setHasOrderChanges(false)\r\n        const payload = { ...data, userName: user.email }\r\n        await PreferenceApi.updateItem(id, payload)\r\n        await loadSavedArmies()\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    [loadSavedArmies, user]\r\n  )\r\n\r\n  const updateArmyName = useCallback(\r\n    async (id: string, armyName: string) => {\r\n      try {\r\n        if (!user?.email) return\r\n        const payload = { armyName, userName: user.email }\r\n        await PreferenceApi.updateItem(id, payload)\r\n        await loadSavedArmies()\r\n        if (loadedArmy) setLoadedArmy({ id, armyName })\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    [loadSavedArmies, user, loadedArmy, setLoadedArmy]\r\n  )\r\n\r\n  const reloadArmy = useCallback(() => {\r\n    if (!loadedArmy) return\r\n    const fullLoadedArmy = savedArmies.find(x => x.id === loadedArmy.id) as ISavedArmyFromApi\r\n    addArmyToStore(fullLoadedArmy)\r\n    logEvent(`ReloadArmy-${fullLoadedArmy.factionName}`)\r\n  }, [loadedArmy, savedArmies])\r\n\r\n  useEffect(() => {\r\n    if (user?.email && isActive) LocalUserName.set(user.email)\r\n  }, [user, isActive])\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      armyHasChanges,\r\n      deleteSavedArmy,\r\n      loadedArmy,\r\n      loadSavedArmies,\r\n      reloadArmy,\r\n      saveArmy,\r\n      saveArmyToS3,\r\n      savedArmies,\r\n      saveLink,\r\n      setHasOrderChanges,\r\n      setLoadedArmy,\r\n      updateArmy,\r\n      updateArmyName,\r\n    }),\r\n    [\r\n      armyHasChanges,\r\n      deleteSavedArmy,\r\n      loadedArmy,\r\n      loadSavedArmies,\r\n      reloadArmy,\r\n      saveArmy,\r\n      savedArmies,\r\n      saveLink,\r\n      setHasOrderChanges,\r\n      setLoadedArmy,\r\n      updateArmy,\r\n      updateArmyName,\r\n    ]\r\n  )\r\n\r\n  return <SavedArmiesContext.Provider value={value}>{children}</SavedArmiesContext.Provider>\r\n}\r\n\r\nconst useSavedArmies = () => {\r\n  const context = React.useContext(SavedArmiesContext)\r\n  if (context === undefined) {\r\n    throw new Error('useSavedArmies must be used within a SavedArmiesProvider')\r\n  }\r\n  return context\r\n}\r\n\r\nexport { SavedArmiesProvider, useSavedArmies }\r\n","import Spinner from 'components/helpers/spinner'\r\nimport GenericButton from 'components/input/generic_button'\r\nimport NavbarWrapper from 'components/page/navbar_wrapper'\r\nimport { useTheme } from 'context/useTheme'\r\nimport { FiWifiOff } from 'react-icons/fi'\r\nimport { Link } from 'react-router-dom'\r\nimport { navbarStyles } from 'theme/helperClasses'\r\nimport { ROUTES } from 'utils/env'\r\n\r\nexport const LoadingBtn = ({ text = 'Loading' }) => (\r\n  <GenericButton disabled type=\"button\">\r\n    <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\"></span> {text}\r\n  </GenericButton>\r\n)\r\n\r\nexport const OfflineBtn = ({ text = 'Offline' }) => {\r\n  return (\r\n    <GenericButton disabled type=\"button\">\r\n      <FiWifiOff className=\"mr-2 text-danger\" /> {text}\r\n    </GenericButton>\r\n  )\r\n}\r\n\r\nexport const LoadingHeader = () => {\r\n  const { theme } = useTheme()\r\n\r\n  return (\r\n    <div className={`${theme.headerColor} py-2`}>\r\n      <NavbarWrapper>\r\n        <div className={`py-1 mr-3 mr-sm-5 align-items-center`}>\r\n          <Spinner variant=\"light\" size=\"small\" />\r\n        </div>\r\n      </NavbarWrapper>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const OfflineHeader = () => {\r\n  const { pathname } = window.location\r\n\r\n  return (\r\n    <NavbarWrapper>\r\n      {pathname !== ROUTES.HOME && (\r\n        <Link to={ROUTES.HOME} className={navbarStyles.link}>\r\n          Home\r\n        </Link>\r\n      )}\r\n      <GenericButton className={navbarStyles.btn} disabled type=\"button\">\r\n        <FiWifiOff className=\"mr-2\" /> Offline\r\n      </GenericButton>\r\n    </NavbarWrapper>\r\n  )\r\n}\r\n\r\nexport const LoadingBody = () => {\r\n  const { theme } = useTheme()\r\n  const containerClass = `container ${theme.bgColor} d-flex flex-column align-items-center justify-content-center LoadingContainer`\r\n\r\n  return (\r\n    <div className={containerClass}>\r\n      <div className=\"col text-center\">\r\n        <h3 className={`pulsate-fwd ${theme.text}`}>AoS Reminders</h3>\r\n        <p className={`lead ${theme.textMuted} fade-out`}>Loading...</p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const LargeSpinner = ({ className = '' }) => (\r\n  <div className={`d-flex flex-row justify-content-center ${className}`}>\r\n    <Spinner variant=\"light-gray\" size=\"large\" />\r\n  </div>\r\n)\r\n","import { mergeParentEffectObjs } from 'factions/temporaryAdapter'\r\nimport { Realmscapes } from 'generic_rules'\r\nimport produce from 'immer'\r\nimport { flatten, sortBy, sortedUniq, uniq } from 'lodash'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport { getFactionFromList } from 'meta/faction_list'\r\nimport { Game, TGameStructure } from 'meta/game_structure'\r\nimport { IArmy, TAllyArmies } from 'types/army'\r\nimport {\r\n  entryKeyToSelectionsKey,\r\n  IReminder,\r\n  selectionsKeyToEntryKey,\r\n  TEffects,\r\n  TEntry,\r\n  TEntryProperties,\r\n  TTurnAction,\r\n} from 'types/data'\r\nimport { RealmscapesEnum } from 'types/realmscapes'\r\nimport { IAllySelections, TSelections, TSelectionTypes } from 'types/selections'\r\nimport { TAllySelectionStore } from 'types/store'\r\nimport { hashReminder } from 'utils/reminderUtils'\r\nimport { getActionTitle, titleCase } from 'utils/textUtils'\r\nimport { getTagFromEntry } from './getTag'\r\nimport { mapListToDict } from './mapListToDict'\r\n\r\ntype TProcessReminders = (\r\n  army: IArmy,\r\n  factionName: TSupportedFaction,\r\n  subFactionName: string,\r\n  selections: TSelections,\r\n  realmscape: RealmscapesEnum | null,\r\n  allyFactionNames: TSupportedFaction[],\r\n  allyArmies: TAllyArmies,\r\n  allySelections: TAllySelectionStore\r\n) => IReminder\r\n\r\nexport const processReminders: TProcessReminders = (\r\n  army,\r\n  factionName,\r\n  subFactionName,\r\n  selections,\r\n  realmscape,\r\n  allyFactionNames,\r\n  allyArmies,\r\n  allySelections\r\n) => {\r\n  const allyData = allyFactionNames.map(name => {\r\n    return {\r\n      allyArmy: allyArmies[name],\r\n      allySelections: allySelections[name],\r\n    }\r\n  })\r\n\r\n  let reminders = processConditions(army.Game, selections, {})\r\n\r\n  if (allyData.length) {\r\n    reminders = allyData.reduce((accum, data) => {\r\n      if (!data.allySelections) return accum\r\n\r\n      // Get mandatory items and assign them to selections\r\n      const alliedMandatorySelections: TMandatorySelectionsAccum = data.allySelections.units.reduce(\r\n        (a, _unit) => {\r\n          const entry = data.allyArmy.Units.find(x => x.name === _unit)\r\n          if (entry) getMandatorySelectionsForAllies(entry, a) // Modifies the accumulator\r\n          return a\r\n        },\r\n        {}\r\n      )\r\n\r\n      // Merge the actual allied selections with their mandatory side effects\r\n      const allAlliedSelections = Object.keys(selectionsKeyToEntryKey).reduce(\r\n        (a, key) => {\r\n          if (!a[key]) a[key] = []\r\n\r\n          if (alliedMandatorySelections[key]) {\r\n            a[key] = uniq(a[key].concat(alliedMandatorySelections[key]))\r\n          }\r\n\r\n          return a\r\n        },\r\n        { ...data.allySelections }\r\n      )\r\n\r\n      return processConditions(data.allyArmy.Game, allAlliedSelections, accum)\r\n    }, reminders)\r\n  }\r\n\r\n  const faction = getFactionFromList(factionName)\r\n\r\n  // Add faction battle traits\r\n  if (faction?.factionBattleTraits?.length) {\r\n    faction.factionBattleTraits.forEach(e => {\r\n      e.when.forEach(when => {\r\n        const t: TTurnAction = {\r\n          ...e,\r\n          id: hashReminder(when, e.name, e.desc),\r\n          condition: [`${titleCase(factionName)} Allegiance`],\r\n          when,\r\n        }\r\n        reminders[when] = reminders[when] ? reminders[when].concat(t) : [t]\r\n      })\r\n    })\r\n  }\r\n\r\n  // Add subfaction battle traits\r\n  if (army.BattleTraits && army.BattleTraits.length) {\r\n    army.BattleTraits.forEach((e: TEffects) => {\r\n      e.when.forEach(when => {\r\n        const t: TTurnAction = {\r\n          ...e,\r\n          id: hashReminder(when, e.name, e.desc),\r\n          condition: [`${titleCase(subFactionName || factionName)} Allegiance`],\r\n          when,\r\n        }\r\n        reminders[when] = reminders[when] ? reminders[when].concat(t) : [t]\r\n      })\r\n    })\r\n  }\r\n\r\n  // Add Realmscape effects\r\n  if (realmscape) {\r\n    const realm = Realmscapes.find(x => x.name === realmscape)\r\n    if (realm) {\r\n      realm.effects.forEach(e => {\r\n        e.when.forEach(when => {\r\n          const t: TTurnAction = {\r\n            ...e,\r\n            id: hashReminder(when, e.name, e.desc),\r\n            condition: [`Realmscape (${realmscape})`],\r\n            when,\r\n          }\r\n          reminders[when] = reminders[when] ? reminders[when].concat(t) : [t]\r\n        })\r\n      })\r\n    }\r\n  }\r\n\r\n  // Last step, we need to sort by the original order\r\n  const ordered = Object.keys(Game).reduce((accum, key) => {\r\n    if (reminders[key]) {\r\n      // Calculate ActionTitles\r\n      const turnActions = reminders[key].map(action => ({ ...action, actionTitle: getActionTitle(action) }))\r\n      accum[key] = sortBy(turnActions, ['actionTitle', 'name'])\r\n    }\r\n    return accum\r\n  }, {})\r\n\r\n  return ordered\r\n}\r\n\r\n/**\r\n * Exported for testing purposes\r\n *\r\n * @param game\r\n * @param selections\r\n * @param startVal\r\n */\r\nexport const processConditions = (\r\n  game: TGameStructure,\r\n  selections: TSelections | IAllySelections,\r\n  startVal = {}\r\n) => {\r\n  const conditionNames = mapListToDict(flatten(Object.values(selections)))\r\n\r\n  const conditionsWithMetadata = Object.entries(selections).reduce((a, [key, value]) => {\r\n    value.forEach(name => {\r\n      a.push({\r\n        name,\r\n        tag: selectionsKeyToEntryKey[key],\r\n      })\r\n    })\r\n    return a\r\n  }, [] as { tag: TEntryProperties; name: string }[])\r\n\r\n  const reminders = Object.keys(game).reduce((accum: Record<string, TTurnAction[]>, when) => {\r\n    if (!game[when].length) return accum\r\n\r\n    game[when].forEach((action: TTurnAction) => {\r\n      // Find a matching name/tag\r\n      if (conditionNames[action.condition[0]]) {\r\n        const tag = conditionsWithMetadata.find(\r\n          x => x.name === action.name && x.tag === getTagFromEntry(action)\r\n        )?.tag\r\n\r\n        // Check for proper tag match (e.g spell, prayer, etc)\r\n        if (!tag || action[tag] === true) {\r\n          accum[when] = accum[when] ? processCondition(accum[when], action) : [action]\r\n        }\r\n      }\r\n    })\r\n\r\n    return accum\r\n  }, startVal)\r\n\r\n  return reminders\r\n}\r\n\r\n/**\r\n * Check to see if we've already added this rule for a different unit\r\n * If so, combine the entries\r\n * We use Immer to make sure we don't accidently mutate anything\r\n * @param phase\r\n * @param action\r\n */\r\nconst processCondition = produce((phase: TTurnAction[], action: TTurnAction) => {\r\n  // See if we can find a matching action already in the phase\r\n  const idx = phase.findIndex(x => x.name === action.name && x.desc === action.desc)\r\n\r\n  // If there's not a matching action, add this action to the existing phase\r\n  if (idx === -1) {\r\n    phase.push(action)\r\n    return phase\r\n  }\r\n\r\n  // If there is a matching action, merge the entries!\r\n  phase[idx].condition = sortedUniq(sortBy(phase[idx].condition.concat(action.condition)))\r\n  return phase\r\n})\r\n\r\ntype TMandatorySelectionsAccum = {\r\n  [key in TSelectionTypes]?: string[]\r\n}\r\n\r\nconst getMandatorySelectionsForAllies = (item: TEntry, accum: TMandatorySelectionsAccum) => {\r\n  if (!item.mandatory) return\r\n\r\n  Object.keys(item.mandatory).forEach(sliceKey => {\r\n    let key = sliceKey as TSelectionTypes\r\n\r\n    const slice = item?.mandatory?.[key]\r\n    if (!slice || !slice.length) return\r\n\r\n    const mergedEntries = mergeParentEffectObjs(slice)\r\n\r\n    mergedEntries.forEach(_entry => {\r\n      const tag = getTagFromEntry(_entry)\r\n      if (tag) {\r\n        const _slice: string[] = accum[entryKeyToSelectionsKey[tag]]\r\n        if (_slice) {\r\n          accum[entryKeyToSelectionsKey[tag]] = accum[entryKeyToSelectionsKey[tag]].concat(_entry.name)\r\n        } else {\r\n          accum[entryKeyToSelectionsKey[tag]] = [_entry.name]\r\n        }\r\n      }\r\n      if (_entry.mandatory) getMandatorySelectionsForAllies(_entry, accum)\r\n    })\r\n  })\r\n}\r\n","import { selectors } from 'ducks'\r\nimport { useMemo } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { processReminders } from 'utils/processReminders'\r\n\r\nconst useGetReminders = () => {\r\n  const allyArmies = useSelector(selectors.selectAllyArmies)\r\n  const army = useSelector(selectors.selectArmy)\r\n  const currentArmy = useSelector(selectors.selectCurrentArmy)\r\n  const notes = useSelector(selectors.selectNotes)\r\n\r\n  // Generate reminders\r\n  const reminders = useMemo(\r\n    () =>\r\n      processReminders(\r\n        army,\r\n        currentArmy.factionName,\r\n        currentArmy.subFactionName,\r\n        currentArmy.selections,\r\n        currentArmy.realmscape,\r\n        currentArmy.allyFactionNames,\r\n        allyArmies,\r\n        currentArmy.allySelections\r\n      ),\r\n    [\r\n      allyArmies,\r\n      army,\r\n      currentArmy.allyFactionNames,\r\n      currentArmy.allySelections,\r\n      currentArmy.factionName,\r\n      currentArmy.realmscape,\r\n      currentArmy.selections,\r\n      currentArmy.subFactionName,\r\n    ]\r\n  )\r\n\r\n  const relevantNotes = useMemo(() => {\r\n    const reminder_ids = Object.keys(reminders)\r\n      .map(key => reminders[key].map(x => x.id))\r\n      .flat()\r\n    return notes.filter(x => reminder_ids.includes(x.linked_hash))\r\n  }, [notes, reminders])\r\n\r\n  return { reminders, relevantNotes }\r\n}\r\n\r\nexport default useGetReminders\r\n","import { TSupportedFaction } from 'meta/factions'\r\nimport { ICurrentArmy } from 'types/army'\r\nimport { IStore } from 'types/store'\r\n\r\n// Army\r\nexport const selectArmy = (state: IStore) => state.army.army\r\nexport const selectAllyArmies = (state: IStore) => state.army.allyArmies\r\n\r\n// Faction Name\r\nexport const selectFactionName = (state: IStore) => state.factionNames.factionName\r\nexport const selectSubFactionName = (state: IStore) => state.factionNames.subFactionName\r\nexport const selectFactionNameSlice = (state: IStore) => state.factionNames\r\n\r\n// Notes\r\nexport const selectNotes = (state: IStore) => state.notes.notes\r\n\r\n// Realmscape\r\nexport const selectOriginRealm = (state: IStore) => state.realmscape.origin_realm\r\nexport const selectRealmscape = (state: IStore) => state.realmscape.realmscape\r\nexport const selectRealmscapeFeature = (state: IStore) => state.realmscape.realmscape_feature\r\nexport const selectRealmscapeSlice = (state: IStore) => state.realmscape\r\n\r\n// Selections\r\nexport const selectAllyFactionNames = (state: IStore) =>\r\n  Object.keys(selectAllySelections(state)) as TSupportedFaction[]\r\nexport const selectAllySelections = (state: IStore) => state.selections.allySelections\r\nexport const selectSelections = (state: IStore) => state.selections.selections\r\nexport const selectSideEffects = (state: IStore) => state.selections.sideEffects\r\n\r\n// Visibility\r\nexport const selectAllies = (state: IStore) => state.visibility.allies\r\nexport const selectReminders = (state: IStore) => state.visibility.reminders\r\nexport const selectSelectors = (state: IStore) => state.visibility.selectors\r\nexport const selectVisibility = (state: IStore) => state.visibility\r\nexport const selectWhen = (state: IStore) => state.visibility.when\r\n\r\n// Utils\r\nexport const selectCurrentArmy = (state: IStore): ICurrentArmy => {\r\n  return {\r\n    allyFactionNames: selectAllyFactionNames(state),\r\n    allySelections: selectAllySelections(state),\r\n    factionName: selectFactionName(state),\r\n    subFactionName: selectSubFactionName(state),\r\n    origin_realm: selectOriginRealm(state),\r\n    realmscape_feature: selectRealmscapeFeature(state),\r\n    realmscape: selectRealmscape(state),\r\n    selections: selectSelections(state),\r\n  }\r\n}\r\nexport const hasSelections = (state: IStore): boolean => {\r\n  const selections = selectSelections(state)\r\n  return Object.values(selections).some(x => x.length > 0)\r\n}\r\n","export const mapListToDict = (names: string[]) => {\r\n  return names.reduce((a, b) => {\r\n    a[b] = b\r\n    return a\r\n  }, {} as Record<string, string>)\r\n}\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_TURN,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  // Storm-forged Weapons\r\n  'Null Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Null Pendant - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Subtract 5 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Quicksilver Draught': {\r\n    effects: [\r\n      {\r\n        name: `Quicksilver Draught - Once Per Battle`,\r\n        desc: `Effect: This unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mirrorshield': {\r\n    effects: [\r\n      {\r\n        name: `Mirrorshield - Passive`,\r\n        desc: `Effect: This unit cannot be targeted by shooting attacks unless the attacking model is within 9\" of it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Hammer of Might': {\r\n    effects: [\r\n      {\r\n        name: `Hammer of Might`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If the unmodified wound roll for an attack made with that weapon is 6, double the Damage characteristic of that weapon for that attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fang of Dracothion': {\r\n    effects: [\r\n      {\r\n        name: `Fang of Dracothion`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If any wounds caused by attacks made with that weapon are allocated to an enemy model, that enemy model suffers 1 mortal wound at the end of each turn.`,\r\n        when: [WOUND_ALLOCATION_PHASE, END_OF_TURN],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  // Heavens-wrought Armour\r\n /* 'Drakescale Armour': {\r\n    effects: [\r\n      {\r\n        name: `Drakescale Armour`,\r\n        desc: `You can reroll save rolls for attacks made with weapons that have a Damage characteristic of 2 or more that target the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Mirrorshield: {\r\n    effects: [\r\n      {\r\n        name: `Mirrorshield`,\r\n        desc: `The bearer cannot be picked as the target of a shooting attack unless the attacking unit is within 9\" of the bearer.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amulet of Silvered Sigmarite': {\r\n    effects: [\r\n      {\r\n        name: `Amulet of Silvered Sigmarite`,\r\n        desc: `Your opponent cannot reroll hit rolls for attacks made with melee weapons that target the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Artefacts of the Tempest\r\n  'Quicksilver Draught': {\r\n    effects: [\r\n      {\r\n        name: `Quicksilver Draught`,\r\n        desc: `Once per battle, at the end of the charge phase, you can say that the bearer will drink their quicksilver draught. If you do so, the bearer fights at the start of the following combat phase, but the bearer cannot fight again in that phase unless an ability or spell allows them to fight more than once.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Luckstone: {\r\n    effects: [\r\n      {\r\n        name: `Luckstone`,\r\n        desc: `Once per battle, before you make a hit or wound roll for an attack made by the bearer, a save roll for an attack that targets the bearer, a run roll or a charge roll made by the bearer, you can say that the bearer will draw upon the power of the luckstone. If you do so, instead of making the roll, you must choose the result of the roll. The result chosen for a D6 roll must be a whole number from 1 to 6, and the result chosen for a 2D6 roll must be a whole number between 2 to 12. The result cannot be rerolled, but any modifiers are applied to it as normal.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Obsidian Amulet': {\r\n    effects: [\r\n      {\r\n        name: `Obsidian Amulet`,\r\n        desc: `Once per battle, at the start of the hero phase, you can say the bearer will raise their obsidian amulet. If you do so, ignore the effects of spells or the abilities of endless spells on the bearer until your next hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestium Ensign': {\r\n    effects: [\r\n      {\r\n        name: `Celestium Ensign`,\r\n        desc: `Once per battle, at the start of any phase, the bearer can say that they will raise their Celestium Ensign. If they do so, you can heal up to D3 wounds allocated to each friendly DRACONITH unit wholly within 9\" of the bearer.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SlayersBattalionEffect, StrategistsBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\nimport { WARDS_PHASE } from 'types/phases'\r\n\r\nconst Battalions = {\r\n /* 'Redemption Brotherhood': {\r\n    effects: [OneDropDeploymentEffect],\r\n  },\r\n  'Brotherhood Command': {\r\n    effects: [StrategistsBattalionEffect],\r\n  },\r\n  'Soulstrike Brotherhood': {\r\n    effects: [SlayersBattalionEffect],\r\n  },\r\n  'The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Justice Will Be Served`,\r\n        desc: `Friendly THE BLACKTALONS units have a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst BattleTactics = {\r\n /* 'Concentrated Force': {\r\n    effects: [\r\n      {\r\n        name: `Concentrated Force`,\r\n        desc: `You complete this tactic if the same enemy unit was targeted by attacks made with melee weapons by 3 or more friendly DRACONITH SKY WING units in the combat phase of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Focused Destruction': {\r\n    effects: [\r\n      {\r\n        name: `Focused Destruction`,\r\n        desc: `You complete this tactic if the same enemy unit was picked as the target of 3 different monstrous rampages carried out by friendly DRACONITH SKY WING units in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Cleansing Strike': {\r\n    effects: [\r\n      {\r\n        name: `Cleansing Strike`,\r\n        desc: `Pick 2 objectives that are contested by enemy units. You complete this tactic if there are no enemy units contesting either objective at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Pioneers of the Realms': {\r\n    effects: [\r\n      {\r\n        name: `Pioneers of the Realms`,\r\n        desc: `You complete this tactic if all of the objectives wholly within your opponent's territory are contested by friendly CITIES OF SIGMAR units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'No Challenge Too Great': {\r\n    effects: [\r\n      {\r\n        name: `No Challenge Too Great`,\r\n        desc: `You complete this tactic if an enemy HERO is slain by wounds caused by an attack made with a melee weapon by a friendly REDEEMER unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hammerstrike Assault': {\r\n    effects: [\r\n      {\r\n        name: `Hammerstrike Assault`,\r\n        desc: `Pick 1 HERO in your opponent's starting army that is on the battlefield, that has a Wounds characteristic of 10 or more and that has 0 wounds allocated to it. You complete this tactic if that HERO is slain during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lightning-shattered Morale': {\r\n    effects: [\r\n      {\r\n        name: `Lightning-shattered Morale`,\r\n        desc: `Pick 1 unit in your opponent's starting army that is on the battlefield and that has a Bravery characteristic of 10 or more. You complete this tactic if any models in that unit flee during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Draconith Destruction': {\r\n    effects: [\r\n      {\r\n        name: `Draconith Destruction`,\r\n        desc: `Pick 1 unit in your opponent's starting army that is on the battlefield and that has 10 or more models. You complete this tactic if that unit is destroyed by wounds caused by attacks made by friendly DRACONITH, STARDRAKE or DRACOTH units during this turm.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'A Matter of Honour': {\r\n    effects: [\r\n      {\r\n        name: `A Matter of Honour`,\r\n        desc: `Pick 1 MONSTER in your opponent's starting army that is on the battlefield. You complete this tactic if that unit is destroyed by wounds caused by attacks made by friendly DRACONITH or STARDRAKE units during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Secure the Battlefield': {\r\n    effects: [\r\n      {\r\n        name: `Secure the Battlefield`,\r\n        desc: `You complete this battle tactic at the end of your turn if there are any friendly Stormcast Eternals units wholly within each large quarter of the battlefield and more than 6\" from all enemy units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { STORMCAST_ETERNALS } from 'meta/factions'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n  START_OF_ROUND,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\n/* const BlazeOfGloryEffect = {\r\n  name: `Blaze of Glory`,\r\n  desc: `If a friendly STORMCAST ETERNALS model is slain within 1\" of an enemy unit, before removing that model from play, pick 1 enemy unit within 1\" of that model and roll a number of dice equal to the Wounds characteristic of that slain model. Add 1 to the number of dice you roll if the slain model has the THUNDERSTRIKE keyword. For each 6+, the target suffers 1 mortal wound at the end of that phase.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true,\r\n} */\r\n\r\n/*const BattleTraits = {\r\n  'Scions of the Storm': {\r\n    effects: [\r\n      {\r\n        name: `Scions of the Storm`,\r\n        desc: `During deployment, instead of setting up a SCIONS OF THE STORM STORMCAST ETERNALS unit on the battlefield, you can place it to one side and say that it is set up in the Celestial Realm as a reserve unit. You can set up 1 unit in the Celestial Realm for each SCIONS OF THE STORM STORMCAST ETERNALS unit you have set up on the battlefield. At the end of your movement phase, you can set up 1 or more of the reserve units in the Celestial Realm on the battlefield, more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Scions of the Storm`,\r\n        desc: `At the end of your movement phase, you can set up 1 or more of the reserve units in the Celestial Realm on the battlefield, more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    \r\n    ],\r\n  },\r\n  Stormkeep: {\r\n    effects: [\r\n      {\r\n        name: `Shield of Civilisation`,\r\n        desc: `In the first and second battle rounds, if any friendly STORMKEEP REDEEMER units contest an objective that is partially or wholly within your territory, each model in that unit counts as 3 models for the purposes of contesting that objective. Starting from the third battle round, if any friendly STORMKEEP REDEEMER units contest an objective that is anywhere on the battlefield, each model in that unit counts as 3 models for the purposes of contesting that objective. In addition, if an enemy unit finishes a charge move within 1\" of a friendly STORMKEEP REDEEMER unit that is within 6\" of an objective you control, roll a dice. On a 3+, that unit suffers D3 mortal wounds.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Shield of Civilisation`,\r\n        desc: `If an enemy unit finishes a charge move within 1\" of a friendly STORMKEEP REDEEMER unit that is within 6\" of an objective you control, roll a dice. On a 3+, that unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Mortal Auxiliaries`,\r\n        desc: `Add 1 to the Bravery characteristic of friendly STORMKEEP units wholly within 12\" of any friendly STORMKEEP REDEEMER units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n\r\n    ],\r\n  },\r\n\r\n  'Draconith Skywing': {\r\n    effects: [\r\n      {\r\n        name: `Draconith Echelon`,\r\n        desc: `Friendly KRONDYS, KARAZAI, and STORMDRAKE GUARD units that have 2 models have the Battleline battlefield role.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Draconith Guardians`,\r\n        desc: `If a friendly IONUS CRYPTBORN is within 3\" of any friendly STORMDRAKE GUARD units, before you allocate a wound or mortal wound to that HERO, or instead of making a ward roll for a wound or mortal wound that would be allocated to that HERO, roll a dice. On a 4+, that wound or mortal wound is allocated to 1 of those friendly units instead of IONUS CRYPTBORN and cannot be negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Exemplars of Fury`,\r\n        desc: `At the start of the combat phase, if there are 2 or more other friendly DRACONITH SKYWING units within 6\" of a friendly HERO, add 1 to the Attacks characteristic of melee weapons used by that HERO'S mount until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stormdrake Champions`,\r\n        desc: `For each DRACONITH SKY WING HERO you include in your army, you can include 1 STORMDRAKE GUARD unit that has 1 model. That STORMDRAKE GUARD unit cannot have the Battleline battlefield role.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Heroic Action: Thunderous Roars`,\r\n        desc: `Pick 1 friendly DRACONITH SKYWING HERO and roll a dice. On a 2+, until the end of that turn, enemy units within 3\" of that HERO cannot receive the Inspiring Presence command.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  const BattleTraits = {\r\n    [STORMCAST_ETERNALS]: {\r\n      effects: [\r\n        {\r\n          name: `The Celestial Realm`,\r\n          desc: `Declare: If there are more friendly Stormcast Eternals units on the battlefield than there are set up in reserve, pick a friendly Stormcast Eternals unit that has not been deployed. \r\n          Effect: Set up that unit in reserve in the Celestial Realm. It has now been deployed.`,\r\n          when: [DURING_SETUP],\r\n        },\r\n        {\r\n          name: `Scions of the Storm`,\r\n          desc: `Declare: Pick a friendly Stormcast Eternals unit that is in the Celestial Realm. \r\n          Effect: Set up that unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Command Ability - Heavens-Sent - Once Per Battle`,\r\n          desc: `Declare: Pick a friendly non-Unique Stormcast Eternals Infantry or Cavalry unit that started the battle with 2 or more models and that has been destroyed to be the target. \r\n          Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) more than 9\" from all enemy units.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Their Finest Hour - Once Per Turn`,\r\n          desc: `Declare: Pick a friendly Stormcast Eternals unit that has not used this ability this battle to use this ability. \r\n          Effect: For the rest of the turn, add 1 to wound rolls for that units combat attacks and add 1 to save rolls for that unit.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n      ],\r\n    },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandAbilities = {\r\n  // Holy Commands\r\n /* 'Call for Aid': {\r\n    effects: [\r\n      {\r\n        name: `Call for Aid`,\r\n        desc: `You can use this command ability once per battle when a friendly REDEEMER unit with 5 or fewer models is destroyed. If you do so, pick 1 STORMCAST ETERNALS HERO on the battlefield. A new replacement unit identical to the unit that was destroyed is added to your army. Set up that unit wholly within 12\" of that STORMCAST ETERNALS HERO and more than 9\" from all enemy units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Steadfast March': {\r\n    effects: [\r\n      {\r\n        name: `Steadfast March`,\r\n        desc: `You can use this command ability once per battle at the start of your movement phase. The command can only be issued by a friendly KNIGHT to a unit wholly within 12\" of them or by a friendly LORD or DRACONITH to a unit wholly within 18\" of them. The unit that receives the command must be a friendly STORMCAST ETERNALS unit. Until your next hero phase, that unit can run and still charge later in the turn.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Thunderbolt Volley': {\r\n    effects: [\r\n      {\r\n        name: `Thunderbolt Volley`,\r\n        desc: `You can use this command ability once per battle in your hero phase. The command can only be issued by a friendly Knight to a unit wholly within 12\" of them or by a friendly Lord or Draconith to a unit wholly within 18\" of them. The unit that receives the command must be a friendly Justicar or Angelos unit that is not reinforced. That unit can shoot in that phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_STORMCAST_ETERNALS,\r\n          rule_sources.ERRATA_JULY_2022,\r\n          meta_rule_sources.BATTLESCROLL_GALLETIAN_CHAMPIONS_JANUARY_2022,\r\n          meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'Unleash Thy Hatred': {\r\n    effects: [\r\n      {\r\n        name: `Unleash Thy Hatred`,\r\n        desc: `You can use this command ability once per battle at the start of the combat phase. The command can only be issued by a friendly KNIGHT to a unit wholly within 12\" of them or by a friendly LORD or DRACONITH to a unit wholly within 18\" of them. The unit that receives the command must be a friendly PALADIN unit. Add 1 to the Attacks characteristic of that unit's melee weapons until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Final Thunderstrike': {\r\n    effects: [\r\n      {\r\n        name: `Final Thunderstrike`,\r\n        desc: `You can use this command ability once per battle at the start of the combat phase. The command can only be issued by a friendly KNIGHT to a unit wholly within 12\" of them or by a friendly LORD or DRACONITH to a unit wholly within 18\" of them. Ihe unit that receives the command must be a friendly STORMCAST ETERNALS unit. Until the end of that phase, add 1 to rolls for the Blaze of Glory battle trait (pg 106) when a model in that unit is slain.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandTraits = {\r\n  // Aspects of Azyr\r\n  'Shock and Awe': {\r\n    effects: [\r\n      {\r\n        name: `Shock and Awe - Passive`,\r\n        desc: `Effect: Each time a friendly Stormcast Eternals unit is set up wholly within 12\" of this unit using the Scions of the Storm ability, subtract 1 from hit rolls for attacks that target that unit for the rest of the battle round.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Staunch Defender': {\r\n    effects: [\r\n      {\r\n        name: `Staunch Defender - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective in friendly territory, add 3 to the control scores of all friendly Stormcast Eternals units contesting that objective.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Envoy of the Heavens': {\r\n    effects: [\r\n      {\r\n        name: `Envoy of the Heavens`,\r\n        desc: `Declare: If a friendly unit was destroyed in the previous turn, pick a visible friendly Stormcast Eternals unit wholly within 12\" of this unit to be the target. \r\n        Effect: The target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Master of the Celestial Menagerie': {\r\n    effects: [\r\n      {\r\n        name: `Master of the Celestial Menagerie`,\r\n        desc: `If this general has the Behemoth battlefield role and is on the battlefield, subtract 1 from wound rolls for attacks made with melee weapons that target friendly STORMCAST ETERNALS units that have the Behemoth battlefield role.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2021],\r\n      },\r\n    ],\r\n  },\r\n  'Favour the Bold': {\r\n    effects: [\r\n      {\r\n        name: `Favour the Bold`,\r\n        desc: `After this general has fought for the first time in the combat phase, if there are no enemy units within 3\" of this general, roll a dice. On a 2+, this general can immediately make a D6\" move and can finish that move within 3\" of any enemy units.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { COMBAT_PHASE, END_OF_HERO_PHASE, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst EndlessSpells = {\r\n  /*'Celestian Vortex': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and range of 6\". If successfully cast, set up the endless spell wholly within range and visible to the caster, and more than 1\" from all models and other endless spells or invocations. Only STORMCAST ETERNALS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Storm of Vengeance`,\r\n        desc: `After this endless spell has moved, the commanding player picks 1 unit that has any models it passed across and rolls 12 dice. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Tornado of Magic`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with missile weapons by units within 6\" of this endless spell. This ability has no effect on Stormcast Eternals units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dais Arcanum': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This endless spell is summoned with a spell that has a casting value of 5 and range of 3\". Wizards that have a Wounds characteristic of 8 or more, that are Unique, that are part of a unit that has 2 or more models, or that are already on a Dais Arcanum cannot attempt to cast this spell. If successfully cast, set up the endless spell within range and visible to the caster, more than 3\" from all terrain features and enemy models, and more than 1\" from all other models, endless spells and invocations. Then place the caster on top of the endless spell.\r\n\r\n        For rules purposes, the caster and this endless spell are treated as a single model in the caster's army that uses the caster's warscroll as well as the endless spell rules (core rules, 19.3). A Wizard on a Dais Arcanum has a Move characteristic of 12\" and can fly.\r\n\r\n        If the caster attempts to dispel this endless spell, it is automatically dispelled (do not make a dispelling roll). If the caster is slain, this endless spell is dispelled. If this endless spell is dispelled and the caster has not been slain, before removing the endless spell from play, set up the caster wholly within 6\" of the endless spell and more than 3\" from all enemy units.\r\n        \r\n        Only STORMCAST ETERNALS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n      {\r\n        name: `Arcane Enhancement`,\r\n        desc: `A Wizard on a Dais Arcanum can attempt to unbind 1 extra spell in the enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Winds of Azyr`,\r\n        desc: `Subtract 1 from hit rolls for attacks that target a Wizard on a Dais Arcanum.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Everblaze Comet': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and range of 36\". If successfully cast, set up the endless spell wholly within range and visible to the caster, and more than 1\" from all models and other endless spells or invocations. Only STORMCAST ETERNALS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n      {\r\n        name: `Arcane Disruption`,\r\n        desc: `Subtract 1 from casting rolls for Wizards within 10\" of this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Vengeance`,\r\n        desc: `After this endless spell is set up, roll a dice for each unit within 10\" of this endless spell. On a 1, that unit suffers 1 mortal wound. On a 2-5, that unit suffers D3 mortal wounds. On a 6, that unit suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Sentinels of the Bleak Citadels': {\r\n    effects: [\r\n      {\r\n        name: `Ancient Aura - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Ruination Chamber unit. \r\n        Effect: That unit has Ward (5+) for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Thunderhead Host': {\r\n    effects: [\r\n      {\r\n        name: `Synchronised Strikes - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks made by friendly Warrior Chamber units while they are wholly within 12\" of any friendly non-Hero Stormcast Eternals units that do not have the Warrior Chamber keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vanguard Wing': {\r\n    effects: [\r\n      {\r\n        name: `Peerless Manoeuvres - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Vanguard Chamber unit that is not in combat. \r\n        Effect: Roll a dice. On a 3+, remove that unit from the battlefield and set it up again anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lightning Echelon': {\r\n    effects: [\r\n      {\r\n        name: `Oncoming Storm - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Extremis Chamber unit that charged this turn. \r\n        Effect: Roll a dice. On a 3+, that unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Knights Excelsior': {\r\n    effects: [\r\n      {\r\n        name: `Annihilation`,\r\n        desc: `Once per turn, at the start of the combat phase, you can pick 1 friendly KNIGHTS EXCELSIOR PALADIN unit on the battlefield. Until the end of that phase, when you pick that unit to fight, pick 1 enemy unit within 1\" of that unit. If the number of models in that enemy unit is greater than the number of models in that PALADIN unit, add 1 to hit and wound rolls for attacks made by that PALADIN unit that target that enemy unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Warbringers': {\r\n    effects: [\r\n      {\r\n        name: `Fearless Foresight`,\r\n        desc: `Once per phase, you can reroll 1 hit roll or 1 wound roll for an attack made bv a friendly CELESTIAL WARBRINGERS unit or 1 save roll for an attack that targets a friendly CELESTIAL WARBRINGERS unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Tempest Lords': {\r\n    effects: [\r\n      {\r\n        name: `The Host on High`,\r\n        desc: `When you attempt a charge with a friendly TEMPEST LORDS unit that can fly, you can reroll 1 of the dice for that charge roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Astral Templars': {\r\n    effects: [\r\n      {\r\n        name: `Beast Stalkers`,\r\n        desc: `Friendly ASTRAL TEMPLARS units cannot be picked when your opponent carries out a monstrous rampage.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n  /*'Draconith Defiance': {\r\n    effects: [\r\n      {\r\n        name: `Draconith Defiance`,\r\n        desc: `When the battle ends, you complete this grand strategy if the only HEROES on the battlefield are friendly DRACONITH, STARDRAKE or DRACOTH units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Pillars of Victory': {\r\n    effects: [\r\n      {\r\n        name: `Pillars of Victory`,\r\n        desc: `When the battle ends, you complete this grand strategy if the only Battleline units on the battlefield are friendly REDEEMER units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Sacred Charge': {\r\n    effects: [\r\n      {\r\n        name: `Sacred Charge`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 2 or more friendly CITIES OF SIGMAR units on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'On Wings of Death': {\r\n    effects: [\r\n      {\r\n        name: `On Wings of Death`,\r\n        desc: `When the battle ends, you complete this grand strategy if 3 friendly DRACONITH units are wholly within 9\" of each other.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* Stun: {\r\n    effects: [\r\n      {\r\n        name: `Stun`,\r\n        desc: `Pick 1 enemy unit within 3\" of this unit and roll a dice. On a 3+, subtract 1 from wound rolls for attacks made by that unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Impact Tremors': {\r\n    effects: [\r\n      {\r\n        name: `Impact Tremors`,\r\n        desc: `Pick 1 enemy unit within 3\" of this unit and roll a dice. On a 3+, in the following combat phase, models in that unit can only move up to 1\" when they make a pile-in move instead of up to 3\"`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst MountTraits = {\r\n /* 'Aetheric Swiftness': {\r\n    effects: [\r\n      {\r\n        name: `Aetheric Swiftness`,\r\n        desc: `GRYPH-CHARGER, DRACOTH or DRACOLINE only. This unit is eligible to fight in the combat phase if it is within 6\" of an enemy unit instead of 3\", and it can move an extra 3\" when it piles in.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Light of the Young Stars': {\r\n    effects: [\r\n      {\r\n        name: `Light of the Young Stars`,\r\n        desc: `STARDRAKE only. You can choose this ability instead of carrying out a monstrous rampage (core rules, 21.1) with this unit. Pick 1 enemy unit within 1\" of this unit and roll a dice. On a 3+, subtract 1 from hit rolls for attacks made by that unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Celestial Instincts': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Instincts`,\r\n        desc: `This unit can retreat and still either shoot or charge in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Envoy of Lightning': {\r\n    effects: [\r\n      {\r\n        name: `Envoy of Lightning`,\r\n        desc: `If this unit is set up on the battlefield using the Scions of the Storm battle trait (pg 106), you can roll a dice for each enemy unit within 10\" of this unit after it is set up. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Scintillating Trail': {\r\n    effects: [\r\n      {\r\n        name: `Scintillating Trail`,\r\n        desc: `Subtract 1 from unbinding rolls for enemy WIZARDS for spells cast by friendly STORMCAST ETERNALS WIZARDS wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Thunderous Presence': {\r\n    effects: [\r\n      {\r\n        name: `Thunderous Presence`,\r\n        desc: `DRACONITH only. You can choose this ability instead of carrying out a monstrous rampage (core rules, 21.1) with this unit. Pick 1 enemy unit within 1\" of this unit and roll a dice. On a 3+, that unit cannot receive commands in the following battleshock phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MountTraits, 'mount_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Prayers = {\r\n 'Prayers of the Stormhosts': {\r\n    effects: [\r\n      {\r\n        name: `Healing Storm: Chant value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Priest to chant this prayer, pick a visible friendly Stormcast Eternals unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Heal (D3) the target. If the chanting roll was 8+, Heal (D3) each visible friendly Stormcast Eternals unit wholly within 12\" of the chanter instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bless Weapons: Chant value of 6`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Priest to chant this prayer, pick a visible friendly Stormcast Eternals Infantry unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons until the start of your next turn. If the chanting roll was 12+, this ability aects all visible friendly Stormcast Eternals units wholly within 12\" of the chanter.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Translocation: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Priest to chant this prayer, pick a visible friendly Stormcast Eternals unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. In addition, if the chanting roll was 8+, subtract 1 from hit rolls for attacks that target that unit for the rest of the battle round.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \r\n/*   Translocation: {\r\n    effects: [\r\n      {\r\n        name: `Translocation`,\r\n        desc: `Answer value of 3 and range of 9\" if the chanter is a KNIGHT or 12\" if the chanter is a LORD, If answered, pick 1 friendly STORMCAST ETERNALS unit wholly within range and visible to the chanter. You can remove that unit from the battlefield and set it up again anywhere on the battlefield more than 9\" from all enemy units. That unit cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2021],\r\n      },\r\n    ],\r\n  },\r\n  'Bless Weapons': {\r\n    effects: [\r\n      {\r\n        name: `Bless Weapons`,\r\n        desc: `Answer value of 3 and range of 12\" if the chanter is a KNIGHT or 18\" if the chanter is a LORD. If answered, pick 1 friendly STORMCAST ETERNALS unit wholly within range and visible to the chanter. Until your next hero phase, if the unmodified hit roll for an attack made by that unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit prayers\r\n  'Lightning Storm': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Storm`,\r\n        desc: `Answer value of 4 and range of 12\". If answered, pick 1 enemy unit within range and visible to the chanter. That unit suffers D3 mortal wounds. In addition, subtract 1 from hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Healing Storm': {\r\n    effects: [\r\n      {\r\n        name: `Healing Storm`,\r\n        desc: `Answer value of 4 and range of 12\". If answered, pick 1 friendly Stormcast Eternals unit wholly within range and visible to the chanter. Heal up to D3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Sanction: {\r\n    effects: [\r\n      {\r\n        name: `Sanction`,\r\n        desc: `Answer value of 4 and range of 12\". If answered, pick 1 enemy unit within range and visible to the chanter. That unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lightning Tempest': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Tempest`,\r\n        desc: `Answer value of 3 and a range of 18\". If answered, pick 1 enemy unit within range. That unit is struck by lightning and suffers D3 mortal wounds. Then, roll a dice. On a 1-2, the tempest clears and the sequence ends. On a 3+, pick 1 other enemy unit within 3\" of the last unit that was struck by lightning. \"Ihat unit is struck by lightning and suffers D3 mortal wounds. Keep rolling dice in this way until the tempest clears or there are no other enemy units within 3\" of the last unit to be struck by lightning. A unit cannot be affected by this prayer more than once per hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  // Draconith skywing\r\n  \"Sigmar's Grace\": {\r\n    effects: [\r\n      {\r\n        name: `Sigmar's Grace`,\r\n        desc: `Answer value of 3 and a range of 12\". If answered, pick 1 friendly unit wholly within range and visible to the chanter. You can heal up to 3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  Sanctification: {\r\n    effects: [\r\n      {\r\n        name: `Sanctification`,\r\n        desc: `Answer value of 4. If answered, until the start of your next hero phase, subtract 1 from casting rolls for enemy WIZARDS and subtract 1 from chanting rolls for enemy PRIESTS.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  Sovereignty: {\r\n    effects: [\r\n      {\r\n        name: `Sovereignty`,\r\n        desc: `Answer value of 4 and a range of 12\". If answered, pick 1 enemy unit within range. Until the start of your next hero phase, that unit counts as a maximum of 5 models for the purposes of contesting objectives.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  // Lore of the Storm\r\n  'Lore of the Storm': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Blast: Casting value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Wizard to cast this spell, then pick the closest visible enemy unit to them that has not been picked to be the target of this ability this turn to be the target. If 2 or more visible enemy units are tied to be the closest, you can pick which is the target. Then, make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Thundershock: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from wound rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Starfall: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Stormcast Eternals Wizard to cast this spell, pick a visible enemy Infantry or Cavalry unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from the number of dice rolled when making charge rolls for the target, to a minimum of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Lightning Blast': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Blast`,\r\n        desc: `Casting value of 5. The closest enemy unit that is visible to caster suffers D3 mortal wounds. If more than 1 enemy unit visible to the caster is equally close you can pick which unit is affected by this spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Azyrite Halo': {\r\n    effects: [\r\n      {\r\n        name: `Azyrite Halo`,\r\n        desc: `Casting value of 5 and range of 12\" if the caster is a KNIGHT or 18\" if the caster is a LORD or DRACONITH. Pick 1 friendly STORMCAST ETERNALS unit wholly within range and visible to the caster. Until your next hero phase, if the unmodified save roll for an attack that targets that unit is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Blades': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Blades`,\r\n        desc: `Casting value of 5 and range of 12\" if the caster is a KNIGHT or 18\" if the caster is a LORD or DRACONITH. Pick 1 friendly STORMCAST ETERNALS unit wholly within range and visible to the caster. Add 1 to wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chain Lightning': {\r\n    effects: [\r\n      {\r\n        name: `Chain Lightning`,\r\n        desc: `Casting value of 6 and range of 12\" if the caster is a KNIGHT or 18\" if the caster is a LORD or DRACONITH. Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. Then, roll a dice for each other enemy unit within 6\" of that unit. On a 3+, that other unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Thundershock: {\r\n    effects: [\r\n      {\r\n        name: `Thundershock`,\r\n        desc: `Casting value of 6 and range of 12\" if the caster is a KNIGHT or 18\" if the caster is a LORD or DRACONITH. If successfully cast, roll a dice for each enemy unit within range and visible to the caster. On a 3+, subtract 1 from wound rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Starfall: {\r\n    effects: [\r\n      {\r\n        name: `Starfall`,\r\n        desc: `Casting value of 5 and range of 12\" if the caster is a KNIGHT or 18\" if the caster is a LORD or DRACONITH. Pick 1 point on the battlefield within range and visible to caster. Roll a D6 for each enemy unit within 3\" of that point. On a 3+, that unit cannot make pile-in moves until the end of that turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit spells\r\n  'Lightning Pulse': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Pulse`,\r\n        desc: `Casting value of 6 and range of 6\". If successfully cast, subtract 1 from hit rolls for attacks made by enemy units within range until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pyroelectric Blast': {\r\n    effects: [\r\n      {\r\n        name: `Pyroelectric Blast`,\r\n        desc: `Casting value of 7 and range of 9\". Pick 1 point on the battlefield within range and visible to the caster. Each enemy unit within 3\" of that point suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Stormsire: {\r\n    effects: [\r\n      {\r\n        name: `Stormsire`,\r\n        desc: `Casting value of 7 and range of 18\". If successfully cast, each enemy unit within range suffers 1 mortal wound. Enemy units within 6\" of the caster suffer D3 mortal wounds instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blaze of the Heavens': {\r\n    effects: [\r\n      {\r\n        name: `Blaze of the Heavens`,\r\n        desc: `Casting value of 7 and range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. Add 2\" to the range of this spell for each other friendly Stormcast Eternals Thunderstrike unit wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spirit Storm': {\r\n    effects: [\r\n      {\r\n        name: `Spirit Storm`,\r\n        desc: `Casting value of 7 and range of 18\". If successfully cast, subtract 1 from run and charge rolls for enemy units within range until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Atavistic Tempest': {\r\n    effects: [\r\n      {\r\n        name: `Atavistic Tempest`,\r\n        desc: `Casting value of 9 and range of 24\". If successfully cast, pick 1 enemy unit within range and visible to the caster, then pick 1 of the effects below. That effect lasts until your next hero phase.\r\n\r\n        Blinding Gales: Subtract 1 from hit rolls for attacks made by that unit.\r\n\r\n        Meteor-hail: Worsen the Rend characteristic of weapons used by that unit by 1 (to a minimum of '-')\r\n\r\n        Lightning Vortex: Subtract 1 from the Attacks characteristic of missile weapons used by that unit (to a minimum of 1).\r\n\r\n        Flash-freezing Blizzard: Subtract 1 from save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Thunderclap: {\r\n    effects: [\r\n      {\r\n        name: `Thunderclap`,\r\n        desc: `Casting value of 6 and range of 18\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Storm Lance': {\r\n    effects: [\r\n      {\r\n        name: `Storm Lance`,\r\n        desc: `Casting value of 5 and range of 12\". Pick 1 point on the battlefield within range and visible to the caster and draw a straight line between that point and the closest part of the caster's base. Roll a dice for each enemy unit passed across by that line. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Healing Light': {\r\n    effects: [\r\n      {\r\n        name: `Healing Light`,\r\n        desc: `Casting value of 5 and range of 18\". Pick 1 friendly Stormcast Eternals unit within range. Heal up to D3 wounds allocated to that unit. If the unmodified casting roll was 8+, heal up to D6 wounds allocated to that unit instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lightning Orb': {\r\n    effects: [\r\n      {\r\n        name: `Lightning Orb`,\r\n        desc: `Casting value of 6 and range of 12\". Pick 1 point on the battlefield within range and visible to the caster. Roll a dice for each enemy unit within 3\" of that point. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Purifying Blast': {\r\n    effects: [\r\n      {\r\n        name: `Purifying Blast`,\r\n        desc: `Casting value of 5 and range of 12\". If successfully cast, roll a dice for each enemy unit within range. Add that unit's Bravery characteristic to the roll. If the result is 12 or less, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Empower: {\r\n    effects: [\r\n      {\r\n        name: `Empower`,\r\n        desc: `Casting value of 6 and range of 12\". Pick 1 friendly Redeemer or Sacrosanct unit wholly within range. Add 1 to wound rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Regal Authority': {\r\n    effects: [\r\n      {\r\n        name: `Regal Authority`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 friendly DRACONITH unit wholly within range and visible to the caster. Until the start of your next hero phase, each time that unit issues a command, roll a dice. On a 5+, the command point used to issue that command is not spent.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Nebulous Sea-fog': {\r\n    effects: [\r\n      {\r\n        name: `Nebulous Sea-fog`,\r\n        desc: `Casting value of 6. If cast, until the start of your next hero phase, shooting attacks that target friendly THE BLACKTALONS units that are wholly within 6\" of this unit only score a hit on an unmodified hit roll of 6.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport CitiesOfSigmarUnits from '../cities_of_sigmar/units'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport MountTraits from './mount_traits'\r\nimport Prayers from './prayers'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { STORMCAST_ETERNALS } from 'meta/factions'\r\n\r\nconst baseSubFaction = {\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    mount_traits: [MountTraits],\r\n    prayers: [Prayers],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n  effects: [],\r\n} satisfies IItemDescription\r\n\r\n\r\nconst subFactions = {\r\n  [STORMCAST_ETERNALS]: {\r\n    //  ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [STORMCAST_ETERNALS]),\r\n  \r\n      available: {\r\n        artifacts: [Artifacts],\r\n        battalions: [Battalions],\r\n        battle_tactics: [BattleTactics],\r\n        command_abilities: [CommandAbilities],\r\n        command_traits: [CommandTraits],\r\n        endless_spells: [EndlessSpells],\r\n        flavors: [Flavors],\r\n        grand_strategies: [GrandStrategies],\r\n        monstrous_rampages: [MonstrousRampages],\r\n        mount_traits: [MountTraits],\r\n        prayers: [Prayers],\r\n        spells: [Spells],\r\n        units: [Units],\r\n      },\r\n    }, \r\n \r\n\r\n/*const subFactions = {\r\n  'Scions of the Storm': {\r\n    effects: pickEffects(BattleTraits, ['Scions of the Storm']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      command_traits: [\r\n        keyPicker(CommandTraits, [\r\n          'Shock and Awe',\r\n          'Envoy of the Heavens',\r\n          'Master of the Celestial Menagerie',\r\n        ]),\r\n      ],\r\n    },\r\n  },\r\n  Stormkeep: {\r\n    effects: pickEffects(BattleTraits, ['Stormkeep']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      allied_units: [CitiesOfSigmarUnits],\r\n      command_traits: [\r\n        keyPicker(CommandTraits, [\r\n          'Staunch Defender',\r\n          'Envoy of the Heavens',\r\n          'Master of the Celestial Menagerie',\r\n        ]),\r\n      ],\r\n    },\r\n  },\r\n\r\n  'Draconith Skywing': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Draconith Skywing']),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { STORMCAST_ETERNALS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const StormcastFaction = new Faction(\r\n  STORMCAST_ETERNALS,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_STORMCAST_ETERNALS\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  'Core Legions': {\r\n    effects: [\r\n      {\r\n        name: `Deathless Minions`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to a friendly DEATH unit within 6\" of your general or another friendly DEATH HERO. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `The Unquiet Dead`,\r\n        desc: `After territories have been determined, but before any units have been set up, you may pick up to 2 points in your territory and up to 2 points anywhere on the battlefield to be gravesites. You may wish to place suitable markers on these points. Instead of setting up a SUMMONABLE unit on the battlefield, you can place it to one side and say that it is set up in the grave. You can do this with as many units as you wish.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Unquiet Dead`,\r\n        desc: `At the end of your movement phase, for each friendly DEATH HERO within 9\" of a gravesite, you may pick a single friendly unit in the grave and set it up wholly within 9\" of the gravesite and more than 9\" from any enemy models. Any model that is unable to be set up in this way is slain. If a unit is still in the grave at the end of the battle, it is considered to be slain.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Invigorating Aura`,\r\n        desc: `At the start of your hero phase, pick a friendly SUMMONABLE unit within 9\" of this gravesite. You can either heal D3 wounds that have been allocated to it or, if no wounds are currently allocated to the unit, you may return a number of slain models to it that have a combined Wounds characteristic equal to or less than the roll of a D3.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Locus of Shyish`,\r\n        desc: `When you cast any spell from any lore and the unmodified casting roll is 9+, then resolve the spell effect twice.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grand Host of Nagash': {\r\n    effects: [\r\n      {\r\n        name: `Chosen Guardians`,\r\n        desc: `Add 1 to the Attacks characteristic of all melee weapons used by GRAND HOST OF NAGASH MORGHAST units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Legions Innumerable`,\r\n        desc: `In your hero phase, you may roll a D6 for each friendly GRAND HOST OF NAGASH SUMMONABLE unit on the battlefield. On a 5+ you can heal up to D3 wounds that have been allocated to it. For units with a Wounds characteristic of 1, return 1 slain model to the unit for each wound that would have been healed.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Grand Host of Nagash`,\r\n        desc: `This is Nagash's Legion/new overall Death force and it can include any units in the battletome. If it includes Nagash he must be the general.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  /*'Legion of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Favored Retainers`,\r\n        desc: `Legion of Blood Vampire Lords and Blood Knights gain +1 attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Immortal Majesty`,\r\n        desc: `Subtract 1 from bravery for any enemy unit within 6\" of any Legion of Blood units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Legion of Blood`,\r\n        desc: `This is Neferata's legion, if she is included in this army, she MUST be the army general and if you include any Mortarch units she has to be one of them.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n  'Legion of Night': {\r\n    effects: [\r\n      {\r\n        name: `The Bait`,\r\n        desc: `Add 1 to save rolls for friendly LEGION OF NIGHT DEATHRATTLE units that are wholly within your territory.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Ageless Cunning`,\r\n        desc: `Instead of setting up a LEGION OF NIGHT unit on the battlefield, you can place it to one side and say that it is set up in ambush. You can do this with up to 3 units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Ageless Cunning`,\r\n        desc: `At the end of any of your movement phases, you can set up any of the units in ambush wholly within 6\" of any battlefield edge and more than 9\" away from any enemy models.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Legion of Night`,\r\n        desc: `This is Mannfred's legion, if he is included in this army he MUST be the army general and if you include any Mortarch units he has to be one of them.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Legion of Sacrament': {\r\n    effects: [\r\n      {\r\n        name: `The Master's Teachings`,\r\n        desc: `Whenever an enemy unit is destroyed, before removing the last model, you may pick one of your gravesites within 6\" of that model. Roll a D6, then remove the model. On a 4+, you may pick a friendly SUMMONABLE unit that has been destroyed and set it up again wholly within 9\" of that gravesite and more than 9\" from any enemy models.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Black Disciples`,\r\n        desc: `Friendly LEGION OF SACRAMENT WIZARDS may add +1 to casting rolls.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Legion of Sacrament`,\r\n        desc: `This is Arkhan's legion, if he is included in this army he MUST be the army general and if you include any Mortarch units he has to be one of them.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  Soulblight: {\r\n    effects: [\r\n      {\r\n        name: `Locus of Shyish`,\r\n        desc: `When you cast any spell from any lore and the unmodified casting roll is 9+, then resolve the spell effect twice.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Deathless Thralls`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to a friendly SOULBLIGHT unit within 6\" of your general or another SOULBLIGHT HERO from your army. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'Deathforged Chain': {\r\n    effects: [\r\n      {\r\n        name: `Deathforged Chain`,\r\n        desc: `At the start of your hero phase, the bearer heals 1 wound that has been allocated to it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Balefire Lantern': {\r\n    effects: [\r\n      {\r\n        name: `Balefire Lantern`,\r\n        desc: `Subtract 1 from wound rolls for enemy units within 6\" of the bearer. In addition, reroll successful casting rolls for enemy WIZARDS within 6\" of the bearer.`,\r\n        when: [HERO_PHASE, SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grave-sand Timeglass': {\r\n    effects: [\r\n      {\r\n        name: `Grave-sand Timeglass`,\r\n        desc: `Whilst the bearer is on the battlefield, once per battle, in your hero phase, you can pick an enemy HERO on the battlefield. The enemy hero suffers D3 mortal wounds. At the start of each of your subsequent hero phases, roll a D6. On a 4+ the enemy hero suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Grave-sand Timeglass`,\r\n        desc: `If active, roll a D6. On a 4+ the enemy hero suffers 1 mortal wound.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ossific Diadem': {\r\n    effects: [\r\n      {\r\n        name: `Ossific Diadem`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to a friendly DEATHRATTLE model within 12\" of the bearer. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amethyst Shard': {\r\n    effects: [\r\n      {\r\n        name: `Amethyst Shard`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will merge the shard with one of their melee weapons. Pick one of the bearer's melee weapons. Until your next hero phase, add 1 to hit and wound rolls made for that weapon.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terrorgheist Mantle': {\r\n    effects: [\r\n      {\r\n        name: `Terrorgheist Mantle`,\r\n        desc: `In your shooting phase, you can declare that the bearer will unleash a death shriek. Pick an enemy unit within 10\" of the bearer and roll 2 dice. If the total is higher than the enemy unit's Bravery characteristic, it suffers a number of mortal wounds equal to the difference.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, START_OF_COMBAT_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Master of Death': {\r\n    effects: [\r\n      {\r\n        name: `Master of Death`,\r\n        desc: `Reroll results of 1 (i.e. rolls of 1-2 on a D3) for friendly units affected by a Deathly Invocation ability that are within 12\" of this general.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chosen Champion': {\r\n    effects: [\r\n      {\r\n        name: `Chosen Champion`,\r\n        desc: `Add 1 to the Damage characteristic of melee weapons used by this general for attacks made against enemy HEROES.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bane of the Living': {\r\n    effects: [\r\n      {\r\n        name: `Bane of the Living`,\r\n        desc: `Reroll wound rolls of 1 for this general for attacks made against enemy units that do not have the DEATH keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aura of Ages': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Ages`,\r\n        desc: `At the start of the combat phase, roll a D6 for each enemy unit within 3\" of this general. On a 4+ subtract 1 from hit rolls made for that unit until the end of the combat phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ancient Strategist': {\r\n    effects: [\r\n      {\r\n        name: `Ancient Strategist`,\r\n        desc: `Reroll failed charge rolls for friendly DEATHRATTLE and MORGHAST units that are within 9\" of this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Nagashizzar': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Nagashizzar`,\r\n        desc: `Add 1 to the Attacks characteristic of melee weapons used by friendly DEATHRATTLE units that are within 6\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_SETUP, HERO_PHASE, SAVES_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'Ring of Dominion': {\r\n    effects: [\r\n      {\r\n        name: `Ring of Dominion`,\r\n        desc: `When the bearer is selected to fight in the combat phase, you can pick an enemy model within 3\" of them and roll a D6. On a 5+ you can pick a melee weapon that the enemy model is armed with (though not one that has a value for one or more characteristics that is given as '*' or 'See below'). For this combat phase, the bearer of this ring may attack with that weapon in addition to their own. Abilities, modifiers or rerolls that apply to attacks made with that weapon when it is used by the enemy model do not apply to the attacks made with it by the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shadeglass Decanter': {\r\n    effects: [\r\n      {\r\n        name: `Shadeglass Decanter`,\r\n        desc: `After armies have been set up but before the first battle round, select an enemy HERO. In your hero phase, as long as that hero is on the battlefield, you can roll a D6. If the result is higher than the number of the current battle round, that hero suffers 1 mortal wound.`,\r\n        when: [DURING_SETUP, HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orb of Enchantment': {\r\n    effects: [\r\n      {\r\n        name: `Orb of Enchantment`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick an enemy HERO within 3\" of the bearer. In that combat phase, that enemy hero may not pile in, attack or use abilities.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soulbound Garments': {\r\n    effects: [\r\n      {\r\n        name: `Soulbound Garments`,\r\n        desc: `Reroll save rolls of 1 for the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Oubliette Arcana': {\r\n    effects: [\r\n      {\r\n        name: `Oubliette Arcana`,\r\n        desc: `When an enemy WIZARD successfully casts a spell within 30\" of the bearer, instead of attempting to unbind it you can declare that the Oubliette Arcana will attempt to capture the magical energies. Roll a D6. On a 6+ the spell is negated and has no effect. In addition, that spell may not be cast again by that WIZARD for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amulet of Screams': {\r\n    effects: [\r\n      {\r\n        name: `Amulet of Screams`,\r\n        desc: `Once per battle, when an enemy Wizard successfully casts a spell, you can declare that the bearer will use the Amulet of Screams. If you do so, you cannot attempt to unbind the spell. Instead, roll a D6. On a 2+, the spell is not successfully cast.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n} from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Swift Strikes': {\r\n    effects: [\r\n      {\r\n        name: `Swift Strikes`,\r\n        desc: `Each time you make a hit roll of 6+ in the combat phase for this general, you can make one additional hit roll for the same weapon against the same target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul-crushing Contempt': {\r\n    effects: [\r\n      {\r\n        name: `Soul-crushing Contempt`,\r\n        desc: `If this general slays any models in the combat phase, subtract 1 from the Bravery characteristic of the slain model's unit until the end of the turn.`,\r\n        when: [COMBAT_PHASE, BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aristocracy of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Aristocracy of Blood`,\r\n        desc: `You can reroll failed charge rolls for friendly SOULBLIGHT units that are within 9\" of this general at the start of the charge phase.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aura of Dark Majesty': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Dark Majesty`,\r\n        desc: `Subtract 1 from the hit rolls of attacks that target this general in the combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Walking Death': {\r\n    effects: [\r\n      {\r\n        name: `Walking Death`,\r\n        desc: `If the hit roll for an attack made with one of this general's melee weapons is 6+, do not roll to wound. Instead, the target suffers a number of mortal wounds equal to the Damage characteristic of that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sanguine Blur': {\r\n    effects: [\r\n      {\r\n        name: `Sanguine Blur`,\r\n        desc: `Add 2\" to this general's Move characteristic. In addition, you can reroll failed charge rolls for this general.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DURING_SETUP, HERO_PHASE, SHOOTING_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'Vial of Pure Blood': {\r\n    effects: [\r\n      {\r\n        name: `Vial of Pure Blood`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will drink from the Vial of Pure Blood. If you do so, you can add 1 to hit and wound rolls for the bearer until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shard of Night': {\r\n    effects: [\r\n      {\r\n        name: `Shard of Night`,\r\n        desc: `Subtract 1 from the hit rolls of attacks that target the bearer in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gem of Exsanguination': {\r\n    effects: [\r\n      {\r\n        name: `Gem of Exsanguination`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick an enemy unit within 6\" of the bearer and roll a D6. On a 1 nothing happens. On a 2-5 the unit suffers D3 mortal wounds. On a 6+ the unit suffers D6 mortal wounds.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chiropteric Cloak': {\r\n    effects: [\r\n      {\r\n        name: `Chiropteric Cloak`,\r\n        desc: `At the start of the combat phase, you can declare that the bearer will feed the Chiropteric Cloak. If you do so, the bearer suffers 1 mortal wound. During that combat phase, each time the hit roll of an attack that targets the bearer is 1 or less, the attacking unit suffers 1 mortal wound after all its attacks have been resolved.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Morbheg's Claw\": {\r\n    effects: [\r\n      {\r\n        name: `Morbheg's Claw`,\r\n        desc: `In your hero phase, you can declare that the bearer will carve sigils in the ground with this claw. If you do so, they may not move, charge or attack this turn, but you can add 2 to casting rolls made for friendly LEGION OF NIGHT WIZARDS within 12\" of the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Curseblade: {\r\n    effects: [\r\n      {\r\n        name: `Curseblade`,\r\n        desc: `After armies have been set up but before the first battle round begins, you can pick an enemy HERO. In your hero phase, as long as the enemy hero is on the battlefield, you can roll a D6. On a 4+ that enemy hero suffers 1 mortal wound and you may heal a wound that has been allocated to the bearer.`,\r\n        when: [DURING_SETUP, HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, DURING_SETUP, MOVEMENT_PHASE } from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Above Suspicion': {\r\n    effects: [\r\n      {\r\n        name: `Above Suspicion`,\r\n        desc: `This general may be set up in ambush in addition to the 3 units normally allowed by the Ageless Cunning battle trait.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Swift Form': {\r\n    effects: [\r\n      {\r\n        name: `Swift Form`,\r\n        desc: `Add 2\" to this general's Move characteristic. In addition, add 2\" to the distance they can move when they run.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unbending Will': {\r\n    effects: [\r\n      {\r\n        name: `Unbending Will`,\r\n        desc: `Friendly LEGION OF NIGHT units within 12\" of this general may reroll failed battleshock tests.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Merciless Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Merciless Hunter`,\r\n        desc: `Reroll wound rolls of 1 for this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unholy Impetus': {\r\n    effects: [\r\n      {\r\n        name: `Unholy Impetus`,\r\n        desc: `If this general slays any models in the combat phase, pick a friendly LEGION OF NIGHT unit within 3\" of the general. Add 1 to the Attacks characteristic of that unit's melee weapons until the end of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terrifying Visage': {\r\n    effects: [\r\n      {\r\n        name: `Terrifying Visage`,\r\n        desc: `Subtract 1 from the Bravery characteristic of enemy units within 6\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_TURN, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'Spirit Cage': {\r\n    effects: [\r\n      {\r\n        name: `Spirit Cage`,\r\n        desc: `Whenever an enemy HERO is slain within 6\" of the bearer, add 1 to wound rolls for friendly DEATH units within 12\" of the bearer until the end of the turn.`,\r\n        when: [DURING_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Shroud of Darkness': {\r\n    effects: [\r\n      {\r\n        name: `Shroud of Darkness`,\r\n        desc: `Subtract 1 from the hit rolls of attacks that target the bearer in the shooting phase if the attacking unit is within 8\" of the bearer. Subtract 2 from the hit rolls of attacks that target the bearer in the shooting phase if the attacking unit is more than 8\" away from the bearer.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Asylumaticae: {\r\n    effects: [\r\n      {\r\n        name: `Asylumaticae`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will open the Asylumaticae. If you do so, roll a D6. On a 1 the bearer suffers a mortal wound. On a 2+ each enemy unit within 12\" of the bearer suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wristbands of Black Gold': {\r\n    effects: [\r\n      {\r\n        name: `Wristbands of Black Gold`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to the bearer in the shooting phase. On a 4+ the wound is negated.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Azyrbane Standard': {\r\n    effects: [\r\n      {\r\n        name: `Azyrbane Standard`,\r\n        desc: `Subtract 1 from wound rolls for enemy units within 6\" of the bearer. In addition, reroll successful casting rolls for ORDER WIZARDS within 6\" of the bearer.`,\r\n        when: [HERO_PHASE, SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Gem': {\r\n    effects: [\r\n      {\r\n        name: `Black Gem`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will shatter the Black Gem. Pick a point on the battlefield within 8\" of the bearer. Roll a D6 for each unit within 3\" of this point. On a 6+, one model from that unit is slain. If the unit has any models with wounds allocated to it, then that model must be the model that is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Emissary of the Master': {\r\n    effects: [\r\n      {\r\n        name: `Emissary of the Master`,\r\n        desc: `You can reroll failed charge rolls for friendly DEATH units that are within 6\" of this general at the start of the charge phase.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mark of the Favoured': {\r\n    effects: [\r\n      {\r\n        name: `Mark of the Favoured`,\r\n        desc: `Each time this general is selected as the target of an attack in the combat phase, roll a D6. On a 6+ the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dark Acolyte': {\r\n    effects: [\r\n      {\r\n        name: `Dark Acolyte`,\r\n        desc: `This general is a WIZARD that knows the Arcane Bolt and Mystic Shield spells, as well as a single spell from one of the Lores of the Dead. If this general is already a WIZARD, they may generate an additional spell from one of the Lores of the Dead.`,\r\n        when: [DURING_SETUP, HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mastery of Death': {\r\n    effects: [\r\n      {\r\n        name: `Mastery of Death`,\r\n        desc: `At the start of your hero phase, all friendly DEATH units within 6\" of this general may immediately make a move of up to 3\" as if it were your movement phase. They may not run as part of this move.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Peerless Commander': {\r\n    effects: [\r\n      {\r\n        name: `Peerless Commander`,\r\n        desc: `This general may summon a unit from a gravesite whilst they are within 12\" rather than 9\".`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bound to the Master': {\r\n    effects: [\r\n      {\r\n        name: `Bound to the Master`,\r\n        desc: `This general may use Arkhan the Black's First of the Mortarchs command ability.\\n\\n (Until the end of the hero phase all friendly DEATH WIZARDS within 18\" of this general can increase the range of their spells by 6\".)`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'The Stalking Blade': {\r\n    effects: [\r\n      {\r\n        name: `The Stalking Blade`,\r\n        desc: `Pick one of the bearer's melee weapons. Keep a tally of the number of wounds allocated as a result of attacks made with that weapon. As soon as the total reaches 6 or more, the bearer heals D3 wounds that have been allocated to them, and you can add 1 to the Damage characteristic of that weapon for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Scabbing Plate': {\r\n    effects: [\r\n      {\r\n        name: `The Scabbing Plate`,\r\n        desc: `At the end of any combat phase in which the bearer caused any wounds to be allocated to any enemy models, you can heal 1 wound that has been allocated to the bearer.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crimson Wing': {\r\n    effects: [\r\n      {\r\n        name: `Crimson Wing`,\r\n        desc: `In your shooting phase, you can pick an enemy unit within 30\" of the bearer and roll a D6. On a roll of 3+ that unit suffers 1 mortal wound.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sigil of the Sanguine Throne': {\r\n    effects: [\r\n      {\r\n        name: `Sigil of the Sanguine Throne`,\r\n        desc: `Once per charge phase, you can reroll a failed charge roll made for a friendly VAMPIRE unit within 12\" of the bearer.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Saccharine Goblet': {\r\n    effects: [\r\n      {\r\n        name: `The Saccharine Goblet`,\r\n        desc: `At start of the combat phase, you can declare that the bearer will drink from the Saccharine Goblet. If you do so, you can add 1 to hit and wound rolls for the bearer until the end of the phase. However, if no wounds are allocated as a result of these attacks, then the bearer suffers D3 mortal wounds.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ruby Vial': {\r\n    effects: [\r\n      {\r\n        name: `Ruby Vial`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will open the Ruby Vial. If you do so, then until your next hero phase, subtract 1 from the Bravery characteristic of enemy units and subtract 1 from the result of any charge rolls made for them.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_GAME, MOVEMENT_PHASE } from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Curse of the Revenant': {\r\n    effects: [\r\n      {\r\n        name: `Curse of the Revenant`,\r\n        desc: `Add 1 to this general's Wounds characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Deathless Duelist': {\r\n    effects: [\r\n      {\r\n        name: `Deathless Duelist`,\r\n        desc: `Reroll hits rolls of 1 for this general when they attack an enemy HERO in the combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Transfix: {\r\n    effects: [\r\n      {\r\n        name: `Transfix`,\r\n        desc: `At the start of the combat phase, pick one enemy HERO within 3\" of this general. Until the end of the phase, subtract 1 from hit rolls for the model you picked when it targets the general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mist Form': {\r\n    effects: [\r\n      {\r\n        name: `Mist Form`,\r\n        desc: `If this general retreats, they can move as if they can fly and they can still charge in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Killing Blow': {\r\n    effects: [\r\n      {\r\n        name: `Killing Blow`,\r\n        desc: `Wound rolls of 6+ for attacks made by this general in the combat phase inflict a mortal wound in addition to any other damage they inflict.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Fury': {\r\n    effects: [\r\n      {\r\n        name: `Blood Fury`,\r\n        desc: `Add 1 to the Attacks characteristic of melee weapons used by this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { COMBAT_PHASE, DURING_GAME, HERO_PHASE, MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'The Bloodlines: Dragon Warriors': {\r\n    effects: [\r\n      {\r\n        name: `The Bloodlines: Dragon Warriors`,\r\n        desc: `You can reroll hit rolls of 1 for models that have the Dragon Warriors bloodline if they charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Bloodlines: Lords of Night': {\r\n    effects: [\r\n      {\r\n        name: `The Bloodlines: Lords of Night`,\r\n        desc: `Models with the Lords of Night bloodline receive the benefit of the Deathless Thralls battle trait even if they are not within 6\" of the general or another friendly SOULBLIGHT HERO.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Bloodlines: Necromantic': {\r\n    effects: [\r\n      {\r\n        name: `The Bloodlines: Necromantic`,\r\n        desc: `Add 1 to casting and unbinding rolls for WIZARDS with the Necromantic bloodline. In addition, subtract 1 from the Bravery characteristic of enemy units that are within 6\" of one or more models with the Necromantic bloodline.`,\r\n        when: [HERO_PHASE, DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Bloodlines: Swift Death': {\r\n    effects: [\r\n      {\r\n        name: `The Bloodlines: Swift Death`,\r\n        desc: `Add 2\" to the Move characteristic of all models that have the Swift Death bloodline. In addition, Swift Death models can always move as if they can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport NighthauntEndlessSpells from '../nighthaunt/endless_spells'\r\nimport NighthauntUnits from '../nighthaunt/units'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport GHoNArtifacts from './grand_host_of_nagash/artifacts'\r\nimport GHoNCommandTraits from './grand_host_of_nagash/command_traits'\r\nimport LegionOfBloodArtifacts from './legion_of_blood/artifacts'\r\nimport LegionOfBloodCommandTraits from './legion_of_blood/command_traits'\r\nimport LegionOfNightArtifacts from './legion_of_night/artifacts'\r\nimport LegionOfNightCommandTraits from './legion_of_night/command_traits'\r\nimport LegionOfSacramentArtifacts from './legion_of_sacrament/artifacts'\r\nimport LegionOfSacramentCommandTraits from './legion_of_sacrament/command_traits'\r\nimport SoulblightArtifacts from './soulblight/artifacts'\r\nimport SoulblightCommandTraits from './soulblight/command_traits'\r\nimport SoulblightFlavors from './soulblight/flavors'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\n\r\nconst baseSubFaction = {\r\n  effects: pickEffects(BattleTraits, ['Core Legions']),\r\n  mandatory: {\r\n    command_abilities: [keyPicker(CommandAbilities, ['Endless Legions'])],\r\n  },\r\n  available: {\r\n    battalions: [],\r\n    command_abilities: [CommandAbilities],\r\n    spells: [Spells],\r\n    units: [\r\n      Units,\r\n      keyPicker(NighthauntUnits, [\r\n        'Cairn Wraith',\r\n        'Chainrasps',\r\n        'Glaivewraith Stalkers',\r\n        'Grimghast Reapers',\r\n        'Guardian of Souls',\r\n        'Hexwraiths',\r\n        'Knight of Shrouds on Ethereal Steed',\r\n        'Knight of Shrouds',\r\n        'Lord Executioner',\r\n        'Spirit Hosts',\r\n        'Spirit Torment',\r\n        'Tomb Banshee',\r\n      ]),\r\n    ],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  'Grand Host of Nagash': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Core Legions', 'Grand Host of Nagash']),\r\n\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      artifacts: [GHoNArtifacts],\r\n      command_traits: [GHoNCommandTraits],\r\n      endless_spells: [NighthauntEndlessSpells],\r\n    },\r\n  },\r\n  'Legion of Blood': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Core Legions', ]),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n\r\n      artifacts: [LegionOfBloodArtifacts],\r\n      command_traits: [LegionOfBloodCommandTraits],\r\n      endless_spells: [NighthauntEndlessSpells],\r\n    },\r\n  },\r\n  'Legion of Night': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Core Legions', 'Legion of Night']),\r\n\r\n    available: {\r\n      ...baseSubFaction.available,\r\n\r\n      artifacts: [LegionOfNightArtifacts],\r\n      command_traits: [LegionOfNightCommandTraits],\r\n      endless_spells: [NighthauntEndlessSpells],\r\n    },\r\n  },\r\n  'Legion of Sacrament': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Core Legions', 'Legion of Sacrament']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n\r\n      artifacts: [LegionOfSacramentArtifacts],\r\n      command_traits: [LegionOfSacramentCommandTraits],\r\n      endless_spells: [NighthauntEndlessSpells],\r\n    },\r\n  },\r\n  Soulblight: {\r\n    effects: pickEffects(BattleTraits, ['Soulblight']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      artifacts: [SoulblightArtifacts],\r\n      command_traits: [SoulblightCommandTraits],\r\n      flavors: [SoulblightFlavors],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { LEGIONS_OF_NAGASH } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LegionsOfNagashFaction = new Faction(LEGIONS_OF_NAGASH, DEATH, SubFactions)\r\n","import { TTurnWhen } from 'types/phases'\r\nimport { ISavedArmyFromApi } from 'types/savedArmy'\r\nimport { TThemeType } from 'types/theme'\r\n\r\nconst LOCAL_LOADED_ARMY_KEY = 'loadedArmy'\r\nconst LOCAL_REDEMPTION_KEY = 'redeem'\r\nconst LOCAL_REMINDER_ORDER = 'reminderOrder'\r\nconst LOCAL_SAVED_ARMIES_KEY = 'savedArmies'\r\nconst LOCAL_THEME_KEY = 'theme'\r\nconst LOCAL_USERNAME_KEY = 'userName'\r\n\r\nexport const hideNotificationBanner = (name: string) => localStorage.setItem(name, 'hidden')\r\nexport const getNotificationBanner = (name: string) => localStorage.getItem(name)\r\n\r\nexport const LocalRedemptionKey = {\r\n  clear: () => localStorage.removeItem(LOCAL_REDEMPTION_KEY),\r\n  get: () => {\r\n    const obj = localStorage.getItem(LOCAL_REDEMPTION_KEY)\r\n    if (!obj) return null\r\n    return JSON.parse(obj) as { giftId: string; userId: string }\r\n  },\r\n  set: (giftId: string, userId: string) => {\r\n    const obj = JSON.stringify({ giftId, userId })\r\n    localStorage.setItem(LOCAL_REDEMPTION_KEY, obj)\r\n  },\r\n}\r\n\r\nexport const LocalTheme = {\r\n  clear: () => localStorage.removeItem(LOCAL_THEME_KEY),\r\n  get: () => localStorage.getItem(LOCAL_THEME_KEY) as TThemeType | null,\r\n  set: (theme: TThemeType) => localStorage.setItem(LOCAL_THEME_KEY, theme),\r\n}\r\n\r\nexport const LocalUserName = {\r\n  clear: () => localStorage.removeItem(LOCAL_USERNAME_KEY),\r\n  get: () => localStorage.getItem(LOCAL_USERNAME_KEY),\r\n  set: (userName: string) => localStorage.setItem(LOCAL_USERNAME_KEY, userName),\r\n}\r\n\r\nexport const LocalSavedArmies = {\r\n  clear: () => localStorage.removeItem(LOCAL_SAVED_ARMIES_KEY),\r\n  get: () => {\r\n    const savedArmies = localStorage.getItem(LOCAL_SAVED_ARMIES_KEY)\r\n    if (!savedArmies) return []\r\n    return JSON.parse(savedArmies) as ISavedArmyFromApi[]\r\n  },\r\n  set: (savedArmies: ISavedArmyFromApi[]) => {\r\n    localStorage.setItem(LOCAL_SAVED_ARMIES_KEY, JSON.stringify(savedArmies))\r\n  },\r\n}\r\n\r\ntype TLoadedArmy = { id: string; armyName: string } | null\r\n\r\nexport const LocalLoadedArmy = {\r\n  get: () => {\r\n    const loadedArmy = localStorage.getItem(LOCAL_LOADED_ARMY_KEY)\r\n    if (!loadedArmy) return null\r\n    return JSON.parse(loadedArmy)\r\n  },\r\n  set: (loadedArmy: TLoadedArmy) => {\r\n    loadedArmy\r\n      ? localStorage.setItem(LOCAL_LOADED_ARMY_KEY, JSON.stringify(loadedArmy))\r\n      : localStorage.removeItem(LOCAL_LOADED_ARMY_KEY)\r\n  },\r\n}\r\n\r\ninterface IGetAll {\r\n  byId: {\r\n    [id: string]: Record<string, string[]>\r\n  }\r\n  current: Record<string, string[]>\r\n}\r\n\r\nexport const LocalReminderOrder = {\r\n  clear: () => localStorage.setItem(LOCAL_REMINDER_ORDER, JSON.stringify({ byId: {}, current: {} })),\r\n  get: (armyId?: string): Record<string, string[]> => {\r\n    const str = localStorage.getItem(LOCAL_REMINDER_ORDER)\r\n    if (!str) return {}\r\n    const reminders = JSON.parse(str) as IGetAll\r\n    if (!armyId) return reminders.current || {}\r\n    return reminders.byId?.[armyId] || {}\r\n  },\r\n  getAll: (): IGetAll => {\r\n    const str = localStorage.getItem(LOCAL_REMINDER_ORDER)\r\n    if (!str) return { byId: {}, current: {} }\r\n    const parsed = JSON.parse(str) as IGetAll\r\n    return parsed\r\n  },\r\n  getWhen: (when: TTurnWhen): string[] => {\r\n    const existingReminders = LocalReminderOrder.get()\r\n    return existingReminders[when] || []\r\n  },\r\n  setByWhen: (when: TTurnWhen, ids: string[]): void => {\r\n    const existingData = LocalReminderOrder.getAll()\r\n\r\n    const newData = {\r\n      current: {\r\n        ...(existingData.current || {}),\r\n        [when]: ids,\r\n      },\r\n      byId: existingData.byId || {},\r\n    }\r\n\r\n    localStorage.setItem(LOCAL_REMINDER_ORDER, JSON.stringify(newData))\r\n  },\r\n\r\n  setById: (armyId: string, orderedReminders?: Record<string, string[]>): void => {\r\n    const existingData = LocalReminderOrder.getAll()\r\n\r\n    const newData = {\r\n      current: existingData.current,\r\n      byId: {\r\n        ...(existingData?.byId || {}),\r\n        [armyId]: orderedReminders || {},\r\n      },\r\n    }\r\n\r\n    localStorage.setItem(LOCAL_REMINDER_ORDER, JSON.stringify(newData))\r\n  },\r\n\r\n  makeIdActive: (armyId: string): void => {\r\n    const dataFromId = LocalReminderOrder.get(armyId)\r\n    console.log('making active', dataFromId)\r\n\r\n    const newData = {\r\n      current: dataFromId,\r\n      byId: LocalReminderOrder.getAll().byId,\r\n    }\r\n\r\n    localStorage.setItem(LOCAL_REMINDER_ORDER, JSON.stringify(newData))\r\n  },\r\n}\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  START_OF_COMBAT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst ChaosArtifacts = {\r\n /* 'Daemon Weapon (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Daemon Weapon (Chaos)`,\r\n        desc: `Pick one of the bearer's melee weapons. Each time you roll a wound roll of 6+ for that weapon, that attack inflicts 1 mortal wound in addition to its normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Runeblade (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Chaos Runeblade (Chaos)`,\r\n        desc: `Pick one of the bearer's melee weapons. Increase the Attacks characteristic of that weapon by 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Beguiling Gem (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Beguiling Gem (Chaos)`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick one enemy model within 3\" of the bearer. Subtract 1 from hit rolls made for that model in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Talisman (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Chaos Talisman (Chaos)`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to the bearer. On a 6+, the wound is negated. Add 1 to the roll if the wound was inflicted by a model with the ORDER keyword.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Favour of the Gods (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Favour of the Gods (Chaos)`,\r\n        desc: `Add 1 to the Wounds characteristic of the bearer.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Crown of Conquest (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Crown of Conquest (Chaos)`,\r\n        desc: `Friendly CHAOS units do not have to take battleshock tests while they are within 6\" of the bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(ChaosArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  Chaos: {\r\n    effects: [\r\n      {\r\n        name: `Unbridled Malice`,\r\n        desc: `When a friendly CHAOS unit is picked to fight, roll a dice if it is within 12\" of your general or 3\" of a friendly HERO. On a 6+, add 1 to hit rolls for the unit for that fight.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE } from 'types/phases'\r\n\r\nconst ChaosCommandAbilities = {\r\n  'Lord of the Monstrous Host': {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Monstrous Host`,\r\n        desc: `If the Troggoth King uses this ability, then until your next hero phase all friendly Chaos Troggoths and Chaos Ogors may use this model's Bravery characteristic instead of their own.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(ChaosCommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, HERO_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst ChaosCommandTraits = {\r\n /* 'Dark Avenger (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Dark Avenger (Chaos)`,\r\n        desc: `Add 1 to hit rolls for this general's melee weapons if the target unit has the ORDER keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spiteful Duellist (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Spiteful Duellist (Chaos)`,\r\n        desc: `Each time this general is picked to fight, you can reroll one wound roll for one of their attacks in that fight.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cunning Deceiver (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Cunning Deceiver (Chaos)`,\r\n        desc: `Roll a D6 at the start of each of your hero phases as long as this general has not been slain. On a 5+ you receive 1 extra command point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of War (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Lord of War (Chaos)`,\r\n        desc: `In your hero phase, pick a friendly CHAOS unit within 3\" of this general and roll a D6. On a 4+ you can add 1 to hit rolls for the unit you picked until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terrifying Presence (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Terrifying Presence (Chaos)`,\r\n        desc: `Subtract 1 from the Bravery characteristic of enemy units while they are within 3\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Malicious Conqueror (Chaos)': {\r\n    effects: [\r\n      {\r\n        name: `Malicious Conqueror (Chaos)`,\r\n        desc: `Add 1 to Unbridled Malice dice rolls for units while they are within 12\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(ChaosCommandTraits, 'command_trait')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  TURN_ONE_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst ChaosMonstrousArcanum = {\r\n/*  'Chaos Siege Gargant': {\r\n    effects: [\r\n      {\r\n        name: `Scaling Spikes and Chains`,\r\n        desc: `When this model makes a move, it can pass across terrain features in the same manner as a model that can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Siege Armour`,\r\n        desc: `You can reroll save rolls for attacks made with ranged weapons that target this unit.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      ...GenericEffects.Gargant,\r\n    ],\r\n  },\r\n  'Gigantic Chaos Spawn': {\r\n    effects: [\r\n      {\r\n        name: `Curse of the Dark Gods`,\r\n        desc: `You can choose one of the following keywords to give to this unit the first time it is set up: Khorne, Nurgle, Slaanesh or Tzeentch.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Plaything of the Dark Gods`,\r\n        desc: `At the start of your hero phase, roll a D6. On a 1, this model suffers D3 mortal wounds. On a 2+, you can heal up to D3 wounds allocated to this model. If you roll a 2+ and no wounds are allocated to this model, add D3 to its Wounds characteristic for the rest of the battle instead of healing D3 wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Writhing Tentacles`,\r\n        desc: `If you roll a double when determining the number of attacks made by this model's Freakish Mutations, add 1 to hit and wound rolls for attacks made by this model until the end of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Preyton: {\r\n    effects: [\r\n      {\r\n        name: `Agonizing Venom`,\r\n        desc: `If the unmodified wound roll for an attack made with this model's Venom-dripping Fangs is 6, that attack inflicts 1 mortal wound in addition to any normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Corrosive Bile`,\r\n        desc: `If the unmodified hit roll for an attack made with this model's Corrosive Bile is 6, that attack inflicts 1 mortal wound on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Goring Charge`,\r\n        desc: `After this model makes a charge move, you can pick 1 enemy unit within 1\" of this model and roll a D6. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Stalker of the Dark Wilds`,\r\n        desc: `Instead of setting up this model on the battlefield, you can place it to one side and say that it is stalking its prey as a reserve unit. In your first hero phase, you must set up this unit anywhere on the battlefield within 12\" of the edge of the battlefield and more than 9\" from any enemy unit.`,\r\n        when: [DURING_SETUP, TURN_ONE_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skin Wolves': {\r\n    effects: [\r\n      {\r\n        name: `Bounding Predators`,\r\n        desc: `This unit can run and still charge later in the same turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Terrifying Bloodlust`,\r\n        desc: `If the unmodified hit roll for an attack made by this unit is 6, that attack inflicts 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nconst Units = {\r\n /* Hellcannon: {\r\n    effects: [\r\n      {\r\n        name: `Caged Fury`,\r\n        desc: `If the Hellcannon is not within 3\" of an enemy unit at the start of your movement phase, roll a D6 and consult the War Machine Crew Table on the warscroll. If the dice roll is equal to or greater than the score shown, the crew have caged the Hellfire's fury this turn. Otherwise, the Hellcannon must move as far as it can towards the closest enemy unit that is visible to it.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Doomfire`,\r\n        desc: `The Hellcannon can only make Doomfire attacks if its crew are within 1\" of the war machine in the shooting phase. To make a Doomfire attack, pick an enemy unit within range, even if it is not visible to the Hellcannon, and roll to hit. Add 1 to the hit roll if the Hellcannon did not move in your preceding movement phase and add another 1 if the target unit has 20 or more models. A unit hit by Doomfire suffers D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Daemon-forged Cover`,\r\n        desc: `A Hellcannon's Crew can use their war machine as cover while they are within 1\" of it.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Exalted Hero with Battle Standard': {\r\n    effects: [\r\n      {\r\n        name: `Chaos Runeshield`,\r\n        desc: `Roll a D6 each time this model is allocated a mortal wound. On a 5+ that mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Eager for Glory`,\r\n        desc: `Reroll hit rolls of 1 for this model when targeting a HERO or a MONSTER.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Standard of the Dark Gods`,\r\n        desc: `In your hero phase, you can declare that this model will plant the Battle Standard of the Dark Gods. If you do, then until your next hero phase you may not move the model, but you may immediately roll a D6 for each enemy unit within 10\". On a 4+ that unit suffers a mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Forsaken: {\r\n    effects: [\r\n      {\r\n        name: `Freakish Mutations`,\r\n        desc: `Before this unit makes its attacks in the combat phase, roll a D6 to see what mutation they have for the duration of that phase:\r\n\r\n        1 - Writhing Tentacles: This unit's Freakish Mutations have a Range characteristic of 3\" instead of 1\".\r\n\r\n        2 - Razor Talons: This unit's Freakish Mutations have a Rend characteristic of -1 instead of '-'.\r\n\r\n        3 - Extra Arms: Add 1 to the result of the roll when determining the Attacks characteristic for this unit's Freakish Mutations.\r\n\r\n        4 - Lashing Tongues: Add 1 to hit rolls for this unit's Freakish Mutations.\r\n\r\n        5 - Venomous Fangs: Add 1 to wound rolls for this unit's Freakish Mutations.\r\n\r\n        6 - Decapitating Claws: Add 1 to the Damage characteristic of this unit's Freakish Mutations.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Dragon': {\r\n    effects: [\r\n      {\r\n        name: `Breath of Mutation`,\r\n        desc: `In the shooting phase, this model can pick one enemy unit in range. That unit suffers D3 mortal wounds. Roll a D6 for each model that is slain; on a 4+ the unit suffers a further mortal wound as warriors are driven insane or twisted beyond recognition by the Breath of Mutation.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Treasonous Curse`,\r\n        desc: `Casting value of 7. Pick an enemy unit within 18\". Each model in that unit makes a single attack with one of its melee weapons against its own unit. If a model has more than one melee weapon you may choose which one is used.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Ogors': {\r\n    effects: [\r\n      {\r\n        name: `Fearsome Gluttony`,\r\n        desc: `Roll a D6 each time this unit slays a model; on a 6 you can heal 1 wound that has been allocated to a model in this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Troggoth King': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Lord of the Monstrous Host'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Mutant Regeneration`,\r\n        desc: `At the start of your hero phase, you can heal D3 wounds that have been allocated to this model.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ferocious Retinue`,\r\n        desc: `Reroll hit rolls of 1 for friendly Chaos Troggoth units and Chaos Ogor units within 8\" of this model.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Troggoths': {\r\n    effects: [\r\n      {\r\n        name: `Regeneration`,\r\n        desc: `At the start of your hero phase, roll a D6. On a 2+ you can heal D3 wounds that have been allocated to models in this unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mutating Trollflesh`,\r\n        desc: `For each hit roll of 6+ with this unit's Scavenged Clubs and Axes, make an additional hit roll with the same weapon against the same unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Familiars': {\r\n    effects: [\r\n      {\r\n        name: `Arcane Meddling`,\r\n        desc: `Subtract 1 from casting and unbinding rolls for enemy WIZARDS while they are within 6\" of any units of Chaos Familiars.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Great Taurus': {\r\n    effects: [\r\n      {\r\n        name: `Blazing Body`,\r\n        desc: `In each hero phase, roll a D6 for every unit (friend or foe) within 3\" of any Great Taurus. On a 6+ that unit suffers a mortal wound. This ability has no effect on Great Taurus.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rage`,\r\n        desc: `If this unit made a charge move this turn, reroll failed wound rolls for its Horns and Teeth.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Lammasu: {\r\n    effects: [\r\n      {\r\n        name: `Sorcerous Miasma`,\r\n        desc: `Subtract 1 from casting rolls for WIZARDS (friend or foe) while they are within 18\" of any Lammasus. This ability does not affect CHAOS WIZARDS.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warpfire Dragon': {\r\n    effects: [\r\n      {\r\n        name: `Deadly Demise`,\r\n        desc: `If this model is slain, before this model is removed from play, roll a D6 for each unit within 3\" of this model. On a 4+, that unit suffers D3 mortal wounds. This model is then removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Warpfire`,\r\n        desc: `Do not use the attack sequence for an attack made with this model's Warpfire. Instead roll a D6. On a 1, nothing happens. On a 2-5, the target unit suffers D3 mortal wounds. On a 6, the target unit suffers D6 mortal wounds.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"Phulgoth's Shudderhood\": {\r\n    effects: [\r\n      {\r\n        name: `Fog of Despair`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with missile weapons that target a unit in this regiment of renown.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Disgustingly Resilient`,\r\n        desc: `Units in this regiment of renown have a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Disgustingly Resilient`,\r\n        desc: `At the start of your hero phase, you can heal 1 wound allocated to each unit in this regiment of renown.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nconst ChaosUnits = { ...ChaosMonstrousArcanum, ...Units } satisfies TItemDescriptions\r\n\r\nexport default tagAs(ChaosUnits, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { CHAOS_GRAND_ALLIANCE } from 'meta/factions'\r\nimport ChaosArtifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport ChaosCommandAbilities from './command_abilities'\r\nimport ChaosCommandTraits from './command_traits'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [CHAOS_GRAND_ALLIANCE]: {\r\n    effects: pickEffects(BattleTraits, ['Chaos']),\r\n    available: {\r\n      artifacts: [ChaosArtifacts],\r\n      command_abilities: [ChaosCommandAbilities],\r\n      command_traits: [ChaosCommandTraits],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { CHAOS_GRAND_ALLIANCE } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const ChaosFaction = new Faction(CHAOS_GRAND_ALLIANCE, CHAOS, SubFactions)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst DeathArtifacts = {\r\n/*  'Cursed Book (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Cursed Book (Death)`,\r\n        desc: `You and your opponent must subtract 1 from hit rolls made for units within 3\" of the bearer, unless the unit has the DEATH keyword.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cloak of Mists and Shadows (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Cloak of Mists and Shadows (Death)`,\r\n        desc: `At the start of any combat phase, the bearer can use this cloak. If it does so, remove the bearer from the battlefield, and then set it up anywhere on the battlefield within 12\" of its original location and more than 3\" from any enemy models. If this is impossible, this model remains in its current location.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blade of Dark Summons (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Blade of Dark Summons (Death)`,\r\n        desc: `Once per battle, in your hero phase, you can set up a SUMMONABLE DEATH unit wholly within 12\" of the bearer and more than 3\" from any enemy models, and add it to your army. The models in the unit must have a combined Wounds characteristic of no more than a 2D6 roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Amulet (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Black Amulet (Death)`,\r\n        desc: `Once per battle, in your hero phase, the bearer can use this amulet. If it does so, pick an enemy unit within 12\" of the bearer. Inflict a number of mortal wounds equal to the number of the current battle round on the unit you picked.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Blade (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Tomb Blade (Death)`,\r\n        desc: `Pick one of the bearer's melee weapons. For each wound roll of 6+ you make for this weapon, you can heal 1 wound that has been allocated to a friendly DEATH model within 6\" of the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ring of Immortality (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Ring of Immortality (Death)`,\r\n        desc: `The first time the bearer is slain, before removing them from the battlefield, roll a D6. On a 3+ the bearer is not slain and D3 wounds allocated to them are healed (any excess damage is negated). Then, remove the bearer from the battlefield and set them up again within 18\" of their original location and more than 3\" from any enemy models.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DeathArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  Death: {\r\n    effects: [\r\n      {\r\n        name: `Deathless Minions`,\r\n        desc: `Each time you allocate a wound or mortal wound to a friendly DEATH model within 6\" of your general or a friendly DEATH HERO, roll a dice. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\n\r\nconst DeathCommandAbilities = {\r\n  // '': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: ``,\r\n  //       desc: ``,\r\n  //       when: [END_OF_SETUP],\r\n  //     },\r\n  //   ],\r\n  // },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DeathCommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, DURING_GAME, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst DeathCommandTraits = {\r\n /* 'Ruler of the Night (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Ruler of the Night (Death)`,\r\n        desc: `Friendly DEATH units are affected by the Deathless Minions battle trait if they are within 12\" of this general rather than only 6\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Predator of the Shadows (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Predator of the Shadows (Death)`,\r\n        desc: `Add 1 to hit and wound rolls for this general if they are in cover.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Death Incarnate (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Death Incarnate (Death)`,\r\n        desc: `In your hero phase, pick an enemy unit within 3\" of this general and roll 2D6. If the roll equals or exceeds the enemy unit's Bravery characteristic, inflict D3 mortal wounds on the unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master of the Black Arts (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Master of the Black Arts (Death)`,\r\n        desc: `This general is a WIZARD who knows the Arcane Bolt and Mystic Shield spells. If this general is already a wizard, add 1 to all of their casting and unbinding rolls instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Red Fury (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Red Fury (Death)`,\r\n        desc: `The first time this general is picked to fight in each combat phase, roll a D6 at the end of that fight. On a 5+ they can immediately fight again.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Supernatural Horror (Death)': {\r\n    effects: [\r\n      {\r\n        name: `Supernatural Horror (Death)`,\r\n        desc: `In the battleshock phase, double the number of models that flee from enemy units while they are within 12\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DeathCommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { CHARGE_PHASE, DURING_GAME, MOVEMENT_PHASE, WARDS_PHASE } from 'types/phases'\r\n\r\nconst DeathUnits = {\r\n/*  \"Jerrion's Delegation\": {\r\n    effects: [\r\n      {\r\n        name: `Urgent Missive`,\r\n        desc: `Units in this regiment of renown can run and still charge later in the turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Deathless Courtiers`,\r\n        desc: `Units in this regiment of renown have a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n    ],\r\n  },\r\n  \"Veremord's Shamblers\": {\r\n    effects: [\r\n      {\r\n        name: `Legend Among Graverobbers`,\r\n        desc: `The CORPSE CART in this regiment of renown has the HERO keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Repurposed Wards`,\r\n        desc: `The DEADWALKER ZOMBIES unit in this regiment of renown has a ward of 6+ while it is wholly within 12\" of the CORPSE CART in this regiment of renown.\r\n\r\n        The CORPSE CART in this regiment of renown has a ward of 5+ while it is wholly within 12\" of the DEADWALKER ZOMBIES unit in this regiment of renown.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Vitiating Vapours`,\r\n        desc: `Subtract 1 from ward rolls for enemy units within 12\" of the CORPSE CART in this regiment of renown.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DeathUnits, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { DEATH_GRAND_ALLIANCE } from 'meta/factions'\r\nimport DeathArtifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport DeathCommandAbilities from './command_abilities'\r\nimport DeathCommandTraits from './command_traits'\r\nimport DeathUnits from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [DEATH_GRAND_ALLIANCE]: {\r\n    effects: pickEffects(BattleTraits, ['Death']),\r\n    available: {\r\n      artifacts: [DeathArtifacts],\r\n      command_abilities: [DeathCommandAbilities],\r\n      command_traits: [DeathCommandTraits],\r\n      units: [DeathUnits],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { DEATH_GRAND_ALLIANCE } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const DeathFaction = new Faction(DEATH_GRAND_ALLIANCE, DEATH, SubFactions, 'Flavors')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst DestructionArtifacts = {\r\n /* 'Hammerblade (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Hammerblade (Destruction)`,\r\n        desc: `Pick one of the bearer's melee weapons. Instead of attacking normally with that weapon, you can roll a D6 for each model within 3\" of the bearer (apart from the bearer). On 5 or 6, 1 mortal wound is inflicted on that model's unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Battered Talisman (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Battered Talisman (Destruction)`,\r\n        desc: `Roll a D6 each time you allocate a mortal wound to the bearer. On a 5+, the mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rockeye (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Rockeye (Destruction)`,\r\n        desc: `In your hero phase, pick an enemy unit within 12\" of the bearer. Until your next hero phase, add 1 to hit rolls made for the bearer when they target the unit you picked.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bellowing Blade (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Bellowing Blade (Destruction)`,\r\n        desc: `When the bearer is picked to fight, you can reroll one wound roll for the bearer's attack in that fight for each enemy HERO that was within 12\" of the bearer when they were picked to fight.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Collar of Domination (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Collar of Domination (Destruction)`,\r\n        desc: `At the start of your opponent's movement phase, pick an enemy MONSTER within 3\" of the bearer and roll 2D6. If the roll is equal or greater than enemy monsterbs Bravery characteristic, it must retreat in that movement phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Battle Brew (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Battle Brew (Destruction)`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the bearer will take either one or two swigs of Battle Brew. If the bearer takes one swig, add 1 to hit and wound rolls made for the bearer until your next hero phase. If the bearer takes two swigs, add 2 to hit and wound rolls made for the bearer until your next hero phase, but you must allocate D6 mortal wounds to the bearer at the end of the turn in which they drank the brew.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DestructionArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  Destruction: {\r\n    effects: [\r\n      {\r\n        name: `Rampaging Destroyers`,\r\n        desc: `In your hero phase, roll a dice for your general and each friendly DESTRUCTION HERO on the battlefield. Add 2 to the roll for the general. On a 6+, pick a friendly DESTRUCTION unit within 6\" of the general or HERO being rolled for. That unit can immediately move 6\" if it is more than 12\" from the enemy, can immediately pile in if it is within 3\" of the enemy, or can immediately declare a charge in any other circumstances. It cannot run when it makes the move, but can move, charge or pile in again later in the same turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst DestructionCommandAbilities = {\r\n /* 'Born to Lead': {\r\n    effects: [\r\n      {\r\n        name: `Born to Lead`,\r\n        desc: `You can use this command ability at the start of your charge phase. If you do so, pick 1 friendly model with this command ability. You can reroll charge rolls for friendly Fimir units while they are wholly within 12\" of that model in that charge phase.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DestructionCommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n /* 'Nothing Left Standing (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Nothing Left Standing (Destruction)`,\r\n        desc: `In your hero phase, pick a terrain feature that is within 6\" of this general and at least 5 other friendly DESTRUCTION models. For the rest of the battle, that terrain feature no longer gives cover to models that are in or on it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Might is Right (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Might is Right (Destruction)`,\r\n        desc: `Add 1 to wound rolls made for this general's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wild Fury (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Wild Fury (Destruction)`,\r\n        desc: `When this general is picked to fight, pick one of their melee weapons. Add 1 to the Attacks characteristic of that melee weapon for that fight. While 3 or more wounds are allocated to this general, instead add 2 to the Attacks characteristic of that melee weapon for that fight.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bellowing Tyrant (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Bellowing Tyrant (Destruction)`,\r\n        desc: `In your hero phase, pick a friendly DESTRUCTION unit within 6\" of this general. Until your next hero phase, add 1 to charge and run rolls for the unit you picked, and use this general's Bravery characteristic for the unit instead of its own.`,\r\n        when: [HERO_PHASE, CHARGE_PHASE, MOVEMENT_PHASE, BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Big and Brutish (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Big and Brutish (Destruction)`,\r\n        desc: `Add 1 to this general's Wounds characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Ravager (Destruction)': {\r\n    effects: [\r\n      {\r\n        name: `Ravager (Destruction)`,\r\n        desc: `Add 3 to the Rampaging Destroyers dice roll (see battle trait) for this general instead of 2.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport orruk_rule_sources from 'factions/orruk_warclans/rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  TURN_ONE_START_OF_HERO_PHASE,\r\n  TURN_TWO_END_OF_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport DestructionCommandAbilities from './command_abilities'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst ShroudingMistEffects = [\r\n  {\r\n    name: `Shrouding Mists`,\r\n    desc: `Subtract 1 from hit rolls for attacks made with missile weapons that target this model.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Shrouding Mists`,\r\n    desc: `Roll a D6 each time you allocate a mortal wound to this model. On a 5+ that mortal wound is negated.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst UnnaturalFleshEffect = {\r\n  name: `Unnatural Flesh`,\r\n  desc: `In your hero phase, you can heal 1 wound allocated to this model.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst BaleglyphMaulsEffect = {\r\n  name: `Baleglyph Mauls`,\r\n  desc: `If the unmodified wound roll for an attack made with a Baleglyph Maul is 6, that attack inflicts 1 mortal wound on the target in addition to any normal damage.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DestructionUnits = {\r\n/*  Basilisk: {\r\n    effects: [\r\n      {\r\n        name: `Corrosive Miasma`,\r\n        desc: `At the start of the combat phase, roll 1 dice for each enemy unit within 3\" of this model. On a 2+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Malignant Gaze`,\r\n        desc: `In your hero phase, you can pick 1 enemy unit within 12\" of this model that is visible to it, and roll a D6. On a 1, nothing happens. On a 2-3, that unit suffers D3 mortal wounds. On a 4+, that unit suffers D3+1 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dread Maw': {\r\n    effects: [\r\n      {\r\n        name: `Devourer From Below`,\r\n        desc: `Instead of setting up this model on the battlefield, you can place it to one side and say that it is tunnelling through the earth in reserve. If you do so, at the end of your second movement phase, you must set up this model on the battlefield more than 9\" from any enemy units.`,\r\n        when: [DURING_SETUP, TURN_TWO_END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Impenetrable Hide`,\r\n        desc: `Roll a D6 each time you allocate a mortal wound to this model. On a 4+ that mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Yawning Maw`,\r\n        desc: `You can reroll wound rolls of 1 for attacks made with this model's Cavernous Maw if the target unit has a Wounds characteristic of 2 or less.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tunnel Worm`,\r\n        desc: `When this model makes a move, it can pass across terrain features and other models in the same manner as a model that can fly.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n /* 'Fimirach Noble': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(DestructionCommandAbilities, ['Born to Lead'])],\r\n    },\r\n    effects: [...ShroudingMistEffects, UnnaturalFleshEffect, BaleglyphMaulsEffect],\r\n  },\r\n  'Fimir Warriors': {\r\n    effects: [...ShroudingMistEffects, UnnaturalFleshEffect, BaleglyphMaulsEffect],\r\n  }, */\r\n /* 'Incarnate Elemental Of Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Savage Frenzy`,\r\n        desc: `If this model is slain, before removing the model from play, it can make a pile-in move and then attack with all of the melee weapons it is armed with. This model is then removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Incarnate of Ghur`,\r\n        desc: `In your hero phase, you can heal up to D3 wounds allocated to this model if the battle is taking place in Ghur, the Realm of Beasts. In addition, you can reroll wound rolls of 1 for attacks made by this model if the battle is taking place in Ghur, the Realm of Beasts.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Lure of Spirit Blood`,\r\n        desc: `You can reroll charge rolls for this model while it is within 12\" of any enemy models that have any wounds allocated to them.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Howl of the Great Beast`,\r\n        desc: `Subtract 1 from the Bravery characteristic of enemy units while they are within 8\" of this model.`,\r\n        when: [DURING_GAME, BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Incarnate Elemental Of Fire': {\r\n    effects: [\r\n      {\r\n        name: `Ashes to Ashes`,\r\n        desc: `If the unmodified hit roll for an attack made by this model is 6, double the Damage characteristic for that attack.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gift of Elemental Fire`,\r\n        desc: `At the end of the combat phase, roll a D6 for each enemy unit within 3\" of this model. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Incarnate of Aqshy`,\r\n        desc: `In your hero phase, you can heal up to D3 wounds allocated to this model if the battle is taking place in Aqshy, the Realm of Fire. In addition, you can reroll wound rolls of 1 for attacks made by this model if the battle is taking place in Aqshy, the Realm of Fire.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magma Dragon': {\r\n    effects: [\r\n      {\r\n        name: `Brimstone Dragonfire`,\r\n        desc: `Do not use the attack sequence for an attack made with this model's Brimstone Dragonfire. Instead, roll a D6. On a 2+, the target unit suffers D6 mortal wounds. If the target unit has 10 or more models, it suffers 2D6 mortal wounds instead of D6.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Blood`,\r\n        desc: `Roll a D6 each time a wound or mortal wound that was inflicted by a melee weapon is allocated to this model. On a 4+, the attacking unit suffers 1 mortal wound. On a 6, the attacking unit suffers D3 mortal wounds instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Merwyrm: {\r\n    effects: [\r\n      {\r\n        name: `Abyssal Predator`,\r\n        desc: `If the unmodified wound roll for an attack made with this model's Hideous Jaws is 6, that attack has a Damage characteristic of D6 instead of D3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stench of the Deep`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unnatural Metabolism`,\r\n        desc: `At the end of the combat phase, if any enemy models were slain by wounds inflicted by this model's attacks in that combat phase, you can heal up to D3 wounds allocated to this model.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rogue Idol': {\r\n    effects: [\r\n      {\r\n        name: `Avalanche!`,\r\n        desc: `If this model is slain, before removing the model from play, roll a D6 for each unit within 3\" of this model. On a 4+, that unit suffers D3 mortal wounds. This model is then removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Da Big' Un`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to this model. On a 5+, that wound or mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Livin' Idol`,\r\n        desc: `Add 1 to casting rolls for friendly Orruk WIZARDS and friendly Grot WIZARDS while they are within 6\" of any friendly models with this ability. In addition, add 1 to the Bravery characteristic of friendly Orruk and friendly Grot units while they are wholly within 18\" of any friendly models with this ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rubble and Ruin`,\r\n        desc: `At the end of the combat phase, roll a D6 for each enemy unit within 3\" of this model. On a 4+, that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Spirit of the Waaagh!`,\r\n        desc: `You can reroll hit rolls of 1 for attacks made by this model if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Kragnos: {\r\n    effects: [\r\n      {\r\n        name: `Bellow of Rage`,\r\n        desc: `At the end of any phase, if any wounds were allocated to this unit in that phase, roll a dice for each other unit and each defensible terrain feature within 6\" of this unit. If the roll is equal to or greater than the Bellow of Rage value shown on this unit's damage table, that unit suffers D3 mortal wounds or that defensible terrain feature is demolished.`,\r\n        when: [END_OF_ANY_PHASE],\r\n        rule_sources: [orruk_rule_sources.BATTLETOME_ORRUK_WARCLANS],\r\n      },\r\n      {\r\n        name: `The End of Empires`,\r\n        desc: `If a friendly DESTRUCTION unit is wholly within 12\" of this unit, you can attempt a charge with that unit if it is within 18\" of an enemy unit instead of 12\". In addition, when making a charge roll for a friendly DESTRUCTION unit wholly within 12\" of this unit, roll 3D6 instead of 2D6.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction`,\r\n        desc: `If the effect of a spell or ability would slay this model without any wounds or mortal wounds being caused by the spell or ability, this model suffers D6 mortal wounds instead of being slain.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `Mightiest Makes Rightiest`,\r\n        desc: `For the purposes of contesting objectives, this unit counts as a number of models equal to the Mightiest Makes Rightiest value on its damage table.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction`,\r\n        desc: `After this unit makes a charge move, you can either roll a dice for each enemy unit within 1\" of this unit or you can pick 1 enemy MONSTER within 1\" of this unit and roll 2D6.\r\n\r\n        If you roll a dice for each enemy unit within 1\" of this unit, on a 2+, that enemy unit suffers D6 mortal wounds.\r\n\r\n        If you pick 1 enemy MONSTER within 1\" of this unit and roll 2D6, on a 7, nothing happens. On any other roll, that enemy MONSTER suffers a number of mortal wounds equal to the score of the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal wounds (2x6 = 12).`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [orruk_rule_sources.BATTLETOME_ORRUK_WARCLANS, orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate`,\r\n        desc: `This unit has a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n        rule_sources: [orruk_rule_sources.BATTLETOME_ORRUK_WARCLANS, orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate`,\r\n        desc: `Each time this unit is affected by a spell or the abilities of an endless spell, you can roll 3D6. If the roll is greater than the casting value of that spell or the spell used to summon that endless spell, ignore the effect of that spell or the effects of that endless spell's abilities on this unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [orruk_rule_sources.BATTLETOME_ORRUK_WARCLANS, orruk_rule_sources.ERRATA_DECEMBER_2021],\r\n      },\r\n      {\r\n        name: `Warmaster`,\r\n        desc: `This unit can be included in an Orruk Warclans, Gloomspite Gitz, Ogor Mawtribes or Sons of Behemat army. If it is, it is treated as a general even if it is not the model picked to be the army's general. In addition, you can still use the army's allegiance abilities even though this unit is not from the army's faction; however, this unit does not benefit from them.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_BROKEN_REALMS_KRAGNOS,\r\n          meta_rule_sources.ERRATA_BROKEN_REALMS_KRAGNOS_JULY_2021,\r\n          orruk_rule_sources.ERRATA_DECEMBER_2021,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  \"Braggit's Bottle-Snatchaz\": {\r\n    effects: [\r\n      {\r\n        name: `Major Irritant`,\r\n        desc: `If a unit in this regiment of renown receives the Redeploy command, any other friendly units in this regiment of renown within 6\" of that unit can immediately make a D6\" move but they must finish that move more than 3\" from all enemy units and cannot shoot later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Secret Tunnels`,\r\n        desc: `Instead of setting up the units in this regiment of renown on the battlefield, you can place them to one side and say that they are navigating secret tunnels. If you do so, at the start of your first hero phase, you can set up all of these units wholly within 6\" of the edge of the battlefield and more than 9\" from all enemy units. The units you set up cannot move in the following movement phase.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Secret Tunnels`,\r\n        desc: `If you set this unit up in secret tunnels, at the start of your first hero phase, you can set up all of these units wholly within 6\" of the edge of the battlefield and more than 9\" from all enemy units. The units you set up cannot move in the following movement phase.`,\r\n        when: [TURN_ONE_START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n    ],\r\n  },\r\n  \"Big Grikk's Kruleshots\": {\r\n    effects: [\r\n      {\r\n        name: `Back-stabbin' Big Shot`,\r\n        desc: `The BEAST-SKEWER KILLBOW in this regiment of renown has the HERO keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Toxin-laden Skewers`,\r\n        desc: `If the unmodified hit roll for an attack made by a model in this regiment of renown is 6, that attack causes a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skewer It Again!`,\r\n        desc: `If any wounds and/or mortal wounds caused by a shooting attack made by this regiment of renown's BEAST-SKEWER KILLBOW are allocated to an enemy MONSTER and not negated, you can pick any number of other models in this regiment of renown and say that they are focusing fire. If you do so, until the end of the phase, add 1 to the Attacks characteristic of missile weapons used by those models but all of their attacks must target that enemy MONSTER.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(DestructionUnits, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { DESTRUCTION_GRAND_ALLIANCE } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport DestructionCommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport DestructionUnits from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [DESTRUCTION_GRAND_ALLIANCE]: {\r\n    effects: pickEffects(BattleTraits, ['Destruction']),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      command_abilities: [DestructionCommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      units: [DestructionUnits],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { DESTRUCTION_GRAND_ALLIANCE } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const DestructionFaction = new Faction(DESTRUCTION_GRAND_ALLIANCE, DESTRUCTION, SubFactions)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst OrderArtifacts = {\r\n /* 'Quicksilver Potion (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Quicksilver Potion (Order)`,\r\n        desc: `Once per battle, at the start of the combat phase, you can use this potion. If you do so, in that combat phase, the bearer (and its mount, if it has one) fights immediately, instead of fighting later in that combat phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Obstinate Blade (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Obstinate Blade (Order)`,\r\n        desc: `Pick one of the bearer's melee weapons. Improve the Rend characteristic of the weapon by 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Relic Blade (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Relic Blade (Order)`,\r\n        desc: `Pick one of the bearer's melee weapons. Increase the Damage characteristic of that weapon by 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hoarfrost (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Hoarfrost (Order)`,\r\n        desc: `Pick one of the bearer's melee weapons. If an enemy model is allocated any wounds from this weapon and is not slain, subtract 1 from that model's hit rolls for the rest of the battle.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Talisman of Blinding Light (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Talisman of Blinding Light (Order)`,\r\n        desc: `Once per battle, at the start of the combat phase, you can use this amulet. If you do so, in that combat phase, subtract 1 from hit rolls made for attacks that target the bearer.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Phoenix Stone (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Phoenix Stone (Order)`,\r\n        desc: `In each hero phase, you can heal 1 wound that has been allocated to the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(OrderArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  Order: {\r\n    effects: [\r\n      {\r\n        name: `Defiant Avengers`,\r\n        desc: `You can reroll battleshock tests for friendly ORDER units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst OrderCommandTraits = {\r\n /* 'Strategic Genius (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Strategic Genius (Order)`,\r\n        desc: `At the start of the first battle round, you receive 1 extra command point.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Inspiring (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Inspiring (Order)`,\r\n        desc: `Friendly ORDER units do not have to take battleshock tests while they are within 6\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dauntless (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Dauntless (Order)`,\r\n        desc: `You can reroll charge rolls for this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tenacious (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Tenacious (Order)`,\r\n        desc: `Add 1 to this general's Wounds characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Legendary Fighter (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Legendary Fighter (Order)`,\r\n        desc: `When this general is selected to fight, add 1 to the Attacks characteristic of one of their melee weapons for that fight.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master of Defence (Order)': {\r\n    effects: [\r\n      {\r\n        name: `Master of Defence (Order)`,\r\n        desc: `Each time you allocate a wound or mortal wound to this general, roll a D6. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(OrderCommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BannerBearerEffect = {\r\n  name: `Banner Bearer`,\r\n  desc: `Models in this unit can be Banner Bearers. You can reroll battleshock tests for a unit that includes any Banner Bearers if it made a charge move in the same turn.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst TrumpeterEffect = {\r\n  name: `Trumpeter`,\r\n  desc: `Models in this unit can be Trumpeters. Roll 3D6 instead of 2D6 when you make a charge roll for a unit that includes any Trumpeters, and then pick two of the dice to determine the result of the roll.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst PendantLancesEffect = {\r\n  name: `Pendant Lances`,\r\n  desc: `Add 1 to the wound rolls and Damage characteristic of this unit's Pendant Lances and Blades if it made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst KnightsShieldEffect = {\r\n  name: `Knight's Shield`,\r\n  desc: `In the combat phase, reroll save rolls of 1 for this unit if it made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE, SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst BretonnianInfantryBaseEffects = [\r\n  {\r\n    name: `Trumpeter`,\r\n    desc: `Models in this unit can be Trumpeters. Add 1 to run rolls for this unit if it includes any Trumpeters.`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Standard Bearer`,\r\n    desc: `Models in this unit can be Standard Bearers. You can reroll battleshock tests for this unit if it includes any Standard Bearers when the test is taken.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst RelicWeaponEffect = {\r\n  name: `Relic Weapon`,\r\n  desc: `Add 1 to the Damage characteristic of the Relic Weapon if the target is a Daemon or Death unit.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst DrummerEffect = {\r\n  name: `Drummer`,\r\n  desc: `Models in this unit can be Drummers. Add 1 to charge rolls for this unit if it includes any Drummers.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst GallantEffect = {\r\n  name: `Gallant`,\r\n  desc: `The leader of this unit is a Gallant. Add 1 to the Attacks characteristic of the Gallant's Pendant Lance and Blade.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyBretonnianUnits = {\r\n /* 'BRETONNIAN Lord': {\r\n    effects: [\r\n      {\r\n        name: `Dragonbane`,\r\n        desc: `Add 1 to hit rolls for the Ducal Sword and Dragonbane Lance if this model made a charge move in the same turn. In addition, reroll failed hit rolls for the Ducal Sword and Dragonbane Lance if the target is a Monster.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ducal Shield`,\r\n        desc: `In the combat phase, reroll save rolls of 1 for this model if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE, SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Lord of the Realm`,\r\n        desc: `If this model uses this ability, until your next hero phase reroll failed charge rolls for friendly Nobility units that are within 15\" of this model when the charge roll is made.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  Damsel: {\r\n    effects: [\r\n      {\r\n        name: `Soothing Aura`,\r\n        desc: `In your hero phase, you can heal 1 wound allocated to a friendly BRETONNIAN model that is within 6\" of this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wizard`,\r\n        desc: `A Damsel is a WIZARD. She can attempt to cast one spell in each of your hero phases, and attempt to unbind one spell in each enemy hero phase. She knows the Arcane Bolt, Mystic Shield and Divine Blessing spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Divine Blessing`,\r\n        desc: `Casting value of 5. Pick a friendly BRETONNIAN unit that is within 16\" of the caster. Until your next hero phase, roll a D6 each time you allocate a wound or mortal wound to that unit. Add 1 to the dice roll if the unit has Nobility keyword. On a roll of 6+, the wound is negated and has no effect.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Battle Pilgrims': {\r\n    effects: [\r\n      {\r\n        name: `Grail Reliquae`,\r\n        desc: `A unit of Battle Pilgrims can have one Grail Reliquae. A Grail Reliquae has a Wounds characteristic of 3 instead of 1. Add 2 to the attacks characteristic of the Grail Reliquae's Reliquary Sword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Inspired Fervour`,\r\n        desc: `Add 1 to hit rolls for this unit if it includes a Grail Reliquae when the hit roll is made.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Inspired Fervour`,\r\n        desc: `Add 1 to any wound rolls for this unit if it has 10 or more models when the wound roll is made.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Pilgrim Shields`,\r\n        desc: `Reroll save rolls of 1 for this unit. Reroll save rolls of 1 or 2 instead if this unit includes a Grail Reliquae when the save roll is made.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Enchantress: {\r\n    effects: [\r\n      {\r\n        name: `Chalice of Potions`,\r\n        desc: `In your hero phase, you can reroll one failed casting roll for this model. If you do and the result of the reroll is a 2 before any modifiers are applied, then you cannot use this ability again for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Saintly Guardians`,\r\n        desc: `In the combat phase, reroll failed hit rolls for friendly Grail Knights units while they are within 10\" of this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Spiteful Glance`,\r\n        desc: `At the start of the combat phase, pick an enemy unit within 3\" of this model and roll 2D6. The enemy unit suffers 1 mortal wound if the result of the roll is equal to or higher than its Bravery characteristic.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blessed`,\r\n        desc: `In your hero phase, heal D3 wounds that have been allocated to this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Divine Favour`,\r\n        desc: `Casting value of 6. Pick a friendly BRETONNIAN unit that is visible to the caster and within 16\" of them. Until your next hero phase, add 1 to hit rolls for that unit's melee weapons.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n      {\r\n        name: `Wizard`,\r\n        desc: `An Enchantress is a WIZARD. She can attempt to cast two spells in each of your own hero phases, and attempt to unbind two spells in each enemy hero phase. She knows the Arcane Bolt, Mystic Shield and Divine Favour spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Grail Knights': {\r\n    effects: [\r\n      BannerBearerEffect,\r\n      TrumpeterEffect,\r\n      {\r\n        name: `Sacred Lances`,\r\n        desc: `Add 1 to the Damage characteristic of this unit's Swords and Sacred Lances if the target of its attacks is a Daemon or Death unit. In addition, add 1 to wound rolls made for, and the Damage characteristic of, this unit's Swords and Sacred Lances if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      KnightsShieldEffect,\r\n    ],\r\n  },\r\n\r\n  'Field Trebuchet': {\r\n    effects: [\r\n      {\r\n        name: `Heavy Artillery`,\r\n        desc: `This model can only move if its Crew are within 1\" of it at the start of the movement phase. If its Crew are within 1\" of the Trebuchet in the shooting phase, they can fire the war machine. The war machine cannot make charge moves, does not need to take battleshock tests and is unaffected by any attack or ability that uses Bravery. The Crew are in cover while they are within 1\" of their war machine.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Arcing Shot`,\r\n        desc: `This unit can shoot at enemy units that are not visible to it. If it does, subtract 1 from the hit roll for the unit's Rocks and Masonry attack.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Seismic Impact`,\r\n        desc: `Roll a D6 before making the hit roll for a Rocks and Masonry attack. If the roll is less than the number of models in the target unit, the attack scores a hit without needing the hit roll to be made.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'King on Hippogryph': {\r\n    effects: [\r\n      {\r\n        name: `Regal Crown`,\r\n        desc: `Do not take battleshock tests for friendly BRETONNIAN units while they are within 24\" of this model.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Lion Shield`,\r\n        desc: `This model can attempt to unbind 1 spell in each enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lion Shield`,\r\n        desc: `In the combat phase, reroll save rolls of 1 for this model if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE, SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Sword of the King`,\r\n        desc: `Reroll failed hit rolls for the Sword of the King if the target is a HERO or MONSTER.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Champion of the People`,\r\n        desc: `At the start of your hero phase, heal D3 wounds that have been allocated to this model.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `King of the Realm`,\r\n        desc: `If this model uses this ability, then in your next combat phase add 1 to hit rolls for friendly NOBILITY units within 24\" of this model that made a charge move in the same turn.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Knights Errant': {\r\n    effects: [\r\n      {\r\n        name: `Cavalier`,\r\n        desc: `The leader of this unit is a Cavalier. Add 1 to the Attacks characteristic of the Cavalier's Pendant Lance and Blade.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      BannerBearerEffect,\r\n      TrumpeterEffect,\r\n      {\r\n        name: `Eager to Impress`,\r\n        desc: `In the combat phase, reroll hit rolls of 1 for this unit if it was within 18\" of a Damsel at the start of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      PendantLancesEffect,\r\n      KnightsShieldEffect,\r\n    ],\r\n  },\r\n\r\n  'Knights of The Realm': {\r\n    effects: [\r\n      GallantEffect,\r\n      BannerBearerEffect,\r\n      TrumpeterEffect,\r\n      {\r\n        name: `Massed Cavalry`,\r\n        desc: `Reroll hit rolls of 1 for this unit if it contains 10 or more models when the hit roll is made.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      PendantLancesEffect,\r\n      KnightsShieldEffect,\r\n    ],\r\n  },\r\n\r\n  'Men-at-Arms': {\r\n    effects: [\r\n      {\r\n        name: `Warden`,\r\n        desc: `The leader of this unit is a Warden. Add 1 to the Attacks characteristic of a Warden's Polearm.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      DrummerEffect,\r\n      ...BretonnianInfantryBaseEffects,\r\n      {\r\n        name: `Rowdy Mob`,\r\n        desc: `Add 1 to hit rolls for this unit if it has 20 models or more when the hit roll is made. Add 2 to hit rolls instead if it has 30 models or more when the hit roll is made.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tower Shields`,\r\n        desc: `Add 1 to save rolls for this unit unless it made charge move in the same turn.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Mounted Yeomen': {\r\n    effects: [\r\n      {\r\n        name: `Warden`,\r\n        desc: `The leader of this unit is a Warden. Add 1 to the Attacks characteristic of the Warden's Hunting Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ...BretonnianInfantryBaseEffects,\r\n      {\r\n        name: `Scouts`,\r\n        desc: `After deployment but before the first battle round, this unit can make a move as if it were the movement phase (though it cannot run).`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Wooden Shields`,\r\n        desc: `In the combat phase, reroll save rolls of 1 for this model if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE, SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Noble Champion': {\r\n    effects: [\r\n      RelicWeaponEffect,\r\n      {\r\n        name: `Virtue of Empathy`,\r\n        desc: `In the battleshock phase, friendly Peasantry units can use this model's Bravery characteristic when they take a battleshock test if they are within 6\" of this model when the test is taken.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Noble Standard Bearer': {\r\n    effects: [\r\n      RelicWeaponEffect,\r\n      {\r\n        name: `Valorous Banner`,\r\n        desc: `In the battleshock phase, you can reroll battleshock tests for friendly Nobility units that were within 12\" of this model when the test was taken.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Peasant Bowmen': {\r\n    effects: [\r\n      ...BretonnianInfantryBaseEffects,\r\n      DrummerEffect,\r\n      {\r\n        name: `Arrowstorm`,\r\n        desc: `Once per battle, at the start of your shooting phase, you can declare that this unit will fire an Arrowstorm. If you do, add 2 to the Attacks characteristics of this unit's Longbows until the end of the phase. Add 3 to the Attacks characteristics instead if this unit has 20 or more models when the Arrowstorm is declared. A unit cannot use this ability if it is within 3\" of any enemy units at the start of its shooting phase.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Stakes`,\r\n        desc: `When you set this unit up, you can declare that it is protecting itself with a barricade of sharpened stakes (you can use the stake models provided with this unit as a reminder of this if you wish). An enemy unit that finishes a charge move within 3\" of a unit protected by stakes suffers D3 mortal wounds. The protection of the stakes is lost for the rest of the battle if this unit moves or is attacked by an enemy unit in the combat phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Stakes`,\r\n        desc: `An enemy unit that finishes a charge move within 3\" of a unit protected by stakes suffers D3 mortal wounds. The protection of the stakes is lost for the rest of the battle if this unit moves or is attacked by an enemy unit in the combat phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Braziers`,\r\n        desc: `Reroll wound rolls of 1 for Longbows used by a unit with burning braziers. The benefit of the burning braziers is lost for the rest of the battle if this unit moves or is attacked by an enemy unit in the combat phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Pegasus Knights': {\r\n    effects: [\r\n      GallantEffect,\r\n      BannerBearerEffect,\r\n      TrumpeterEffect,\r\n      {\r\n        name: `Swooping Charge`,\r\n        desc: `Add 1 to wound rolls and 1 to the Damage characteristic of this unit's Lances and Blades if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      KnightsShieldEffect,\r\n    ],\r\n  },\r\n\r\n  'Questing Knights': {\r\n    effects: [\r\n      {\r\n        name: `Paragon`,\r\n        desc: `The leader of this unit is a Paragon. Add 1 to the Attacks characteristic of the Paragon's Knightly Greatblade.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      BannerBearerEffect,\r\n      {\r\n        name: `Lutist`,\r\n        desc: `Models in this unit can be Lutists. Roll 3D6 instead of 2D6 when you make a charge roll for a unit that includes any Lutists, and then pick two of the dice to determine the result of the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The Questing Vow`,\r\n        desc: `Add 1 to the Damage characteristic of a Knightly Greatblade if the target has the MONSTER keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Questing Vow`,\r\n        desc: `You can reroll charge rolls for this unit if there is an enemy unit with the MONSTER keyword within 12\" of it when the charge roll is made.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      KnightsShieldEffect,\r\n    ],\r\n  },\r\n\r\n  'Sacred Protector': {\r\n    effects: [\r\n      {\r\n        name: `Ethereal`,\r\n        desc: `When making save rolls for this unit, ignore the attacking weapon's Rend characteristic.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Shield of the Ancient Forests`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to this model. On a roll of 6+ that wound is negated and has no effect.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Summoned from the Mists`,\r\n        desc: `Instead of setting up this model on the battlefield, you must place it to one side and say that it is set up in the mists.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Summoned from the Mists`,\r\n        desc: `In each of your movement phases, roll a D6 for this model. On a roll of 3 or less the model remains in the mists - you must roll again in your next movement phase. On a roll of 4+, set up this model anywhere on the battlefield, more than 9\" from any enemy models. This counts as its move for that movement phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst HornblowerEffect = {\r\n  name: `Hornblower`,\r\n  desc: `Models in this unit can be Hornblowers. When a unit containing any Hornblowers runs, they can 'Sound the Advance'. If they do so, do not roll a D6 to see how far the unit runs; instead, they can move up to an extra 4\".`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyDuardinUnits = {\r\n /* 'Apprentice Runesmith': {\r\n    effects: [\r\n      {\r\n        name: `Overworked`,\r\n        desc: `Whilst within 5\" of a Runelord on Anvil of Doom, this model's Forging Tongs have an Attacks characteristic of 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Enthusiastic Young Assistant`,\r\n        desc: `This model can attempt to unbind one spell in each enemy hero phase as if he were a wizard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Slayers: {\r\n    effects: [\r\n      {\r\n        name: `Giant Slayer`,\r\n        desc: `The leader of this unit is the Giant Slayer. Add 1 to the Attacks characteristic of the Giant Slayer's Slayer Axes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Icon Bearer`,\r\n        desc: `Models in this unit may be Icon Bearers. Roll a D6 if a spell affects a unit with any Icon Bearers. On a roll of a 5+, that spell has no affect on the unit (but it will affect other units normally).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      HornblowerEffect,\r\n      {\r\n        name: `Seeking a Glorious Death`,\r\n        desc: `If there is an enemy MONSTER visible to this unit you do not need to take battleshock tests for this unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Deathblow`,\r\n        desc: `If a Slayer is slain in the combat phase, roll a D6 before it is removed. On a roll of 4+ you can inflict 1 mortal wound on the enemy unit that struck the fatal blow after all of its attacks have been made.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Slayer Oath`,\r\n        desc: `You can add 1 to wound rolls for attacks made with Slayer Axes if the target unit has a Wounds characteristic of 2 or more.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Miners: {\r\n    effects: [\r\n      {\r\n        name: `Prospector`,\r\n        desc: `The leader of this unit is the Prospector. Some Prospectors fight with a Miner's Pickaxe, but some instead wield a Steam Drill in battle. Add 1 to the Attacks characteristic of the Prospector's Miner's Pickaxe.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mining Cart`,\r\n        desc: `A unit of Miners can have one Mining Cart. A Mining Cart has a Wounds characteristic of 4 instead of 1. It is pulled by a stubborn Mule that will Bite any foe that annoys it - it cannot attack with any other weapons.\r\n\r\n        Whilst a unit of Miners includes a Mining Cart they gain the Blasting Charges weapon. Some Mining Carts also carry Steam Harpoons.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      HornblowerEffect,\r\n      GenericEffects.ClanBannerEffect,\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. Standard Bearers can carry either a Runic Icon or a Clan Banner.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Underground Advance`,\r\n        desc: `Instead of setting up a Miners unit on the battlefield, you may place it to one side and say that it is set up underground.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Underground Advance`,\r\n        desc: `In any of your movement phases, the Miners can surface. When they do so, set up the unit on the battlefield more than 9\" from any enemy models. This is the unit's move for that movement phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Runic Icon`,\r\n        desc: `Roll a D6 if a spell affects a unit with any Runic Icons. On a roll of a 5+1 that spell has no affect on the unit (but it will affect other units normally).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Steam Harpoon`,\r\n        desc: `If a unit of Miners includes a Mining Cart with a Steam Harpoon, and the unit did not move in its movement phase (or arrive on the battlefield using the Underground Advance ability), they can ready the Steam Harpoon and use it as a makeshift weapon. If they do so, one Miner within 1\" of the Mining Cart can fire the Steam Harpoon in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grudge Thrower': {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Duardin Artillery'),\r\n      {\r\n        name: `Lobbed Shot`,\r\n        desc: `A Grudge Thrower can hurl Grudge Rocks at units that are not visible to it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Settling a Grudge`,\r\n        desc: `At the start of the first battle round, pick an enemy unit on the battlefield. Reroll failed hit and wound rolls for this Grudge Thrower when it targets that unit.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Settling a Grudge`,\r\n        desc: `Reroll failed hit and wound rolls for this Grudge Thrower when it targets the unit you chose at the start of the first battle round.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Shattering`,\r\n        desc: `Grudge Rocks have a Damage characteristic of 6 instead of 3 if the target unit has 20 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Duardin Bolt Thrower': {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Duardin Artillery'),\r\n      {\r\n        name: `Penetrating Shot`,\r\n        desc: `If a wound roll for a Runic Bolt is 6+, that shot has a Damage characteristic of D6 and a Rend characteristic of -3.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Skewering`,\r\n        desc: `Add 1 to wound rolls for Runic Bolts if the target unit has 20 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warden King on Throne of Power': {\r\n    effects: [\r\n      {\r\n        name: `Ancestral Armour`,\r\n        desc: `Reroll failed save rolls for this model.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Great Book of Grudges`,\r\n        desc: `At the start of the first battle round, pick an enemy unit on the battlefield. Reroll failed wound rolls for this model for attacks made against that enemy unit.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Great Book of Grudges`,\r\n        desc: `Reroll failed wound rolls for this model for attacks made against the enemy unit you chose at the start of the first battle round.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Throne of Power`,\r\n        desc: `Once per game, in the charge phase, you may reroll one of the dice when determining this unit's charge distance.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Throne of Power`,\r\n        desc: `Reroll hit rolls of 1 for this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Thane with Battle Standard': {\r\n    effects: [\r\n      {\r\n        name: `Honour of the Clan`,\r\n        desc: `Reroll failed hit rolls when attacking with this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ancestral Rune Standard`,\r\n        desc: `In your hero phase, you can declare that this model will plant his Runic Standard. If you do, you may not move this model until your next hero phase, but until then he gains the following abilities:\r\n\r\n        Defiance of the Ancestors: Reroll failed save rolls for this model.\r\n\r\n        Rune of Spellbreaking: Subtract 2 from casting rolls for all enemy Wizards that are within 16\" of an Ancestral Rune Standard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Flame Cannon': {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Duardin Artillery'),\r\n      {\r\n        name: `Flame Burst`,\r\n        desc: `When firing a Flame Burst, pick a unit within range to suffer D3 mortal wounds. After firing a Flame Burst, roll a D6; on a 1, 2 or 3, the flames die out and the unit you shot suffers no further damage, but on a 4+ it is set ablaze and suffers another D3 mortal wounds before the flames are extinguished.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Burning`,\r\n        desc: `A Flame Burst inflicts D6 mortal wounds on the target instead of D3 if the target unit has 20 or more models (it will also inflict an additional D6 mortal wounds instead of D3 if the unit is set ablaze, as described in Flame Burst).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst RangeFindingOpticsEffect = {\r\n  name: `Range-finding Optics`,\r\n  desc: `You can reroll hit rolls of 1 for this model in the shooting phase if they did not move in their preceding movement phase and there are no enemy models within 3\" of them.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyDwarfUnits = {\r\n  /*'Far-Ranger': {\r\n    effects: [\r\n      {\r\n        name: `Veteran Ranger`,\r\n        desc: `Instead of setting up this unit on the battlefield, you can place it to\r\n        one side in hiding.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Veteran Ranger`,\r\n        desc: `At the end of your movement phase you may set this unit up anywhere on the battlefield that is more than 9\" from any enemy models.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Heirloom Tankard`,\r\n        desc: `Once per battle, in your hero phase, you may choose for this model to drink from this tankard to refresh and restore themselves. If you do so, heal D3 wounds that have been allocated to this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Gunmaster: {\r\n    effects: [RangeFindingOpticsEffect],\r\n  },\r\n\r\n  Huntmarshal: {\r\n    effects: [\r\n      {\r\n        name: `Monster Hunter`,\r\n        desc: `Add 1 to hit rolls for this model's attacks that target a Monster.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Huntmarshal's Bow`,\r\n        desc: `A Huntmarshal's Bow has a Damage characteristic of D6 instead of D3 for attacks that target a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Engineer on Mechanical Steed': {\r\n    effects: [\r\n      RangeFindingOpticsEffect,\r\n      {\r\n        name: `Clockwork Charge`,\r\n        desc: `Roll a D6 for each enemy unit that is within 1\" of this model after this model makes a charge move. On a 4+ the unit being rolled for suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Runelord on Anvil of Doom': {\r\n    effects: [\r\n      {\r\n        name: `Anvil of Doom`,\r\n        desc: `This model cannot make charge moves.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Anvil of Doom`,\r\n        desc: `This model cannot run.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Master Runes of Spellbreaking`,\r\n        desc: `This model can attempt to unbind two spells in each enemy hero phase as if it were a wizard. Add 2 to any unbinding rolls for this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Strike the Runes`,\r\n        desc: `In your hero phase, you can declare that the Runelord will strike a rune of power. If you do so, pick one of the following runes and roll a D6.\r\n\r\n        On a 1 the rune is struck incorrectly and nothing happens.\r\n        On a roll of 2+ the rune is struck correctly and you may apply its effects.\r\n\r\n        If this model is within 4\" of a friendly Apprentice Runesmith, then the Runelord can attempt to strike two different runes in your hero phase rather than one.\r\n\r\n        Rune of Hearth and Home: Reroll failed hit rolls for this unit until your next hero phase.\r\n        Rune of Oath and Steel: Add 1 to save rolls for this unit until your next hero phase.\r\n        Rune of Wrath and Ruin: Pick an enemy unit that is visible to the Runelord and is within 24\" of him. That unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SAVES_PHASE } from 'types/phases'\r\n\r\nconst TalismanOfArcanePowerEffect = {\r\n  name: `Talisman of Arcane Power`,\r\n  desc: `You can add 1 to any unbinding rolls for an Archmage with a Talisman of Arcane Power.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst DeflectShotsEffect = {\r\n  name: `Deflect Shots`,\r\n  desc: `You can reroll failed save rolls for this unit in the shooting phase.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyEldritchUnits = {\r\n /* Swordmasters: {\r\n    effects: [\r\n      {\r\n        name: `Bladelord`,\r\n        desc: `The leader of this unit is a Bladelord. A Bladelord makes 3 attacks\r\n        rather than 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      GenericEffects.InfantryHornblowerEffect,\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. If the unit includes any Standard Bearers, add 1 to the Bravery of its models. Add 2 to their Bravery instead if the unit is within 8\" of another Eldritch Council unit from your army that includes a Standard Bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `A Blur of Blades`,\r\n        desc: `You can reroll hit rolls of 1 when attacking with a Swordmaster.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      DeflectShotsEffect,\r\n    ],\r\n  },\r\n\r\n  Archmage: {\r\n    effects: [\r\n      {\r\n        name: `Aelven Steed`,\r\n        desc: `An Archmage can ride an Aelven Steed. If he does so, his Move is increased to 14\" and he gains the Swift Hooves attack.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      TalismanOfArcanePowerEffect,\r\n      {\r\n        name: `Wizard`,\r\n        desc: `An Archmage is a wizard. He can attempt to cast one spell in each of your own hero phases, and attempt to unbind one spell in each enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Elemental Shield spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Elemental Shield`,\r\n        desc: `Casting value of 6. Until your next hero phase, you can roll a D6 each time the Archmage, or a model in your army within 18\" of him, suffers a wound or a mortal wound. On the roll of a 6 that hit is deflected by the magical barrier surrounding the Archmage and is ignored.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Archmage on Dragon': {\r\n    effects: [\r\n      TalismanOfArcanePowerEffect,\r\n      GenericEffects.Dragonfire,\r\n      {\r\n        name: `Wizard`,\r\n        desc: `An Archmage on Dragon is a wizard. He can attempt to cast one spell in each of your own hero phases, and attempt to unbind two spells in each enemy hero phase. An Archmage with an Arcane Tome can attempt to cast two different spells in each of your hero phases instead of just one, and attempt to unbind two spells in each enemy hero phase. An Archmage on Dragon knows the Arcane Bolt, Mystic Shield and Drain Magic spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Drain Magic`,\r\n        desc: `Casting value of 4. Select a visible unit within 18\". Any spells that are affecting that unit immediately cease. Furthermore, if that unit is a Daemon unit, it suffers D3 mortal wounds as the magic sustaining their forms is ripped away and dissipated by the vortex. If that unit is an Endless Spell, it is dispelled.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  Drakeseer: {\r\n    effects: [\r\n      {\r\n        name: `Warrior Mage`,\r\n        desc: `A Drakeseer makes 3 attacks with his Sunstaff instead of 1 if he charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      GenericEffects.Dragonfire,\r\n      {\r\n        name: `Wizard`,\r\n        desc: `A Drakeseer is a wizard. He can attempt to cast one spell in each of your own hero phases, and attempt to unbind one spell in each enemy hero phase. He knows the Arcane Bolt, Mystic Shield, and Flames of the Phoenix spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flames of the Phoenix`,\r\n        desc: `Casting value of 7. Pick a visible enemy unit within 18\". That unit suffers a mortal wound as it is set ablaze.\r\n\r\n        Then, roll another dice - if the result is a 3 or less the flames die out and this spell ends.\r\n\r\n        On a 4 or more, however, the unit suffers an additional 2 mortal wounds and continues to burn; roll another dice - if the result is a 3 or less the fire dies out, but on a 4 or more, the unit suffers an additional 3 mortal wounds and the conflagration continues.\r\n\r\n        Keep rolling extra dice in this way, inflicting 1 more mortal wound than last time you rolled, until either the flames die out or the unit does!`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  Loremaster: {\r\n    effects: [\r\n      DeflectShotsEffect,\r\n      {\r\n        name: `Wizard`,\r\n        desc: `A Loremaster is a wizard. He can attempt to cast one spell in each of your hero phases, and attempt to unbind one spell in each enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Hand of Glory spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hand of Glory`,\r\n        desc: `Casting value of 5. Pick a model within 18\". Until your next hero phase you can reroll all failed hit rolls and wound rolls for that model.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst StandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `Add 1 to the Bravery characteristic of the unit while it includes any Standard Bearers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst HornblowerEffect = {\r\n  name: `Hornblower`,\r\n  desc: `Reroll any dice rolls of 1 when determining how far this unit can run or charge while it includes any Hornblowers.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst EnchantedShieldEffect = {\r\n  name: `Enchanted Shield`,\r\n  desc: `Reroll failed save rolls for this model.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyHighElvesUnits = {\r\n /* 'Highborn Repeater Bolt Thrower': {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Crewed War Machine'),\r\n      {\r\n        name: `Bolt Selection`,\r\n        desc: `Each time a Highborn Repeater Bolt Thrower is fired in the shooting phase, the crew can load and fire either Ithilmar Bolts or volleys of Repeating Bolts. They cannot load and fire both in the same turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Highborn Archers': {\r\n    effects: [\r\n      {\r\n        name: `Hawkeye`,\r\n        desc: `The leader of this unit is a Hawkeye. Add 1 to hit rolls for a Hawkeye in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      StandardBearerEffect,\r\n      HornblowerEffect,\r\n      {\r\n        name: `Aelven Archery`,\r\n        desc: `Add 1 to hit rolls for this unit in the shooting phase while it has 20 or more models and there are no enemy models within 3\" of it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Storm of Arrows`,\r\n        desc: `Once per battle, you can declare that this unit will fire a Storm of Arrows in their shooting phase; when you do so, add 1 to the Attacks characteristic of their Silverwood Longbows. This unit cannot fire a Storm of Arrows if there are any enemy models within 3\" of it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Highborn Spearmen': {\r\n    effects: [\r\n      {\r\n        name: `Sentinel`,\r\n        desc: `The leader of this unit is a Sentinel. Add 1 to the Attacks characteristic of the Sentinel's Silverwood Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      StandardBearerEffect,\r\n      HornblowerEffect,\r\n      GenericEffects.AelvenShield,\r\n      {\r\n        name: `Militia`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's Silverwood Spears while it has 20 or more models. Spear Phalanx.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Spear Phalanx`,\r\n        desc: `Reroll hit rolls of 1 for this unit if it did not move in its preceding movement phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Highborn Silver Helms': {\r\n    effects: [\r\n      {\r\n        name: `High Helm`,\r\n        desc: `The leader of this unit is a High Helm. Add 1 to the Attacks characteristic of the High Helm's Ithilmar Lance and Sword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      HornblowerEffect,\r\n      StandardBearerEffect,\r\n      GenericEffects.AelvenShield,\r\n      {\r\n        name: `Lance Charge`,\r\n        desc: `Add 1 to wound rolls for this unit's Ithilmar Lances and Swords and increase the Damage characteristic of the weapons by 1 if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dragon Blades': {\r\n    effects: [\r\n      {\r\n        name: `Drakemaster`,\r\n        desc: `The leader of this unit is a Drakemaster. A Drakemaster makes 3 attacks rather than 2 with his Drake Lance and Sword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. If the unit includes any Standard Bearers, add 1 to the Bravery of its models. Add 2 to their Bravery instead if the unit is within 8\" of another Order Draconis unit from your army that includes a Standard Bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      HornblowerEffect,\r\n      {\r\n        name: `Lance Charge`,\r\n        desc: `Add 1 to the wound rolls and Damage of this unit's Drake Lances and Swords if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Drake Shield`,\r\n        desc: `You can reroll save rolls of 1 for a unit with Drake Shields. You can instead reroll failed save rolls of 1 or 2 for this unit in the shooting phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Ancient Dignity`,\r\n        desc: `This unit does not need to take a battleshock test if it is within 16\" of any friendly ORDER DRACONIS HERO.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Seawarden on Foot': {\r\n    effects: [\r\n      EnchantedShieldEffect,\r\n      {\r\n        name: `Sea Drake Pennant`,\r\n        desc: `A Seawarden with a Sea Drake Pennant gains the Totem keyword. Add 1 to all wound rolls for Highborn units from your army if they are within 8\" of a friendly Sea Drake Pennant when they attack.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stand Fast!`,\r\n        desc: `If a Seawarden uses this ability, pick a friendly Highborn unit within 16\". That unit cannot move or charge this turn, but you can reroll hit rolls, wound rolls and save rolls for it until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n  'Dragon Noble': {\r\n    effects: [\r\n      {\r\n        name: `Aelven Purebred`,\r\n        desc: `Some Dragon Nobles ride to battle on Aelven Purebreeds; these models have Move 12\" instead of 6\" and gain the steed's lthilmar-shod Hooves attack.`,\r\n        when: [MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Phoenix Banner`,\r\n        desc: `A Noble with a Phoenix Banner gains the Totem keyword. You can reroll any dice when determining the charge distance for Order Draconis units from your army if they are within 16\" of this model when they charge.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Star Lance`,\r\n        desc: `Add 1 to the wound rolls and Damage of a Star Lance if the Dragon Noble charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      EnchantedShieldEffect,\r\n      {\r\n        name: `Might of the Dragon`,\r\n        desc: `If a Noble uses this ability, pick a Order Draconis unit within 16\". Until your next hero phase you can reroll all failed hit rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n  Dragonlord: {\r\n    effects: [\r\n      {\r\n        name: `Dragon Lance`,\r\n        desc: `Add 1 to the wound rolls and Damage of a Dragon Lance if the Dragonlord charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aelven War Horn`,\r\n        desc: `Once per game, in your hero phase, a Dragonlord with an Aelven War Horn can blow it to sound the attack. When he does so, all models in Order Draconis units from your army within 10\" of this model when they attack in your next combat phase make one extra attack with each of their melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      EnchantedShieldEffect,\r\n      GenericEffects.Dragonfire,\r\n      {\r\n        name: `Lord of Dragons`,\r\n        desc: `If a Dragonlord uses this ability, then until your next hero phase you can reroll failed hit rolls for any Order Draconis unit from your army that is within 10\" when it attacks in the combat phase.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst DeadlyVenomEffect = {\r\n  name: `Deadly Venom`,\r\n  desc: `Each time you roll a hit roll of 6+ for this unit, that attack inflicts 1 mortal wound instead of normal damage (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyOrderUnits = {\r\n/*  'Hunting Hounds': {\r\n    effects: [\r\n      {\r\n        name: `Hounds of the Wild Hunt`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's Savage Teeth while it is within 6\" of any friendly Avatars of the Hunt.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Great Eagles': {\r\n    effects: [\r\n      {\r\n        name: `Death from the Skies`,\r\n        desc: `Add 2 to the Attacks characteristic of this unit's Beaks and Talons if it made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Soar Away`,\r\n        desc: `At the end of the combat phase you may declare that this unit will swoop out of combat and soar away as long as there are enemy models within 3\" of it. If you do, roll 3D6; the result is how far you can immediately move this unit. The unit must end this move more than 3\" from any enemy units - if they are unable to do so then they fail to escape and cannot swoop out of combat and soar away.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tree Kin': {\r\n    effects: [\r\n      {\r\n        name: `Roused to War`,\r\n        desc: `Add 1 to hit rolls for this unit's Bludgeoning Branches if it made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Greatcannon: {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Crewed Artillery'),\r\n      {\r\n        name: `Grapeshot`,\r\n        desc: `Instead of firing a Cannon Ball using the profile above in the shooting phase, the Crew can load their war machine with grapeshot; if they do, then select a target that is visible to the Greatcannon. Roll one dice for each model in the target unit that is within 10\" of the Greatcannon; for each roll of a 6, that unit suffers a mortal wound.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knights of Order': {\r\n    effects: [\r\n      {\r\n        name: `Preceptor`,\r\n        desc: `The leader of this unit is a Preceptor. Add 1 to the Attacks characteristic of the Preceptor's Lance and Sword or Cavalry Hammer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. While the unit includes any Standard Bearers, it only needs to take a battleshock test if two or more of its models were slain during the turn.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Hornblower`,\r\n        desc: `Models in this unit may be Hornblowers. If the unit includes any Hornblowers, add 2 to its charge rolls.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Shield`,\r\n        desc: `Reroll save rolls of 1 for a unit equipped with Shields.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Charging Lance`,\r\n        desc: `Add 1 to the wound rolls and Damage characteristic for this unit's Lances and Swords if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Archers': {\r\n    effects: [\r\n      {\r\n        name: `Marksman`,\r\n        desc: `The leader of this unit is a Marksman. Add 1 to the hit rolls for a Marksman using a Bow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Huntsmen`,\r\n        desc: `After set-up is complete, you can make a bonus move with this unit as if it were moving in the movement phase.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Ordered Volleys`,\r\n        desc: `You can reroll hit rolls of 1 for Freeguild Archers in the shooting phase. You can reroll hit rolls of 1 or 2 instead if the unit has 20 or more models, or reroll any failed hit roll if it has 30 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Swarms': {\r\n    effects: [\r\n      {\r\n        name: `Swarming Tide`,\r\n        desc: `In your hero phase, you may heal D3 wounds allocated to this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      DeadlyVenomEffect,\r\n    ],\r\n  },\r\n  'Chameleon Skink Stalker': {\r\n    effects: [\r\n      {\r\n        name: `Chameleon Ambush`,\r\n        desc: `Instead of setting up this model, you can place it to one side and say that it is in hiding.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Chameleon Ambush`,\r\n        desc: `At the end of your movement phase you can reveal this model by setting it up anywhere on the battlefield, more than 9\" from any enemy models.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Disappear from Sight`,\r\n        desc: `In your hero phase, you can declare that the Skink Stalker will vanish from sight and go into hiding. If it does so, remove this model from the battlefield. You can reveal it as described in the Chameleon Ambush ability in this turn or any subsequent turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flawless Mimicry`,\r\n        desc: `If this model is within or on a terrain feature, its Save characteristic is 3+ rather than 6+. This includes the bonus for being in cover.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Master Hunter`,\r\n        desc: `Add 2 to the result of wound rolls for this model's Stalker Blowpipe if it did not move, and was not set up, in the movement phase of the same turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Witch Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Baroque Pistols`,\r\n        desc: `A Witch Hunter equipped with two Baroque Pistols makes 2 attacks in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Grim Resolve`,\r\n        desc: `Roll a D6 if a Witch Hunter is targeted or affected by an enemy spell. On a 5 of more, that spell has no effect on the Witch Hunter (but it may affect other units normally).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sigmar's Judgement`,\r\n        desc: `A Witch Hunter's attacks inflict D3 Damage instead of 1 if the target of the attack is a Wizard or a Daemon.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'War Altar of Sigmar': {\r\n    effects: [\r\n      {\r\n        name: `Divine Power`,\r\n        desc: `The Arch Lector atop a War Altar of Sigmar can attempt to unbind 2 spells in each enemy hero phase as if it were a wizard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sigmar's Shield`,\r\n        desc: `If a friendly Devoted of Sigmar model is slain by a wound or mortal wound that has been allocated to the model while it is within range of any friendly models with the Sigmar's Shield ability, roll a D6 before the slain model is removed from play. On a 6, the wound or mortal wound is negated and the model is not slain. The range of the Sigmar's Shield ability for this model is shown on the damage table on the warscroll.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `The Power of Faith`,\r\n        desc: `Devoted of Sigmar units from your army do not need to take battleshock tests if they are within 10\" of a War Altar.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Light of Banishment`,\r\n        desc: `When you make a Light of Banishment attack against a Chaos unit, double any wounds it suffers. The holy light is especially dangerous to Chaos Daemons, who cannot abide its searing touch. Furthermore, attacks against these units are resolved with a Rend of -2 instead of -1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Devotional Horn`,\r\n        desc: `Once per battle, the Devotional Horn can be blown in a battleshock phase. When it is blown, all enemy units within 10\" of the War Altar must subtract 1 from their Bravery until the end of that phase.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Prayers`,\r\n        desc: `In your hero phase, the Arch Lector can pray to Sigmar. If he does so, pick a Devoted of Sigmar unit within 10\", select one of the following blessings and roll a D6. On a 1 or a 2, his prayers go unanswered, but on a 3 or more they have been heard:\r\n\r\n        Soulfire: Roll a D6 for each enemy unit within 3\" of the unit you picked; on a 4 or more it is struck by soulfire and suffers a mortal wound.\r\n\r\n        Righteous Fury: Until your next hero phase you can reroll failed hit rolls for the unit in the combat phase.\r\n\r\n        Holy Fervour: Until your next hero phase, you can add 1 to the unit's run rolls, charge rolls, and hit rolls in the combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skink Prophet': {\r\n    effects: [\r\n      DeadlyVenomEffect,\r\n      {\r\n        name: `Priestly Rites`,\r\n        desc: `In your hero phase, you may declare that this model is performing a rite to harness the power of the heavens. If you do so, roll a D6. If the result is 4+ you can reroll run rolls, charge rolls and save rolls for this model until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Priestly Rites`,\r\n        desc: `If active, you can reroll run rolls for this model until your next hero phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Priestly Rites`,\r\n        desc: `If active, you can reroll charge rolls for this model until your next hero phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Priestly Rites`,\r\n        desc: `If active, you can reroll save rolls for this model until your next hero phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skink Chief': {\r\n    effects: [\r\n      {\r\n        name: `Marked for Greatness`,\r\n        desc: `You can reroll a single dice for this model in each phase.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE, COMBAT_PHASE, BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Star-buckler`,\r\n        desc: `When making save rolls for this model, ignore the attacking weapon's Rend characteristic unless it is -2 or better.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warrior Priest': {\r\n    effects: [\r\n      {\r\n        name: `Warhorse`,\r\n        desc: `A Warrior Priest can be mounted on a barded Warhorse, granting them a Move of 12\" and the Steel-shod Hooves attack.`,\r\n        when: [MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sigmarite Shield`,\r\n        desc: `A Warrior Priest with a Sigmarite Shield has a Save of 3+.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Sigmarite Warhammers`,\r\n        desc: `You can reroll hit rolls of 1 for a Warrior Priest armed with two Sigmarite Warhammers.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Divine Power`,\r\n        desc: `A Warrior Priest can attempt to unbind 1 spell in each enemy hero phase, as if he were a wizard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Prayers`,\r\n        desc: `In your hero phase, a Warrior Priest can pray to Sigmar. If he does so, pick a Devoted of Sigmar unit within 10\", select one of the following blessings and roll a D6. On a 1 or a 2, his prayers go unanswered, but on a 3 or more they have been heard:\r\n\r\n        Shield of Faith: Until your next hero phase, you can roll a D6 each time the unit suffers a wound or a mortal wound. On a 6, that wound is ignored.\r\n\r\n        Hammer of Sigmar: Until your next hero phase you can reroll failed wound rolls for the unit in the combat phase.\r\n\r\n        Healing Hands: One model in the unit immediately heals D3 wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst FleetOfWingEffect = {\r\n  name: `Fleet of Wing`,\r\n  desc: `If this model runs, roll 2D6 instead of one and use the total when determining how much extra it can move.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst SwifthawkDiscipline = {\r\n  name: `Swifthawk Discipline`,\r\n  desc: `If you fail a battleshock test for this unit whilst a Swifthawk Agents Hero from your army is within 16\", halve the number of models that flee (rounding fractions up).`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacySwifthawkAgentUnits = {\r\n/*  Chariots: {\r\n    effects: [\r\n      {\r\n        name: `Graceful Charge`,\r\n        desc: `You can reroll all failed wound rolls for a Chariot in the combat phase if it made a charge in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Swift and Deadly`,\r\n        desc: `If a Chariot runs there is no need to roll a D6, it can always move up to an extra 6\".`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Swift and Deadly`,\r\n        desc: `Chariots can pile in up to 6\", instead of 3\".`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'High Warden': {\r\n    effects: [\r\n      {\r\n        name: `Predatory Leap`,\r\n        desc: `When this model piles in it can move up to 6\" and can move over enemy models. Furthermore, it does not have to move towards the closest enemy model, as long as it ends its move within 1/2\" of an enemy unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Starwood Lance`,\r\n        desc: `Add 1 to the wound rolls and Damage of a Starwood Lance if this model charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hurricane Charge`,\r\n        desc: `If a High Warden uses this ability, then until your next hero phase you can reroll any dice when determining the charge distance for Swifthawk Agents from your army if they are within 16\" of this model when they charge.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  Reavers: {\r\n    effects: [\r\n      {\r\n        name: `Harbinger`,\r\n        desc: `The leader of this unit is a Harbinger. A Harbinger wields a Starsteel Blade in place of a Starwood Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aelven Purebreeds`,\r\n        desc: `In the shooting phase, before or after making attacks with this unit, you can roll two dice and move all of the models in this unit up to that many inches. Models cannot start or end this move within 3\" of an enemy unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Swift Volleys`,\r\n        desc: `Models in this unit make 3 attacks with their Reaver Cavalry Bows if the unit is not within 3\" of an enemy unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Skycutters: {\r\n    effects: [\r\n      GenericEffects.AelvenShield,\r\n      FleetOfWingEffect,\r\n      {\r\n        name: `Agents' Blades and Spears`,\r\n        desc: `If a Skycutter is crewed by a trio of Agents, it makes 3 attacks with its Agents' Blades and Spears instead of 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sky Chariot`,\r\n        desc: `Skycutters can shoot even if they ran in their movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      SwifthawkDiscipline,\r\n    ],\r\n  },\r\n\r\n  Skywarden: {\r\n    effects: [\r\n      {\r\n        name: `Enchanted Shield`,\r\n        desc: `You can reroll all failed save rolls for this model.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Swifthawk Pennant`,\r\n        desc: `A Skywarden with a Swifthawk Pennant gains the Totem keyword. You can add 1 to all wound rolls for all Swifthawk Agents from your army if they are within 16\" of this model when they attack.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Windrider`,\r\n        desc: `A Skywarden has a Save of 4+ instead of 5+ in the shooting phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      FleetOfWingEffect,\r\n      {\r\n        name: `Swoop and Attack!`,\r\n        desc: `If a Skywarden uses this ability, Swifthawk Agents in your army that can fly can charge in your next charge phase even if they ran this turn.`,\r\n        when: [HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  },\r\n\r\n  Spireguard: {\r\n    effects: [\r\n      {\r\n        name: `Watch Master`,\r\n        desc: `The leader of this unit is a Watch Master. A Watch Master makes 2 attacks rather than 1 with a Silverwood Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      GenericEffects.InfantryHornblowerEffect,\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. If the unit includes any Standard Bearers, add 1 to the Bravery of its models. Add 2 to their Bravery instead if the unit is within 8\" of another Swifthawk Agents unit from your army that includes a Standard Bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      GenericEffects.AelvenShield,\r\n      {\r\n        name: `Strength of the Spireguard`,\r\n        desc: `You can reroll hit rolls of 1 for a Spireguard if its unit has 20 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      SwifthawkDiscipline,\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst getShadowdancerBaseEffects = (attacks: 1 | 2) => [\r\n  {\r\n    name: `Shadow Dance`,\r\n    desc: `At the start of your hero phase, you may declare that this unit will perform a shadow dance. Choose one of the dances from the list below. The dance lasts until the start of your next hero phase. The same dance cannot be performed by the same unit in consecutive battle rounds.\r\n\r\n    Whirling Death: Add 1 to wound rolls for this unit's Weaving Blades and change their Rend characteristic to -1.\r\n\r\n    Storm of Blades: Add ${attacks} to the Attacks characteristic of this unit's Weaving Blades.\r\n\r\n    The Shadow's Coil: Add 2 to this unit's save rolls.`,\r\n    when: [START_OF_HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Talismanic Tattoos`,\r\n    desc: `Roll a D6 each time a wound or mortal is allocated to this unit. On a 6 the wound or mortal wound is negated.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst SoporificBreathEffect = {\r\n  name: `Soporific Breath`,\r\n  desc: `Enemy units within 3\" of this model cannot be chosen to make attacks in the combat phase until all other units have made their attacks.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst KindredShieldEffect = {\r\n  name: `Kindred Shield`,\r\n  desc: `Reroll failed save rolls for this model.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst LionCloakEffect = {\r\n  name: `Lion Cloak`,\r\n  desc: `You can reroll save rolls of 1 for this unit in the shooting phase.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nexport const LegacyWoodElvesUnits = {\r\n /* 'Avatar of the Hunt': {\r\n    effects: [\r\n      {\r\n        name: `Cloak of Leaves`,\r\n        desc: `In your hero phase, you can heal 1 wound that has been allocated to this model. In addition, this model can attempt to unbind one spell in the enemy hero phase in the same manner as a wizard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Horn of the Wild Hunt`,\r\n        desc: `You may reroll the dice when determining the charge distance for this model and friendly Hunting Hounds units within 8\" of it at the start of the charge phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Lord on Purebred Steed': {\r\n    effects: [\r\n      {\r\n        name: `Hunter's Strike`,\r\n        desc: `Increase the Damage characteristic of the Glade Lord's Starlight Hunting Spear to D3 if this model made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      KindredShieldEffect,\r\n    ],\r\n  },\r\n  'Glade Lord on Great Eagle': {\r\n    effects: [\r\n      {\r\n        name: `Death from the Skies`,\r\n        desc: `Add 2 to the Attacks characteristic of the Great Eagle's Beak and Talons if this model made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Lord on Great Stag': {\r\n    effects: [\r\n      {\r\n        name: `Impaling Charge`,\r\n        desc: `Add 1 to the Damage characteristic of the Great Stag's Mighty Antlers if this model made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Lord on Forest Dragon': {\r\n    effects: [\r\n      SoporificBreathEffect,\r\n      KindredShieldEffect,\r\n      {\r\n        name: `Starlight Strike`,\r\n        desc: `Add 1 to the Damage characteristic of the Glade Lord's Starlight Spear if this model made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Wardancers: {\r\n    effects: [\r\n      {\r\n        name: `Drummer`,\r\n        desc: `You can reroll the dice when determining how far this unit runs if it includes Drummers.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Bladesinger`,\r\n        desc: `A Bladesinger fights with Weaving Blades and a War Stave.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ...getShadowdancerBaseEffects(1),\r\n    ],\r\n  },\r\n  Waywatchers: {\r\n    effects: [\r\n      {\r\n        name: `Waywatcher Sentinel`,\r\n        desc: `Add 1 to the Attacks characteristic of the Waywatcher Sentinel's Longbow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hawk-eyed Archers`,\r\n        desc: `Each time this unit shoots its Longbows, you can declare that it will make either Fast Shots or Precise Shots:\r\n\r\n        Fast Shots: Add 1 to the Attacks characteristic of this unit's Longbows until the end of this phase. In addition, for each hit roll of 6+, the attacking model can make one additional attack with its Longbow.\r\n\r\n        Precise Shots: Add 1 to the Damage characteristic of this unit's Longbows until the end of this phase. In addition, for each wound roll of 6+, that attack is resolved with a Rend characteristic of -2 instead of '-'. `,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Invisible Hunter`,\r\n        desc: `If this unit is in cover, subtract 1 from hit rolls that target it.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Riders': {\r\n    effects: [\r\n      {\r\n        name: `Glade Knight`,\r\n        desc: `Add 1 to the Attacks characteristic of the Glade Knight's Riding Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Pennant Bearer`,\r\n        desc: `While the unit includes any Pennant Bearers, add 1 to its Bravery characteristic. Add 2 to its Bravery characteristic instead if the unit is in cover.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Hornblower`,\r\n        desc: `You can reroll the dice when determining how far this unit can run while it includes any Hornblowers.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Fire on the Move`,\r\n        desc: `This unit can run and shoot in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Shadowdancer: {\r\n    effects: [\r\n      ...getShadowdancerBaseEffects(2),\r\n      {\r\n        name: `Bridge of Shadows`,\r\n        desc: `Casting value of 5. For the duration of your next Movement phase this model's Move characteristic is doubled and it can fly.`,\r\n        when: [HERO_PHASE],\r\n        spell: true,\r\n      },\r\n    ],\r\n  },\r\n  'Warhawk Riders': {\r\n    effects: [\r\n      {\r\n        name: `Predator's Descent`,\r\n        desc: `Add 1 to the Damage characteristic of this unit's Hunting Spears if it made a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Swift of Wing`,\r\n        desc: `You always count as having rolled a 6 when making a run move for this unit - do not roll a D6.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sweep Through Their Lines`,\r\n        desc: `If, after this unit has made its attacks in the combat phase, there are no enemy models within 3\", it can immediately pile in 6\" and attack again.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Twilight Sisters on Forest Dragon': {\r\n    effects: [\r\n      SoporificBreathEffect,\r\n      {\r\n        name: `Impetuous Beast`,\r\n        desc: `If this model is within 12\" of any enemy model at the start of your charge phase, you must attempt to charge with it.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dawnbow`,\r\n        desc: `Add 1 to wound rolls for this model's Dawnbow when targeting a CHAOS unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Duskbow`,\r\n        desc: `Add 1 to wound rolls for this model's Duskbow when targeting an ORDER unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Conjoined Destiny`,\r\n        desc: `Roll a D6 for this unit in your hero phase. If the result is odd, nothing happens. If the result is even, you can heal a number of wounds that have been allocated to this model equal to the dice result.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Captain Battle Standard Bearer': {\r\n    effects: [\r\n      {\r\n        name: `To Their Dying Breath`,\r\n        desc: `If this model is slain in the combat phase, before you remove it you can immediately make a pile in move and then attack with it.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Banner of the Forests`,\r\n        desc: `In your hero phase, you can declare that this model will plant his standard in the ground. If you do so, you may not move this model until your next hero phase. Roll a D6 for each enemy unit within 10\". On a 4+, halve that unit's Move characteristic (rounding up) until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'White Lion Chariots': {\r\n    effects: [\r\n      LionCloakEffect,\r\n      {\r\n        name: `Unbridled Ferocity`,\r\n        desc: `A White Lion Chariot's War Lions make 8 attacks with their Fangs and Claws instead of 4 if this model charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'White Lions': {\r\n    effects: [\r\n      {\r\n        name: `Guardian`,\r\n        desc: `The leader of this unit is a Guardian. A Guardian makes 3 attacks rather than 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hornblower`,\r\n        desc: `Models in this unit may be Hornblowers. You can reroll any dice rolls of 1 when determining how far this unit can run or charge if it includes any Hornblowers.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `Models in this unit may be Standard Bearers. If the unit includes any Standard Bearers, add 1 to the Bravery of its models. Add 2 to their Bravery instead if the unit is within 8\" of another Lion Rangers unit from your army that includes a Standard Bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      LionCloakEffect,\r\n      {\r\n        name: `Unflinching Courage`,\r\n        desc: `Roll a D6 each time a White Lion flees; on a 4 or more that model's courage stirs up within him and he returns to the battle - he does not flee.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n","import { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport { LegacyBretonnianUnits } from './unit_groups/bretonnia'\r\nimport { LegacyDuardinUnits } from './unit_groups/duardin'\r\nimport { LegacyDwarfUnits } from './unit_groups/dwarfs'\r\nimport { LegacyEldritchUnits } from './unit_groups/eldritch'\r\nimport { LegacyEmpireUnits } from './unit_groups/empire'\r\nimport { LegacyHighElvesUnits } from './unit_groups/high_elves'\r\nimport { LegacyOrderUnits } from './unit_groups/misc_order'\r\nimport { MonstrousArcanumOrder } from './unit_groups/monstrous_arcanum'\r\nimport { LegacySwifthawkAgentUnits } from './unit_groups/swifthawk_agents'\r\nimport { LegacyWoodElvesUnits } from './unit_groups/wood_elves'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst OrderUnits = {\r\n  /*'Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Avatar of Grimnir`,\r\n        desc: `If the damage inflicted by an attack, spell or ability that targets or affects this model is greater than 1, change it to 1. In addition, if a spell or ability would slay this model, this model suffers 1 mortal wound instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [meta_rule_sources.CROSS_FACTION_HEROES_JULY_2022],\r\n      },\r\n      {\r\n        name: `Avatar of Grimnir`,\r\n        desc: `If this model is included in your army, it cannot be set up in reserve (it must be set up on the battlefield), and you cannot use spells or abilities on this model that would allow you to set it up again after the battle has begun.`,\r\n        when: [START_OF_GAME],\r\n        rule_sources: [meta_rule_sources.CROSS_FACTION_HEROES_JULY_2022],\r\n      },\r\n      {\r\n        name: `Krag Blackhammer's Master Rune`,\r\n        desc: `You can reroll hit rolls and wound rolls for attacks made by this model. In addition, if the unmodified hit roll for an attack made by this model is 6, that attack inflicts D6 mortal wounds on the target in addition to any normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CROSS_FACTION_HEROES_JULY_2022],\r\n      },\r\n      {\r\n        name: `Unstoppable Battle Fury`,\r\n        desc: `At the end of the combat phase, if this model is within 3\" of an enemy unit, this model can fight again.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.CROSS_FACTION_HEROES_JULY_2022],\r\n      },\r\n      {\r\n        name: `Shoulder Plate of Edassa`,\r\n        desc: `Roll a dice each time you allocate a wound or mortal wound to this model. On a 3+, that wound or mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [meta_rule_sources.CROSS_FACTION_HEROES_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n  \"Fjori's Flamebearers\": {\r\n    effects: [\r\n      {\r\n        name: `Toe to Toe`,\r\n        desc: `Enemy MONSTERS within 3\" of any units in this regiment of renown cannot contest objectives.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Defiance of Grimnir`,\r\n        desc: `Units in this regiment of renown cannot be picked when your opponent carries out a monstrous rampage.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n    ],\r\n  }, */\r\n  ...LegacyBretonnianUnits,\r\n  ...LegacyDuardinUnits,\r\n  ...LegacyDwarfUnits,\r\n  ...LegacyEldritchUnits,\r\n  ...LegacyEmpireUnits,\r\n  ...LegacyHighElvesUnits,\r\n  ...LegacyOrderUnits,\r\n  ...LegacySwifthawkAgentUnits,\r\n  ...LegacyWoodElvesUnits,\r\n  ...MonstrousArcanumOrder,\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(OrderUnits, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { ORDER_GRAND_ALLIANCE } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandTraits from './command_traits'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [ORDER_GRAND_ALLIANCE]: {\r\n    effects: pickEffects(BattleTraits, ['Order']),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      command_traits: [CommandTraits],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { ORDER_GRAND_ALLIANCE } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const OrderFaction = new Faction(ORDER_GRAND_ALLIANCE, ORDER, SubFactions)\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport { mergeParentEffectObjs } from 'factions/temporaryAdapter'\r\nimport { ChaosFaction } from './chaos'\r\nimport ChaosArtifacts from './chaos/artifacts'\r\nimport ChaosTraits from './chaos/command_traits'\r\nimport ChaosUnits from './chaos/units'\r\nimport { DeathFaction } from './death'\r\nimport DeathArtifacts from './death/artifacts'\r\nimport DeathTraits from './death/command_traits'\r\nimport DeathUnits from './death/units'\r\nimport { DestructionFaction } from './destruction'\r\nimport DestructionArtifacts from './destruction/artifacts'\r\nimport DestructionTraits from './destruction/command_traits'\r\nimport DestructionUnits from './destruction/units'\r\nimport { OrderFaction } from './order'\r\nimport OrderArtifacts from './order/artifacts'\r\nimport OrderTraits from './order/command_traits'\r\nimport OrderUnits from './order/units'\r\n\r\n// Available to ALL factions in this Grand Alliance\r\nconst AvailableOrderUnits = mergeParentEffectObjs([\r\n  keyPicker(OrderUnits, []),\r\n])\r\nconst AvailableDestructionUnits = mergeParentEffectObjs([{ ...DestructionUnits }])\r\nconst AvailableDeathUnits = mergeParentEffectObjs([keyPicker(DeathUnits, [])])\r\nconst AvailableChaosUnits = mergeParentEffectObjs([keyPicker(ChaosUnits, [])])\r\n\r\nexport {\r\n  AvailableChaosUnits,\r\n  AvailableDeathUnits,\r\n  AvailableDestructionUnits,\r\n  AvailableOrderUnits,\r\n  ChaosArtifacts,\r\n  ChaosFaction,\r\n  ChaosTraits,\r\n  ChaosUnits,\r\n  DeathArtifacts,\r\n  DeathFaction,\r\n  DeathTraits,\r\n  DeathUnits,\r\n  DestructionArtifacts,\r\n  DestructionFaction,\r\n  DestructionTraits,\r\n  DestructionUnits,\r\n  OrderArtifacts,\r\n  OrderFaction,\r\n  OrderTraits,\r\n  OrderUnits,\r\n}\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_ORRUK_WARCLANS: {\r\n    name: 'Battletome: Orruk Warclans (2021)',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_OCTOBER_2021: {\r\n    name: 'Errata (October 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/TPxg4RtP6GEezm8N.pdf',\r\n  },\r\n  ERRATA_DECEMBER_2021: {\r\n    name: 'Errata (December 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/Wc8ugHhzx0x4NAV4.pdf',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/ZHSSm4hs7Ud0plKY.pdf',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/koYAcRdlIdWRYJhN.pdf',\r\n  },\r\n  BATTLETOME_SUPPLEMENT_IRONJAWZ: {\r\n    name: 'Batteltome Supplement Ironjawz (December 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/09/r8DTAWmkrsW2fiRW.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_SHOOTING_PHASE,\r\n  END_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst IronjawzArtifacts = {\r\n  'Armour of Gork': {\r\n    effects: [\r\n      {\r\n        name: `Armour of Gork - Passive`,\r\n        desc: `Effect: This unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Trophy Skulls': {\r\n    effects: [\r\n      {\r\n        name: `Trophy Skulls - Passive`,\r\n        desc: `Effect: Add 10 to this units control score.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Amberbone Whetstone': {\r\n    effects: [\r\n      {\r\n        name: `Amberbone Whetstone`,\r\n        desc: `Effect: Pick 1 of this units weapons. Add 1 to the Rend characteristic of that weapon for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Squish Da Puny Gitz': {\r\n    effects: [\r\n      {\r\n        name: `Squish Da Puny Gitz`,\r\n        desc: `You can pick this battle tactic only if the model picked to be your general has the IRONJAWZ keyword and there is at least 1 enemy Battleline unit on the battlefield. You complete this tactic if there are no enemy Battleline units on the battlefield at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, HERO_PHASE, START_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst IronjawzBattleTraits = {\r\n  'Mighty Destroyers': {\r\n    effects: [\r\n      {\r\n        name: `Mighty Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Ironjawz unit that was not set up this turn to be the target. \r\n        Effect: The target can move up to 3\". It can move into combat. If it was in combat at the start of the move, it must end that move in combat.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ironjawz Waaagh!': {\r\n    effects: [\r\n      {\r\n        name: `Ironjawz Waaagh! - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Ironjawz Hero to be the target. \r\n        Effect: For the rest of the turn, the following effects apply to friendly Ironjawz units while they are wholly within 18\" of the target:  \r\n        Add 1 to charge rolls for those units.  \r\n        Add 1 to the Attacks characteristic of those units melee weapons.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzBattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE, HERO_PHASE } from 'types/phases'\r\n\r\nconst IronjawzCommandAbilities = {\r\n /* 'Mighty Destroyers': {\r\n    effects: [\r\n      {\r\n        name: `Mighty Destroyers`,\r\n        desc: `You can use this command ability in your hero phase. The model that issues the command must be an IRONJAWZ model and the unit that receives the command must be an IRONJAWZ unit.\r\n\r\n        - If the unit that received the command is more than 12\" from all enemy units, you must make a normal move with the unit.\r\n\r\n        - If the unit that received the command is within 3\" of an enemy unit, you must make a pile-in move with each model in the unit.\r\n\r\n        - If the unit is within 12\" of an enemy unit and more than 3\" from all enemy units, you must attempt a charge with the unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Alright, Get 'Em!\": {\r\n    effects: [\r\n      {\r\n        name: `Alright, Get 'Em!`,\r\n        desc: `You can use this command ability at the end of the enemy charge phase. The unit that receives the command must be a friendly IRONSUNZ unit that is within 12\" of an enemy unit and more than 3\" from all enemy units. That IRONSUNZ unit can attempt a charge.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzCommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, HERO_PHASE, MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst IronjawzCommandTraits = {\r\n  'Hulking Brute': {\r\n    effects: [\r\n      {\r\n        name: `Hulking Brute`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If this units unmodified charge roll this turn was 8+, roll a D6 instead of a D3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Mega Bossy': {\r\n    effects: [\r\n      {\r\n        name: `Mega Bossy - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to charge rolls for friendly Ironjawz units while they are wholly within 18\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'An Eye for Da Fight': {\r\n    effects: [\r\n      {\r\n        name: `An Eye for Da Fight - Reaction: You declared the Redeploy command for a friendly Ironjawz unit wholly within 12\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Touched by the Waaagh!': {\r\n    effects: [\r\n      {\r\n        name: `Touched by the Waaagh!`,\r\n        desc: `Before attempting to cast a spell with this general, you must pick a unit within 6\" of them. That unit suffers D3 mortal wounds but you can add the number of mortal wounds caused to that unit to the casting roll for the spell. If you pick this general to suffer the mortal wounds and they are slain by one of those wounds, the spell is not successfully cast.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Master of the Weird': {\r\n    effects: [\r\n      {\r\n        name: `Master of the Weird`,\r\n        desc: `You can pick 1 extra spell for this general from the Lore of the Weird (pg 91).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzCommandTraits, 'command_trait')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, END_OF_COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE } from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst IronjawzFlavors = {\r\n /* Ironsunz: {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, [\"Alright, Get 'Em!\"])],\r\n    },\r\n    effects: [],\r\n  },\r\n  Bloodtoofs: {\r\n    effects: [\r\n      {\r\n        name: `Hunt and Crush`,\r\n        desc: `At the end of the combat phase, friendly BLOODTOOFS GORE-GRUNTAS units that fought in that phase and are within 3\" of any enemy units can make a pile-in move. In addition, those that fought but are not within 3\" of any enemy units can each make a normal move or attempt a charge.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Ironjawz Brawl': {\r\n    effects: [\r\n      {\r\n        name: `Natural Disaster - Passive`,\r\n        desc: `Effect: If you make an unmodified charge roll of 8+ for a friendly non-Hero Ironjawz unit, add 1 to the Attacks characteristic of that units melee weapons for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grunta Stampede': {\r\n    effects: [\r\n      {\r\n        name: `'Ere We Come! - Passive`,\r\n        desc: `Effect: Add the number of enemy units that have been destroyed this battle to the Move characteristic of friendly Gore-Gruntas and Maw-Grunta units, to a maximum of +4.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ironfist': {\r\n    effects: [\r\n      {\r\n        name: `Smashin' and Bashin' - Passive`,\r\n        desc: `Effect: The first time each turn that an enemy unit is destroyed by a Fight ability used by a friendly Ironjawz unit, add 1 to hit rolls for combat attacks made by the next friendly Ironjawz unit that is picked to use a Fight ability for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Weirdfist': {\r\n    effects: [\r\n      {\r\n        name: `Spirit of Gork - Passive`,\r\n        desc: `Effect: Friendly Ironjawz Infantry units have Ward (6+) while they are wholly within 12\" of any friendly Ironjawz Wizards or Priests.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default IronjawzFlavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\nimport rule_sources from '../rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst MonstrousRampages = {\r\n/*  'Flattened into the Mud': {\r\n    effects: [\r\n      {\r\n        name: `Flattened into the Mud`,\r\n        desc: `Only a model in a unit that has made a charge move this turn can carry out this monstrous rampage. Pick an enemy unit with a Wounds characteristic of 1 or 2 within 3\" of this unit and roll a dice. If the roll is less than this unit's momentum score, the strike-last effect applies to that enemy unit until the end of the turn.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Carve a Path': {\r\n    effects: [\r\n      {\r\n        name: `Carve a Path`,\r\n        desc: `Pick an enemy unit with a Wounds characteristic of 4 or less within 3\" of this unit and roll a dice. If the roll is less than this unit's momentum score, that enemy unit suffers a number of mortal wounds equal to the roll and you can immediately attempt a charge with this unit even though it is within 3\" of an enemy unit. When a unit charges in this manner, it can pass across enemy units with a Wounds characteristic of 4 or less in the same manner as a unit that can fly.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst IronjawzSpells = {\r\n  'Lore of the Weird': {\r\n    effects: [\r\n      {\r\n        name: `Bash 'Em Ladz!: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Ironjawz Wizard to cast this spell, pick a visible friendly Ironjawz unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The targets melee weapons have Crit (2 Hits) for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mighty 'Eadbutt: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Ironjawz Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target. If the target is a Wizard, inflict 3 mortal damage on the target instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Da Great Big Green Hand of Gork: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Ironjawz Wizard to cast this spell, pick a visible friendly unit wholly within 9\" of them and not in combat to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again wholly within 24\" of the caster and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Brain-bursta': {\r\n    effects: [\r\n      {\r\n        name: `Brain-bursta`,\r\n        desc: `Casting value of 5. Pick 1 enemy unit within 16\" of the caster and visible to them, and roll 2D6. If the roll is greater than that unit's Bravery characteristic, that unit suffers D6 mortal wounds; if not, that unit suffers D3 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Mighty 'Eadbutt\": {\r\n    effects: [\r\n      {\r\n        name: `Mighty 'Eadbutt`,\r\n        desc: `Casting value of 5 and range of 16\". Pick 1 enemy HERO within range and visible to the caster. That HERO suffers 1 mortal wound. If that HERO is a WIZARD, they suffer D3 mortal wounds instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Da Blazin' Eyes\": {\r\n    effects: [\r\n      {\r\n        name: `Da Blazin' Eyes`,\r\n        desc: `Casting value of 6. Pick 1 point on the battlefeld within 4D6\" of the caster and visible to them. Draw an imaginary straight line 1mm wide between that point and the closest part of the caster's base. Roll a D6 for each enemy model passed across by this line. On a 4+ that model's unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Foot of Gork': {\r\n    effects: [\r\n      {\r\n        name: `Foot of Gork`,\r\n        desc: `Casting value of 10 and range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D6 mortal wounds. Then, roll a dice. On a 1-3, the sequence stops. On a 4+, the unit suffers D6 mortal wounds. Keep rolling dice in this way until the sequence stops or the target unit is destroyed.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Da Great Big Green Hand of Gork': {\r\n    effects: [\r\n      {\r\n        name: `Da Great Big Green Hand of Gork`,\r\n        desc: `Casting value of 7 and range of 12\". Pick 1 friendly ORRUK unit wholly within range, visible to the caster and more than 3\" from all enemy units. Remove that unit from the battlefield and set it up again anywhere on the battlefield more than 9\" from any enemy units. It cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Bash 'Em, Ladz!\": {\r\n    effects: [\r\n      {\r\n        name: `Bash 'Em, Ladz!`,\r\n        desc: `Bash 'Em, Ladz! is a spell that has a casting value of 8. If successfully cast, until your next hero phase, you can add 1 to wound rolls for attacks made by friendly IRONJAWZ units that are wholly within 16\" of the caster.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath of Gork': {\r\n    effects: [\r\n      {\r\n        name: `Wrath of Gork`,\r\n        desc: `Casting value of 8. Pick en enemy unit within 16\" and visible. roll 2 dice for each IRONJAWZ unit with 2+ models wholly within 16\", for each 2+ inflict 1 mortal wound to the chosen enemy unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzSpells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from '../rule_sources'\r\nimport spells from './spells'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\n/*const MawGruntaSharedEffects = [\r\n  {\r\n    name: `Unstoppable Momentum`,\r\n    desc: `Each time this unit finishes a run or charge move, add D3 to its momentum score. This unit's momentum score can never exceed 6 or go below 1. At the end of the battle round, subtract 1 from this unit's momentum score (to a minimum of 1).`,\r\n    when: [DURING_GAME],\r\n    rule_sources: [\r\n      rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ,\r\n      meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n    ],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Unstoppable Momentum`,\r\n    desc: `Each time this unit finishes a run add D3 to its momentum score. This unit's momentum score can never exceed 6.`,\r\n    when: [MOVEMENT_PHASE],\r\n    rule_sources: [\r\n      rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ,\r\n      meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n    ],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Unstoppable Momentum`,\r\n    desc: `Each time this unit finishes a charge move, add D3 to its momentum score. This unit's momentum score can never exceed 6.`,\r\n    when: [CHARGE_PHASE],\r\n    rule_sources: [\r\n      rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ,\r\n      meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n    ],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Unstoppable Momentum`,\r\n    desc: `At the end of the battle round, subtract 1 from this unit's momentum score (to a minimum of 1).`,\r\n    when: [END_OF_TURN],\r\n    rule_sources: [\r\n      rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ,\r\n      meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n    ],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Headlong Charger`,\r\n    desc: `While this unit has a momentum score of 4 or more, this unit can charge even if it ran earlier in the turn.`,\r\n    when: [CHARGE_PHASE],\r\n    rule_sources: [rule_sources.BATTLETOME_SUPPLEMENT_IRONJAWZ],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst StrengthFromVictoryEffect = {\r\n  name: `Strength from Victory`,\r\n  desc: `At the end of the combat phase, if any models were slain by a wound caused by an attack made by this unit in that combat phase, add 1 to this unit's Wounds characteristic and add 1 to the Attacks characteristic of this unit's melee weapons, excluding those of its mount.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DestructiveBulkEffect = {\r\n  name: `Destructive Bulk`,\r\n  desc: `If you carry out a Stomp monstrous rampage with this unit and the enemy unit you picked suffers any mortal wounds, that enemy unit suffers an additional number of mortal wounds equal to the Destructive Bulk value on this unit's damage table. After all models slain by those mortal wounds have been removed from play, if there are no enemy models within 3\" of this unit, you can move this unit D6\" and then you can carry out another Stomp monstrous rampage with this unit even though you have already carried out the Stomp monstrous rampage in that phase.`,\r\n  when: [END_OF_CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DuffUpdaBigThingEffect = {\r\n  name: `Duff Up da Big Thing`,\r\n  desc: `Add 1 to hit rolls for attacks made by this unit that target a unit with a Wounds characteristic of 4 or more.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst BerserkersEffect = {\r\n  name: `Berserkers`,\r\n  desc: `This unit can run and still charge later in the turn.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst IronjawzUnits = {\r\n  'Kragnos': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of The Dread Mace is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 3+, ignore the effect of that spell on this unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this phase, pick 1 of the following effects:  \r\n        Roll a dice for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.  \r\n        Pick an enemy Monster in combat with this unit and roll 2D6. On a 7, this ability has no effect. Otherwise, inflict an amount of mortal damage on that unit equal to the results on the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal damage (2x6).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The End of Empires - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for friendly Destruction units while they are wholly within 12\" of this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gordrakk the Fist of Gork': {\r\n    effects: [\r\n     // DestructiveBulkEffect,\r\n     // StrengthFromVictoryEffect,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Bigteefs Fists and Tail is 6.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Monster Grapple - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the targets weapons. You must pick a Companion weapon if it has any. Halve the Attacks characteristic of that weapon (rounding up) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Voice of Gork - Once Per Battle - Reaction: You declared a Waaagh! ability`,\r\n        desc: `Effect: Until the start of your next turn, add 1 to hit rolls for combat attacks made by friendly Ironjawz units while they are wholly within 18\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Strength from Victory`,\r\n        desc: `Effect: If any damage points were allocated to an enemy unit by this units combat attacks this turn and that enemy unit has been destroyed, give this unit a Waaagh! token, to a maximum of 3. \r\n        Until the end of the next turn, add 1 to the Attacks characteristic of this units weapons for each Waaagh! token it has.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Megaboss on Maw-Krusha': {\r\n    effects: [\r\n    //  StrengthFromVictoryEffect,\r\n    //  DestructiveBulkEffect,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Maw-krushas Fists and Tail is 5.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Strength from Victory`,\r\n        desc: `Effect: If any damage points were allocated to an enemy unit by this units combat attacks this turn and that enemy unit has been destroyed, give this unit a Waaagh! token, to a maximum of 3. \r\n        Until the end of the next turn, add 1 to the Attacks characteristic of this units weapons for each Waaagh! token it has.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Destructive Bulk - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick a visible enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the mortal damage inflicted.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Through - Passive`,\r\n        desc: `Effect: When this unit makes a pile-in move, if it charged in the same turn, it can move 2D6\" instead of 3\".`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Megaboss': {\r\n    effects: [\r\n    //  StrengthFromVictoryEffect,\r\n      {\r\n        name: `Get Stuck in Ladz!`,\r\n        desc: `Declare: Pick a friendly Brute unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, add 1 to the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lead Da Brutes - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Roll a dice. On a 3+, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Brute units while they are within this units combat range.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Strength from Victory`,\r\n        desc: `Effect: If any damage points were allocated to an enemy unit by this units combat attacks this turn and that enemy unit has been destroyed, give this unit a Waaagh! token, to a maximum of 3. \r\n        Until the end of the next turn, add 1 to the Attacks characteristic of this units weapons for each Waaagh! token it has.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Warchanter': {\r\n    effects: [\r\n      {\r\n        name: `Rhythm of Destruction`,\r\n        desc: `Effect: If any enemy models were slain this turn by this units combat attacks, give this unit D3 ritual points.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Weirdnob Shaman': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Green Puke'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Brutal Power - Passive`,\r\n        desc: `Effect: Add 1 to this units power level while there are any friendly Ironjawz units that have 10 or more models wholly within 12\" of it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ardboy Big Boss': {\r\n    effects: [\r\n      {\r\n        name: `Iron-Fisted Commander - Passive`,\r\n        desc: `Effect: If a friendly Ardboyz unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Get Bashin!' - Passive`,\r\n        desc: `Effect: Add 1 to shield bash rolls for friendly Ardboyz units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Ardboys': {\r\n    effects: [\r\n      {\r\n        name: `Shield Bash`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit and that charged this turn to be the target. \r\n        Effect: Make a shield bash roll of D6 for each model in this unit. For each 6+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Brutes': {\r\n    effects: [\r\n     // DuffUpdaBigThingEffect,\r\n      {\r\n        name: `You Messin'?`,\r\n        desc: `Effect: Enemy models with a Health characteristic of 1 or 2 cannot contest objectives while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Gore-Gruntas': {\r\n    effects: [\r\n      {\r\n        name: `Gore-Grunta Charge`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Add 1 to the mortal damage inflicted (if any) if the target is Cavalry`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* \"Ironskull's Boyz\": {\r\n    effects: [\r\n      {\r\n        name: `Dead 'Ard`,\r\n        desc: `Gurzag Ironskull has a ward of 5+. The other models in this unit have a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Morgok's Krushas\": {\r\n    effects: [\r\n    //  DuffUpdaBigThingEffect,\r\n      {\r\n        name: `Beastbashas`,\r\n        desc: `The first time a MONSTER is destroyed by an attack made by this unit, add 1 to wound rolls for attacks made by this unit for the rest of the battle.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Tuskboss On Maw-Grunta': {\r\n  /*  mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Carve a Path'])],\r\n    }, */\r\n    effects: [\r\n     // ...MawGruntaSharedEffects,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Maw-gruntas Tusks is 3.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Head of the Stampede - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick up to 3 friendly Maw-grunta units wholly within 12\" of this unit that charged this turn to be the targets. \r\n        Effect: Add 1 momentum point to each target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Unstoppable Momentum - Passive`,\r\n        desc: `Effect: Each time this unit uses a Charge ability, it gains 1 momentum point. Each time it uses a Run ability, it gains 2 momentum points. It can have a maximum of 3 momentum points at once. \r\n        Add the number of momentum points this unit has to the Damage characteristic of its Maw-gruntas Tusks. At the end of each battle round, subtract 1 from its momentum points, to a minimum of 0`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Maw-Grunta with Hakkin' Krew\": {\r\n   /* mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Carve a Path'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Momentum - Passive`,\r\n        desc: `Effect: Each time this unit uses a Charge ability, it gains 1 momentum point. Each time it uses a Run ability, it gains 2 momentum points. It can have a maximum of 3 momentum points at once. \r\n        Add the number of momentum points this unit has to the Damage characteristic of its Maw-gruntas Tusks. At the end of each battle round, subtract 1 from its momentum points, to a minimum of 0`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Carve a Path - Once Per Turn`,\r\n        desc: `Effect: If this unit is in combat, it can move a distance up to its Move characteristic. It can pass through models and the combat ranges of enemy units, but it cannot end that move in combat. \r\n        Then, pick each enemy unit that this unit passed across during that move to be the targets. Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Then, this unit gains 2 momentum points.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     // ...MawGruntaSharedEffects\r\n    ],\r\n  },\r\n  'Maw-Grunta Gougers': {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Flattened into the Mud'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Momentum - Passive`,\r\n        desc: `Effect: Each time this unit uses a Charge ability, it gains 1 momentum point. Each time it uses a Run ability, it gains 2 momentum points. It can have a maximum of 3 momentum points at once. \r\n        Add the number of momentum points this unit has to the Damage characteristic of its Maw-gruntas Tusks. At the end of each battle round, subtract 1 from its momentum points, to a minimum of 0`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Flattened Into the Mud - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a dice and add the number of momentum points this unit has to the roll. On a 5+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ...MawGruntaSharedEffects\r\n    ],\r\n  },\r\n  'Zoggrok Anvilsmasha': {\r\n    effects: [\r\n      {\r\n        name: `Klonk - Passive`,\r\n        desc: `Effect: Klonk is a token. You can re-roll forgin rolls for this unit while this units Klonk is on the battlefield. If you make an unmodified save roll of 1 for this unit, remove this units Klonk from the battlefield after the Attack ability has been resolved (the damage point is still inflicted).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Power of Da Great Green God`,\r\n        desc: `Declare: Pick a visible friendly Ironjawz Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Make a forgin roll of D6. Add 1 to the roll if this unit is armed with Grunta-tongs. On a 4+, the targets melee weapons have Crit (Mortal) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ward-Smashing Choppa - Passive`,\r\n        desc: `Effect: If an attack made with this units Ward-Smashing Choppa scores a hit, the target has the Ward-Smashed keyword for the rest of the battle. Ward rolls cannot be made for a Ward-Smashed unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Brute Ragerz': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n     // BerserkersEffect,\r\n      {\r\n        name: `Berserkers - Passive`,\r\n        desc: `Effect: This unit can use a Run ability and still use Charge abilities later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Unleasehed Rage - Passive`,\r\n        desc: `Effect: This unit has Strike-first if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Weirdbrute Wrekkaz': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n    //  BerserkersEffect,\r\n      {\r\n      name: `Berserkers - Passive`,\r\n      desc: `Effect: This unit can use a Run ability and still use Charge abilities later in the turn.`,\r\n      when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Braggit`s Bottle-Snatchaz': {\r\n    effects: [\r\n      {\r\n        name: `Super-Secret Tunnels`,\r\n        desc: `Declare: Pick a unit in this Regiment of Renown that has not been deployed. \r\n        Effect: Set up that unit in reserve in a super-secret tunnel. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Sudden Emergence - Once Per Turn`,\r\n        desc: `Declare: If the Rabble-Rowza in this Regiment of Renown is in a super-secret tunnel, pick it to be the target. \r\n        Effect: Set up the target anywhere on the battlefield more than 9\" from all enemy units. Then, set up all other friendly units that are in a super-secret tunnel within 3\" of the target and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Rabble-Rowza: Neh Neh Na-Neh Neh! Can't Catch me! - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Monster or Beast unit to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn, but each time it uses a Move ability, it must end the move closer to this unit. \r\n        In addition, for the rest of the turn, the first time the target ends a move within this units combat range, inflict D6 mortal damage on this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Hallucinogenic Fungus Brews - Passive`,\r\n        desc: `Effect: In the first battle round, this unit has Ward (4+). In the second battle round, this unit has Ward (5+). In the third and subsequent battle rounds, this unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Gobbapalooza Know-Wotz`,\r\n        desc: `Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Glareface Dance: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to run rolls and charge rolls for that unit until the start of your next turn. \r\n        Nasty Poisons: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to the Rend characteristic of that units weapons until the start of your next turn. \r\n        Mesmerise: Pick a visible enemy unit within 12\" of this unit. Until the start of your next turn, that unit cannot use commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Squig Herd: Squigs Gone Wild - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Herding Squigs`,\r\n        desc: `Effect: Roll a dice for each Squig Herder in this unit. For each 2+, you can return D3 slain Cave Squigs to this unit. For each 1, 1 Squig Herder in this unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Hoppers: Boing! Boing! Boing!`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sneaky Distraction: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Gobbapalooza in this Regiment of Renown to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for attacks made by enemy units while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Grikk`s Kruleshots': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Skewer Killbow: Skewering Bolts - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, the Damage characteristic of this units Beast-Skewer Bolts is 6 if the target is a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Skewer Killbow: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Man-Skewer Crossbows - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, pick either the Hasty Shot or Aimed Shot weapon characteristics for all the attacks it makes with its Man-skewer Crossbows.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Skewer It Again! - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster that had any damage points allocated to it this phase by a shooting attack made by the Beast-skewer Killbow in this Regiment of Renown. Then, pick any number of Man-skewer Boltboyz units in this Regiment of Renown to focus fire. \r\n        Effect: For the rest of the turn, add 1 to the Attacks characteristic of the ranged weapons used by the units you picked to focus fire but all of their attacks must target the enemy Monster you picked.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },  \r\n  'ROR: Odo Godswallow': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Breaking Strike`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 5D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Behemoth Brawler - Passive`,\r\n        desc: `Effect: Subtract 1 from the Attacks characteristic of enemy Monsters while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Menhir Club is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mighty Walloper - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzUnits, 'unit')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst IronjawzPrayers = {\r\n  'Warbeats': {\r\n    effects: [\r\n      {\r\n        name: `Get 'Em Beat: Chanting value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Ironjawz Priest to chant this prayer, pick a visible friendly Ironjawz unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, add 1 to charge rolls for the target. In addition, if the chanting roll was 8+, add 1 to the number of dice rolled when making charge rolls for the target, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Fixin' Beat: Chanting value of 4`,\r\n        desc: `Declare: Pick a friendly Ironjawz Priest to chant this prayer, pick a visible friendly Ironjawz unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Heal (D6) the target. If the chanting roll was 8+, Heal (D3+3) the target instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Killa Beat: Chanting value of 4`,\r\n        desc: `Declare: Pick a friendly Ironjawz Priest to chant this prayer, pick a visible friendly Ironjawz unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Add 1 to the Damage characteristic of the targets melee weapons for the rest of the turn. If the chanting roll was 8+, you can pick up to 2 eligible units to be the targets instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(IronjawzPrayers, 'prayer')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, HERO_PHASE, SHOOTING_PHASE, START_OF_COMBAT_PHASE, START_OF_SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst KruleboyzArtifacts = {\r\n  'Eye-Biter Ash': {\r\n    effects: [\r\n      {\r\n        name: `Eye-Biter Ash - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Subtract 1 from hit rolls and wound rolls for attacks made by the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Mork's Eye Pebble\": {\r\n    effects: [\r\n      {\r\n        name: `Mork's Eye Pebble - Once Per Battle - Reaction: Opponent declared an Attack ability `,\r\n        desc: `Effect: For the rest of the turn, friendly Kruleboyz units have Ward (5+) while they are wholly within 12\" of this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Swamp Staff': {\r\n    effects: [\r\n      {\r\n        name: `Swamp Staff - Passive`,\r\n        desc: `Effect: If this unit is not a Wizard, it can use the Unbind ability as if it had Wizard (1). Otherwise, add 1 to this units power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KruleboyzArtifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Take Dat, Ya Suckers!': {\r\n    effects: [\r\n      {\r\n        name: `Take Dat, Ya Suckers!`,\r\n        desc: `You can pick this battle tactic only if the model picked to be your general has the KRULEBOYZ keyword. You complete this tactic if the following 2 criteria are met:\r\n\r\n        - At least 10 wounds or mortal wounds in any combination that were caused by friendly units are allocated to enemy models this turn.\r\n\r\n        - Fewer than 10 wounds or mortal wounds in any combination that were caused by enemy units are allocated to friendly models this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, END_OF_SETUP, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\nimport rule_sources from '../rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst KruleboyzBattleTraits = {\r\n  'Venom-Encrusted Weapons': {\r\n    effects: [\r\n      {\r\n        name: `Venom-Encrusted Weapons - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Infantry unit to be the target, then make a dirty trick roll. \r\n        Effect: Until the start of your next turn, the targets attacks score critical hits on unmodified hit rolls of 5+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lethal Surprise': {\r\n    effects: [\r\n      {\r\n        name: `Lethal Surprise - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with any friendly Kruleboyz units to be the target, then make a dirty trick roll. \r\n        Effect: Inflict D3 mortal damage on the target. In addition, for the rest of the turn, the targets weapons cannot be affected by the Charge (+1 Damage) weapon ability.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sneaky Sneakin`': {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Sneakin' - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Infantry unit that has 10 or fewer models and is not in combat to be the target, then make a dirty trick roll. \r\n        Effect: Remove the target from the battlefield and set it up again wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Noisy Racket': {\r\n    effects: [\r\n      {\r\n        name: `Noisy Racket - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with any friendly Kruleboyz units to be the target, then make a dirty trick roll. \r\n        Effect: The target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dirty Tricks': {\r\n    effects: [\r\n      {\r\n        name: `Dirty Tricks - Passive`,\r\n        desc: `Effect: Your army can use 1 Dirty Trick ability per phase. The effect of a Dirty Trick ability is only applied if you make a successful dirty trick roll. The success of a dirty trick roll depends on the number of Dirty Trick abilities your army has already used this battle round: \r\n        Dirty Trick \r\n        First 2+\r\n        Second 3+\r\n        Third 4+\r\n        Fourth or subsequent 5+`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KruleboyzBattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_GAME, END_OF_TURN, TURN_ONE_START_OF_ROUND, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst KruleboyzCommandTraits = {\r\n  'Slippery Skumbag': {\r\n    effects: [\r\n      {\r\n        name: `Slippery Skumbag`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 3+, it can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Backstabba': {\r\n    effects: [\r\n      {\r\n        name: `Backstabba`,\r\n        desc: `Declare: Pick an enemy Hero in combat with both this unit and another friendly Kruleboyz unit to be the target. \r\n        Effect: Inflict D3 mortal damage on the target. Add 1 to the mortal damage inflicted for each friendly Kruleboyz unit in combat with the target in addition to the first two Kruleboyz units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Egomaniak: {\r\n    effects: [\r\n      {\r\n        name: `Egomaniak - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly non-Hero Kruleboyz Infantry unit:  \r\n        This unit has Ward (4+).  \r\n        Each time you make a successful ward roll for this unit, allocate 1 damage point to a friendly non-Hero Kruleboyz Infantry unit within this units combat range after the damage sequence for this unit has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KruleboyzCommandTraits, 'command_trait')\r\n","import { COMBAT_PHASE, DURING_GAME, MOVEMENT_PHASE, SHOOTING_PHASE, TURN_ONE_SHOOTING_PHASE } from 'types/phases'\r\nimport rule_sources from '../rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst KruleboyzFlavors = {\r\n  \"Kruleboyz Klaw\": {\r\n    effects: [\r\n      {\r\n        name: `Swamp Shroud - Passive`,\r\n        desc: `Effect: Friendly Kruleboyz units that are wholly within 3\" of a terrain feature are not visible to enemy units that are more than 12\" away from them.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Middul Finga': {\r\n    effects: [\r\n      {\r\n        name: `Far-Killa Bolts`,\r\n        desc: `Declare: Pick up to 3 friendly Man-skewer Boltboyz or Beast-skewer Killbow units to be the targets. \r\n        Effect: For the rest of the turn, add 3\" to the Range characteristic of the targets ranged weapons.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Light Finga': {\r\n    effects: [\r\n      {\r\n        name: `Ded Sneaky - Passive`,\r\n        desc: `Effect: You can use the Sneaky Sneakin' Dirty Trick ability twice per turn instead of only once per turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Trophy Finga': {\r\n    effects: [\r\n      {\r\n        name: `Meanest Beasts - Passive`,\r\n        desc: `Effect: Companion weapons used by friendly Kruleboyz units have Crit (2 Hits).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  Skulbugz: {\r\n    effects: [\r\n      {\r\n        name: `Crawly Swarm`,\r\n        desc: `When an enemy unit is picked to fight, roll a dice if it is within 3\" of any friendly SKULBUGZ units. Add 2 to the roll if that enemy unit is within 3\" of any friendly SKULBUGZ MONSTERS. On a roll of 6+, subtract 1 from hit rolls for attacks made by that enemy unit in that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default KruleboyzFlavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, HERO_PHASE } from 'types/phases'\r\n\r\nconst KruleboyzSpells = {\r\n  // Lore of the Swamp\r\n  'Lore of the Swamp': {\r\n    effects: [\r\n      {\r\n        name: `Da Black Pit: Casting value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Choking Mist: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Wizard to cast this spell, pick a visible enemy unit wholly within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from the Attacks characteristic of the targets weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mork's Kunnin': Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Wizard to cast this spell, pick a visible friendly Kruleboyz unit wholly within 12\" of them, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, add 1 to save rolls for attacks that target that friendly unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Da Black Pit': {\r\n    effects: [\r\n      {\r\n        name: `Da Black Pit`,\r\n        desc: `Casting value of 7 and range of 12\". Pick 1 enemy unit within range and visible to the caster. Roll a dice for each model in that unit. For each 6, and for each other roll that is equal to or greater than that unit's Save characteristic, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Choking Mist': {\r\n    effects: [\r\n      {\r\n        name: `Choking Mist`,\r\n        desc: `Casting value of 7 and range of 24\". Pick a point on the battlefield within range and visible to the caster. All units within 6\" of that point are affected by choking mist until the start of your next hero phase. While a unit is affected by choking mist, subtract 1 from the Attacks characteristic of melee weapons used by it (to a minimum of 1), and it cannot run.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sneaky Miasma': {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Miasma`,\r\n        desc: `Casting value of 6 and range of 18\". Pick 1 friendly KRULEBOYZ MONSTER within range and visible to the caster. That MONSTER can make a normal move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nasty Hex': {\r\n    effects: [\r\n      {\r\n        name: `Nasty Hex`,\r\n        desc: `Casting value of 7 and range of 12\". Pick 1 enemy unit within range and visible to the caster. Until the end of your turn, ward rolls cannot be made for models in that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KruleboyzSpells, 'spell')\r\n","import { DestructionUnits } from 'factions/grand_alliances'\r\nimport { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_TURN,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from '../rule_sources'\r\nimport spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const AllPartOfDaPlanEffect = {\r\n  name: `All Part of Da Plan`,\r\n  desc: `lf a friendly KRULEBOYZ unit fails a battleshock test within 3\" of any friendly units with this ability, only 1 model from that unit will flee.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst PickEmOffEffect = {\r\n  name: `Pick 'Em Off`,\r\n  desc: `When this unit attacks with its ranged weapon, use the Aimed Shot missile weapon characteristics if it did not make a normal move in the same turn and is more than 3\" from all enemy units. Otherwise, use the Hasty Shot missile weapon characteristics.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst KruleboyzUnits = {\r\n  'Kragnos': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of The Dread Mace is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 3+, ignore the effect of that spell on this unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this phase, pick 1 of the following effects:  \r\n        Roll a dice for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.  \r\n        Pick an enemy Monster in combat with this unit and roll 2D6. On a 7, this ability has no effect. Otherwise, inflict an amount of mortal damage on that unit equal to the results on the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal damage (2x6).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The End of Empires - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for friendly Destruction units while they are wholly within 12\" of this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Man-Skewer Boltboyz': {\r\n    effects: [\r\n    //  PickEmOffEffect\r\n    {\r\n      name: `Man-Skewer Crossbows - Passive`,\r\n      desc: `Effect: Each time this unit uses a Shoot ability, pick either the Hasty Shot or Aimed Shot weapon characteristics for all the attacks it makes with its Man-skewer Crossbows.`,\r\n      when: [SHOOTING_PHASE],\r\n    },\r\n    {\r\n      name: `Pick 'Em Off`,\r\n      desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n      when: [SHOOTING_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Hobgrot Slittaz': {\r\n    effects: [\r\n      {\r\n        name: `Scrap-Bang`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+:  \r\n        Inflict 1 mortal damage on the target.  \r\n        This unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Gutrippaz: {\r\n    effects: [\r\n      {\r\n        name: `Scare Taktikz`,\r\n        desc: `Effect: Roll a dice. On a 3+, subtract 1 from hit rolls for attacks made by non-Hero units that target this unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Murknob with Belcha-Banna': {\r\n    effects: [\r\n      {\r\n        name: `Power of Kragnos - Passive`,\r\n        desc: `Effect: Friendly Kruleboyz units have Ward (6+) while they are wholly within 12\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Breath of the Mire-Drakes`,\r\n        desc: `Declare: Pick each enemy unit in combat with this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 1, this ability has no effect. On a 2-5, inflict 1 mortal damage on the target. On a 6, inflict D3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Swampcalla Shaman and Pot-grot': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Summon Boggy Mist'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Pot-Grot - Passive`,\r\n        desc: `Effect: This units Pot-grot is a token. Add 1 to casting rolls for this unit while its Pot-grot is on the battlefield. If you make an unmodified casting roll of 4 or less for this unit, remove its Pot-grot from the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Foul Elixers - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Kruleboyz Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to save rolls for the target for the rest of the turn. On a 1-2, allocate D3 damage points to the target (ward rolls cannot be made for those damage points).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Killaboss on Great Gnashtoof': {\r\n    effects: [\r\n     // AllPartOfDaPlanEffect,\r\n      {\r\n        name: `That's Ours, Ya Gitz! - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective you do not control, add 1 to hit rolls for combat attacks made by friendly Kruleboyz Infantry units wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `All Part of Da Plan`,\r\n        desc: `Declare: Pick another friendly Kruleboyz unit wholly within 9\" of this unit to be the target. \r\n        Effect: Add 3 to the targets control score until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Killaboss on Corpse-Rippa Vulcha': {\r\n    effects: [\r\n    //  AllPartOfDaPlanEffect,\r\n      {\r\n        name: `Commanding View - Reaction: You declared the Redeploy command for a friendly Gutrippaz unit wholly within 12\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Vulchas Talons and Beak is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulcha Dive - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a number of dice equal to the unmodified charge roll. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Killaboss with Stab-grot': {\r\n    effects: [\r\n    //  AllPartOfDaPlanEffect,\r\n      {\r\n        name: `Stab-Grot - Passive`,\r\n        desc: `Effect: This units Stab-grot is a token. If this units Stab-grot has been removed, it can no longer attack with its Stab-grots Shiv and it cannot use the Unleash the Stab-grot! ability.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Unleash the Stab-Grot! - Once Per Battle`,\r\n        desc: `Effect: Pick 1 of the following effects:  \r\n        Pick an enemy unit in combat with this unit to be the target. Inflict D3 mortal damage on the target.  \r\n        This unit has Ward (5+) for the rest of the turn. \r\n        After resolving either effect, remove this units Stab-Grot from the battlefield.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Keep 'Em in Line - Reaction: You declared the All Out Attack command for a friendly Kruleboyz Infantry unit`,\r\n        desc: `Effect: If this unit is wholly within 12\" of the unit using the All-out Attack command, add 1 to wound rolls for combat attacks made by that unit for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Beast-Skewer Killbow': {\r\n    effects: [\r\n     // PickEmOffEffect,\r\n      {\r\n        name: `Skewering Bolts - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, the Damage characteristic of this units Beast-Skewer Bolts is 6 if the target is a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Breaka-boss on Mirebrute Troggoth': {\r\n    effects: [\r\n      {\r\n        name: `Breaka-Harness`,\r\n        desc: `Effect: Allocate D3 damage points to this unit (ward rolls cannot be made for those damage points). For each damage point allocated to this unit by this ability, add 2 to the Attacks characteristic of this units Mirebrutes Clubs for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Regeneration`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n      {\r\n        name: `Tear Limb from Limb - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Gobsprakk: {\r\n   /* mandatory: {\r\n      spells: [\r\n        keyPicker(spells, [\r\n          'Choking Mist',\r\n          'Da Black Pit',\r\n          'Nasty Hex',\r\n          'Sneaky Miasma',\r\n          'Summon Boggy Mist',\r\n        ]),\r\n      ],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Killabeaks Talons and Beak is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crush to Death - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mork Sez No! - Passive`,\r\n        desc: `Effect: Each time this unit unbinds a spell, inflict D3 mortal damage on the caster. If the unbinding roll was 10+, inflict D6 mortal damage on the caster instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Strangle Hex: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic, to a maximum of 10. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Screamin' Mandrakk - Once Per Battle - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: This unit uses the Unbind ability but the unbinding roll is 3D6 instead of 2D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Snatchaboss on Sludgeraker Beast': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Sludgerakers Talons is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sludgeraker Venom`,\r\n        desc: `Declare: Pick a friendly non-Hero Kruleboyz unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, for the rest of the turn, add 1 to the Damage characteristic of the targets weapons that have Crit (Mortal). On a 1, inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Festering Wounds - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by this units combat attacks to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Subtract 1 from wound rolls for attacks made by the target until the start of your next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Swampboss Skumdrekk': {\r\n    effects: [\r\n      {\r\n        name: `Bet-Master`,\r\n        desc: `Declare: Pick an enemy unit on the battlefield to be the bet. \r\n        Effect: Add 1 to wound rolls for attacks made by this unit and friendly Hobgrot Slittaz units that target the bet.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Sloppklaws Talons is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Kountin' Krew`,\r\n        desc: `Declare: Pick a friendly Hobgrot Slittaz unit within this units combat range to be the target. \r\n        Effect: For the rest of the battle, the targets Slitta-knives have Crit (Mortal) while they are wholly within 12\" of this unit.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Aggravate Wounds - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the number of damage points the target has. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Marshcrawla Sloggoth': {\r\n    effects: [\r\n      {\r\n        name: `On Da March - Passive`,\r\n        desc: `Effect: While they are wholly within 12\" of this unit, friendly Kruleboyz Infantry units can use Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Regeneration`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n/*  \"Mannok Da Kunnin'\": {\r\n    effects: [\r\n      {\r\n        name: `Kunnin' Tricks`,\r\n        desc: `If this unit is part of a Kruleboyz army, after you have picked a Dirty Trick to employ during the battle, roll a dice. Add 1 to the roll if this unit is your general. On a 5+, you can pick a second Dirty Trick to employ during the battle. The second Dirty Trick must be different to the first one you picked.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Spasming Wreck`,\r\n        desc: `When you use the Venom-encrusted Weapons battle trait for this unit, mortal wounds are caused on an unmodified hit roll of 5+ instead of 6.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `You Lot Hold 'Em Off`,\r\n        desc: `Before you allocate a wound or mortal wound to this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to this unit, if this unit is within 3\" of a friendly DA KUNNIN' KREW unit, you can roll a dice.\r\n\r\n        On a 1, that wound or mortal wound is allocated to this unit as normal. On a 2-5, that wound or mortal wound is allocated to that friendly DA KUNNIN' KREW unit instead of this unit. On a 6, that wound or mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  \"Da Kunnin' Krew\": {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Torka Tuffskul is the unit champion. Add 1 to that model's Wounds characteristic.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Snatcha-krew`,\r\n        desc: `At the end of the combat phase, you can pick 1 enemy model within 2\" of this unit and roll a dice. Add 1 to the roll if this unit includes Torka Tuffskul, and add 1 to the roll if this unit includes Shank. If the roll is at least double that model's Wounds characteristic, it is slain.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Paymaster`,\r\n        desc: `Do not take battleshock tests for this unit if it includes Krookgrin.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Kruleboyz Monsta-Killaz': {\r\n    effects: [\r\n      {\r\n        name: `Klutcha-Grot - Passive`,\r\n        desc: `Effect: This units Klutcha-grot is a token. If it is removed from the battlefield, this unit cannot use the A Tough Grot to Swallow ability.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `A Tough Grot to Swallow - Once Per Turn - Reaction: Opponent declared a Rampage ability for an enemy Monster within 6\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 2+, that Rampage ability has no effect. On a 1, remove this units Klutcha-grot from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bait and Trap`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. Add 1 to the roll if the target is damaged. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Braggit`s Bottle-Snatchaz': {\r\n    effects: [\r\n      {\r\n        name: `Super-Secret Tunnels`,\r\n        desc: `Declare: Pick a unit in this Regiment of Renown that has not been deployed. \r\n        Effect: Set up that unit in reserve in a super-secret tunnel. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Sudden Emergence - Once Per Turn`,\r\n        desc: `Declare: If the Rabble-Rowza in this Regiment of Renown is in a super-secret tunnel, pick it to be the target. \r\n        Effect: Set up the target anywhere on the battlefield more than 9\" from all enemy units. Then, set up all other friendly units that are in a super-secret tunnel within 3\" of the target and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Rabble-Rowza: Neh Neh Na-Neh Neh! Can't Catch me! - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Monster or Beast unit to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn, but each time it uses a Move ability, it must end the move closer to this unit. \r\n        In addition, for the rest of the turn, the first time the target ends a move within this units combat range, inflict D6 mortal damage on this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Hallucinogenic Fungus Brews - Passive`,\r\n        desc: `Effect: In the first battle round, this unit has Ward (4+). In the second battle round, this unit has Ward (5+). In the third and subsequent battle rounds, this unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Gobbapalooza Know-Wotz`,\r\n        desc: `Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Glareface Dance: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to run rolls and charge rolls for that unit until the start of your next turn. \r\n        Nasty Poisons: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to the Rend characteristic of that units weapons until the start of your next turn. \r\n        Mesmerise: Pick a visible enemy unit within 12\" of this unit. Until the start of your next turn, that unit cannot use commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Squig Herd: Squigs Gone Wild - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Herding Squigs`,\r\n        desc: `Effect: Roll a dice for each Squig Herder in this unit. For each 2+, you can return D3 slain Cave Squigs to this unit. For each 1, 1 Squig Herder in this unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Hoppers: Boing! Boing! Boing!`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sneaky Distraction: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Gobbapalooza in this Regiment of Renown to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for attacks made by enemy units while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Odo Godswallow': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Breaking Strike`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 5D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Behemoth Brawler - Passive`,\r\n        desc: `Effect: Subtract 1 from the Attacks characteristic of enemy Monsters while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Menhir Club is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mighty Walloper - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n // ...keyPicker(DestructionUnits, ['Rogue Idol']),\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KruleboyzUnits, 'unit')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE, TURN_ONE_START_OF_HERO_PHASE, TURN_TWO_START_OF_HERO_PHASE } from 'types/phases'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Time to Get Stuck In!': {\r\n    effects: [\r\n      {\r\n        name: `Time to Get Stuck In!`,\r\n        desc: `You can pick this battle tactic only in your first or second turn. You complete this tactic if the model picked to be your general and all of the models in your army that are on the battlefield are within 12\" of an enemy unit at the end of this turn.`,\r\n        when: [TURN_ONE_START_OF_HERO_PHASE, TURN_TWO_START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Destroyer of Empires': {\r\n    effects: [\r\n      {\r\n        name: `Destroyer of Empires`,\r\n        desc: `You can pick this battle tactic only if a friendly KRAGNOS is on the battlefield. Pick 1 faction terrain feature on the battlefield that was set up by your opponent and that has not been demolished. You complete this tactic if that faction terrain feature is demolished this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sneak Up': {\r\n    effects: [\r\n      {\r\n        name: `Sneak Up`,\r\n        desc: `You complete this tactic if, at the end of the turn, every friendly Kruleboyz unit is within 3\" of any terrain features and is more than 3\" from all enemy units. You can only pick this tactic if the model picked to be your general has the Kruleboyz keyword.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  \"Dat's Our Turf Now!\": {\r\n    effects: [\r\n      {\r\n        name: `Dat's Our Turf Now!`,\r\n        desc: `You complete this tactic if, at the end of the turn, 2 or more friendly Ironjawz units are within 3\" of the centre of the battlefield. You can only pick this tactic if the model picked to be your general has the Ironjawz keyword.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_GAME, END_OF_CHARGE_PHASE, HERO_PHASE, WARDS_PHASE } from 'types/phases'\r\n\r\nconst OrrukWarclanMountTraits = {\r\n /* \"Tough 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Tough 'Un`,\r\n        desc: `MONSTER only. Unless this model has a number of wounds allocated to it that exceeds half its Wounds characteristic, use the top row on its damage table, regardless of how many wounds it has suffered.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"Fast 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Fast 'Un`,\r\n        desc: `Once per battle, in your hero phase, this model can make a normal move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Mean 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Mean 'Un`,\r\n        desc: `MONSTER only. When you carry out the Stomp monstrous rampage with this model, the enemy unit you pick suffers D6 mortal wounds on a 2+ instead of D3.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Loud 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Loud 'Un`,\r\n        desc: `MONSTER only. When you carry out the Roar monstrous rampage with this model, pick all enemy units within 3\" of this model instead of 1.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Weird 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Weird 'Un`,\r\n        desc: `This model has a ward of 4+ against mortal wounds caused by spells and the abilities of endless spells.`,\r\n        when: [WARDS_PHASE, HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Smelly 'Un\": {\r\n    effects: [\r\n      {\r\n        name: `Smelly 'Un`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this model if it has not made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(OrrukWarclanMountTraits, 'mount_trait')\r\n","import { keyPicker, pickEffects } from '../metatagger'\r\nimport BigWaaaghBattleTactics from './big_waaagh/battle_tactics'\r\nimport BigWaaaghBattleTraits from './big_waaagh/battle_traits'\r\nimport BonesplitterzArtifacts from './bonesplitterz/artifacts'\r\nimport BonesplitterzBattleTactics from './bonesplitterz/battle_tactics'\r\nimport BonesplitterzBattleTraits from './bonesplitterz/battle_traits'\r\nimport BonesplitterzCommandAbilities from './bonesplitterz/command_abilities'\r\nimport BonesplitterzCommandTraits from './bonesplitterz/command_traits'\r\nimport BonesplitterzFlavors from './bonesplitterz/flavors'\r\nimport BonesplitterzSpells from './bonesplitterz/spells'\r\nimport BonesplitterzUnits from './bonesplitterz/units'\r\nimport GreenskinzUnits from '../greenskinz/units'\r\nimport GruntaStampedeArtifacts from './grunta_stampede/artifacts'\r\nimport GruntaStampedeBattleTactics from './grunta_stampede/battle_tactics'\r\nimport GruntaStampedeBattleTraits from './grunta_stampede/battle_traits'\r\nimport GruntaStampedeCommandTraits from './grunta_stampede/command_traits'\r\nimport GruntaStampedeGrandStrategies from './grunta_stampede/grand_strategies'\r\nimport GruntaStampedeMonstrousRampages from './grunta_stampede/monstrous_rampages'\r\nimport GruntaStampedeMountTraits from './grunta_stampede/mount_traits'\r\nimport IronjawzArtifacts from './ironjawz/artifacts'\r\nimport IronjawzBattleTactics from './ironjawz/battle_tactics'\r\nimport IronjawzBattleTraits from './ironjawz/battle_traits'\r\nimport IronjawzCommandAbilities from './ironjawz/command_abilities'\r\nimport IronjawzCommandTraits from './ironjawz/command_traits'\r\nimport IronjawzFlavors from './ironjawz/flavors'\r\nimport IronjawzMonstrousRampages from './ironjawz/monstrous_rampages'\r\nimport IronjawzSpells from './ironjawz/spells'\r\nimport IronjawzUnits from './ironjawz/units'\r\nimport IronjawzPrayers from './ironjawz/prayers'\r\nimport KruleboyzArtifacts from './kruleboyz/artifacts'\r\nimport KruleboyzBattleTactics from './kruleboyz/battle_tactics'\r\nimport KruleboyzBattleTraits from './kruleboyz/battle_traits'\r\nimport KruleboyzCommandTraits from './kruleboyz/command_traits'\r\nimport KruleboyzFlavors from './kruleboyz/flavors'\r\nimport KruleboyzSpells from './kruleboyz/spells'\r\nimport KruleboyzUnits from './kruleboyz/units'\r\nimport OrrukWarclansBattalions from './battalions'\r\nimport OrrukWarclansBattleTactics from './battle_tactics'\r\nimport OrrukWarclansGrandStrategies from './grand_strategies'\r\nimport OrrukWarclansMountTraits from './mount_traits'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  /*'Big Waaagh': {\r\n    effects: [\r\n      ...pickEffects(BigWaaaghBattleTraits, [\r\n        'The Power of the Waaagh!',\r\n        \"'Ere We Go, 'Ere We Go, 'Ere We Go!\",\r\n      ]),\r\n      ...pickEffects(BonesplitterzBattleTraits, ['Warpaint']),\r\n      ...pickEffects(KruleboyzBattleTraits, ['Venom-encrusted Weapons']),\r\n    ],\r\n    available: {\r\n      allied_units: [GreenskinzUnits, IronjawzUnits, BonesplitterzUnits, KruleboyzUnits],\r\n      artifacts: [IronjawzArtifacts, BonesplitterzArtifacts, KruleboyzArtifacts],\r\n      battalions: [OrrukWarclansBattalions],\r\n      battle_tactics: [OrrukWarclansBattleTactics, BigWaaaghBattleTactics],\r\n      command_abilities: [BonesplitterzCommandAbilities, IronjawzCommandAbilities],\r\n      command_traits: [IronjawzCommandTraits, BonesplitterzCommandTraits, KruleboyzCommandTraits],\r\n      grand_strategies: [keyPicker(OrrukWarclansGrandStrategies, ['Waaagh!', \"Krump 'Em All!\"])],\r\n      mount_traits: [OrrukWarclansMountTraits],\r\n      spells: [IronjawzSpells, BonesplitterzSpells, KruleboyzSpells],\r\n    },\r\n    mandatory: {\r\n      command_abilities: [keyPicker(IronjawzCommandAbilities, ['Mighty Destroyers'])],\r\n    },\r\n  },\r\n\r\n  Bonesplitterz: {\r\n    effects: pickEffects(BonesplitterzBattleTraits, [\r\n      'Bonesplitterz Waaagh!',\r\n      'Spirit of Gorkamorka',\r\n      'Tireless Trackers',\r\n      'Warpaint',\r\n    ]),\r\n    available: {\r\n      artifacts: [BonesplitterzArtifacts],\r\n      battalions: [keyPicker(OrrukWarclansBattalions, ['Bonesplitterz Rukk'])],\r\n      battle_tactics: [OrrukWarclansBattleTactics, BonesplitterzBattleTactics],\r\n      command_abilities: [BonesplitterzCommandAbilities],\r\n      command_traits: [BonesplitterzCommandTraits],\r\n      flavors: [BonesplitterzFlavors],\r\n      grand_strategies: [\r\n        keyPicker(OrrukWarclansGrandStrategies, ['Get Dem Bones!', 'Waaagh!', \"Krump 'Em All!\"]),\r\n      ],\r\n      mount_traits: [OrrukWarclansMountTraits],\r\n      spells: [BonesplitterzSpells],\r\n      units: [BonesplitterzUnits],\r\n    },\r\n  }, */\r\n\r\n  Ironjawz: {\r\n    effects: pickEffects(IronjawzBattleTraits, ['Mighty Destroyers', 'Ironjawz Waaagh!']),\r\n    available: {\r\n      artifacts: [IronjawzArtifacts],\r\n     // battalions: [keyPicker(OrrukWarclansBattalions, ['Ironjawz Fist'])],\r\n      battle_tactics: [OrrukWarclansBattleTactics, IronjawzBattleTactics],\r\n      command_abilities: [IronjawzCommandAbilities],\r\n      command_traits: [IronjawzCommandTraits],\r\n      flavors: [IronjawzFlavors],\r\n     /* grand_strategies: [\r\n        keyPicker(OrrukWarclansGrandStrategies, [\"Show 'Em Who's Boss!\", 'Waaagh!', \"Krump 'Em All!\"]),\r\n      ], */\r\n      mount_traits: [OrrukWarclansMountTraits],\r\n      monstrous_rampages: [IronjawzMonstrousRampages],\r\n      spells: [IronjawzSpells],\r\n      units: [IronjawzUnits],\r\n      prayers: [IronjawzPrayers],\r\n    },\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(IronjawzCommandAbilities, ['Mighty Destroyers'])],\r\n    }, */\r\n  },\r\n\r\n  Kruleboyz: {\r\n    effects: pickEffects(KruleboyzBattleTraits, [\r\n      'Venom-Encrusted Weapons',\r\n      'Dirty Tricks',\r\n      'Sneaky Sneakin`',\r\n      'Lethal Surprise',\r\n      'Noisy Racket',\r\n    ]),\r\n    available: {\r\n      artifacts: [KruleboyzArtifacts],\r\n     // battalions: [keyPicker(OrrukWarclansBattalions, ['Kruleboyz Finga'])],\r\n      battle_tactics: [OrrukWarclansBattleTactics, KruleboyzBattleTactics],\r\n      command_traits: [KruleboyzCommandTraits],\r\n      flavors: [KruleboyzFlavors],\r\n    /*  grand_strategies: [\r\n        keyPicker(OrrukWarclansGrandStrategies, ['In and Out, Ladz', 'Waaagh!', \"Krump 'Em All!\"]),\r\n      ], */\r\n      mount_traits: [OrrukWarclansMountTraits],\r\n      spells: [KruleboyzSpells],\r\n      units: [KruleboyzUnits],\r\n    },\r\n  },\r\n\r\n /* 'Grunta Stampede': {\r\n    effects: pickEffects(GruntaStampedeBattleTraits, ['Grunta Waaagh!', 'Hogs of War', \"'Ere We Come!\"]),\r\n    available: {\r\n      units: [GreenskinzUnits, IronjawzUnits, BonesplitterzUnits, KruleboyzUnits],\r\n      artifacts: [GruntaStampedeArtifacts],\r\n      battle_tactics: [GruntaStampedeBattleTactics],\r\n      command_traits: [GruntaStampedeCommandTraits],\r\n      grand_strategies: [GruntaStampedeGrandStrategies],\r\n      mount_traits: [GruntaStampedeMountTraits],\r\n      monstrous_rampages: [GruntaStampedeMonstrousRampages],\r\n    },\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { ORRUK_WARCLANS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const OrrukWarclansFaction = new Faction(\r\n  ORRUK_WARCLANS,\r\n  DESTRUCTION,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_ORRUK_WARCLANS\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SLAVES_TO_DARKNESS: {\r\n    name: 'Battletome: Slaves To Darkness',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2022/11/ksqazT5l435bK8TK.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_TURN,\r\n  TURN_ONE_START_OF_TURN,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Artifacts = {\r\n  // Shared\r\n  'Infernal Puppet': {\r\n    effects: [\r\n      {\r\n        name: `Infernal Puppet - Once Per Battle`,\r\n        desc: `Declare: Pick a visible enemy Wizard within 24\" of this unit to be the target. \r\n        Effect: For the rest of the turn, each time the target is picked to use a Spell ability, inflict D3 mortal damage on the target as a reaction. If the target is destroyed by this ability, do not resolve the effect of that Spell ability.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Realmwarpers Twist-Rune': {\r\n    effects: [\r\n      {\r\n        name: `Realmwarpers Twist-Rune - Once Per Battle`,\r\n        desc: `Declare: Pick a terrain feature within 12\" of this unit to be the target. \r\n        Effect: If the target does not have the Obscuring terrain ability, it gains that ability until the start of your next turn. Then, roll a dice for each model (friendly and enemy) within 1\" of the target. For each 5+, inflict 1 mortal damage on that models unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Conquerors Crown': {\r\n    effects: [\r\n      {\r\n        name: `The Conqueror's Crown - Passive`,\r\n        desc: `Effect: Subtract 5 from the control scores of enemy Infantry units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  //SLAVES TO DARKNESS WIZARD HEROES\r\n  /*'Chaos Familiar': {\r\n    effects: [\r\n      {\r\n        name: `Chaos Familiar`,\r\n        desc: `Once per battle, at the start of your hero phase you can say the bearer will call upon their Chaos Familiar. If you do so, the bearer can attempt to cast 1 additional spell in that hero phase, and that spell can be any from the Lore of the Damned.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Infernal Puppet': {\r\n    effects: [\r\n      {\r\n        name: `Infernal Puppet`,\r\n        desc: `Once per battle, at the start of the enemy hero phase, you can pick 1 enemy WIZARD within 24\" of the bearer and visible to them. Until the end of the phase, each time that WIZARD attempts to cast a spell they suffer D3 mortal wounds before the casting roll is made. If the WIZARD is slain by these mortal wounds, the casting attempt fails (do not roll the dice).`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Helm of Eldritch Command': {\r\n    effects: [\r\n      {\r\n        name: `Helm of Eldritch Command`,\r\n        desc: `If this unit dispells and endless spell, instead of it being dispelled you can say the bearer has seized control of it. If you do so, the bearer now controls that endless spell in the same manner as if they had summoned it, and the model that summoned the endless spell does not control it. If that endless spell is later dispelled and summoned again the bearer does not control it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //SLAVES TO DARKNESS DAEMON PRINCES only.\r\n  'Helm of Many Eyes': {\r\n    effects: [\r\n      {\r\n        name: `Helm of Many Eyes`,\r\n        desc: `The strike-first effect applies to the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Doombringer Blade': {\r\n    effects: [\r\n      {\r\n        name: `Doombringer Blade`,\r\n        desc: `At the start of the first battle round, after set-up is complete but before the first turn begins, you can pick 1 enemy HERO or enemy MONSTER on the battlefield. If you do so, add 1 to wound rolls for attacks made with melee weapons by friendly units that target that unit.`,\r\n        when: [TURN_ONE_START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  \"Realmwarper's Twist-rune\": {\r\n    effects: [\r\n      {\r\n        name: `Realmwarper's Twist-rune`,\r\n        desc: `Once per battle, in your hero phase, you can pick 1 terrain feature within 12\" of the bearer. Roll a dice for each model within 1\" of that terrain feature. For each 5+, that model's unit suffers 1 mortal wound. In addition, until your next hero phase, that terrain feature blocks visibility in the same manner as a wyldwood.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { MagnificentBattalionEffect, SlayersBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst Battalions = {\r\n /* 'Chaos Warband (Unified)': {\r\n    effects: [OneDropDeploymentEffect],\r\n  },\r\n  'Chaos Warband (Slayers)': {\r\n    effects: [SlayersBattalionEffect],\r\n  },\r\n  'Overlords of Chaos (Magnificent)': {\r\n    effects: [MagnificentBattalionEffect],\r\n  },\r\n  'Overlords of Chaos (Unified)': {\r\n    effects: [OneDropDeploymentEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'In Thrall to Chaos': {\r\n    effects: [\r\n      {\r\n        name: `In Thrall to Chaos`,\r\n        desc: `Pick 1 objective marker on the battlefield that is within 12\" of any enemy units. You complete this battle tactic if there are no enemy units within 12\" of that objective marker at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lust for Power': {\r\n    effects: [\r\n      {\r\n        name: `Lust for Power`,\r\n        desc: `Pick 1 friendly SLAVES TO DARKNESS HERO that has the EYE OF THE GODS keyword. You complete this battle tactic if you roll on the Eye of the Gods table for that HERO during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The March of Ruin': {\r\n    effects: [\r\n      {\r\n        name: `The March of Ruin`,\r\n        desc: `Pick 1 friendly SLAVES TO DARKNESS unit that includes an Ensorcelled Banner and is not within enemy territory. You complete this battle tactic if at the end of this turn that unit is wholly within enemy territory and within 3\" of any other friendly units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Iconoclasts: {\r\n    effects: [\r\n      {\r\n        name: `Iconoclasts`,\r\n        desc: `Pick 1 enemy unit that is a PRIEST OF TOTEM. You complete this battle tactic if that unit is destroyed at the end of the turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Champions of Chaos': {\r\n    effects: [\r\n      {\r\n        name: `Champions of Chaos`,\r\n        desc: `You complete this battle tactic if at the end of your turn there are 3 or more friendly HEROES within 3\" of enemy HEROES.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Run Them Down': {\r\n    effects: [\r\n      {\r\n        name: `Run Them Down`,\r\n        desc: `You complete this battle tactic if at the end of your turn, 3 or more friendly SLAVES TO DARKNESS units made a charge move in that turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { SLAVES_TO_DARKNESS } from 'meta/factions'\r\n\r\nconst BattleTraits = {\r\n  // Slaves to Darkness Allegiance\r\n  [SLAVES_TO_DARKNESS]: {\r\n    effects: [\r\n      {\r\n        name: `Eye of the Gods - Once Per Turn`,\r\n        desc: `Declare: Each friendly Slaves to Darkness unit that destroyed an enemy unit this turn is a target. Friendly Beasts and non-Hero Monsters cannot be targeted by this ability. \r\n        Effect: Make a reward roll of D6 for each target and apply the corresponding effect below. You can re-roll the reward roll for the target, but if you do so and you roll a 1, inflict D3 mortal damage on the target. \r\n        1 Snubbed by the Gods: No effect. \r\n        2 Mutative Regrowth: Heal (3) the target. \r\n        3 Unnatural Grace: Add 1 to hit rolls for the targets combat attacks for the rest of the battle. \r\n        4 Lurid Aura: The target has Ward (6+) for the rest of the battle. If the target already has Ward (6+), it has Ward (5+) instead. \r\n        5 Slaughterers Might: Add 1 to the Rend characteristic of the targets melee weapons for the rest of the battle. \r\n        6 Champion of Chaos: Pick any other effect. \r\n        The same effect can be applied multiple times to a unit, and more than 1 effect can apply to a unit at the same time.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Marks of Chaos - Passive`,\r\n        desc: `Effect: Friendly Slaves to Darkness units have 1 of the following effects based on the Mark of Chaos keyword they have.  \r\n        Undivided: Add 1 to wound rolls for the units combat attacks that target a Hero or Monster.  \r\n        Khorne: Add 1 to the Attacks characteristic of the units melee weapons for the rest of the turn if the unit charged in the same turn.  \r\n        Tzeentch: The unit has Ward (4+) against mortal damage inflicted by Spell abilities and abilities used by Manifestations.  \r\n        Nurgle: Subtract 1 from wound rolls for combat attacks that target the unit.  \r\n        Slaanesh: Add 1 to run rolls and charge rolls for the unit. \r\n        If a unit with a Mark of Chaos keyword is replaced, the replacement unit has the same Mark of Chaos keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Nexus Chaotica (Faction Terrain) - Draw Power`,\r\n        desc: `Effect: Roll a dice. Give a number of power points to this terrain feature equal to the roll. This terrain feature can have a maximum of 12 power points at once.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Nexus Chaotica (Faction Terrain) - Infernal Sorcery`,\r\n        desc: `Declare: If this terrain feature has 3 or more power points, pick a friendly Slaves to Darkness Wizard within 3\" of this terrain feature to be the target. \r\n        Effect: Remove 3 power points from this terrain feature, then add 1 to casting rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Nexus Chaotica (Faction Terrain) - Corrupt the Realms`,\r\n        desc: `Declare: If this terrain feature has 9 or more power points, pick an objective or terrain feature within 24\" of this terrain feature to be the source. Then, pick any number of enemy units within 3\" of the source to be the targets. \r\n        Effect: Remove 9 power points from this terrain feature, then roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // ENSORCELLED BANNERS\r\n /* 'Ensorcelled Banners: Icons of Chaos': {\r\n    effects: [\r\n      {\r\n        name: `The Blasphemous Icon`,\r\n        desc: `While this model is on the battlefield, subtract 1 from chanting rolls for prayers chanted by PRIESTS that do not have the CHAOS keyword.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //Heroic Actions\r\n  'Vows of Darkness': {\r\n    effects: [\r\n      {\r\n        name: `Heroic Action: Pledge to Dark Gods`,\r\n        desc: `Pick 1 friendly SLAVES TO DARKNESS HERO with the EYE OF THE GODS keyword. Until the end of that turn, each time you roll on the Eye of the Gods table for that HERO, you can roll 3 dice instead of 2, and pick any 2 of the dice rolled as your score.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Draw on Power`,\r\n        desc: `Pick 1 friendly SLAVES TO DARKNESS WIZARD. Until the end of that turn, when making casting rolls with that WIZARD, roll 3 dice instead of 2. However, if the unmodified roll on 2 or more of the dice is 1, the spell miscasts, and the caster suffers D6 mortal wounds instead of D3.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // SUB FACTIONS\r\n  Ravagers: {\r\n    effects: [\r\n      {\r\n        name: `Heroic Action: Rally the Tribes`,\r\n        desc: `You can carry out the following heroic action with a RAVAGERS HERO instead of any other heroic action you can carry out with that HERO. Pick 1 CHAOS MARAUDERS, CHAOS MARAUDER HORSEMEN, CULTIST or DARKOATH unit in your army that has been destroyed. If you do so, a new replacement unit with half the number of models in the unit that was destroyed (rounding up) is added to your army. Set up that unit wholly within 12\" of the HERO carrying out this heroic action and more than 9\" from all enemy units. Each destroyed unit can only be replaced once - replacement units cannot themselves be replaced.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Cabalists: {\r\n    effects: [\r\n      {\r\n        name: `Blasphemous Rituals`,\r\n        desc: `CABALIST HEROES become WIZARDS. If the HERO is already a WIZARD, they can attempt to cast 1 additional spell in each of your hero phases and know 1 additional spell from the Lore of the Damned spell lore.`,\r\n        when: [DURING_GAME, HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.ERRATA_JANUARY_2023,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n      {\r\n        name: `Blasphemous Rituals`,\r\n        desc: `If you carry out the Draw on Power heroic action (pg 72) with a Cabalist Hero, you can immediately carry out the same heroic action with each other Cabalist Hero that has the Eye of Gods keyword and that is within 3\" of the first.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.ERRATA_JANUARY_2023,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  Despoilers: {\r\n    effects: [\r\n      {\r\n        name: `The Favoured and the Cursed`,\r\n        desc: `Each DESPOILER DAEMON PRINCE can be given a command trait in addition to your general, which can be used as if they were a general. Each command trait must be different.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Favoured and the Cursed`,\r\n        desc: `Add 2 to the Wounds characteristic of friendly DESPOILERS MONSTER units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Host of the Everchosen': {\r\n    effects: [\r\n      {\r\n        name: `Legions of Darkness`,\r\n        desc: `Chaos Chosen, Chaos Knights or Chaos Warriors unit that receives the Rally command, you can return 1 slain model to that unit for each 5+ instead of each 6.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n      {\r\n        name: `Legions of Darkness`,\r\n        desc: `You can pick 1 additional Ensorcelled Banners enhancement for your army.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n  },\r\n  'The Knights of the Empty Throne': {\r\n    effects: [\r\n      {\r\n        name: `Unmatched Conquerors`,\r\n        desc: `KNIGHTS OF THE EMPTY THRONE units that have a Mount can run and still charge in the same turn.`,\r\n        when: [CHARGE_PHASE, MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Dread Lieutenant`,\r\n        desc: `When you pick the general for your army, if Archaon is not included in the army, you can pick a model in a friendly VARANGUARD unit to be your general. If you do so, that unit gains the Leader battlefield role.\r\n        Designer's Note: This general cannot be given a command trait as it is not a HERO.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Dread Lieutenant`,\r\n        desc: `If a VARANGUARD general issues the Rally command and a friendly VARANGUARD unit receives it, you can return 1 slain model to that unit for each 5+ instead of each 6.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Legions of the First Prince': {\r\n    effects: [\r\n      {\r\n        name: `The Favour of the Four`,\r\n        desc: `You can pick 1 LEGION OF THE FIRST PRINCE UNDIVIDED unit and then pick 1 of the following Marks of Chaos keywords; KHORNE, TZEENTCH, NURGLE or SLAANESH. That unit has that Mark of Chaos until the start of your next hero phase in addition to the UNDIVIDED Mark of Chaos.\r\n        \r\n        Designer's Note: If you pick a WIZARD unit to have the TEENTCH Mark of Chaos, it knows the Warp Reality' spell until the start of your next hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Servants`,\r\n        desc: `Allied Bloodletters, Horrors of Teentch, Plaguebearers and Daemonettes units benefit from the Marks of Chaos battle trait (pg 70) as if they had the SLAVES TO DARKNESS keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, START_OF_CHARGE_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandAbilities = {\r\n  //MARKS OF CHAOS\r\n /* 'Let the Blood Flow': {\r\n    effects: [\r\n      {\r\n        name: `Let the Blood Flow`,\r\n        desc: `A friendly KHORNE SLAVES TO DARKNESS unit must receive this command from a KHORNE SLAVES TO DARKNESS HERO. After that unit makes a charge move, pick an enemy unit within 1\" and roll a dice. On a 2+ that enemy unit suffers D3 mortal wounds.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bestow Contagion': {\r\n    effects: [\r\n      {\r\n        name: `Bestow Contagion`,\r\n        desc: `A friendly NURGLE SLAVES TO DARKNESS unit must receive this command from a NURGLE SLAVES TO DARKNESS HERO. After this unit fights for the first time in that phase, roll a dice for each enemy unit within 3\" of this unit. On a 3+, that unit suffers D3 mortal wounds.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Close in for the Kill': {\r\n    effects: [\r\n      {\r\n        name: `Close in for the Kill`,\r\n        desc: `You can use this command ability at the start of your charge phase. A friendly SLAANESH SLAVES TO DARKNESS unit must receive this command from a SLAANESH SLAVES TO DARKNESS HERO. That unit can run and still charge later in the same turn.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slay Worthy Foes': {\r\n    effects: [\r\n      {\r\n        name: `Slay Worthy Foes`,\r\n        desc: `A friendly Undivided Slaves to Darkness unit must receive this command from a UNDIVIDED SLAVES TO DARKNESS HERO. Until the end of that phase, add 1 to wound rolls for attacks made with melee weapons by that unit that target an enemy Hero or Monster.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //UNITS\r\n  'By My Will': {\r\n    effects: [\r\n      {\r\n        name: `By My Will`,\r\n        desc: `This is a command ability this unit can issue at the start of the combat phase. Another friendly CHAOS unit must receive it (this unit cannot issue this command to itself). Until the end of that phase, each time a model in the receiving unit is slain it can fight.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  // Shared Command Traits\r\n  'Deathmonger': {\r\n    effects: [\r\n      {\r\n        name: `Deathmonger - Once Per Battle`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Favoured of the Pantheon': {\r\n    effects: [\r\n      {\r\n        name: `Favoured of the Pantheon`,\r\n        desc: `Effect: This unit can use the Eye of the Gods ability as if it were the end of the turn and it had destroyed an enemy unit this turn.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Radiance of Dark Glory': {\r\n    effects: [\r\n      {\r\n        name: `Radiance of Dark Glory`,\r\n        desc: `Declare: Pick each damaged friendly unit wholly within 12\" of this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, Heal (1) the target. Heal (3) the target instead if it is a Monster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Idolater Lord': {\r\n    effects: [\r\n      {\r\n        name: `Idolater Lord`,\r\n        desc: `This general becomes a PRIEST. In addition, you can choose to replace the UNDIVIDED keyword on every UNDIVIDED CULTIST unit in your army with one of the following keywords: KHORNE, TEENTCH, NURGLE or SLAANESH. All CULTIST units must be given the same keyword and it must be one this general has too.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //SLAVES TO DARKNESS DAEMON PRINCES only\r\n  'Not to be Denied': {\r\n    effects: [\r\n      {\r\n        name: `Not to be Denied`,\r\n        desc: `In each hero phase, once you have carried out a heroic action, if you did not carry out the heroic action with this general you carry out an additional heroic action with this general. The heroic action carried out with this general cannot be the same as the other heroic action you carried out in this phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bolstered by Chaos': {\r\n    effects: [\r\n      {\r\n        name: `Bolstered by Chaos`,\r\n        desc: `Add 2 to this general's Wounds characteristic.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Bolstered by Chaos`,\r\n        desc: `This general becomes a MONSTER.`,\r\n        when: [DURING_GAME, END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Radiance of Dark Glory': {\r\n    effects: [\r\n      {\r\n        name: `Radiance of Dark Glory`,\r\n        desc: `At the start of your hero phase, roll a dice for each friendly model within 9\" of this general that has any wounds allocated to them. On a 3+, you can heal 1 wound from the model being rolled for. If the model being rolled for is a MONSTER, on a 3+ you can heal up to 3 wounds instead.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Diabolic Majesty': {\r\n    effects: [\r\n      {\r\n        name: `Diabolic Majesty`,\r\n        desc: `UNDIVIDED only. Once per battle, when you carry out a heroic action with this general you can carry out any one of the heroic actions on its warscroll even if it does not have the required keywords.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const Summoning_Casting7_Range9_Effect = {\r\n  name: `Summoning`,\r\n  desc: `Casting value of 7 and range of 9\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only SLAVES TO DARKNESS WIZARDS can attempt to summon this endless spell.`,\r\n  when: [HERO_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n  shared: true,\r\n}*/\r\n\r\nconst EndlessSpells = {\r\n/*  'Eightfold Doom-Sigil': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and range of 6\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only SLAVES TO DARKNESS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Empowered by Atrocity`,\r\n        desc: `Keep track of the number of models that are slain within 12\" of this endless spell each turn.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Empowered by Atrocity`,\r\n        desc: `At the end of each turn, roll a dice for each model that was slain within 12\" of this endless spell during that turn. For each 3+, the player whose turn is taking place must pick 1 SLAVES TO DARKNESS unit wholly within 18\" of this endless spell. Add 1 to the Attacks characteristic of that unit's melee weapons (excluding those of its mounts) until that player's next hero phase. A unit cannot benefit from this ability more than once per turn.`,\r\n        when: [END_OF_TURN],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Empowered by Atrocity`,\r\n        desc: `If the unit is effected add 1 to attacks with melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Darkfire Daemonrift': {\r\n    effects: [\r\n      GenericEffects.Predatory.Nine_Inches,\r\n      Summoning_Casting7_Range9_Effect,\r\n      {\r\n        name: `Billowing Energies`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across and for each other unit within 1\" of it at the end of its move. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Fuelled by Sorcery`,\r\n        desc: `Add 1 to the number of mortal wounds caused by this endless spell for each other endless spell within 12\" of this endless spell after it has moved.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Realmscourge Rupture': {\r\n    effects: [\r\n      {\r\n        name: `Predatory`,\r\n        desc: `This endless spell is a predatory endless spell. It can be moved up to 9\" and can fly. When this endless spell is moved, it must move in a straight line in the direction in which its spikes are pointing.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      Summoning_Casting7_Range9_Effect,\r\n      {\r\n        name: `Debilitating Shockwave`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across and for each other unit within 1\" of it at the end of its move. On a 2+, that unit suffers D3 mortal wounds and its Move characteristic is halved until the end of the battle round.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Debilitating Shockwave`,\r\n        desc: `If a unit was affected, halve the movement characteristic until the end of the battle round.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker } from 'factions/metatagger'\r\nimport { MARK_KHORNE, MARK_NURGLE, MARK_SLAANESH, MARK_TZEENTCH, MARK_UNDIVIDED } from 'meta/alliances'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport spells from './spells'\r\n\r\nconst Flavors = {\r\n  'Legion of Chaos': {\r\n    effects: [\r\n      {\r\n        name: `United in Darkness - Passive`,\r\n        desc: `Effect: While there is at least 1 friendly Warriors of Chaos Hero and 1 other friendly Daemon Hero or Darkoath Hero on the battlefield, add 2 to the control scores of friendly Slaves to Darkness units while they are contesting an objective that is wholly outside friendly territory.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Godswrath Warband': {\r\n    effects: [\r\n      {\r\n        name: `Ironclad Onslaught - Once Per Turn`,\r\n        desc: `Declare: Pick an objective that is contested by any friendly units to be the target. \r\n        Effect: Place a defiled token next to the target objective. Then, roll a D3 for each enemy unit contesting an objective that has a defiled token. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Despoilers': {\r\n    effects: [\r\n      {\r\n        name: `Feral Ruin - Once Per Turn - Reaction: You declared a Fight ability for a friendly Daemon Prince unit`,\r\n        desc: `Used By: The Daemon Prince unit using that Fight ability. \r\n        Effect: Pick a friendly non-Hero Slaves to Darkness Monster or Beast unit that has not used a Fight ability this turn and is wholly within 12\" of this unit to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Horde': {\r\n    effects: [\r\n      {\r\n        name: `Rally the Tribes - Once Per Turn`,\r\n        desc: `Declare: If there is a friendly Darkoath Hero on the battlefield, pick a friendly non-Hero non-Unique Darkoath unit that has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 3+, set up a replacement unit with half the number of models from the target unit (rounding up) on the battlefield, wholly within 6\" of a battlefield edge and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /* Khorne: {\r\n    effects: [\r\n      {\r\n        name: `Mark of ${MARK_KHORNE}`,\r\n        desc: `Add 1 to the attacks characteristic of melee weapons used by KHORNE SLAVES TO DARKNESS units if they made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Banner of Rage: Khorne Unit Only`,\r\n        desc: `Add 1 to wound roll for attacks made with melee weapons by this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Let the Blood Flow'])],\r\n    },\r\n  },\r\n  Tzeentch: {\r\n    effects: [\r\n      {\r\n        name: `Mark of ${MARK_TZEENTCH}`,\r\n        desc: `You can roll a dice each time a spell targets a friendly TZEENTCH SLAVES TO DARKNESS unit. On a 6, that spell has no effect on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Blasted Standard: Tzeentch Unit Only`,\r\n        desc: `This unit has a ward of 4+ for attacks made with missile weapons that target this unit.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Warp Reality'])],\r\n    },\r\n  },\r\n  Nurgle: {\r\n    effects: [\r\n      {\r\n        name: `Mark of ${MARK_NURGLE}`,\r\n        desc: `Subtract 1 from wound rolls for attacks made with melee weapons that target NURGLE SLAVES TO DARKNESS units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Eroding Icon: Nurgle Unit Only`,\r\n        desc: `Worsen the Rend characteristic of melee weapons that target this unit by 1.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Bestow Contagion'])],\r\n    },\r\n  },\r\n  Slaanesh: {\r\n    effects: [\r\n      {\r\n        name: `Mark of ${MARK_SLAANESH}`,\r\n        desc: `Add 1 to run and charge rolls for SLAANESH SLAVES TO DARKNESS units.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The Banner of Screaming Flesh: Slaanesh Unit Only`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Close in for the Kill'])],\r\n    },\r\n  },\r\n  Undivided: {\r\n    effects: [\r\n      {\r\n        name: `Mark of ${MARK_UNDIVIDED}`,\r\n        desc: `All MORTAL and OGROID SLAVES TO DARKNESS UNDIVIDED units that are not unique gain the EYE OF THE GODS keyword.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Mark of ${MARK_UNDIVIDED}`,\r\n        desc: `When a SLAVES TO DARKNESS UNDIVIDED HERO rolls on the Eye of the Gods table, you can reroll any 1 of the dice.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Dread Banner: Undivided Unit Only`,\r\n        desc: `Each time this unit rolls on the Eye of the Gods table, you can roll 2 dice instead of 1 and pick 1 to be used as your roll.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Slay Worthy Foes'])],\r\n    },\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Dominating Presence': {\r\n    effects: [\r\n      {\r\n        name: `Dominating Presence`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is at least 1 friendly SLAVES TO DARKNESS unit wholly within each large quarter of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Follow the Path to Glory': {\r\n    effects: [\r\n      {\r\n        name: `Follow the Path to Glory`,\r\n        desc: `When the battle ends, you complete this grand strategy if you rolled the Dark Apotheosis (11+) result on the Eye of the Gods table one or more times during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Bring Ruin to the Realms': {\r\n    effects: [\r\n      {\r\n        name: `Bring Ruin to the Realms`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed this battle was from the Glory of Chaos battle tactics.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Masters of Dark Ritual': {\r\n    effects: [\r\n      {\r\n        name: `Masters of Dark Ritual`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any SLAVES TO DARKNESS endless spells on the battlefield that you set up.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { MARK_KHORNE, MARK_NURGLE, MARK_SLAANESH, MARK_TZEENTCH, MARK_UNDIVIDED } from 'meta/alliances'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Prayers = {\r\n/*  'Favour of the Ruinous Powers': {\r\n    effects: [\r\n      {\r\n        name: `Bloodlust - ${MARK_KHORNE}`,\r\n        desc: `Answer value of 3 and range of 18\". This unit and the target unit must have the ${MARK_KHORNE} keyword. Pick 1 unit wholly within 18\" and visible. Add 1 to charge rolls for that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Bloodlust - ${MARK_KHORNE}`,\r\n        desc: `If picked, add 1 to charge rolls for that unit until the start of your next hero phase.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Prismatic Glamour - ${MARK_TZEENTCH}`,\r\n        desc: `Answer value of 3 and range of 18\". This unit and the target unit must have the ${MARK_TZEENTCH} keyword. Pick 1 unit wholly within 18\" and visible. Subtract 1 from wound rolls for attacks that target that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Prismatic Glamour - ${MARK_TZEENTCH}`,\r\n        desc: `If picked, subtract 1 from wound rolls for attacks that target that unit until the start of your next hero phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Seeping Blades - ${MARK_NURGLE}`,\r\n        desc: `Answer value of 3 and range of 18\". This unit and the target unit must have the ${MARK_NURGLE} keyword. Pick 1 unit wholly within 18\" and visible. Add 1 to wound rolls for attacks made with melee weapons until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Seeping Blades - ${MARK_NURGLE}`,\r\n        desc: `If picked, add 1 to wound rolls for attacks made with melee weapons until the start of your next hero phase.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Unnatural Speed - ${MARK_SLAANESH}`,\r\n        desc: `Answer value of 3 and range of 18\". This unit and the target unit must have the ${MARK_SLAANESH} keyword. Pick 1 unit wholly within 18\" and visible. Until the start of your next hero phase you can attempt a charge within 18\" and roll 3d6 to charge.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Unnatural Speed - ${MARK_SLAANESH}`,\r\n        desc: `If picked, until the start of your next hero phase you can attempt a charge within 18\" and roll 3d6 to charge.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Favour of Chaos - ${MARK_UNDIVIDED}`,\r\n        desc: `Answer value of 3 and range of 18\". This unit and the target unit must have the ${MARK_UNDIVIDED} keyword. If answered, pick 1 friendly unit wholly within range and visible. Until the start of your next hero phase halve the number of models that flee from battleshock (rounded down).`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Favour of Chaos ${MARK_UNDIVIDED}`,\r\n        desc: `If picked, halve the number of models that flee from battleshock (rounded down).`,\r\n        when: [BATTLESHOCK_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  // Idolators\r\n /* 'Blessings of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `Blessings of Khorne`,\r\n        desc: `Blessings of Khorne is a prayer with an answer value of 3 and range of 12\". If answered, pick 1 friendly KHORNE IDOLATORS unit wholly within range of the chanter and visible to them. You can reroll hit rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Blessings of Khorne`,\r\n        desc: `If active, you can reroll hit rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Blessings of Tzeentch': {\r\n    effects: [\r\n      {\r\n        name: `Blessings of Tzeentch`,\r\n        desc: `Blessings of Tzeentch is a prayer with an answer value of 3 and range of 12\". If answered, pick 1 friendly Tzeentch Idolators unit wholly within range of the chanter and visible to them. Add 1 to save rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Blessings of Tzeentch`,\r\n        desc: `If active, add 1 to save rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [SAVES_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Blessings of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Blessings of Nurgle`,\r\n        desc: `Blessings of Nurgle is a prayer with an answer value of 3 and range of 12\". If answered, pick 1 friendly NURGLE IDOLATORS unit wholly within range of the chanter and visible to them. You can reroll wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Blessings of Nurgle`,\r\n        desc: `If active, you can reroll wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Blessings of Slaanesh': {\r\n    effects: [\r\n      {\r\n        name: `Blessings of Slaanesh`,\r\n        desc: `Blessings of Slaanesh is a prayer with an answer value of 3 and range of 12\". If answered, pick 1 friendly SLAANESH IDOLATORS unit wholly within range of the chanter and visible to them. You can reroll charge rolls for that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n      {\r\n        name: `Blessings of Slaanesh`,\r\n        desc: `If active, you can reroll charge rolls for that unit until your next hero phase.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Blessings of Chaos Undivided': {\r\n    effects: [\r\n      {\r\n        name: `Blessings of Chaos Undivided`,\r\n        desc: `Blessings of Chaos Undivided is a prayer with an answer value of 3 and range of 12\". If answered, pick 1 friendly IDOLATORS model within range of the chanter and visible to them. You can heal D3 wounds allocated to that model.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","// Spell Lores of Slaves to Darkness - Lore of the Damned\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Spells = {\r\n  //Spell Lore\r\n  'Lore of the Damned': {\r\n    effects: [\r\n      {\r\n        name: `Spite-Tongue Curse: Casting value of 5 (UNLIMITED) `,\r\n        desc: `Declare: Pick a friendly Slaves to Darkness Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. If the casting attempt is unsuccessful or if the spell is unbound, inflict D3 mortal damage on the caster. \r\n        Effect: Inflict 3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Binding Damnation: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Slaves to Darkness Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has Strike-last until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Daemonic Speed: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Slaves to Darkness Wizard to cast this spell, pick a visible friendly Slaves to Darkness unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: For the rest of the turn, add 1 to the number of dice rolled when making charge rolls for the target, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Spite-tongue Curse': {\r\n    effects: [\r\n      {\r\n        name: `Spite-tongue Curse`,\r\n        desc: `Casting value of 3. Pick 1 enemy unit within 12\" and visible. That unit suffers 3 mortal wounds. If the casting roll fails or the spell is unbound, the caster suffers 3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaotic Conduit': {\r\n    effects: [\r\n      {\r\n        name: `Chaotic Conduit`,\r\n        desc: `Casting value of 7. Pick 1 friendly EYE OF THE GODS unit within 12\" and visible. You can immediately roll on the Eye of the Gods table for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ruinous Vigour': {\r\n    effects: [\r\n      {\r\n        name: `Ruinous Vigour`,\r\n        desc: `Casting value of 6. Pick 1 friendly Slaves to Darkness MONSTER wholly within 12\" and visible. Until your next hero phase the MONSTER uses the 0 wounds suffered row of its damage table.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ruinous Vigour`,\r\n        desc: `The affected MONSTER uses the 0 wounds suffered row of its damage table.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Daemonic Speed': {\r\n    effects: [\r\n      {\r\n        name: `Daemonic Speed`,\r\n        desc: `Casting value of 7. Pick 1 friendly Slaves to Darkness unit that has a mount wholly within 12\" and visible. Until the start of your next hero phase, you can charge with that unit if it is within 18\" and roll 3D6 for charge rolls.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n      {\r\n        name: `Daemonic Speed`,\r\n        desc: `The affected unit can charge from 18\" and roll 3D6.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warp Reality': {\r\n    effects: [\r\n      {\r\n        name: `Warp Reality`,\r\n        desc: `All Tzeentch Slaves to Darkness Wizards know this spell. Casting value of 6 and a range of 9\". Pick 1 friendly Tzeentch Slaves to Darkness unit visible to the caster. Remove that unit from the battlefield and set it up again wholly within range of the caster and more than 9\" from all enemy units. That unit cannot move in the next movement phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //UNITS\r\n  'Enfeeble Foe': {\r\n    effects: [\r\n      {\r\n        name: `Enfeeble Foe`,\r\n        desc: `Casting value of 6. Pick one visible enemy unit within 18\" of the caster. Until your next hero phase, subtract 1 from the melee wound rolls made by the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Enfeeble Foe`,\r\n        desc: `If active, subtract 1 from the wound rolls made by the target in the combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Infernal Flames': {\r\n    effects: [\r\n      {\r\n        name: `Infernal Flames`,\r\n        desc: `Casting value of 7. Pick 1 enemy unit within 12\" of the caster that is visible to them, and roll 1 dice for each model in that unit. For each 5+, that unit suffers 1 mortal wound. If that unit is a MONSTER or War Machine, roll 5 dice for each model instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* 'Winds of Chaos': {\r\n    effects: [\r\n      {\r\n        name: `Winds of Chaos`,\r\n        desc: `Casting value of 8. Pick 1 enemy unit within 18\" and visible. Roll a number of dice equal to the number of models in the target unit. For each 5, the target suffers 1 mortal wound. For each 6, the target suffers 2 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Daemonic Power': {\r\n    effects: [\r\n      {\r\n        name: `Daemonic Power`,\r\n        desc: `Casting value of 6. Select a friendly MORTAL SLAVES TO DARKNESS unit wholly within 18\" and visible. Until your next hero phase, add 1 to hit and wound rolls for melee weapons for the targeted unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Daemonic Power`,\r\n        desc: `If active, you can add 1 to hit and wound rolls for melee weapons for the targeted unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Enfeeblement: {\r\n    effects: [\r\n      {\r\n        name: `Enfeeblement`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit within 12\" and visible to the caster. Subtract 1 from wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Mask of Darkness': {\r\n    effects: [\r\n      {\r\n        name: `Mask of Darkness`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 friendly KHAGRA's RAVAGERS unit wholly within range and visible to the caster. Remove that unit from the battlefield and set it up again anywhere on the battlefield wholly within 24\" of the caster and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mask of Darkness`,\r\n        desc: `Affected units cannot move in this phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { MARK_KHORNE, MARK_NURGLE, MARK_SLAANESH, MARK_TZEENTCH, MARK_UNDIVIDED } from 'meta/alliances'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Prayers from './prayers'\r\nimport rule_sources from './rule_sources'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n// Common effects used on multiple warscrolls.\r\n/* const ChaosRuneshieldSaveEffect = {\r\n  name: `Shield`,\r\n  desc: `If this unit has a Chaos Runeshield it has a save of 3+ instead of 4+`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst ArcaneFuryEffect = {\r\n  name: `Arcane Fury`,\r\n  desc: `If the unmodified hit roll for a melee attack by this model is a 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nexport const LordsOfTheSilverTowerEffect = {\r\n  name: `Lords of the Silver Towers`,\r\n  desc: `Once per battle, at the end of a phase, you can pick 1 enemy unit HERO that is within 9\" of this unit and that made an attack that targeted this unit in that phase, or caused any mortal wounds to this unit with an ability or spell in that phase (even if the wounds or mortal wounds were negated). If you do so, roll 2D6, If the roll is greater than the Wounds characteristic of that HERO, that HERO is removed from play.\r\n  \r\n  Designer's Note: The HERO cannot be returned if you are allowed to bring back slain models (the model has not been slain).`,\r\n  when: [END_OF_ANY_PHASE],\r\n  shared: true,\r\n}\r\nexport const BookOfProfaneSecretsEffect = {\r\n  name: `Book of Profane Secrets`,\r\n  desc: `Add 1 to casting, dispelling, and unbinding rolls for this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in your army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst strikeFirstOnChargeEffect = {\r\n  name: `Blade of the First Prince / The Knights of Chaos`,\r\n  desc: `The strike-first effect applies to this unit if it has made a charge move in the same turn.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst knightsOfChaosEffect = {\r\n  name: `The Knights of Chaos`,\r\n  desc: `If this unit has made a charge move in the same turn, after this unit has fought in the combat phase for the first time, you can pick 1 friendly CHAOS KNIGHT, CHAOS CHARIOT or GOREBEAST CHARIOT unit wholly within 12\" of this unit and that has not yet fought in that phase. That unit can fight immediately.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst ChaosRuneshieldPlatingEffect = {\r\n  name: `Chaos Runeshield / Rune-etched Plating`,\r\n  desc: `Roll a D6 each time the equipped model suffers a mortal wound. On a 5+ it is negated.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst DarkBlessingsEffect = {\r\n  name: `Dark Blessings / The Rewards of Chaos`,\r\n  desc: `After deployment, you can roll once on the Eye of the Gods table for this unit.`,\r\n  when: [START_OF_GAME],\r\n  shared: true,\r\n}\r\nconst OracularVisionsEffects = [\r\n  {\r\n    name: `Oracular Visions`,\r\n    desc: `In your hero phase, you can pick 1 friendly MORTAL SLAVES TO DARKNESS unit wholly within 12\" of this unit. That unit has gets a 6+ ward until the start of your next hero phase.`,\r\n    when: [HERO_PHASE],\r\n    rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Oracular Visions`,\r\n    desc: `If active, 6+ ward unit until your next hero phase.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n    shared: true,\r\n  },\r\n]\r\nconst DaemonforgedWeaponEffect = {\r\n  name: `Daemonbound / Soul Splitter`,\r\n  desc: `If the unmodified hit roll for an attack made with the appropriate weapon is 6, that attack inflicts 1 mortal wound in addition to any normal damage.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst chaosLanceEffect = {\r\n  name: `Chaos Lance`,\r\n  desc: `Add 1 to the Damage characteristic and improve the Rend characteristic of this unit's Chaos Lance by 1 if it made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst BerserkRageEffect = {\r\n  name: `Berserk Rage`,\r\n  desc: `Add 1 to wound rolls for melee attacks made by this model if any wounds or mortal wounds were allocated to this model earlier in the same phase.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst TerritorialPredatorEffect = {\r\n  name: `Territorial Predator`,\r\n  desc: `Add 1 to the Damage of attacks made with this unit's Honed Fangs and Claws that target an enemy MONSTER.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst TribalWarleaderEffect = {\r\n  name: `Tribal Warleader`,\r\n  desc: `After this unit has fought in the combat phase for the first time, you can pick 1 friendly DARKOATH unit that has not yet fought in that combat phase, is within 3\" of an enemy unit and is wholly within 12\" of this unit, that unit can fight immediately.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst ChaosChariotEffects = [\r\n  {\r\n    name: `Don't Spare the Lash`,\r\n    desc: `Once per battle, this unit can run and still charge later in the same turn.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Swift Death`,\r\n    desc: `After finishing a charge move with this unit, pick 1 enemy unit within 1\". Roll a number of dice equal to the charge roll. For each 5+ that enemy suffers 1 mortal wound.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst SilveredPortalEffect = {\r\n  name: `Silvered Portal`,\r\n  desc: `After you have deployed this unit, when you would set up another friendly TZEENTCH unit that is not a MONSTER, you can say that it is in this Gaunt Summoner's Silver Tower as a reserve unit. Up to 2 units can be set up in reserve in this way. At the end of any of your movement phases, you can set up 1 or more of these units on the battlefield wholly within 9\" of this unit and more than 9\" from all enemy units. At the start of the fourth battle round, reserve units that are still in a Silver Tower are destroyed.`,\r\n  when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n  shared: true,\r\n}\r\n// Common unit composition effects.\r\nconst UnitLeaderEffect = {\r\n  name: `Unit Leader`,\r\n  desc: `Add 1 to the attacks characteristic of the unit leader's melee weapons (excluding its mount if it has one).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst MusiciansEffect = {\r\n  name: `Musicians`,\r\n  desc: `If the unit includes any musicians, add 1 charge rolls.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst StandardBearersEffect = {\r\n  name: `Standard Bearers`,\r\n  desc: `Add 1 to the bravery of a friendly unit containing any standard bearers.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst IconBearersEffect = {\r\n  name: `Icon Bearers`,\r\n  desc: `Subtract 1 from the bravery characteristic of enemy units while they are within 6\" of any friendly icon bearers.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\n\r\n// Marauder specific effects.\r\nconst DarkwoodShieldEffect = {\r\n  name: `Darkwood Shield`,\r\n  desc: `This unit has a Save characteristic of 5+ instead of 6+.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\n// Chariot specific effects.\r\nconst ExaltedCharioteerEffect = {\r\n  name: `Exalted Charioteer`,\r\n  desc: `If this unit has 2 or more models, 1 model in this unit can be an Exalted Charioteer. Add 1 to attacks made with that model's melee weapons (excluding those of its mount)`,\r\n  when: [COMBAT_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n  shared: true,\r\n}\r\n\r\n// Chaos Mark Effects.\r\nconst ChaosMarkAll = {\r\n  name: `Mark of Chaos (${MARK_KHORNE}, ${MARK_NURGLE}, ${MARK_SLAANESH}, ${MARK_TZEENTCH}, ${MARK_UNDIVIDED})`,\r\n  desc: `This unit either has or must take any Mark of Chaos during list construction.`,\r\n  when: [DURING_SETUP],\r\n  shared: true,\r\n}\r\n\r\nconst ChaosMarkSorcerer = {\r\n  name: `Mark of Chaos (${MARK_NURGLE}, ${MARK_SLAANESH}, ${MARK_TZEENTCH}, ${MARK_UNDIVIDED})`,\r\n  desc: `This unit must take any one of the following Mark of Chaos during list construction: Nurgle, Slaanesh, Tzeentch, or Undivided.`,\r\n  when: [DURING_SETUP],\r\n  shared: true,\r\n}\r\n\r\nconst ChaosMarkKhorne = {\r\n  name: `Mark of Chaos (${MARK_KHORNE})`,\r\n  desc: `This unit must take the Khorne Mark of Chaos during list construction.`,\r\n  when: [DURING_SETUP],\r\n  shared: true,\r\n}\r\n\r\nconst ChaosMarkTzeentch = {\r\n  name: `Mark of Chaos (${MARK_TZEENTCH})`,\r\n  desc: `This unit must take the Tzeentch Mark of Chaos during list construction.`,\r\n  when: [DURING_SETUP],\r\n  shared: true,\r\n}*/\r\n\r\nconst Units = {\r\n  'Archaon the Everchosen': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['By My Will'])],\r\n    }, */\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    //  WarmasterEffect,\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Dorghars Claws and Tails is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Three-Headed Titan - Once Per Turn`,\r\n        desc: `Effect: Pick 1 of the following effects: \r\n        Filth-spewer: Pick an enemy unit within 6\" of this unit and roll a number of dice equal to the number of models in that unit, to a maximum of 7. For each 3+, inflict 1 mortal damage on that unit. \r\n        Skull-gorger: Pick an enemy unit in combat with this unit and roll a dice. If the roll exceeds that units Health characteristic, 1 model in that unit is slain and you can Heal (X) this unit, where X is that units Health characteristic. \r\n        Spell-eater: Pick a Manifestation within 12\" of this unit and roll a dice. On a 2+, it is banished and inflict D3 mortal damage on the unit that summoned it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Eye of Sheerian - Once Per Battle`,\r\n        desc: `Effect: Roll a dice. This roll replaces the priority roll of the next battle round. On a 1-3, your opponent must take the first turn of that battle round. On a 4-6, you must take the first turn of that battle round. This ability cannot be used if there is an enemy Archaon on the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Favoured Warlord`,\r\n        desc: `Effect: Pick 1 of the following keywords: Khorne, Tzeentch, Nurgle or Slaanesh. This unit has that keyword in addition to Undivided.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Slayer of Kings - Passive`,\r\n        desc: `Effect: Each time this unit uses a Fight ability, if the unmodified wound roll for 2 or more attacks made with The Slayer of Kings that target the same Hero is 6, that Hero is automatically destroyed.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Daemon Prince': {\r\n    effects: [\r\n     // ChaosMarkAll,\r\n      {\r\n        name: `Airborne Horror - Passive`,\r\n        desc: `Effect: If this unit has Wings, it has a Move characteristic of 10\" and has Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `The Mounted Skulls of Fallen - Passive`,\r\n        desc: `Effect: If this unit has a Trophy Rack, its Hellforged Weapons also have Anti-Hero (+1 Rend).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ruinous Favor`,\r\n        desc: `Declare: Pick a friendly non-Unique unit wholly within 12\" of this unit that shares a Mark of Chaos keyword with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target can immediately use the Eye of the Gods ability as if it were the end of the turn and they had destroyed an enemy unit this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Varanguard: {\r\n    effects: [\r\n     // GenericEffects.Elite,\r\n     // ChaosMarkAll,\r\n     // DaemonforgedWeaponEffect,\r\n      {\r\n        name: `Relentless Killers - Once Per Battle`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Be'Lakor\": {\r\n   // mandatory: {\r\n    //  spells: [keyPicker(Spells, ['Enfeeble Foe'])],\r\n   // },\r\n    effects: [\r\n      {\r\n        name: `Shadow Form - Passive`,\r\n        desc: `Effect: Ignore modifiers to save rolls for this unit (positive and negative).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Dark Master - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick a visible enemy unit to be the target. \r\n        Effect: Until the start of your next turn, each time the target is picked to use an ability, roll a dice as a reaction. On a 3+, that ability has no effect.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Blade of Shadows is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Deadly Trap - Once Per Turn - Enemy Combat Phase`,\r\n        desc: `Declare: Pick this unit and up to 2 friendly Slaves to Darkness units within this units combat range to be the targets. \r\n        Effect: Roll a dice for each target. On a 4+, that target has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Enfeeble Foe: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn:  \r\n        Subtract 1 from hit rolls from the targets combat attacks.  \r\n        The targets combat attacks cannot score critical hits (treat them as regular hits instead).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  Eternus: {\r\n    effects: [\r\n    //  strikeFirstOnChargeEffect,\r\n      {\r\n        name: `Network of Spies - Reaction: Opponent declared a command for a unit within 12\" of this unit`,\r\n        desc: `Effect: Roll a dice. Add 1 to the roll if the enemy unit is in combat with a friendly Chaos Legionnaires or Chaos Furies unit. On a 5+, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Veins of Black Lightning`,\r\n        desc: `Declare: This unit can use this ability if it has been destroyed. \r\n        Effect: Roll 2D6. Add 1 to the roll if a friendly Belakor is on the battlefield. On an 8+, set up a replacement unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gaunt Summoner on Disc of Tzeentch': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Flames'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Minions of the Silver Tower`,\r\n        desc: `Declare: Pick a friendly unit that has not been deployed to be the target. \r\n        Effect: The target is set up in reserve in a Silver Tower. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Book of Profane Secrets`,\r\n        desc: `Declare: Pick a friendly unit in a Silver Tower to be the target. \r\n        Effect: Set up the target on the battlefield wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Imprisonment: Casting value of 7`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: If the unmodified casting roll exceeds the targets Health characteristic, it is automatically destroyed. For the rest of the battle, that unit cannot be picked to be the target of an ability that allows a replacement unit to be set up.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // ChaosMarkTzeentch,\r\n     // SilveredPortalEffect,\r\n      //BookOfProfaneSecretsEffect,\r\n      //LordsOfTheSilverTowerEffect,\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'Gaunt Summoner': {\r\n    \r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Flames'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Minions of the Silver Tower`,\r\n        desc: `Declare: Pick a friendly unit that has not been deployed to be the target. \r\n        Effect: The target is set up in reserve in a Silver Tower. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Book of Profane Secrets`,\r\n        desc: `Declare: Pick a friendly unit in a Silver Tower to be the target. \r\n        Effect: Set up the target on the battlefield wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Divert Realmgate: Casting value of 7`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Units set up this turn using this units Book of Profane Secrets ability can be set up wholly within 18\" of this unit and more than 7\" from all enemy units instead of the distances in the ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  ChaosMarkTzeentch,\r\n     // SilveredPortalEffect,\r\n     // BookOfProfaneSecretsEffect,\r\n     // LordsOfTheSilverTowerEffect,\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'Chaos Lord on Daemonic Mount': {\r\n    effects: [\r\n      {\r\n        name: `The Knights of Chaos - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Warriors of Chaos Cavalry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ChaosMarkAll,\r\n     // ChaosRuneshieldPlatingEffect,\r\n    //  strikeFirstOnChargeEffect,\r\n     // knightsOfChaosEffect,\r\n     // chaosLanceEffect,\r\n    ],\r\n  },\r\n  'Chaos Lord on Manticore': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    //  DaemonforgedWeaponEffect,\r\n    //  TerritorialPredatorEffect,\r\n    //  chaosLanceEffect,\r\n    //  ChaosRuneshieldSaveEffect,\r\n      {\r\n        name: `Apex Predator - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Add 1 to hit rolls for this units combat attacks that target that Monster for the rest of the turn. This ability also aects Companion weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Iron-Willed Overlord - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Warriors of Chaos units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Sorcerer Lord on Manticore': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Winds of Chaos'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Oracular Visions - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Warriors of Chaos unit wholly within 12\" of this unit to be the target and roll a dice. \r\n        Effect: On a 3+, the target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Venomous Tail Strike - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ChaosMarkSorcerer,\r\n     // ...OracularVisionsEffects,\r\n     // TerritorialPredatorEffect,\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  'Chaos Lord on Karkadrak': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    //  knightsOfChaosEffect,\r\n     // strikeFirstOnChargeEffect,\r\n     // ChaosRuneshieldPlatingEffect,\r\n     // DaemonforgedWeaponEffect,\r\n      {\r\n        name: `Brutish Rampage`,\r\n        desc: `Declare: If this unit charged this phase, pick up to 3 enemy units within 1\" of it to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Drive the Legions Forward - Once Per Battle`,\r\n        desc: `Declare: Pick this unit and up to 2 friendly non-Hero Warriors of Chaos units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 2 to charge rolls for the targets for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Lord': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n     // DaemonforgedWeaponEffect,\r\n      {\r\n        name: `Glory in Battle - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Warriors of Chaos Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Sorcerer Lord': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Daemonic Power'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Oracular Visions - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Warriors of Chaos unit wholly within 12\" of this unit to be the target and roll a dice. \r\n        Effect: On a 3+, the target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  ChaosMarkSorcerer, ...OracularVisionsEffects, GenericEffects.WizardOneSpellEffect\r\n    ],\r\n  },\r\n  'Exalted Hero of Chaos': {\r\n    effects: [\r\n      //ChaosMarkAll,\r\n      //ChaosRuneshieldPlatingEffect,\r\n      //DarkBlessingsEffect,\r\n     // ChaosRuneshieldSaveEffect,\r\n      {\r\n        name: `Glory-Seeker - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons for attacks that target Heroes or Monsters.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ogroid Myrmidon': {\r\n    effects: [\r\n      {\r\n        name: `Pit Master - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Ogroid Theridons unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  BerserkRageEffect, ArcaneFuryEffect\r\n    ],\r\n  },\r\n  'Ogroid Theridons': {\r\n    effects: [\r\n      //UnitLeaderEffect,\r\n      //StandardBearersEffect,\r\n     // BerserkRageEffect,\r\n     // MusiciansEffect,\r\n     // ArcaneFuryEffect,\r\n      {\r\n        name: `Unleashed Savagery - Once Per Battle`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Warshrine': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Favour of the Ruinous Powers'])],\r\n    }, */\r\n    effects: [\r\n   //   ChaosMarkAll,\r\n      {\r\n        name: `Protection of the Dark Gods - Passive`,\r\n        desc: `Effect: Friendly Warriors of Chaos units have Ward (6+) while they are wholly within 12\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Flailing Fists is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of Chaos: Chant value of 4`,\r\n        desc: `Declare: Pick a visible friendly Slaves to Darkness unit wholly within 12\" of this unit that shares a Mark of Chaos keyword with this unit to be the target. Then, make a chanting roll of D6. \r\n        Effect: Apply 1 of the following effects to the target for the rest of the turn depending on which Mark of Chaos keyword this unit has:  \r\n        Undivided: When the target uses the Rally command, you can make 3 additional rally rolls of D6.  \r\n        Khorne: Add 1 to hit rolls for the targets attacks.  \r\n        Tzeentch: The target has Ward (5+).  \r\n        Nurgle: Add 1 to wound rolls for the targets attacks.  \r\n        Slaanesh: Add 1 to the number of dice rolled when making charge rolls for the target, to a maximum of 3. \r\n        If the chanting roll was 8+, you can pick up to 2 eligible units to be the targets instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Chariots': {\r\n    effects: [\r\n      {\r\n        name: `Swift Death`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  ChaosMarkAll, ExaltedCharioteerEffect, ...ChaosChariotEffects\r\n    ],\r\n  },\r\n  'Gorebeast Chariots': {\r\n    effects: [\r\n      //ChaosMarkAll,\r\n      //ExaltedCharioteerEffect,\r\n      {\r\n        name: `Brutal Momentum - Passive`,\r\n        desc: `Effect: When this unit uses the Power Through command, inflict an additional D3 mortal damage on the target and add 3\" to the distance this unit can move as part of that ability.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Theddra Skull-Scryer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Enfeeblement'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `Oath of Arcane Apotheosis`,\r\n        desc: `If the unmodified casting roll made for this unit is 10+, this unit fulfils its oath. This unit can then attempt to cast 2 spells in your hero phase and attempt to unbind 2 spells in the enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  'Godsworn Hunt': {\r\n    effects: [\r\n      {\r\n        name: `Oath of Conquest`,\r\n        desc: `If you gain control of an objective previously controlled by your opponent while this unit is contesting it, this unit fulfils its oath. This unit has a 5+ ward for the rest of the battle.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Avowed Kinsmen`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly THEDDRA SOUL-SCRYER, or instead of making a ward roll, if this unit is within 3\" of that friendly THEDDRA SOUL-SCRYER, vou can roll a dice. On a 3+, that wound or mortal wound is allocated to this unit instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Darkoath Warqueen': {\r\n    effects: [\r\n    //  TribalWarleaderEffect,\r\n      {\r\n        name: `Ruin-Blessed Conqueror - Once Per Turn`,\r\n        desc: `Declare: Pick an objective that this unit is contesting. \r\n        Effect: Roll a dice. On a 3+, for the rest of the turn, other friendly Darkoath units have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Oath of Supremacy - Once Per Battle`,\r\n        desc: `Effect: If this unit is wholly within enemy territory and charged this phase, for the rest of the battle, add 1 to hit rolls for combat attacks made by friendly Darkoath units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Chieftain': {\r\n    effects: [\r\n    //  TribalWarleaderEffect,\r\n      {\r\n        name: `Tribal Warleader - Reaction: You declared a Fight abililty for this unit`,\r\n        desc: `Unmodified hit rolls of 6 inflict 1 mortal wound in addition to any normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Oath of Murder - Once Per Battle`,\r\n        desc: `Effect: If this unit destroyed an enemy Hero or Monster this turn, this unit has Strike-first for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Chosen': {\r\n    effects: [\r\n   //   ChaosMarkAll,\r\n   //   UnitLeaderEffect,\r\n   //   IconBearersEffect,\r\n   //   MusiciansEffect,\r\n   //   DaemonforgedWeaponEffect,\r\n   //   DarkBlessingsEffect,\r\n      {\r\n        name: `Heralds of Ruination - Once Per Battle`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Spawn': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Drawn to Power - Passive`,\r\n        desc: `Effect: While this unit is wholly within 12\" of a friendly Daemon Prince that shares a Mark of Chaos keyword with it, you can re-roll the random characteristic rolls for this units Move and Attacks characteristics.`,\r\n        when: [MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Warriors': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    //  UnitLeaderEffect,\r\n    //  StandardBearersEffect,\r\n   //   MusiciansEffect,\r\n    //  ChaosRuneshieldPlatingEffect,\r\n      {\r\n        name: `Bringers of Desolation - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Rune-Etched Weapons while it is contesting an objective you control.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Knights': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    //  UnitLeaderEffect,\r\n    //  StandardBearersEffect,\r\n   //   ChaosRuneshieldPlatingEffect,\r\n      {\r\n        name: `Impaling Charge - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to the Rend characteristic of its Cursed Lances`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Fellriders': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n     // UnitLeaderEffect,\r\n     // StandardBearersEffect,\r\n   //   MusiciansEffect,\r\n    //  DarkwoodShieldEffect,\r\n      {\r\n        name: `Swift Attackers - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oath of the Raider - Once Per Battle`,\r\n        desc: `Effect: If this unit charged this phase and is only in combat with 1 enemy unit, and that enemy unit is only in combat with this unit, add 1 to the Rend characteristic of this units weapons for the rest of the battle.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Marauders': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n   //   UnitLeaderEffect,\r\n    //  StandardBearersEffect,\r\n    //  MusiciansEffect,\r\n    //  DarkwoodShieldEffect,\r\n      {\r\n        name: `Glorious Death - Passive`,\r\n        desc: `Effect: While this unit is wholly within 12\" of any friendly Darkoath Heroes, each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Oath of the Marauder - Once Per Battle`,\r\n        desc: `Effect: If this unit charged this phase and the unmodified charge roll was 8+, add 1 to the Rend characteristic of this units weapons for the rest of the battle.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mutalith Vortex Beast': {\r\n    effects: [\r\n    //  ChaosMarkTzeentch,\r\n      {\r\n        name: `Mutant Regeneration`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Betentacled Maw is 8.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of Mutation - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target. \r\n        Effect: Roll a dice and apply the corresponding effect below. If this unit is wholly within 12\" of a friendly Tzeentch Wizard, you can roll 2 dice instead, pick either result, then apply the corresponding effect below. \r\n        1 Untouched: No effect. \r\n        2 Hideous Disgurement: Subtract 3 from the targets control score until the start of your next turn. \r\n        3 Troggbrains: The target cannot use commands for the rest of the turn. \r\n        4 Gift of Mutations: Subtract 1\" from the targets Move characteristic for the rest of the battle. \r\n        5 Horrific Absorption: Inflict D6 mortal damage on the target. Then, Heal (D6) this unit. \r\n        6 Transmogrication: Pick any other effect.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul Grinder': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Piston-driven Legs and Daemonic Blade or Claw is 6.`,\r\n      when: [COMBAT_PHASE],\r\n    },  \r\n    {\r\n        name: `Piston-Driven Carnage - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Then, this unit can move 6\". During that move, it can pass through models in the target unit but must end that move in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Implacable Advance - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Abraxia': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Gorbolga is 3.`,\r\n      when: [COMBAT_PHASE],\r\n    },  \r\n    {\r\n        name: `Warlord of the First Circle - Passive`,\r\n        desc: `Effect: If a friendly Varanguard unit uses the Relentless Killers ability while it is wholly within 12\" of this unit, that unit does not have Strike-last as a result of that ability.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Roar of Domination - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood of Molten Varanite - Passive`,\r\n        desc: `Effect: Roll a dice each time a damage point inflicted by a combat attack is allocated to this unit. On a 4+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gorbolga the Accursd`,\r\n        desc: `Effect: If this unit is in combat, roll a dice and apply the corresponding effect: \r\n        1 Uncontrollable Power: Allocate 1 damage point to this unit. \r\n        2 The Spear Slumbers: No effect. \r\n        3-5 White-hot Varanite: Add 1 to the Damage characteristic of this units Gorbolga for the rest of the turn. \r\n        6 Rampant Mutation: The effect of White-hot Varanite applies and this units Gorbolga has Crit (Mortal) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gunnar Brand': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    {\r\n      name: `Carve a Path to Glory`,\r\n      desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n      Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n      when: [COMBAT_PHASE],\r\n    },  \r\n    {\r\n        name: `Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Singri Brand': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    {\r\n      name: `Swift as the Wind - Passive`,\r\n      desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n      when: [SHOOTING_PHASE],\r\n    },  \r\n    {\r\n        name: `Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Oathsworn Kin': {\r\n    effects: [\r\n    //  ChaosMarkAll,\r\n    {\r\n      name: `Withering Death: Casting value of 5`,\r\n      desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n      Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n      when: [HERO_PHASE],\r\n    },  \r\n    {\r\n        name: `Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Slaughterbrute: {\r\n    effects: [\r\n     // ChaosMarkKhorne,\r\n      {\r\n        name: `Sigils of Domination`,\r\n        desc: `Declare: Pick a friendly Slaves to Darkness Hero within this units combat range to be this units master. \r\n        Effect: For the rest of the battle, while this unit is within its masters combat range, add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Razor-tipped Claws is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      }, \r\n      {\r\n        name: `Rampaging Charge - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target unit is Infantry, double the amount of mortal damage inflicted.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Centaurion Marshal': {\r\n    effects: [\r\n      {\r\n        name: `Marshal of the Legions - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Undivided unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Legionnaires': {\r\n    effects: [\r\n      {\r\n        name: `Sow Confusion - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, the target cannot use commands for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Horns of Hashut': {\r\n    effects: [\r\n      {\r\n        name: `Ruinator Alpha`,\r\n        desc: `1 in every 10 models in this unit must be a Ruinator Alpha. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Ruinator Alphas can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ruinator`,\r\n        desc: `1 in every 10 models in this unit must be a Ruinator. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Demolisher with Flamehurler`,\r\n        desc: `1 in every 10 models in this unit must be a Demolisher with Flamehurler. A Demolisher with Flamehurler is armed with a Flamehurler and Forge Weapons.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Torrent of Flames`,\r\n        desc: `The Attacks characteristic of a Flamehurler is equal to the number of models in the target unit (to a maximum Attacks characteristic of 8).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Stampede of Iron`,\r\n        desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll 1 dice for each model in this unit. For each 6, that enemy unit suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tarantulos Brood': {\r\n    effects: [\r\n      {\r\n        name: `Broodmaster`,\r\n        desc: `1 in every 13 models in this unit must be a Broodmaster. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Broodmasters can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Spider Swarms`,\r\n        desc: `3 in every 13 models in this unit must be Spider Swarms. Spider Swarms are armed with Venomous Bites instead of Brood Weapons and Envenomed Projectiles.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skittering Ascent`,\r\n        desc: `When this unit makes a move, it can pass across terrain features in the same manner as a model that can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Creeping Summons`,\r\n        desc: `You can return D3 slain Spider Swarms to this unit for each Broodmaster in this unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Splintered Fang': {\r\n    effects: [\r\n      {\r\n        name: `Trueblood`,\r\n        desc: `1 in every 10 models in this unit must be a Trueblood. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Truebloods can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Serpent Caller`,\r\n        desc: `1 in every 10 models in this unit must be a Serpent Caller. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Serpents`,\r\n        desc: `1 in every 10 models in this unit must be a Serpents model. Serpents models have a Wounds characteristic of 2.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `One Cut, One Kill`,\r\n        desc: `If the unmodified hit roll for an attack made by this unit is 6, the attack inflicts 1 mortal wound and the attack seqeunce ends.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Snake Charmer`,\r\n        desc: `You can return 1 slain Serpents model to this unit in your hero phase for each Serpent Caller in the unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Corvus Cabal': {\r\n    effects: [\r\n      {\r\n        name: `Shadow Piercer`,\r\n        desc: `1 in every 9 models in this unit must be a Shadow Piercer. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Shadow Piercers can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shrike Talon`,\r\n        desc: `1 in every 9 models in this unit must be a Shrike Talon. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Death From Above`,\r\n        desc: `This unit is not visible to enemy units while it is in cover. In addition, if this unit attempts a charge while it is wholly on a terrain feature, it can fly when making a charge move in that phase.`,\r\n        when: [DURING_GAME, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Denizens of Ulgu`,\r\n        desc: `Instead of setting up this unit on the battlefield, you can place this unit to one side as a reserve unit. At the end of your movement phase, you can set up this unit anywhere on the battlefield more than 9\" from all enemy units. Any reserve units not set up on the battlefield before the start of the fourth battle round are destroyed.`,\r\n        when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Unmade': {\r\n    effects: [\r\n      {\r\n        name: `Blissful One`,\r\n        desc: `1 in every 9 models in this unit must be a Blissful One. A Blissful One is armed with Nightmare Sickles instead of Maiming Weapons. In addition, Blissful Ones can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Joyous One`,\r\n        desc: `1 in every 9 models in this unit must be a Joyous One. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Frozen in Fear`,\r\n        desc: `Enemy units cannot receive the Rally command while they are within 12\" of this unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Frozen in Fear`,\r\n        desc: `Enemy units cannot receive the Redeploy command while they are within 12\" of this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cypher Lords': {\r\n    effects: [\r\n      {\r\n        name: `Thrallmaster.`,\r\n        desc: `1 in every 8 models in this unit must be a Thrallmaster. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Thrallmasters can issue commands to their own unit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Luminate`,\r\n        desc: `1 in every 8 models in this unit must be a Luminate. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shattered Gloom Globe`,\r\n        desc: `While this unit includes any Thrallmasters, you can pick 1 enemy unit within 3\" of this unit and roll a D6. On a 4+, subtract 1 from hit rolls for that unit until your next hero phase. The same unit cannot be affected by this ability more than once per turn.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Acrobatic Leaps`,\r\n        desc: `When this unit makes a move, it can pass across other models in the same manner as a unit that can fly. In addition, after this unit moves, excluding pile-in moves, you can pick 1 enemy unit it passed across and roll a dice for each model in this unit. For each 6+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scions of the Flame': {\r\n    effects: [\r\n      {\r\n        name: `Blazing Lord`,\r\n        desc: `1 in every 8 models in this unit must be a Blazing Lord. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Blazing Lords can issue commands to their own unit.`,\r\n        when: [COMBAT_PHASE, DURING_GAME],\r\n      },\r\n      {\r\n        name: `IMMOLATOR`,\r\n        desc: `1 in every 8 models in this unit must be an Immolator. At the end of the combat phase, pick 1 enemy unit within 1\" of this unit a roll a dice for each Immolator in this unit. For each 2+, that enemy unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Inferno Priest`,\r\n        desc: `1 in every 8 models in this unit must be an Inferno Priest. An Inferno Priest is armed with Scion Weapons and Engulfing Flames instead of Scion Weapons and Flameburst Pots.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `All Shall Burn`,\r\n        desc: `If an attack made with Flameburst Pots targets an enemy unit that has 10 or more models and scores a hit, that attack scores 3 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spire Tyrants': {\r\n    effects: [\r\n      {\r\n        name: `Pit Champion`,\r\n        desc: `1 in every 9 models in this unit must be a Pit Champion. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Pit Champions can issue commands to their own unit.`,\r\n        when: [COMBAT_PHASE, DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bestigor Destroyer`,\r\n        desc: `1 in every 9 models in this unit must be a Bestigor Destroyer. Add 1 to the Damage characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Headclaimer`,\r\n        desc: `1 in every 9 models in this unit must be a Headclaimer. Add 1 to the Damage characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fight for Glory`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons while they are wholly within 9\" of any friendly MORTAL HERO.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Veterans of the Warpits`,\r\n        desc: `Do not take battleshock tests for this unit while it is within 3\" of any enemy units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Iron Golems': {\r\n    effects: [\r\n      {\r\n        name: `Dominar`,\r\n        desc: `1 in every 8 models in this unit must be a Dominar. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Dominars can issue commands to their own unit.`,\r\n        when: [COMBAT_PHASE, DURING_GAME],\r\n      },\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `1 in every 8 models in this unit must be a Signifer. Add 1 to the Bravery characteristic of a unit that includes a Signifer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Ogor Breacher`,\r\n        desc: `1 in every 8 models in this unit must be an Ogor Breacher. Add 1 to the Damage characteristic of that model's melee weapons. In addition, Ogor Breachers have a Wounds characteristic of 3.`,\r\n        when: [COMBAT_PHASE, WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Iron Resilience`,\r\n        desc: `Add 1 to save rolls for attacks that target this unit if this unit has not made a normal move, run, retrested, or made a charge move in the same turn.`,\r\n        when: [SAVES_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS, rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n    ],\r\n  },\r\n  'Untamed Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Heart-eater`,\r\n        desc: `1 in every 9 models in this unit must be a Heart-eater. Add 1 to the Attacks characteristic of that model's melee weapons. In addition, Heart-eaters can issue commands to their own unit.`,\r\n        when: [COMBAT_PHASE, DURING_GAME],\r\n      },\r\n      {\r\n        name: `First Fang`,\r\n        desc: `1 in every 9 models in this unit must be a First Fang. A First Fang is armed with a Jagged Harpoon and Hunting Weapons.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rocktusk Prowler`,\r\n        desc: `1 in every 9 models in this unit must be a Rocktusk Prowler. Rocktusk Prowlers have a Wounds characteristic of 2.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Rocktusk Prowler`,\r\n        desc: `1 in every 9 models in this unit must be a Rocktusk Prowler. Add 1 to the Damage characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unleash the Beast`,\r\n        desc: `This unit can run and still charge later in the same turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Unleash the Beast`,\r\n        desc: `After armies are set up but before the first battle round begins, this unit can move up to 6\" (it cannot run).`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n  'Darkoath Savagers': {\r\n    effects: [\r\n      {\r\n        name: `Oath of Conquest - Once Per Battle`,\r\n        desc: `Effect: If this unit is contesting an objective you control that is wholly within enemy territory, this unit has Ward (5+) for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Furies: {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Little Devils`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 3+, this unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Raptoryx: {\r\n    effects: [\r\n      {\r\n        name: `Crazed Flock - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Mindstealer Sphiranx': {\r\n    effects: [\r\n      {\r\n        name: `Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fomoroid Crusher': {\r\n    effects: [\r\n      {\r\n        name: `Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Wilderfiend': {\r\n    effects: [\r\n      {\r\n        name: `Feed on Flesh - Passive`,\r\n        desc: `Effect: Each time a model (friendly or enemy) is slain within 12\" of this unit, give this unit a sacrifice point, to a maximum of 6. If there are more than 1 friendly Darkoath Wilderend units within 12\" of the slain model, only 1 of them can be given a sacrifice point for that slain model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Primal Sorcery`,\r\n        desc: `Effect: Pick 1 of the following effects: \r\n        Mind Shroud: Pick an enemy unit within 12\" of this unit to be the target and roll a number of dice equal to the number of sacrifice points this unit has. If any of the rolls are a 5+, the target cannot use commands for the rest of the turn. \r\n        Warping Balefire: Pick an enemy unit within 12\" of this unit to be the target and roll a number of dice equal to the number of sacrifice points this unit has. For each 3+, inflict 1 mortal damage on the target. \r\n        Dark Might: Heal (X) this unit, where X is the number of sacrifice points this unit has. \r\n        After applying the effect you picked, reset this units sacrifice points to 0.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkoath Chieftain on Warsteed': {\r\n    effects: [\r\n      {\r\n        name: `Cavalry Warleader - Passive`,\r\n        desc: `Effect: You can re-roll charge rolls for friendly Darkoath Cavalry units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Oath of Murder - Once Per Battle`,\r\n        desc: `Effect: If this unit destroyed an enemy Hero or Monster this turn, this unit has Strike-first for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Zarshia Bittersoul': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Mask of Darkness'])],\r\n    }, \r\n    effects: [\r\n    //  ...OracularVisionsEffects, GenericEffects.WizardOneSpellEffect\r\n    ],\r\n  },\r\n  \"Khagra's Ravagers\": {\r\n    effects: [\r\n      //ChaosRuneshieldPlatingEffect,\r\n      {\r\n        name: `Fierce Conquerors`,\r\n        desc: `Models in this unit count as 2 models for the purposes of contesting objectives.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: The Coven of Thryx': {\r\n    effects: [\r\n      {\r\n        name: `Magister: Magic-Touched`,\r\n        desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n        Add 1 to this units power level.  \r\n        If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pink Horrors: Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tome of Eyes: Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      }, \r\n      {\r\n        name: `Burning SIgil of Tzeentch: Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sparks of Profane Potential - Once Per Battle`,\r\n        desc: `Effect: If the Magister in the Regiment of Renown has been deployed, set up one of the following Manifestations within 1\" of them:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Skilled Summoner: Casting value of 6`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick 1 of the Manifestations from the list below that is not on the battlefield, then make a casting roll of 2D6:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum \r\n        Effect: If there is already a friendly Manifestation from the list above on the battlefield, it is immediately banished. Then, set up the Manifestation you picked within 1\" of the caster and visible to them. If that Manifestation is a Daemonic Simulacrum, it must also be set up more than 9\" away from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flickering Wyrdflame - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points inflicted on it this turn by Wyrdflame Spell abilities or attacks made with weapons that have the Wyrdflame weapon ability to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport battle_traits from './battle_traits'\r\nimport command_abilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Prayers from './prayers'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { SLAVES_TO_DARKNESS } from 'meta/factions'\r\n\r\n/*const baseSubFaction = {\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [command_abilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    prayers: [Prayers],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n  effects: [],\r\n} satisfies IItemDescription */\r\n\r\nconst subFactions = {\r\n  [SLAVES_TO_DARKNESS]: {\r\n   // ...baseSubFaction,\r\n    effects: pickEffects(battle_traits, [SLAVES_TO_DARKNESS]),\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [command_abilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n      prayers: [Prayers],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  \r\n//    effects: [],\r\n  } satisfies IItemDescription\r\n  }\r\n\r\nexport default subFactions\r\n/*  Ravagers: {\r\n    effects: pickEffects(battle_traits, ['Ravagers']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  },\r\n  Cabalists: {\r\n    effects: pickEffects(battle_traits, ['Cabalists']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  },\r\n  Despoilers: {\r\n    effects: pickEffects(battle_traits, ['Despoilers']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  },\r\n  'Host of the Everchosen': {\r\n    effects: pickEffects(battle_traits, ['Host of the Everchosen']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  },\r\n  'The Knights of the Empty Throne': {\r\n    effects: pickEffects(battle_traits, ['The Knights of the Empty Throne']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  },\r\n  'Legions of the First Prince': {\r\n    effects: pickEffects(battle_traits, ['Legions of the First Prince']),\r\n    available: {\r\n      ...baseSubFaction.available,\r\n    },\r\n  }, */\r\n\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { SLAVES_TO_DARKNESS } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SlavesToDarknessFaction = new Faction(\r\n  SLAVES_TO_DARKNESS,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_SLAVES_TO_DARKNESS,\r\n // pickEffects(battle_traits, ['Ensorcelled Banners: Icons of Chaos', 'Vows of Darkness'])\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_KHARADRON_OVERLORDS: {\r\n    name: 'Battletome: Kharadron Overlords',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JANUARY_2021: {\r\n    name: 'Errata (January 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/oyysZxiLF19anAc7.pdf',\r\n  },\r\n  ERRATA_JULY_2021: {\r\n    name: 'Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/T6LNSIDslUOTB0Ho.pdf',\r\n  },\r\n  ERRATA_AUGUST_2021: {\r\n    name: 'Errata (August 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/mnIpUNP536ZDzhzq.pdf',\r\n  },\r\n  WHITE_DWARF_MAY_2022: {\r\n    name: 'White Dwarf (May 2022)',\r\n    type: 'white_dwarf',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/yZSgwuU45O72wNtB.pdf',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/L1l9ZHIAyq7tBRbT.pdf',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/06/X56aKSIwkch6qyi9.pdf',\r\n  },\r\n  ERRATA_MARCH_2023: {\r\n    name: 'Errata (March 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/03/ww7V9OeWxIUgjNtI.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  START_OF_SETUP,\r\n  WARDS_PHASE,\r\n  COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n /* 'Masterwrought Armour': {\r\n    effects: [\r\n      {\r\n        name: `Masterwrought Armour`,\r\n        desc: `The bearer has a ward of 5+`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Celestium Burst-grenade': {\r\n    effects: [\r\n      {\r\n        name: `Celestium Burst-grenade - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit within 12\" of this unit to be the target. \r\n        Effect: Ward rolls cannot be made for the target for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Blazebeard and Sons 'Drakk-hobbler' Mag-bolas\": {\r\n    effects: [\r\n      {\r\n        name: `Blazebeard and Sons 'Drakk-hobbler' Mag-bolas - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Monster within 12\" of this unit to be the target. \r\n        Effect: Until the start of your next turn, subtract 1 from the number of dice rolled when making charge rolls for the target, to a minimum of 1.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Spell in a Bottle': {\r\n    effects: [\r\n      {\r\n        name: `Spell in a Bottle`,\r\n        desc: `Pick 1 endless spell that does not belong to a faction. You can include that endless spell in your army without spending any points to do so.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Spell in a Bottle`,\r\n        desc: `Once per battle, bearer can automatically cast the spell that summons the endless spell (do not make a casting roll), and it cannot be unbound. Bearer cannot control the endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Phosphorite Bomblets': {\r\n    effects: [\r\n      {\r\n        name: `Phosphorite Bomblets`,\r\n        desc: `Once per battle, you can pick 1 enemy unit within 6\". Ona D6 2+, the unit suffers 1 MW and you may roll again. Repeat until you roll a 1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Voidstone Orb': {\r\n    effects: [\r\n      {\r\n        name: `Voidstone Orb - Once Per Battle - Reaction: Opponent declared a Spell ability for a Wizard within 30\" of this unit`,\r\n        desc: `Effect: That spell is unbound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Grundstok Expeditionary Force\r\n /* 'Aetheric Nullifier': {\r\n    effects: [\r\n      {\r\n        name: `Aetheric Nullifier`,\r\n        desc: `Each time a friendly GRUNDSTOK EXPEDITIONARY FORCE unit wholly within 12\" of the bearer is affected by a spell or the abilities of an endless spell, you can roll a dice. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  \"'Gimlet Gaze' Scope\": {\r\n    effects: [\r\n      {\r\n        name: `'Gimlet Gaze' Scope`,\r\n        desc: `Add 9\" to the Range characteristic of missile weapons used by the bearer.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Grudgefire Rounds': {\r\n    effects: [\r\n      {\r\n        name: `Grudgefire Rounds`,\r\n        desc: `Pick 1 of the bearer's missile weapons. If the unmodified hit roll for an attack made with that weapon is 6, that attack causes a number of mortal wounds to the target equal to its Damage characteristic and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  ExpertBattalionEffect,\r\n  SlayersBattalionEffect,\r\n  SwiftBattalionEffect,\r\n} from 'generic_rules/core_battalions'\r\n\r\nconst KharadronOverlordsBattalions = {\r\n /* 'Attack Squadron': {\r\n    effects: [ExpertBattalionEffect, SwiftBattalionEffect],\r\n  },\r\n  'Escort Wing': {\r\n    effects: [SlayersBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(KharadronOverlordsBattalions, 'battalion')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  START_OF_HERO_PHASE,\r\n  TURN_FIVE_START_OF_HERO_PHASE,\r\n  TURN_FOUR_START_OF_HERO_PHASE,\r\n  TURN_THREE_START_OF_HERO_PHASE,\r\n  TURN_TWO_START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Blow Them Away': {\r\n    effects: [\r\n      {\r\n        name: `Blow Them Away`,\r\n        desc: `You complete this battle tactic if an enemy unit was destroyed during this turn by an attack made using the Grudgesettler Protocols battle trait.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'No Safe Haven': {\r\n    effects: [\r\n      {\r\n        name: `No Safe Haven`,\r\n        desc: `Pick 1 objective on the battlefield that is controlled by your opponent. You complete this battle tactic if, at the end of this turn, you control that objective and a friendly unit that was set up this turn with the Rapid Redeployment battle trait is contesting that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Thunderous Claim': {\r\n    effects: [\r\n      {\r\n        name: `Thunderous Claim`,\r\n        desc: `Pick 1 objective on the battlefield that you do not control. You complete this battle tactic if, at the end of this turn, you control that objective and that objective is contested by 2 different friendly GRUNDSTOK THUNDERERS units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Bombing Run': {\r\n    effects: [\r\n      {\r\n        name: `Bombing Run`,\r\n        desc: `Pick 1 enemy unit. You complete this battle tactic if that unit is destroyed during this turn by the Bomb Racks ability of a friendly unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mobilise the Fleet': {\r\n    effects: [\r\n      {\r\n        name: `Mobilise the Fleet`,\r\n        desc: `You cannot pick this battle tactic in the first battle round. Pick 3 friendly units that are not embarked in SKYVESSELS. You complete this battle tactic at the end of the turn if those units are all embarked in SKYVESSELS.`,\r\n        when: [\r\n          TURN_TWO_START_OF_HERO_PHASE,\r\n          TURN_THREE_START_OF_HERO_PHASE,\r\n          TURN_FOUR_START_OF_HERO_PHASE,\r\n          TURN_FIVE_START_OF_HERO_PHASE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'Boots on the Ground': {\r\n    effects: [\r\n      {\r\n        name: `Boots on the Ground`,\r\n        desc: `Pick 3 friendly units embarked in SKYVESSELS. You complete this battle tactic at the end of the turn if those units are not embarked and are wholly within enemy territory.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Opening Salvo': {\r\n    effects: [\r\n      {\r\n        name: `Opening Salvo`,\r\n        desc: `You can only pick this battle tactic if no units have been destroyed in the battle. You complete this battle tactic if an enemy unit is destroyed in your shooting phase this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Blast 'em to Smithereens\": {\r\n    effects: [\r\n      {\r\n        name: `Blast 'em to Smithereens`,\r\n        desc: `Pick 1 objective on the battlefield within 12\" of any enemy units. You complete this battle tactic if there are no enemy units within 12\" of that objective at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stake a Claim': {\r\n    effects: [\r\n      {\r\n        name: `Stake a Claim`,\r\n        desc: `You can pick this tactic only if you control fewer objectives than your opponent. You complete this battle tactic if you control more objectives than your opponent at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { KHARADRON_OVERLORDS } from 'meta/factions'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { DURING_ANY_PHASE, DURING_GAME, DURING_SETUP, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [KHARADRON_OVERLORDS]: {\r\n    effects: [\r\n      {\r\n        name: `Flying High - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Skyvessel that is part of a regiment from which no units have been deployed, then pick a number of units up to its Transport Capacity (see its warscroll) that are in its regiment. \r\n        Effect: Set up all of those units in reserve in the clouds. They have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n      {\r\n        name: `Descend from the Clouds`,\r\n        desc: `Declare: Pick a friendly Skyvessel in the clouds to use this ability. \r\n        Effect: Set up that Skyvessel anywhere on the battlefield more than 9\" from all enemy units. Then, set up all other units that were set up in the clouds with that Skyvessel wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n      {\r\n        name: `Transport Skyfarers - Reaction: You declared a non-Charge Move ability for a friendly Skyvessel`,\r\n        desc: `Used By: The Skyvessel using that Move ability. \r\n        Effect: Pick a number of units up to that Skyvessels Transport Capacity (see its warscroll) that are wholly within 6\" of it to be the targets. Units that have been transported this turn cannot be targets. \r\n        Remove the targets from the battlefield. After the Skyvessel ends its move, you must set up each target unit on the battlefield, wholly within 6\" of that Skyvessel and not in combat. Those units have been transported. A unit cannot use Charge abilities if it was transported in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n      {\r\n        name: `Skyvessel Cover - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target friendly Kharadron Overlords Infantry units while they are wholly within 6\" of a friendly Arkanaut Ironclad or Arkanaut Frigate.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n /* 'Grundstok Expeditionary Force': {\r\n    effects: [\r\n      {\r\n        name: `Only The Best`,\r\n        desc: `Friendly GRUNDSTOK EXPEDITIONARY FORCE units that do not have the Leader battlefield role gain the Battleline battlefield role.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n      {\r\n        name: `Grudgesettler Protocols`,\r\n        desc: `In any phase, after a friendly Grundstok Expeditionary Force unit has shot or fought for the first time in that phase, you can roll a dice. On a 4+, that unit immediately shoots or fights for a second time in that phase. However, you must subtract 1 from hit rolls for attacks made in this way.\r\n\r\n        Designer's Note: This ability can be used in your opponent's turn after a Grundstok Expeditionary Force unit shoots with the Unleash Hell command. The second time it shoots, those attacks are part of that Unleash Hell command and must target the same enemy unit. `,\r\n        when: [DURING_ANY_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n      {\r\n        name: `Rapid Redeployment`,\r\n        desc: `Each time a friendly Grundstok Gunhauler makes a normal move or runs, you can say that it will transport a friendly unit. If you do so, before the move is made, you can pick up to 2 other friendly Grundstok Expeditionary Force units with a combined model count of 6 or less. Each unit must have a Wounds characteristic of 6 or less and must be within 3\" of the Grundstok Gunhauler and more than 3\" from all enemy units (you can pick a unit that has already moved in that phase). Remove that unit from the battlefield. Then, when the Grundstok Gunhauler finishes its move, set up the transported unit on the battlefield again, wholly within 3\" of the Grundstok Gunhauler and more than 3\" from all enemy units. Units transported in this manner cannot make a charge move in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2,\r\n          meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2,\r\n        ],\r\n      },\r\n    ],\r\n  },*/\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  END_OF_MOVEMENT_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* 'Combat Landing': {\r\n    effects: [\r\n      {\r\n        name: `Combat Landing`,\r\n        desc: `You can use this command ability at the end of your movement phase. The unit that receives the command must be a friendly TRANSPORT VESSEL. Any units embarked in that TRANSPORT VESSEL can immediately disembark. A unit that disembarks in this way cannot move in the same turn.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fly High': {\r\n    effects: [\r\n      {\r\n        name: `Fly High`,\r\n        desc: `You can use this command ability at the end of your movement phase. The unit that receives the command must be a friendly SKYVESSEL more than 3\" from all enemy units. Remove that unit from the battlefield and set it up anywhere on the battlefield more than 9\" from all enemy units and more than 1\" from all terrain features.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Disengage: {\r\n    effects: [\r\n      {\r\n        name: `Disengage`,\r\n        desc: `You can use this command ability in your movement phase. The unit that receives the command must be a friendly SKYVESSEL that has not yet moved in that phase. That unit and any units embarked in it can retreat and still shoot later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Command the Skies': {\r\n    effects: [\r\n      {\r\n        name: `Command the Skies`,\r\n        desc: `You can use this command ability at the start of your movement phase. The unit that receives the command must be a friendly SKYVESSEL more than 3\" from all enemy units. That unit can reroll run rolls this phase. In addition, that unit can run and still shoot and/or charge later in the turn.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bring Every Gun to Bear': {\r\n    effects: [\r\n      {\r\n        name: `Bring Every Gun to Bear`,\r\n        desc: `You can use this command ability at the start of your shooting phase. The unit that receieves the command must be a friendly SKYVESSEL that is more than 3\" from all enemy units, that remained stationery in the preceding movement phase and that did not receive the Fly High command in the preceding movement phase. Add 1 to the Attacks characteristic of that unit's missile weapons until the end of the phase.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Command the Fleet': {\r\n    effects: [\r\n      {\r\n        name: `Command the Fleet`,\r\n        desc: `You can use this command ability at the start of your movement phase. Up to 3 friendly SKYVESSELS that are more than 3\" from all enemy units can receive the command. In that phase you can reroll run rolls for the units that receive the command. In addition, the units that receive the command can run and still shoot and/or charge later in the turn.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  DURING_SETUP,\r\n} from 'types/phases'\r\n\r\nconst AllegianceCommandTraits = {\r\n /* 'ARTYCLE: Honour is Everything': {\r\n    effects: [\r\n      {\r\n        name: `ARTYCLE: Honour is Everything`,\r\n        desc: `When a friendly KHARADRON OVERLORDS unit receives the Rally command, you can return 1 slain model to the unit for each 4+ instead of each 6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ARTYCLE: Master the Skies': {\r\n    effects: [\r\n      {\r\n        name: `ARTYCLE: Master the Skies`,\r\n        desc: `Add 2\" to the Move characteristic of friendly SKYVESSELS.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ARTYCLE: Settle the Grudges': {\r\n    effects: [\r\n      {\r\n        name: `ARTYCLE: Settle the Grudges`,\r\n        desc: `After deployment but before the first battle round begins, pick 1 enemy unit, add 1 to wound rolls for attacks made by friendly KHARADRON OVERLORDS units that target that unit.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'AMENDMENT: Always Take What You Are Owed': {\r\n    effects: [\r\n      {\r\n        name: `AMENDMENT: Always Take What You Are Owed`,\r\n        desc: `At the start of your hero phase, pick 1 friendly ARKANAUT COMPANY unit. Until the start of your next hero phase, each model in that unit counts as 2 models instead of 1 for the purposes of contesting objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'AMENDMENT: Prosecute Wars With All Haste': {\r\n    effects: [\r\n      {\r\n        name: `AMENDMENT: Prosecute Wars With All Haste`,\r\n        desc: `Once per turn in your movement phase, when you make a run roll for a KHARADRON OVERLORDS unit, you can roll 2D6 instead of a single dice.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'AMENDMENT: Trust to Your Guns': {\r\n    effects: [\r\n      {\r\n        name: `AMENDMENT: Trust to Your Guns`,\r\n        desc: `Once per turn in your shooting phase, you can reroll 1 hit roll of 1 for an attack made by a friendly KHARADRON OVERLORDS unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"FOOTNOTE: There's No Reward Without Risk\": {\r\n    effects: [\r\n      {\r\n        name: `FOOTNOTE: There's No Reward Without Risk`,\r\n        desc: `Once per battle, in your charge phase, you can attempt a charge with 1 friendly KHARADRON OVERLORDS unit within 18\" of an enemy unit. If you do so, roll 3D6 for the charge roll instead of 2D6.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"FOOTNOTE: There's No Trading With Some People\": {\r\n    effects: [\r\n      {\r\n        name: `FOOTNOTE: There's No Trading With Some People`,\r\n        desc: `One per battle, at the end of the enemy shooting phase, pick 1 friendly SKYFARERS unit that was targeted by any shooting attacks in that phase. That unit can immediately shoot.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'FOOTNOTE: Without Our Ships, We Are Naught': {\r\n    effects: [\r\n      {\r\n        name: `FOOTNOTE: Without Our Ships, We Are Naught`,\r\n        desc: `Once per battle, at the start of any phase, pick 1 friendly SKYVESSEL. That unit can receive up to 2 commands in that phase instead of only 1.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nconst CommandTraits = {\r\n /* Grudgebearer: {\r\n    effects: [\r\n      {\r\n        name: `Grudgebearer`,\r\n        desc: `After deployment but before the start of the first battle round, pick 1 enemy HERO. Double the damage inflicted by each successful attack made with this general's weapons that target that HERO.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n  'Cunning Fleetmaster': {\r\n    effects: [\r\n      {\r\n        name: `Cunning Fleetmaster - Passive`,\r\n        desc: `Effect: Each time a friendly Skyvessel wholly within 12\" of this unit uses the Redeploy command, roll 2 dice and use the highest result when determining the distance that unit can move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Endrinmaestro': {\r\n    effects: [\r\n      {\r\n        name: `Endrinmaestro - Passive`,\r\n        desc: `Effect: Add 2\" to the Range characteristic of ranged weapons used by friendly Kharadron Overlords Infantry units while they are wholly within 12\" of this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grudgebearer': {\r\n    effects: [\r\n      {\r\n        name: `Grudgebearer`,\r\n        desc: `Declare: Pick an enemy unit to be the target. \r\n        Effect: Double the Damage characteristic of this units weapons for attacks that target that enemy unit for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n /* 'Ex-Grundstok': {\r\n    effects: [\r\n      {\r\n        name: `Ex-Grundstok`,\r\n        desc: `Friendly GRUNDSTOK units have the Battleline battlefield role. In addition, once per turn, this general can issue a command to a friendly GRUNDSTOK unit without a command point being spent.`,\r\n        when: [START_OF_SETUP, DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Stormcaller: {\r\n    effects: [\r\n      {\r\n        name: `Stormcaller`,\r\n        desc: `While this general is on the battlefield, you can reroll any of the dice rolled when a friendly AETHERIC NAVIGATOR reads the winds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  // Grundstok Expeditionary Force\r\n /* 'Back On Your Feet!': {\r\n    effects: [\r\n      {\r\n        name: `Back On Your Feet!`,\r\n        desc: `When a friendly GRUNDSTOK EXPEDITIONARY FORCE unit receives the Rally command (core rules, 7.2), you can return 1 slain model to the unit for each 4+ instead of each 6.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Entrenchment Expert': {\r\n    effects: [\r\n      {\r\n        name: `Entrenchment Expert`,\r\n        desc: `When this general issues the All-out Defence command to a friendly GRUNDSTOK EXPEDITIONARY FORCE unit, until the end of the phase, that unit has a ward of 5+.\r\n        \r\n        Designer's Note: This effect is in addition to the normal effect of All-out Defence.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Grundcorps Technician': {\r\n    effects: [\r\n      {\r\n        name: `Grundcorps Technician`,\r\n        desc: `Once per battle, at the end of your hero phase, if a friendly GRUNDSTOK GUNHAULER has been destroyed, you can roll a dice and add the number of the current battle round to the roll. On a 6+, you can set up that GRUNDSTOK GUNHAULER again on the battlefield more than 9\" from all enemy units and with 5 wounds allocated to it.`,\r\n        when: [END_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs({ ...AllegianceCommandTraits, ...CommandTraits }, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { COMBAT_PHASE, DURING_GAME, DURING_SETUP, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, START_OF_HERO_PHASE, START_OF_SETUP } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Iron Sky Attack Squadron': {\r\n    effects: [\r\n      {\r\n        name: `Meticulously Maintained - Passive`,\r\n        desc: `Effect: Ignore the first damage point that would be allocated to each friendly Skyvessel in each phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Aether-Runners': {\r\n    effects: [\r\n      {\r\n        name: `Fastest Vessels in the Fleet - Passive`,\r\n        desc: `Effect: Add 2\" to the Move characteristic of all friendly Skyvessels.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Endrineers Guild Expeditionary Force': {\r\n    effects: [\r\n      {\r\n        name: `Special Procurement - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Unique Kharadron Overlords Hero that does not have an artefact of power. \r\n        Effect: Give that Hero 1 artefact of power from the Inventions of the Sky-ports.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Grundcorps Wing': {\r\n    effects: [\r\n      {\r\n        name: `Grudgesettler Protocols - Once Per Battle`,\r\n        desc: `Effect: Add 3\" to the Range characteristic of ranged weapons used by friendly Grundstok Thunderers and Grundstok Gunhaulers units for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Barak-Thryng, City of the Ancestors (Skyport)': {\r\n    effects: [\r\n      {\r\n        name: `Honour the Gods, Just in Case`,\r\n        desc: `Allied DUARDIN PRIESTS know the prayer \"Rune of Ancestral Guidance\" in addition to any others they know.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Rune of Ancestral Guidance`,\r\n        desc: `Answer value of 3 and a range of 16\". If answered, pick 1 friendly ARKANAUT COMPANY or GRUNDSTOK THUNDERERS unit wholly within range. Until the start of your next hero phase, unmodified hit rolls of 6 for attacks made with missile weapons by that unit cause a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Barak-Nar, City of the First Sunrise (Skyport)': {\r\n    effects: [\r\n      {\r\n        name: `Scholars and Commanders`,\r\n        desc: `At the start of your hero phase, roll a dice for each friendly BARAK-NAR HERO on the battlefield (including any that are embarked). For each 4+, you receive 1 extra command point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n  /*'Rule the Skies': {\r\n    effects: [\r\n      {\r\n        name: `Rule the Skies`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 1 or more friendly SKYVESSELS on the battlefield and there are no enemy Behemoths that can fly on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Defend the Flagship': {\r\n    effects: [\r\n      {\r\n        name: `Defend the Flagship`,\r\n        desc: `You can pick this grand strategy only if the model picked to be your general is an ARKANAUT ADMIRAL. When the battle ends, you complete this grand strategy if that general has not been slain and the SKYVESSEL picked to be their flagship has not been destroyed.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Prospector Fleet': {\r\n    effects: [\r\n      {\r\n        name: `Prospector Fleet`,\r\n        desc: `After deployment, your opponent must pick 1 terrain feature to hold a bounty of mineral wealth. When the battle ends, you complete this grand strategy if you control that terrain feature.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Guided by the Code': {\r\n    effects: [\r\n      {\r\n        name: `Guided by the Code`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed this battle was a Kharadron Overlords specific battle tactic.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Acceptable Profit Margin': {\r\n    effects: [\r\n      {\r\n        name: `Acceptable Profit Margin`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is at least 1 friendly GRUNDSTOK THUNDERERS unit and at least 1 friendly GRUNDSTOK GUNHAULER on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { pickEffects } from '../metatagger'\r\nimport { KHARADRON_OVERLORDS } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MountTraits from './mount_traits'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/* const baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    mount_traits: [MountTraits],\r\n    units: [Units],\r\n  }, \r\n} satisfies IItemDescription */\r\n\r\nconst subFactions = {\r\n  [KHARADRON_OVERLORDS]: {\r\n  //  ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [KHARADRON_OVERLORDS]),\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      //endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n      //prayers: [Prayers],\r\n      //spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  }, \r\n/* 'Grundstok Expeditionary Force': {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, ['Grundstok Expeditionary Force']),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { KHARADRON_OVERLORDS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const KharadronOverlordsFaction = new Faction(\r\n  KHARADRON_OVERLORDS,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_KHARADRON_OVERLORDS\r\n)\r\n","import ReactGA from 'react-ga4'\r\nimport { TImportParsers, TLoadedArmy } from 'types/import'\r\nimport { TSavePdfType } from 'types/pdf'\r\nimport { TSelections } from 'types/selections'\r\nimport { isValidFactionName } from 'utils/armyUtils'\r\nimport { isDev, isProd, isTest } from 'utils/env'\r\nimport { GiftedSubscriptionPlans, SubscriptionPlans } from 'utils/plans'\r\nimport { generateUUID, titleCase } from 'utils/textUtils'\r\n\r\nif (!isTest) {\r\n  ReactGA.initialize('G-EM4GX294XG', {\r\n    // titleCase: false,\r\n    gaOptions: { siteSpeedSampleRate: 100 },\r\n  })\r\n  // if (isProd) ReactGA.plugin.require('ecommerce')\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event\r\n */\r\nexport const logPageView = () => {\r\n  if (isProd) {\r\n    ReactGA.send({ hitType: 'pageview', page: window.location.pathname + window.location.search })\r\n    // ReactGA.pageview(window.location.pathname + window.location.search)\r\n  }\r\n}\r\n\r\n/**\r\n * Generic wrapper for logging events\r\n * Will print to console in dev, will actually log in prod\r\n */\r\nconst logToGA = (event: { category: string; action: string; label: string }) => {\r\n  if (isDev) {\r\n    console.log(`GA Event: `, event)\r\n  } else if (isProd) {\r\n    ReactGA.event(event)\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event indicating a pdf download\r\n * @param factionName\r\n */\r\nexport const logDownloadEvent = (factionName: string | null, layout: TSavePdfType) => {\r\n  if (isValidFactionName(factionName)) {\r\n    logToGA({\r\n      category: 'Button',\r\n      action: `Download-${factionName}`,\r\n      label: `DownloadPDF-${layout}`,\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event telling us which faction the user has selected\r\n * @param factionName\r\n */\r\nexport const logFactionSwitch = (factionName: string | null) => {\r\n  if (isValidFactionName(factionName)) {\r\n    logToGA({\r\n      category: 'Select',\r\n      action: `Select-${factionName}`,\r\n      label: factionName,\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event telling us which subfaction the user has selected\r\n * @param subFaction\r\n */\r\nexport const logSubFactionSwitch = (subFaction = '') => {\r\n  if (!subFaction) return\r\n  logToGA({\r\n    category: 'Select',\r\n    action: `Select-SubFaction-${subFaction}`,\r\n    label: subFaction,\r\n  })\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event telling us which allied faction the user has selected\r\n * @param factionName\r\n */\r\nexport const logAllyFaction = (factionName: string | null) => {\r\n  if (isValidFactionName(factionName)) {\r\n    logToGA({\r\n      category: 'Select',\r\n      action: `Select-Ally-${factionName}`,\r\n      label: factionName,\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event telling us about a click event\r\n * @param label\r\n */\r\nexport const logClick = (label: string) => {\r\n  if (label) {\r\n    logToGA({\r\n      category: 'Click',\r\n      action: `Click-${label}`,\r\n      label: 'AoS Reminders',\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event\r\n * @param event\r\n */\r\nexport const logEvent = (event: string) => {\r\n  if (event) {\r\n    logToGA({\r\n      category: 'Event',\r\n      action: `Event-${event}`,\r\n      label: 'AoS Reminders',\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * This variable stores individual selections that we've already seen\r\n * To prevent logging duplicate selections\r\n */\r\nlet selectionStore: string[] = []\r\n\r\n/**\r\n * Utility to reset the selectionStore\r\n */\r\nexport const resetAnalyticsStore = () => {\r\n  selectionStore = []\r\n}\r\n\r\n/**\r\n * Used for logging individual units, traits, abilities, etc\r\n * @param trait\r\n * @param name\r\n */\r\nexport const logIndividualSelection = (trait: string, name: string, label: string) => {\r\n  if (!name || !trait) return\r\n\r\n  const lookup = `${trait}-${name}-${label}`\r\n\r\n  if (selectionStore.includes(lookup)) return\r\n  selectionStore.push(lookup)\r\n\r\n  logToGA({\r\n    category: `Individual-Selection`,\r\n    action: `${trait}-${name}`,\r\n    label,\r\n  })\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event\r\n * @param value\r\n */\r\nexport const logFailedImport = (value: string, type: TImportParsers) => {\r\n  if (value) {\r\n    logToGA({\r\n      category: 'Event',\r\n      action: `failedImport-${type}-${value}`,\r\n      label: 'FailedImport',\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Sends a Google Analytics event telling us which faction the user has attempted to load\r\n * @param factionName\r\n */\r\nexport const logInvalidFactionLookup = (factionName: string | null) => {\r\n  if (factionName) {\r\n    logToGA({\r\n      category: 'Event',\r\n      action: `InvalidFactionLookup-${factionName}`,\r\n      label: factionName,\r\n    })\r\n  }\r\n}\r\n\r\nexport const logDeprecatedImport = (value: string, type: TImportParsers) => {\r\n  if (value) {\r\n    logToGA({\r\n      category: 'Event',\r\n      action: `deprecatedImport-${type}-${value}`,\r\n      label: 'DeprecatedImport',\r\n    })\r\n  }\r\n}\r\n\r\nexport const logIgnoredImport = (value: string, type: TImportParsers) => {\r\n  if (value) {\r\n    logToGA({\r\n      category: 'Event',\r\n      action: `IgnoredImport-${type}-${value}`,\r\n      label: 'IgnoredImport',\r\n    })\r\n  }\r\n}\r\n\r\nexport const logDisplay = (element: string) => {\r\n  if (element) {\r\n    logToGA({\r\n      category: 'Display',\r\n      action: `Display-${element}`,\r\n      label: 'Display',\r\n    })\r\n  }\r\n}\r\n\r\nexport const logNote = (action: string, factionName: string) => {\r\n  logToGA({\r\n    category: 'Note',\r\n    action: `${action}-Note-${factionName}`,\r\n    label: factionName,\r\n  })\r\n}\r\n\r\nexport const logMigration = (version: number) => {\r\n  logToGA({\r\n    category: 'Migration',\r\n    action: `Migrate-to-v${version}`,\r\n    label: `Migrate-to-v${version}`,\r\n  })\r\n}\r\n\r\nexport const logSubscription = (planTitle: string, provider: 'stripe' | 'paypal') => {\r\n  const plan = SubscriptionPlans.find(x => x.title === planTitle)\r\n  if (!isProd || !plan) return\r\n  try {\r\n    const transaction_id = generateUUID()\r\n\r\n    // https://github.com/codler/react-ga4/issues/11\r\n\r\n    // ReactGA.gtag('event', 'addItem', {\r\n    //   transaction_id,\r\n    //   name: plan.title,\r\n    //   sku: provider === 'paypal' ? plan.paypal_prod : plan.stripe_prod,\r\n    //   price: plan.cost,\r\n    //   category: 'Subscription',\r\n    //   quantity: '1',\r\n    // })\r\n\r\n    ReactGA.gtag('event', 'purchase', {\r\n      transaction_id,\r\n      value: plan.cost,\r\n      items: [\r\n        {\r\n          transaction_id,\r\n          name: plan.title,\r\n          sku: provider === 'paypal' ? plan.paypal_prod : plan.stripe_prod,\r\n          price: plan.cost,\r\n          category: 'Subscription',\r\n          quantity: '1',\r\n        },\r\n      ],\r\n    })\r\n\r\n    // ReactGA.gtag('event', 'send', 'ga')\r\n    // ReactGA.gtag('event', 'clear', 'ga')\r\n  } catch (err) {}\r\n}\r\n\r\nexport const logGiftedSubscription = (planTitle: string, quantity: string) => {\r\n  const plan = GiftedSubscriptionPlans.find(x => x.title === planTitle)\r\n  if (!isProd || !plan) return\r\n  try {\r\n    const transaction_id = generateUUID()\r\n    const value = (parseFloat(plan.cost) * parseInt(quantity)).toFixed(2)\r\n\r\n    // https://github.com/codler/react-ga4/issues/11\r\n    // ReactGA.gtag('event', 'addItem', {\r\n    //   transaction_id,\r\n    //   name: plan.title,\r\n    //   sku: plan.stripe_prod,\r\n    //   price: plan.cost,\r\n    //   category: 'Gifted-Subscription',\r\n    //   quantity,\r\n    // })\r\n    ReactGA.gtag('event', 'purchase', {\r\n      transaction_id,\r\n      value,\r\n      items: [\r\n        {\r\n          transaction_id,\r\n          name: plan.title,\r\n          sku: plan.stripe_prod,\r\n          price: plan.cost,\r\n          category: 'Gifted-Subscription',\r\n          quantity,\r\n        },\r\n      ],\r\n    })\r\n\r\n    // ReactGA.gtag('event', 'send', 'ga')\r\n    // ReactGA.gtag('event', 'clear', 'ga')\r\n  } catch (err) {}\r\n}\r\n\r\n/**\r\n * Logs all the pertinent details of a loaded army to Google Analytics\r\n * @param army\r\n */\r\nexport const logLoadedArmy = (army: TLoadedArmy) => {\r\n  try {\r\n    const {\r\n      selections = [] as unknown as TSelections,\r\n      allySelections = {},\r\n      origin_realm = null,\r\n      realmscape = null,\r\n      realmscape_feature = null,\r\n      factionName,\r\n    } = army\r\n\r\n    // Log the faction name\r\n    logFactionSwitch(factionName)\r\n\r\n    // Log each selection\r\n    Object.keys(selections).forEach(key => {\r\n      const trait = titleCase(key)\r\n      const _selections = selections[key as keyof typeof selections] || []\r\n      _selections.forEach((name: string) => logIndividualSelection(trait, name, factionName))\r\n    })\r\n\r\n    // Log each allied faction + selection\r\n    Object.keys(allySelections).forEach(allyFactionName => {\r\n      logAllyFaction(allyFactionName)\r\n      const _units = allySelections[allyFactionName as keyof typeof allySelections]?.units || []\r\n      _units.forEach(name => logIndividualSelection('AlliedUnits', name, allyFactionName))\r\n    })\r\n\r\n    // Log Realm information\r\n    if (origin_realm) logIndividualSelection('Realm of Origin', origin_realm, factionName)\r\n    if (realmscape) logIndividualSelection('Realm of Battle', realmscape, factionName)\r\n    if (realmscape_feature) logIndividualSelection('Realm Feature', realmscape_feature, factionName)\r\n  } catch (err) {\r\n    console.error(err)\r\n  }\r\n}\r\n","import { IItemDescription } from 'factions/factionTypes'\r\nimport { TRuleSource } from 'meta/rule_sources'\r\nimport { TCollection } from 'types/army'\r\nimport { TTurnWhen } from 'types/phases'\r\nimport { TSelectionTypes } from 'types/selections'\r\n\r\nexport type TEntryProperties =\r\n  | 'artifact'\r\n  | 'battalion'\r\n  | 'battle_trait'\r\n  | 'battle_tactic'\r\n  | 'command_ability'\r\n  | 'command_trait'\r\n  | 'core_rule'\r\n  | 'endless_spell'\r\n  | 'grand_strategy'\r\n  | 'incarnate'\r\n  | 'monstrous_rampage'\r\n  | 'mount_trait'\r\n  | 'prayer'\r\n  | 'scenery'\r\n  | 'spell'\r\n  | 'triumph'\r\n  | 'unit'\r\n  | 'manifestations'\r\n\r\nexport const ENTRY_PROPERTIES: TEntryProperties[] = [\r\n  'artifact',\r\n  'battalion',\r\n  'battle_trait',\r\n  'battle_tactic',\r\n  'command_ability',\r\n  'command_trait',\r\n  'core_rule',\r\n  'endless_spell',\r\n  'grand_strategy',\r\n  'incarnate',\r\n  'monstrous_rampage',\r\n  'mount_trait',\r\n  'prayer',\r\n  'scenery',\r\n  'spell',\r\n  'triumph',\r\n  'unit',\r\n  'manifestations',\r\n]\r\n\r\nexport const SELECTION_TYPES: TSelectionTypes[] = [\r\n  'artifacts',\r\n  'battalions',\r\n  'battle_tactics',\r\n  'command_abilities',\r\n  'command_traits',\r\n  'core_rules',\r\n  'endless_spells',\r\n  'flavors',\r\n  'grand_strategies',\r\n  'incarnates',\r\n  'monstrous_rampages',\r\n  'mount_traits',\r\n  'prayers',\r\n  'scenery',\r\n  'spells',\r\n  'triumphs',\r\n  'units',\r\n  'manifestations',\r\n]\r\n\r\nexport const lowerToUpperLookup: Record<TSelectionTypes, keyof TCollection> = {\r\n  artifacts: 'Artifacts',\r\n  battalions: 'Battalions',\r\n  battle_tactics: 'BattleTactics',\r\n  command_abilities: 'CommandAbilities',\r\n  command_traits: 'CommandTraits',\r\n  core_rules: 'CoreRules',\r\n  endless_spells: 'EndlessSpells',\r\n  flavors: 'Flavors',\r\n  grand_strategies: 'GrandStrategies',\r\n  incarnates: 'Incarnates',\r\n  monstrous_rampages: 'MonstrousRampages',\r\n  mount_traits: 'MountTraits',\r\n  prayers: 'Prayers',\r\n  scenery: 'Scenery',\r\n  spells: 'Spells',\r\n  triumphs: 'Triumphs',\r\n  units: 'Units',\r\n  manifestations: `Manifestations`,\r\n}\r\n\r\nexport const upperToLowerLookup: Record<keyof TCollection, TSelectionTypes> = {\r\n  Artifacts: 'artifacts',\r\n  Battalions: 'battalions',\r\n  BattleTactics: 'battle_tactics',\r\n  CommandAbilities: 'command_abilities',\r\n  CommandTraits: 'command_traits',\r\n  CoreRules: 'core_rules',\r\n  EndlessSpells: 'endless_spells',\r\n  Flavors: 'flavors',\r\n  GrandStrategies: 'grand_strategies',\r\n  Incarnates: 'incarnates',\r\n  MonstrousRampages: 'monstrous_rampages',\r\n  MountTraits: 'mount_traits',\r\n  Prayers: 'prayers',\r\n  Scenery: 'scenery',\r\n  Spells: 'spells',\r\n  Triumphs: 'triumphs',\r\n  Units: 'units',\r\n  Manifestations: `manifestations`,\r\n}\r\n\r\nexport const entryKeyToSelectionsKey: Record<Exclude<TEntryProperties, 'battle_trait'>, TSelectionTypes> = {\r\n  artifact: 'artifacts',\r\n  battalion: 'battalions',\r\n  battle_tactic: 'battle_tactics',\r\n  command_ability: 'command_abilities',\r\n  command_trait: 'command_traits',\r\n  core_rule: 'core_rules',\r\n  endless_spell: 'endless_spells',\r\n  grand_strategy: 'grand_strategies',\r\n  incarnate: 'incarnates',\r\n  monstrous_rampage: 'monstrous_rampages',\r\n  mount_trait: 'mount_traits',\r\n  prayer: 'prayers',\r\n  scenery: 'scenery',\r\n  spell: 'spells',\r\n  triumph: 'triumphs',\r\n  unit: 'units',\r\n  manifestations: `manifestations`,\r\n}\r\n\r\nexport const selectionsKeyToEntryKey: Record<\r\n  Exclude<TSelectionTypes, 'battle_traits' | 'flavors'>,\r\n  TEntryProperties\r\n> = {\r\n  artifacts: 'artifact',\r\n  battalions: 'battalion',\r\n  battle_tactics: 'battle_tactic',\r\n  command_abilities: 'command_ability',\r\n  command_traits: 'command_trait',\r\n  core_rules: 'core_rule',\r\n  endless_spells: 'endless_spell',\r\n  grand_strategies: 'grand_strategy',\r\n  incarnates: 'incarnate',\r\n  monstrous_rampages: 'monstrous_rampage',\r\n  mount_traits: 'mount_trait',\r\n  prayers: 'prayer',\r\n  scenery: 'scenery',\r\n  spells: 'spell',\r\n  triumphs: 'triumph',\r\n  units: 'unit',\r\n  manifestations: `manifestations`\r\n}\r\n\r\ntype TEntryMetadata = IItemDescription & {\r\n  [prop in TEntryProperties]?: boolean\r\n}\r\n\r\nexport type TEntry = {\r\n  name: string\r\n  isSideEffect?: boolean\r\n} & TEntryMetadata\r\n\r\nexport type TEffects = {\r\n  name: string\r\n  desc: string\r\n  when: TTurnWhen[]\r\n  rule_sources?: TRuleSource[]\r\n  shared?: boolean\r\n} & {\r\n  [prop in TEntryProperties]?: boolean\r\n}\r\n\r\nexport interface IReminder {\r\n  [key: string]: TTurnAction[]\r\n}\r\n\r\nexport type TTurnAction = {\r\n  id: string\r\n  actionTitle?: string\r\n  condition: string[]\r\n  desc: string\r\n  name: string\r\n  rule_sources?: TRuleSource[]\r\n  when: TTurnWhen\r\n} & {\r\n  [prop in TEntryProperties]?: boolean\r\n}\r\n","import * as Selectors from 'ducks/selectors'\r\nexport const selectors = Selectors\r\n\r\nexport * from 'ducks/army'\r\nexport * from 'ducks/factionNames'\r\nexport * from 'ducks/notes'\r\nexport * from 'ducks/realmscape'\r\nexport * from 'ducks/selections'\r\nexport * from 'ducks/visibility'\r\n","import { sortBy } from 'lodash'\r\n\r\n// Supported Faction Types\r\ntype TBeastsOfChaos = 'BEASTS_OF_CHAOS'\r\ntype TChaosGrandAlliance = 'CHAOS_GRAND_ALLIANCE'\r\ntype TCitiesOfSigmar = 'CITIES_OF_SIGMAR'\r\ntype TDaughtersOfKhaine = 'DAUGHTERS_OF_KHAINE'\r\ntype TDeathGrandAlliance = 'DEATH_GRAND_ALLIANCE'\r\ntype TDestructionGrandAlliance = 'DESTRUCTION_GRAND_ALLIANCE'\r\ntype TDispossessed = 'DISPOSSESSED'\r\ntype TFleshEaterCourts = 'FLESH_EATER_COURTS'\r\ntype TFyreslayers = 'FYRESLAYERS'\r\ntype TGloomspiteGitz = 'GLOOMSPITE_GITZ'\r\ntype TGreenskinz = 'GREENSKINZ'\r\ntype TIdonethDeepkin = 'IDONETH_DEEPKIN'\r\ntype TKharadronOverlords = 'KHARADRON_OVERLORDS'\r\ntype TKhorne = 'KHORNE'\r\ntype TLegionOfAzgorh = 'LEGION_OF_AZGORH'\r\ntype TLegionOfGrief = 'LEGION_OF_GRIEF'\r\ntype TLegionOfTheFirstPrince = 'LEGION_OF_THE_FIRST_PRINCE'\r\ntype TLegionsOfNagash = 'LEGIONS_OF_NAGASH'\r\ntype TLethisianDefenders = 'LETHISIAN_DEFENDERS'\r\ntype TLuminethRealmlords = 'LUMINETH_REALMLORDS'\r\ntype TMegaGargantMercenaries = 'MEGA_GARGANT_MERCENARIES'\r\ntype TMercenaryCompanies = 'MERCENARY_COMPANIES'\r\ntype TNighthaunt = 'NIGHTHAUNT'\r\ntype TNurgle = 'NURGLE'\r\ntype TOgorMawtribes = 'OGOR_MAWTRIBES'\r\ntype TOrderGrandAlliance = 'ORDER_GRAND_ALLIANCE'\r\ntype TOrrukWarclans = 'ORRUK_WARCLANS'\r\ntype TOssiarchBonereapers = 'OSSIARCH_BONEREAPERS'\r\ntype TSeraphon = 'SERAPHON'\r\ntype TSkaven = 'SKAVEN'\r\ntype TSlaanesh = 'SLAANESH'\r\ntype TSlavesToDarkness = 'SLAVES_TO_DARKNESS'\r\ntype TSonsOfBehemat = 'SONS_OF_BEHEMAT'\r\ntype TSoulblightGravelords = 'SOULBLIGHT_GRAVELORDS'\r\ntype TStormcastEternals = 'STORMCAST_ETERNALS'\r\ntype TSylvaneth = 'SYLVANETH'\r\ntype TTombKings = 'TOMB_KINGS'\r\ntype TTzeentch = 'TZEENTCH'\r\ntype TWanderers = 'WANDERERS'\r\n\r\n// Exported Faction Names\r\nexport const BEASTS_OF_CHAOS: TBeastsOfChaos = 'BEASTS_OF_CHAOS'\r\nexport const CHAOS_GRAND_ALLIANCE: TChaosGrandAlliance = 'CHAOS_GRAND_ALLIANCE'\r\nexport const CITIES_OF_SIGMAR: TCitiesOfSigmar = 'CITIES_OF_SIGMAR'\r\nexport const DAUGHTERS_OF_KHAINE: TDaughtersOfKhaine = 'DAUGHTERS_OF_KHAINE'\r\nexport const DEATH_GRAND_ALLIANCE: TDeathGrandAlliance = 'DEATH_GRAND_ALLIANCE'\r\nexport const DESTRUCTION_GRAND_ALLIANCE: TDestructionGrandAlliance = 'DESTRUCTION_GRAND_ALLIANCE'\r\nexport const DISPOSSESSED: TDispossessed = 'DISPOSSESSED'\r\nexport const FLESH_EATER_COURTS: TFleshEaterCourts = 'FLESH_EATER_COURTS'\r\nexport const FYRESLAYERS: TFyreslayers = 'FYRESLAYERS'\r\nexport const GLOOMSPITE_GITZ: TGloomspiteGitz = 'GLOOMSPITE_GITZ'\r\nexport const GREENSKINZ: TGreenskinz = 'GREENSKINZ'\r\nexport const IDONETH_DEEPKIN: TIdonethDeepkin = 'IDONETH_DEEPKIN'\r\nexport const KHARADRON_OVERLORDS: TKharadronOverlords = 'KHARADRON_OVERLORDS'\r\nexport const KHORNE: TKhorne = 'KHORNE'\r\nexport const LEGION_OF_AZGORH: TLegionOfAzgorh = 'LEGION_OF_AZGORH'\r\nexport const LEGION_OF_GRIEF: TLegionOfGrief = 'LEGION_OF_GRIEF'\r\nexport const LEGION_OF_THE_FIRST_PRINCE: TLegionOfTheFirstPrince = 'LEGION_OF_THE_FIRST_PRINCE'\r\nexport const LEGIONS_OF_NAGASH: TLegionsOfNagash = 'LEGIONS_OF_NAGASH'\r\nexport const LETHISIAN_DEFENDERS: TLethisianDefenders = 'LETHISIAN_DEFENDERS'\r\nexport const LUMINETH_REALMLORDS: TLuminethRealmlords = 'LUMINETH_REALMLORDS'\r\nexport const MEGA_GARGANT_MERCENARIES: TMegaGargantMercenaries = 'MEGA_GARGANT_MERCENARIES'\r\nexport const MERCENARY_COMPANIES: TMercenaryCompanies = 'MERCENARY_COMPANIES'\r\nexport const NIGHTHAUNT: TNighthaunt = 'NIGHTHAUNT'\r\nexport const NURGLE: TNurgle = 'NURGLE'\r\nexport const OGOR_MAWTRIBES: TOgorMawtribes = 'OGOR_MAWTRIBES'\r\nexport const ORDER_GRAND_ALLIANCE: TOrderGrandAlliance = 'ORDER_GRAND_ALLIANCE'\r\nexport const ORRUK_WARCLANS: TOrrukWarclans = 'ORRUK_WARCLANS'\r\nexport const OSSIARCH_BONEREAPERS: TOssiarchBonereapers = 'OSSIARCH_BONEREAPERS'\r\nexport const SERAPHON: TSeraphon = 'SERAPHON'\r\nexport const SKAVEN: TSkaven = 'SKAVEN'\r\nexport const SLAANESH: TSlaanesh = 'SLAANESH'\r\nexport const SLAVES_TO_DARKNESS: TSlavesToDarkness = 'SLAVES_TO_DARKNESS'\r\nexport const SONS_OF_BEHEMAT: TSonsOfBehemat = 'SONS_OF_BEHEMAT'\r\nexport const SOULBLIGHT_GRAVELORDS: TSoulblightGravelords = 'SOULBLIGHT_GRAVELORDS'\r\nexport const STORMCAST_ETERNALS: TStormcastEternals = 'STORMCAST_ETERNALS'\r\nexport const SYLVANETH: TSylvaneth = 'SYLVANETH'\r\nexport const TOMB_KINGS: TTombKings = 'TOMB_KINGS'\r\nexport const TZEENTCH: TTzeentch = 'TZEENTCH'\r\nexport const WANDERERS: TWanderers = 'WANDERERS'\r\n\r\n/**\r\n * Primary factions\r\n *\r\n * Excludes mercenary armies that are only taken as allies e.g. Mercenary Companies and Mega Gargant Mercenaries\r\n */\r\nexport type TPrimaryFactions =\r\n  | TBeastsOfChaos\r\n  | TChaosGrandAlliance\r\n  | TCitiesOfSigmar\r\n  | TDaughtersOfKhaine\r\n  | TDeathGrandAlliance\r\n  | TDestructionGrandAlliance\r\n  | TDispossessed\r\n  | TFleshEaterCourts\r\n  | TFyreslayers\r\n  | TGloomspiteGitz\r\n  | TGreenskinz\r\n  | TIdonethDeepkin\r\n  | TKharadronOverlords\r\n  | TKhorne\r\n  | TLegionOfAzgorh\r\n  | TLegionOfGrief\r\n  | TLegionOfTheFirstPrince\r\n  | TLegionsOfNagash\r\n  | TLethisianDefenders\r\n  | TLuminethRealmlords\r\n  | TMercenaryCompanies\r\n  | TNighthaunt\r\n  | TNurgle\r\n  | TOgorMawtribes\r\n  | TOrderGrandAlliance\r\n  | TOrrukWarclans\r\n  | TOssiarchBonereapers\r\n  | TSeraphon\r\n  | TSkaven\r\n  | TSlaanesh\r\n  | TSlavesToDarkness\r\n  | TSonsOfBehemat\r\n  | TSoulblightGravelords\r\n  | TStormcastEternals\r\n  | TSylvaneth\r\n  | TTombKings\r\n  | TTzeentch\r\n  | TWanderers\r\n\r\n// Supported Factions\r\nexport type TSupportedFaction = TPrimaryFactions | TMercenaryCompanies | TMegaGargantMercenaries\r\n\r\nexport const PRIMARY_FACTIONS: TPrimaryFactions[] = [\r\n  BEASTS_OF_CHAOS,\r\n  CHAOS_GRAND_ALLIANCE,\r\n  CITIES_OF_SIGMAR,\r\n  DAUGHTERS_OF_KHAINE,\r\n  DEATH_GRAND_ALLIANCE,\r\n  DESTRUCTION_GRAND_ALLIANCE,\r\n  DISPOSSESSED,\r\n  FLESH_EATER_COURTS,\r\n  FYRESLAYERS,\r\n  GLOOMSPITE_GITZ,\r\n  GREENSKINZ,\r\n  IDONETH_DEEPKIN,\r\n  KHARADRON_OVERLORDS,\r\n  KHORNE,\r\n  LEGION_OF_AZGORH,\r\n  LEGION_OF_GRIEF,\r\n  LEGION_OF_THE_FIRST_PRINCE,\r\n  LEGIONS_OF_NAGASH,\r\n  LETHISIAN_DEFENDERS,\r\n  LUMINETH_REALMLORDS,\r\n  NIGHTHAUNT,\r\n  NURGLE,\r\n  OGOR_MAWTRIBES,\r\n  ORDER_GRAND_ALLIANCE,\r\n  ORRUK_WARCLANS,\r\n  OSSIARCH_BONEREAPERS,\r\n  SERAPHON,\r\n  SKAVEN,\r\n  SLAANESH,\r\n  SLAVES_TO_DARKNESS,\r\n  SONS_OF_BEHEMAT,\r\n  SOULBLIGHT_GRAVELORDS,\r\n  STORMCAST_ETERNALS,\r\n  SYLVANETH,\r\n  TOMB_KINGS,\r\n  TZEENTCH,\r\n  WANDERERS,\r\n]\r\n\r\nexport const SUPPORTED_FACTIONS: TSupportedFaction[] = sortBy([\r\n  ...PRIMARY_FACTIONS,\r\n  MEGA_GARGANT_MERCENARIES,\r\n  MERCENARY_COMPANIES,\r\n])\r\n","import { withAuthenticationRequired } from '@auth0/auth0-react'\r\nimport { ComponentType } from 'react'\r\nimport { Route } from 'react-router-dom'\r\n\r\ntype TProps = { component: ComponentType; [x: string]: any }\r\n\r\nconst ProtectedRoute = ({ component, ...args }: TProps) => (\r\n  <Route component={withAuthenticationRequired(component)} {...args} />\r\n)\r\n\r\nexport default ProtectedRoute\r\n","import { isString } from 'lodash'\r\nimport qs from 'qs'\r\nimport { logEvent, logGiftedSubscription, logSubscription } from 'utils/analytics'\r\nimport { loadArmyFromLink } from 'utils/loadArmy/loadArmyHelpers'\r\n\r\nexport const handleStripeCheckout = () => {\r\n  const {\r\n    subscribed = false,\r\n    canceled = false,\r\n    plan = '',\r\n    gifted = false,\r\n    quantity = '',\r\n  } = qs.parse(window.location.search, {\r\n    ignoreQueryPrefix: true,\r\n  })\r\n\r\n  if (subscribed && isString(plan)) {\r\n    logEvent(`Checkout-Subscribed-${plan}`)\r\n    logSubscription(plan, 'stripe')\r\n  }\r\n  if (gifted && isString(plan) && isString(quantity)) {\r\n    logEvent(`Checkout-Gifted-Subscription-${plan}-x-${quantity}`)\r\n    logGiftedSubscription(plan, quantity)\r\n  }\r\n  if (canceled) logEvent(`Checkout-Canceled-${plan}`)\r\n\r\n  if (subscribed || canceled || gifted) {\r\n    window.history.replaceState({}, document.title, window.location.pathname)\r\n  }\r\n}\r\n\r\n/**\r\n * Returns an army link e.g.\r\n * aosreminders.com/?army=abc123 === abc123\r\n *\r\n * Returns null if no link is found\r\n */\r\nexport const getArmyLink = (): string | null => {\r\n  const { army = null } = qs.parse(window.location.search, {\r\n    ignoreQueryPrefix: true,\r\n  })\r\n  return army as string | null\r\n}\r\n\r\n/**\r\n * Returns true if we are loading an army from a link embedded in the query params\r\n */\r\nexport const handleArmyLink = (): boolean => {\r\n  const link = getArmyLink()\r\n  if (!link) return false\r\n  loadArmyFromLink(link)\r\n  return true\r\n}\r\n","// https://github.com/ReactTraining/react-router/blob/master/FAQ.md#how-do-i-access-the-history-object-outside-of-components\r\nimport { createBrowserHistory } from 'history'\r\nexport default createBrowserHistory()\r\n","import { LoadingBody } from 'components/helpers/suspenseFallbacks'\r\nimport ProtectedRoute from 'components/page/privateRoute'\r\nimport { lazy, Suspense, useEffect } from 'react'\r\nimport { Route, Router, Switch } from 'react-router-dom'\r\nimport { ROUTES } from 'utils/env'\r\nimport { handleArmyLink, handleStripeCheckout } from 'utils/handleQueryParams'\r\nimport history from 'utils/history'\r\n\r\n// Lazy loading routes (takes advantage of code splitting)\r\nconst Goodbye = lazy(() => import('components/routes/Goodbye'))\r\nconst Faq = lazy(() => import('components/routes/Faq'))\r\nconst Home = lazy(() => import('components/routes/Home'))\r\nconst Join = lazy(() => import('components/routes/Join'))\r\nconst Profile = lazy(() => import('components/routes/Profile'))\r\nconst Redeem = lazy(() => import('components/routes/Redeem'))\r\n// const Stats = lazy(() => import('components/routes/Stats'))\r\nconst Subscribe = lazy(() => import('components/routes/Subscribe'))\r\n\r\nconst App = () => {\r\n  useEffect(() => {\r\n    handleStripeCheckout() // Post-Stripe-checkout handling\r\n    handleArmyLink() // Load army from link\r\n  }, [])\r\n\r\n  return (\r\n    <div className={`d-block`}>\r\n      <Router history={history}>\r\n        <Suspense fallback={<LoadingBody />}>\r\n          <Switch>\r\n            {/* Main page of the app */}\r\n            <Route path={ROUTES.HOME} exact component={Home} />\r\n\r\n            {/* Help/FAQ */}\r\n            <Route path={ROUTES.FAQ} component={Faq} />\r\n\r\n            {/* Coupon redemption */}\r\n            <Route path={ROUTES.JOIN} component={Join} />\r\n\r\n            {/* Gift subscription redemption */}\r\n            <Route path={ROUTES.REDEEM} component={Redeem} />\r\n\r\n            {/* Subscribe page */}\r\n            <Route path={ROUTES.SUBSCRIBE} component={Subscribe} />\r\n\r\n            {/* Stats page */}\r\n            {/* <Route path={ROUTES.STATS} component={Stats} /> */}\r\n\r\n            {/* Farewell page */}\r\n            <Route path={ROUTES.GOODBYE} component={Goodbye} />\r\n\r\n            {/* Profile page */}\r\n            <ProtectedRoute path={ROUTES.PROFILE} component={Profile} />\r\n          </Switch>\r\n        </Suspense>\r\n      </Router>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://cra.link/PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\r\n)\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\r\n}\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config)\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://cra.link/PWA'\r\n          )\r\n        })\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing\r\n        if (installingWorker == null) {\r\n          return\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://cra.link/PWA.'\r\n              )\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration)\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.')\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error)\r\n    })\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type')\r\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload()\r\n          })\r\n        })\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      window.dispatchEvent(new Event('isOffline'))\r\n      console.log('No internet connection found. App is running in offline mode.')\r\n    })\r\n}\r\n","import 'core-js/stable' // organize-imports-ignore\r\nimport 'css/animations.scss' // organize-imports-ignore\r\nimport 'css/index.scss' // organize-imports-ignore\r\nimport App from 'components/App'\r\nimport { AppStatusProvider } from 'context/useAppStatus'\r\nimport { SavedArmiesProvider } from 'context/useSavedArmies'\r\nimport { SubscriptionProvider } from 'context/useSubscription'\r\nimport { ThemeProvider } from 'context/useTheme'\r\nimport React from 'react'\r\nimport { render } from 'react-dom'\r\nimport { Provider } from 'react-redux'\r\nimport { PersistGate } from 'redux-persist/integration/react'\r\nimport { installNewWorker } from 'utils/installNewWorker'\r\nimport config from './auth_config.json'\r\nimport { Auth0Provider } from '@auth0/auth0-react'\r\nimport { persistor, store } from 'store'\r\nimport history from 'utils/history'\r\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration'\r\n\r\nconst onRedirectCallback = (appState: any) => {\r\n  // Use the router's history module to replace the url\r\n  history.replace(appState?.returnTo || window.location.pathname)\r\n}\r\n\r\nrender(\r\n  <Provider store={store}>\r\n    <PersistGate loading={null} persistor={persistor}>\r\n      <Auth0Provider\r\n        domain={config.domain}\r\n        clientId={config.clientId}\r\n        authorizationParams={{\r\n          redirect_uri: window.location.origin,\r\n        }}\r\n        onRedirectCallback={onRedirectCallback}\r\n      >\r\n        <AppStatusProvider>\r\n          <SubscriptionProvider>\r\n            <SavedArmiesProvider>\r\n              <ThemeProvider>\r\n                <App />\r\n              </ThemeProvider>\r\n            </SavedArmiesProvider>\r\n          </SubscriptionProvider>\r\n        </AppStatusProvider>\r\n      </Auth0Provider>\r\n    </PersistGate>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n)\r\n\r\n// Learn more about service workers: https://cra.link/PWA\r\n// https://github.com/facebook/create-react-app/issues/5316\r\n// https://github.com/facebook/create-react-app/issues/7237\r\nserviceWorkerRegistration.register({\r\n  onUpdate: async registration => {\r\n    // We post a message letting the rest of the app know that we have updated content\r\n    if (typeof BroadcastChannel !== 'undefined') {\r\n      const bc = new BroadcastChannel('app-update')\r\n      bc.postMessage('App has updated.')\r\n    }\r\n\r\n    // We prefer using the BroadcastChannel (above) as it can reach across tabs\r\n    // But it won't always work due to browser limitations.\r\n    // So we always dispatch an event to the window just in case.\r\n    window.dispatchEvent(new Event('hasNewContent'))\r\n\r\n    // Go ahead and update to the latest cached worker\r\n    // The user will be given an option in the UI to reload and get the newest version\r\n    // But this ensures that they'll get the new worker next time they visit\r\n    installNewWorker()\r\n  },\r\n})\r\n","export const installNewWorker = async () => {\r\n  try {\r\n    if (window.navigator && window.navigator.serviceWorker) {\r\n      const waitingServiceWorker = await window.navigator.serviceWorker.ready\r\n\r\n      if (waitingServiceWorker.waiting) {\r\n        waitingServiceWorker.waiting.postMessage({ type: 'SKIP_WAITING' })\r\n      }\r\n    }\r\n  } catch (err) {\r\n    console.error(err)\r\n  }\r\n}\r\n","import deepmerge from 'deepmerge'\r\nimport { TSubfactionArmy } from 'types/army'\r\nimport { TEntry } from 'types/data'\r\nimport { IItemDescription, TItemKey, TItemDescriptions } from './factionTypes'\r\n\r\ntype TAdapter = (subFaction: IItemDescription, subFactionName: string, FlavorType?: string) => TSubfactionArmy\r\n\r\n/**\r\n * To see how a new data-structure army might feel in the UI as-is\r\n */\r\nexport const temporaryAdapter: TAdapter = (subFaction, subFactionName, FlavorType = 'Flavors') => {\r\n  const army: TSubfactionArmy = {\r\n    AlliedUnits: mergeData(subFaction, 'allied_units'),\r\n    Artifacts: mergeData(subFaction, 'artifacts'),\r\n    Battalions: mergeData(subFaction, 'battalions'),\r\n    BattleTactics: mergeData(subFaction, 'battle_tactics'),\r\n    BattleTraits: subFaction.effects,\r\n    CommandAbilities: mergeData(subFaction, 'command_abilities'),\r\n    CommandTraits: mergeData(subFaction, 'command_traits'),\r\n    CoreRules: mergeData(subFaction, 'core_rules'),\r\n    EndlessSpells: mergeData(subFaction, 'endless_spells'),\r\n    Flavors: mergeData(subFaction, 'flavors'),\r\n    FlavorType,\r\n    GrandStrategies: mergeData(subFaction, 'grand_strategies'),\r\n    Incarnates: mergeData(subFaction, 'incarnates'),\r\n    MonstrousRampages: mergeData(subFaction, 'monstrous_rampages'),\r\n    MountTraits: mergeData(subFaction, 'mount_traits'),\r\n    Prayers: mergeData(subFaction, 'prayers'),\r\n    Scenery: mergeData(subFaction, 'scenery'),\r\n    Spells: mergeData(subFaction, 'spells'),\r\n    SubFaction: subFactionAdapter(subFaction, subFactionName),\r\n    Triumphs: mergeData(subFaction, 'triumphs'),\r\n    Units: mergeData(subFaction, 'units'),\r\n    Manifestations: mergeData(subFaction, 'manifestations'),\r\n  }\r\n\r\n  return army\r\n}\r\n\r\nexport const getAggregateArmy = (subFactions: TItemDescriptions, flavorType = 'Flavors'): TSubfactionArmy => {\r\n  return Object.entries(subFactions).reduce((a, [key, value]) => {\r\n    const b = temporaryAdapter(value, key, flavorType)\r\n    return deepmerge(a, b)\r\n  }, {} as TSubfactionArmy)\r\n}\r\n\r\nconst subFactionAdapter = (subFaction: IItemDescription, name: string): TEntry => {\r\n  const { mandatory = {}, effects = [] } = subFaction\r\n  return { mandatory, effects, name }\r\n}\r\n\r\nconst mergeData = (subFaction: IItemDescription, slice: TItemKey): TEntry[] => {\r\n  const { available = {}, mandatory = {} } = subFaction\r\n  const merged: TItemDescriptions[] = [...(available[slice] || []), ...(mandatory[slice] || [])]\r\n  return mergeParentEffectObjs(merged)\r\n}\r\n\r\nexport const mergeParentEffectObjs = <T extends TItemDescriptions>(\r\n  objs: T[]\r\n): (TItemDescriptions & TEntry)[] => {\r\n  return objs.reduce((a, obj) => {\r\n    const arr = parentEffectObjConverter(obj)\r\n    a = a.concat(arr)\r\n    return a\r\n  }, [] as (TItemDescriptions & TEntry)[])\r\n}\r\n\r\nconst parentEffectObjConverter = <T extends TItemDescriptions>(obj: T): (T & TEntry)[] => {\r\n  return Object.keys(obj).reduce((a, name) => {\r\n    const entry = { ...obj[name], name }\r\n    a.push(entry as T & TEntry)\r\n    return a\r\n  }, [] as (T & TEntry)[])\r\n}\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_MOVEMENT_PHASE, HERO_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Endless Legions': {\r\n    effects: [\r\n      {\r\n        name: `Endless Legions`,\r\n        desc: `You can use this command ability at the end of your movement phase. If you do so, pick a gravesite that is within 9\" of your general, and then pick a friendly Summonable unit that has been destroyed. Set up that unit wholly within 9\" of that gravesite and more than 9\" from any enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Bones': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Bones`,\r\n        desc: `If this model uses this ability, pick a friendly DEATHRATTLE unit within 18\" of it. Until your next hero phase, add 1 to the Attacks characteristic of that unit's melee weapons. You cannot pick the same unit to benefit from this command ability more than once per hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Death Magic Incarnate': {\r\n    effects: [\r\n      {\r\n        name: `Death Magic Incarnate`,\r\n        desc: `You can use this command ability if this unit is on the battlefield at the start of the combat phase. The unit that receives this command must be a different friendly Death unit. Add 1 to ward rolls for that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vigour of Undeath': {\r\n    effects: [\r\n      {\r\n        name: `Vigour of Undeath`,\r\n        desc: `If Mannfred uses this ability, then until your next hero phase you can reroll hit and wound rolls of 1 for friendly DEATH units that are within the range shown on the damage table.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Twilights Allure': {\r\n    effects: [\r\n      {\r\n        name: `Twilights Allure`,\r\n        desc: `If Neferata uses this ability, then until your next hero phase subtract 1 from hit rolls for enemy units that are within the range shown on the damage table.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fist of Nagash': {\r\n    effects: [\r\n      {\r\n        name: `Fist of Nagash`,\r\n        desc: `If Prince Vhordrai uses this ability, pick a friendly DEATH HERO within 14\" of him (you cannot choose Prince Vhordrai). That hero can immediately either be chosen to pile in and attack as if it were the combat phase, or if it is a WIZARD, attempt to cast a spell in addition to any others they can attempt to cast this phase. The same unit cannot be picked to benefit from this command ability more than once per hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dread Knight': {\r\n    effects: [\r\n      {\r\n        name: `Dread Knight`,\r\n        desc: `If this model uses this ability, pick a friendly DEATH unit within 15\" of it. Until your next hero phase, you can reroll failed hit rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Feast': {\r\n    effects: [\r\n      {\r\n        name: `Blood Feast`,\r\n        desc: `If this model uses this ability, pick a friendly DEATH unit within 15\" of it. Models in that unit make one extra attack with each of their melee weapons until your next hero phase. You cannot pick the same unit to benefit from this command ability more than once per hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tactical Insight': {\r\n    effects: [\r\n      {\r\n        name: `Tactical Insight`,\r\n        desc: `If this model uses this ability, pick a friendly DEATH unit within 12\" of it. You can reroll hit, wound and save rolls of 1 for that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","export type TRuleSource = {\r\n  name: string\r\n  type: 'battletome' | 'white_dwarf' | 'errata' | 'ghb' | 'other_book' | 'boxed_game'\r\n  /**\r\n   * A helpful link to where these rules can be found. Optional.\r\n   */\r\n  url?: string\r\n}\r\n\r\nexport type TRuleSources = Record<string, TRuleSource>\r\n\r\n// Use this as the centralized rule_sources\r\n// Core books, non-faction books, General's Handbooks, etc\r\nconst meta_rule_sources = {\r\n  ERRATA_BROKEN_REALMS_TECLIS_MAY_2021: {\r\n    name: 'Broken Realms: Teclis Errata (May 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/05/a5tBnjkUz0X5zrFr.pdf',\r\n  },\r\n  ERRATA_BROKEN_REALMS_TECLIS_JULY_2021: {\r\n    name: 'Broken Realms: Teclis Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/05/5TXh9dhnksx7PhbX.pdf',\r\n  },\r\n\r\n  ERRATA_BROKEN_REALMS_MORATHI_JANUARY_2021: {\r\n    name: 'Broken Realms: Morathi Errata (January 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/01/q9Fg2qordsr7bbCP.pdf',\r\n  },\r\n  ERRATA_BROKEN_REALMS_MORATHI_JULY_2021: {\r\n    name: 'Broken Realms: Morathi Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/01/soZJF6JOs4BrQi8z.pdf',\r\n  },\r\n\r\n  ERRATA_WRATH_OF_THE_EVERCHOSEN_JULY_2021: {\r\n    name: 'Soul Wars: Wrath of the Everchosen Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/grTM4zXseeVRy7HL.pdf',\r\n  },\r\n  ERRATA_WRATH_OF_THE_EVERCHOSEN_AUGUST_2021: {\r\n    name: 'Soul Wars: Wrath of the Everchosen Errata (August 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/tHcsi6mqEyQoq1SE.pdf',\r\n  },\r\n\r\n  BOOK_BROKEN_REALMS_KRAGNOS: {\r\n    name: 'Broken Realms: Kragnos',\r\n    type: 'other_book',\r\n  },\r\n  ERRATA_BROKEN_REALMS_KRAGNOS_JULY_2021: {\r\n    name: 'Broken Realms: Kragnos Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/07/OEZvWdlyDRHD9tfj.pdf',\r\n  },\r\n  ERRATA_BROKEN_REALMS_KRAGNOS_AUGUST_2021: {\r\n    name: 'Broken Realms: Kragnos Errata (August 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/07/rqrtl9Iet9Yq3vDX.pdf',\r\n  },\r\n\r\n  BOOK_BROKEN_REALMS_BELAKOR: {\r\n    name: \"Broken Realms: Be'lakor\",\r\n    type: 'other_book',\r\n  },\r\n  ERRATA_BROKEN_REALMS_BELAKOR_AUGUST_2021: {\r\n    name: \"Broken Realms: Be'lakor Errata (August 2021)\",\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/07/OQelhstq4HoJuYm6.pdf',\r\n  },\r\n  ERRATA_BROKEN_REALMS_BELAKOR_JULY_2022: {\r\n    name: \"Broken Realms: Be'lakor Errata (July 2022)\",\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/07/Z4b4plVM8gDObBDe.pdf',\r\n  },\r\n\r\n  CORE_RULES_2021: {\r\n    name: 'Core Rules (2021)',\r\n    type: 'other_book',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2021/06/bHB57xEZVMKO4T1U.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_JULY_2021: {\r\n    name: 'Core Rules Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/u7QSQCYGoqZ6e4TL.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_SEPTEMBER_2021: {\r\n    name: 'Core Rules Errata (September 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/0f2lPBAeWV2trBmu.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_OCTOBER_2021: {\r\n    name: 'Core Rules Errata (October 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/mx79gx5TnnSNrWI2.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_DECEMBER_2021: {\r\n    name: 'Core Rules Errata (December 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/VrQ1PX4ZvydjBuKl.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_JULY_2022: {\r\n    name: 'Core Rules Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/TKy3YFHtTFpL4ZVW.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_OCTOBER_2022: {\r\n    name: 'Core Rules Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/svhEUwlP6J1AQFXl.pdf',\r\n  },\r\n  ERRATA_CORE_RULES_JANUARY_2023: {\r\n    name: 'Core Rules Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/Y9OeMNhzYrlFauuB.pdf',\r\n  },\r\n\r\n  GHB_2021: {\r\n    name: \"General's Handbook (2021)\",\r\n    type: 'ghb',\r\n  },\r\n  GHB_2022: {\r\n    name: \"General's Handbook (2022)\",\r\n    type: 'ghb',\r\n  },\r\n  GHB_2022_2023_SEASON_2: {\r\n    name: \"General's Handbook (2022-23 - Season 2)\",\r\n    type: 'ghb',\r\n  },\r\n  GHB_2023_2024: {\r\n    name: \"General's Handbook (2023-2024)\",\r\n    type: 'ghb',\r\n  },\r\n\r\n  ERRATA_GHB_SEPTEMBER_2021: {\r\n    name: \"General's Handbook Errata (September 2021)\",\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/Nx3vTlkaz7ekCv7J.pdf',\r\n  },\r\n  ERRATA_GHB_OCTOBER_2022: {\r\n    name: \"General's Handbook Errata (October 2022)\",\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2022/06/v1iepvOM3Oycl774.pdf',\r\n  },\r\n  ERRATA_GHB_JANUARY_2023: {\r\n    name: \"General's Handbook (2022-23 - Season 2) Errata (January 2023)\",\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2022/06/0niAh9Z8ntoVaTlG.pdf',\r\n  },\r\n\r\n  CROSS_FACTION_HEROES_JULY_2022: {\r\n    name: 'Cross Faction Heroes (July 2022)',\r\n    type: 'other_book',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2022/07/F7rLk5rmPJoiqZZw.pdf',\r\n  },\r\n\r\n  ERRATA_SEASON_OF_WAR_THONDIA: {\r\n    name: 'Season of War: Thondia (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2022/10/AIPRIiH3XKEsLKFl.pdf',\r\n  },\r\n\r\n  BATTLESCROLL_GALLETIAN_CHAMPIONS_JANUARY_2022: {\r\n    name: 'Battlescroll: Galletian Champions (July 2022)',\r\n    type: 'other_book',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/01/Ugb15RoC5uAQIMWi.pdf',\r\n  },\r\n\r\n  BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023: {\r\n    name: 'Battlescroll: Depleted Reserves (April 2023)',\r\n    type: 'other_book',\r\n  },\r\n\r\n  BATTLESCROLL_ANDTOR_SEPTEMBER_2023: {\r\n    name: 'Battlescroll: Tactics of Andtor (September 2023)',\r\n    type: 'other_book',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/07/AefiGVn8NoPchpF2.pdf',\r\n  },\r\n\r\n  BOOK_DAWNBRINGERS_BOOK_1: {\r\n    name: 'Dawnbringers Book I',\r\n    type: 'other_book',\r\n  },\r\n\r\n  BOOK_DAWNBRINGERS_BOOK_2: {\r\n    name: 'Dawnbringers Book II',\r\n    type: 'other_book',\r\n  },\r\n  ERRATA_DAWNBRINGERS_BOOK_2: {\r\n    name: 'Dawnbringers Book II Errata (October 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/10/82g1IHzMFxXDUL4j.pdf',\r\n  },\r\n\r\n  BOOK_DAWNBRINGERS_BOOK_3: {\r\n    name: 'Dawnbringers Book III',\r\n    type: 'other_book',\r\n  },\r\n\r\n  BATTLESCROLL_NULLSTONE_CACHE: {\r\n    name: 'Battlescroll: Nullstone Cache (February 2024)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/07/u46c37l8ZQIPm57N.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default meta_rule_sources\r\n","import { camelCase, startCase } from 'lodash'\r\nimport { TTurnAction } from 'types/data'\r\n\r\nexport const titleCase = (val: string): string => startCase(camelCase(val))\r\n\r\nexport const stripPunctuation = (text: string): string => text.replace(/[.,/#!$%^&*;:{}=\\-_`'\"~()]/g, '')\r\n\r\nexport const generateUUID = () => {\r\n  return [...Array(10)].map(i => (~~(Math.random() * 36)).toString(36)).join('')\r\n}\r\n\r\nexport const hashCode = (str: string): string => {\r\n  let hash = 0\r\n  if (str.length === 0) return 'none'\r\n  for (let i = 0; i < str.length; i++) {\r\n    let char = str.charCodeAt(i)\r\n    hash = (hash << 5) - hash + char\r\n    hash = hash & hash // Convert to 32bit integer\r\n  }\r\n  return `${hash}`\r\n}\r\n\r\nexport const getActionTitle = ({\r\n  artifact,\r\n  battalion,\r\n  battle_tactic,\r\n  command_ability,\r\n  command_trait,\r\n  condition,\r\n  endless_spell,\r\n  grand_strategy,\r\n  incarnate,\r\n  monstrous_rampage,\r\n  mount_trait,\r\n  name,\r\n  prayer,\r\n  scenery,\r\n  spell,\r\n  triumph,\r\n}: TTurnAction): string => {\r\n  const joinedCond = condition.filter(x => x !== name).join(', ')\r\n  const suffix = name === joinedCond || joinedCond === `` ? `` : `: ${joinedCond}`\r\n  if (artifact) return `Artifact${suffix}`\r\n  if (battalion) return `Battalion${suffix}`\r\n  if (battle_tactic) return `Battle Tactic${suffix}`\r\n  if (command_ability) return `Command Ability${suffix}`\r\n  if (command_trait) return `Command Trait${suffix}`\r\n  if (endless_spell) return `Endless Spell${suffix}`\r\n  if (grand_strategy) return `Grand Strategy${suffix}`\r\n  if (incarnate) return `Incarnate${suffix}`\r\n  if (monstrous_rampage) return `Monstrous Rampage${suffix}`\r\n  if (mount_trait) return `Mount Trait${suffix}`\r\n  if (prayer) return `Prayer${suffix}`\r\n  if (scenery) return `Scenery${suffix}`\r\n  if (spell) return `Spell${suffix}`\r\n  if (triumph) return `Triumph${suffix}`\r\n  return joinedCond\r\n}\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const ChillingHordeEffect = {\r\n  name: `Chilling Horde`,\r\n  desc: `Add 1 to wound rolls for attacks made with melee weapons by this unit if this unit made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in a Nighthaunt army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst StolenHoursEffect = {\r\n  name: `Stolen Hours`,\r\n  desc: `At the end of the combat phase, if any enemy models were slain by attacks made with this unit's Sword of Stolen Hours in that phase, you can heal 1 wound allocated to this unit and add 1 to the Wounds characteristic of this unit.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nexport const Nagash = {\r\n /* 'Nagash, Supreme Lord of the Undead': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, subtract 3 from its power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Staff of Power - Passive`,\r\n        desc: `Effect: Add 2 to casting rolls for this unit while it has not miscast any spells this turn. If this unit miscasts a spell, ignore the restriction that would stop this unit from casting any more spells this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hand of Dust - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy Hero or Monster in combat with this unit to be the target. \r\n        Effect: Hide a dice in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one hiding the dice, this ability has no effect. If they pick the empty one, the target is automatically destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Supreme Lord of the Undead - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero non-Unique Death unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit identical to the target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Invocation of Nagash: Casting value of 7`,\r\n        desc: `Declare: This unit can cast this spell more than once per phase. Pick a visible unit wholly within 18\" of this unit that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target is an enemy unit, inflict D3 mortal damage on it. If the target is a friendly Death unit, pick 1 of the following effects:  \r\n        Return a number of slain models to the target unit with a combined Health characteristic of up to 3.  The target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} \r\n\r\nconst Units = {\r\n // ...Nagash,\r\n 'Nagash, Supreme Lord of the Undead': {\r\n  effects: [\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, subtract 3 from its power level.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `The Staff of Power - Passive`,\r\n      desc: `Effect: Add 2 to casting rolls for this unit while it has not miscast any spells this turn. If this unit miscasts a spell, ignore the restriction that would stop this unit from casting any more spells this turn.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Hand of Dust - Once Per Turn`,\r\n      desc: `Declare: Pick a visible enemy Hero or Monster in combat with this unit to be the target. \r\n      Effect: Hide a dice in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one hiding the dice, this ability has no effect. If they pick the empty one, the target is automatically destroyed.`,\r\n      when: [END_OF_TURN],\r\n    },\r\n    {\r\n      name: `Supreme Lord of the Undead - Once Per Battle`,\r\n      desc: `Declare: Pick a friendly non-Hero non-Unique Death unit that has been destroyed to be the target. \r\n      Effect: Set up a replacement unit identical to the target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Invocation of Nagash: Casting value of 7`,\r\n      desc: `Declare: This unit can cast this spell more than once per phase. Pick a visible unit wholly within 18\" of this unit that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n      Effect: If the target is an enemy unit, inflict D3 mortal damage on it. If the target is a friendly Death unit, pick 1 of the following effects:  \r\n      Return a number of slain models to the target unit with a combined Health characteristic of up to 3.  The target has Ward (5+) until the start of your next turn.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n  ],\r\n},\r\n  'Awlrach the Drowner': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Passage Through the Underworlds'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Passage Through the Underworlds - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a friendly non-Hero Nighthaunt unit that is not in combat and is wholly within 12\" of this unit to be the target. \r\n        Effect: Remove this unit and the target from the battlefield, then set them up again on the battlefield wholly within 6\" of each other and more than 7\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lady Olynder, Mortarch of Grief': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Grief-Stricken'])],\r\n    }, */\r\n    effects: [\r\n    //  WarmasterEffect,\r\n      {\r\n        name: `Grief-Stricken: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore positive modifiers to hit rolls, wound rolls and save rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Grief - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `No Rest For the Wicked - Once Per Battle`,\r\n        desc: `Declare: Pick any number of friendly Nighthaunt units on the battlefield to be the targets. \r\n        Effect: For each target, you can return a number of slain models to that unit with a combined Health characteristic of up to D3+3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'Kurdoss Valentian, the Craven King': {\r\n    effects: [\r\n      {\r\n        name: `If I Cannot Rule, None Shall Rule! - Once Per Turn - Reaction: Opponent declared a command for a unit within 12\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 3+, unless your opponent spends 1 additional command point to use that command, the command has no effect, it still counts as having been used and the command points spent to use the command are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Reikenor the Grimhailer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Wraithstorm'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Corpse Candles`,\r\n        desc: `Declare: Pick either this unit or a visible enemy unit within 12\" of this unit to be the target. \r\n        Effect: Allocate 1 damage point to the target. \r\n        If you picked an enemy unit, add 1 to casting rolls for this unit for the rest of the turn. \r\n        If you picked this unit, for the rest of the turn:  \r\n        Add 1 to casting rolls for this unit.  \r\n        Add 1 to this units power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wraithstorm: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target. If any models are slain by this ability, inflict an additional D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Grim Justice - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for attacks made with this units Fellreaper if the target is a Priest or a Wizard.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scriptor Mortis': {\r\n    effects: [\r\n      {\r\n        name: `Judge, Jury, and Executioner - Once Per Turn`,\r\n        desc: `Effect: Roll a dice for each Sentenced enemy unit on the battlefield. On a 4+, inflict an amount of mortal damage equal to the current battle round number on that Sentenced unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Sentenced to Eternal Torment - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has the Sentenced keyword for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight of Shrouds': {\r\n    effects: [\r\n    //  StolenHoursEffect,\r\n      {\r\n        name: `Stolen Hours - Passive`,\r\n        desc: `Effect: Each time this unit uses a Fight ability, after that Fight ability has been resolved, Heal (X) this unit, where X is the number of damage points allocated to enemy units by combat attacks made as part of that Fight ability.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Infantry Overseer - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Nighthaunt Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight of Shrouds on Ethereal Steed': {\r\n    effects: [\r\n     // StolenHoursEffect,\r\n     {\r\n      name: `Stolen Hours - Passive`,\r\n      desc: `Effect: Each time this unit uses a Fight ability, after that Fight ability has been resolved, Heal (X) this unit, where X is the number of damage points allocated to enemy units by combat attacks made as part of that Fight ability.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    {\r\n      name: `Cavalry Overseer - Reaction: You declared a Fight ability for this unit`,\r\n      desc: `Effect: Pick a friendly non-Hero Nighthaunt Cavalry or War Machine unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Craventhrone Guard': {\r\n    effects: [\r\n      {\r\n        name: `Spectral Bolts - Passive`,\r\n        desc: `Effect: This unit can pick enemy units to be the targets of shooting attacks even if they are not visible to this unit. In addition, ignore negative modifiers to hit rolls for this units shooting attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Guardian of Souls': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Spectral Lure'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Nightmare Lantern - Passive`,\r\n        desc: `Effect: While this unit is in combat, add 1 to wound rolls for combat attacks made by friendly Nighthaunt units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spirit Torment': {\r\n    effects: [\r\n      {\r\n        name: `Captured Soul Energy - Passive`,\r\n        desc: `Effect: Each time a friendly Nighthaunt unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Chainghasts: {\r\n    effects: [\r\n     // GenericEffects.Elite,\r\n      {\r\n        name: `Another Link in the Chain`,\r\n        desc: `Effect: Roll a dice. Add 1 to the roll if this unit is wholly within 12\" of any friendly Spirit Torments. On a 3+, for the rest of the turn, add 1 to hit rolls for combat attacks made by friendly Nighthaunt units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreadblade Harrow': {\r\n    effects: [\r\n      {\r\n        name: `Phantasmal Discorporation`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Curse of Loyalty - Passive`,\r\n        desc: `Effect: If this unit charged this turn, add 3 to the control scores of friendly Nighthaunt units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n        //rule_sources: [rule_sources.BATTLETOME_NIGHTHAUNT, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Lord Executioner': {\r\n    effects: [\r\n      {\r\n        name: `Staring Death in the Face - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from the Attacks characteristic of the targets melee weapons for the rest of the turn. In addition, if the target is a Hero, subtract 5 from the targets control score for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Banshee': {\r\n    effects: [\r\n      {\r\n        name: `Ghostly Howl - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by attacks made with this units Piercing Scream to be the target. \r\n        Effect: Roll a dice. On a 2+, the target cannot use commands until the start of your next turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Cacophony of Sorrow - Passive`,\r\n        desc: `Effect: While there are any friendly Myrmourn Banshees units wholly within 12\" of this unit, ignore positive modifiers to the control scores of enemy units within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Cairn Wraith': {\r\n    effects: [\r\n      {\r\n        name: `Eager Death-Dealers - Passive`,\r\n        desc: `Effect: While this unit is in combat, add 1 to the Attacks characteristic of melee weapons used by friendly Grimghast Reapers while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glaivewraith Stalkers': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n      {\r\n        name: `The Point of Death - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit to be the target. \r\n        Effect: The target has the Stalked keyword for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Unerring Hunters - Reaction: You declared a Charge ability for this unit and a Stalked enemy unit is within 12\" of it`,\r\n        desc: `Effect: Add 2 to charge rolls for this unit made as part of that ability, but this unit must end the move in combat with the Stalked enemy unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grimghast Reapers': {\r\n    effects: [\r\n      {\r\n        name: `Reaped Like Corn - Passive`,\r\n        desc: `Effect: This units combat attacks score critical hits on unmodified hit rolls of 5+ while the target unit has 5 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Chainrasps: {\r\n    effects: [\r\n      {\r\n        name: `Chilling Horde - Passive`,\r\n        desc: `Effect: Add 1 to wound rolls for this units combat attacks if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ChillingHordeEffect,\r\n    ],\r\n  },\r\n  'Bladegheist Revenants': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n      {\r\n        name: `Thrashing Desperation - Passive`,\r\n        desc: `Effect: If this unit charged this turn, add 1 to the Attacks characteristic of this units melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Myrmourn Banshees': {\r\n    effects: [\r\n   //   GenericEffects.Elite,\r\n      {\r\n        name: `Spell-Eaters - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Nighthaunt unit wholly within 12\" of this unit was picked to be the target of that spell, this unit can use the Unbind ability as if it had Wizard (1). Add 1 to the unbinding roll for that ability. If the spell is unbound, inflict D3 mortal damage on the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreadscythe Harridans': {\r\n    effects: [\r\n      {\r\n        name: `Harrowing Shriek - Passive`,\r\n        desc: `Effect: If this unit charged in the same turn, subtract 1 from wound rolls for attacks made by enemy units while they are in combat with this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Murderous Bloodlust - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units combat attacks while it is in combat with any damaged enemy units or while it is in combat with any enemy units that had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spirit Hosts': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n      {\r\n        name: `Drawn to War - Passive`,\r\n        desc: `Effect: Friendly Nighthaunt Infantry Heroes have Ward (4+) while they are wholly within this units combat range.`,\r\n        when: [DURING_GAME],\r\n       // rule_sources: [rule_sources.BATTLETOME_NIGHTHAUNT, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n    ],\r\n  },\r\n  Hexwraiths: {\r\n    effects: [\r\n      {\r\n        name: `Spectral Hunters`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Coach': {\r\n    effects: [\r\n      {\r\n        name: `Nimbus of Power`,\r\n        desc: `Effect: If this unit is not in combat, remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death`,\r\n        desc: `Declare: If this unit destroyed any enemy units this turn, pick a friendly non-Unique Nighthaunt Hero that has been destroyed. .\r\n        Effect: Set up a replacement unit wholly within 12\" of this unit. The replacement unit can only be set up in combat with enemy units that are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Runaway Coach`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage equal on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'The Briar Queen': {\r\n mandatory: {\r\n      spells: [keyPicker(spells, ['Howling Vortex'])],\r\n    }, \r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Grasping Chains`,\r\n        desc: `Before you allocate a wound or mortal wound to this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to this unit, if this unit is within 3\" of its retinue, roll a dice. On a 1-2, that wound or mortal wound is allocated to this unit as normal. On a 3+, that wound or mortal wound is allocated to this unit's retinue instead of this unit.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Thorns of the Briar Queen': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Varclav the Cruel is the unit champion. Add 1 to the Attacks characteristic of that model's Malignant Weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ChillingHordeEffect,\r\n    ],\r\n  }, */\r\n  'Krulghast Cruciator': {\r\n    effects: [\r\n      {\r\n        name: `Empowered Through Excruciation - Passive`,\r\n        desc: `Effect: Ignore the first damage point that would be allocated to each friendly Nighthaunt unit wholly within 12\" of this unit in each phase.`,\r\n        when: [DURING_GAME],\r\n       //  rule_sources: [rule_sources.BATTLETOME_NIGHTHAUNT, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Pyregheists': {\r\n    effects: [\r\n      {\r\n        name: `Light a Pyre`,\r\n        desc: `Declare: If this unit is contesting an objective, pick a visible enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Add a number equal to the roll to this units control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n       //  rule_sources: [rule_sources.BATTLETOME_NIGHTHAUNT, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n    ],\r\n  },\r\n /* Mourngul: {\r\n    effects: [\r\n      {\r\n        name: `Devourer of Flesh and Souls`,\r\n        desc: `At the end of the combat phase, if any enemy models were slain by wounds inflicted by this model's attacks in that combat phase, you can heal up to D3 wounds allocated to this model.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ethereal`,\r\n        desc: `Ignore modifiers (positive and negative) when making save rolls for attacks that target this model.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Frightful Touch`,\r\n        desc: `If the unmodified hit roll for an attack made with this model's Nightmarish Claws and Fangs is 6, that attack causes 2 mortal wounds to the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ghastly Apparition`,\r\n        desc: `Subtract 1 from hit rolls for attacks made by enemy units while they are within 6\" of any friendly models with this ability.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: The Summerking`s Entourage': {\r\n    effects: [\r\n      {\r\n        name: `Ushoran: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Monstrous Talons is 6.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Epicentre of Delusion`,\r\n          desc: `Effect: Pick 1 of the following effects to apply until the start of your next turn: \r\n          The Royal Hunt: Add 1 to wound rolls for attacks made by friendly Flesh-eater Courts units that target a Monster. \r\n          Crusading Army: Add 1 to run rolls and charge rolls for friendly Flesh-eater Courts units. \r\n          Defenders of the Realm: Add 1 to save rolls for friendly Flesh-eater Courts units while they are contesting an objective you control. \r\n          The Grand Tournament: Add 1 to hit rolls for attacks made by other friendly Flesh-eater Courts Heroes if they charged in the same turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Shroudcage Fragment - Once Per Turn`,\r\n          desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n          Effect: Roll a dice for each target. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Glimpse of Delusion: Casting value of 7`,\r\n          desc: `Declare: Pick a visible enemy model within 18\" of this unit to be the target, pick another enemy unit within the targets combat range to be the victim, then make a casting roll of 2D6. \r\n          Effect: Pick 1 of the targets melee weapons. Immediately resolve combat attacks made with that weapon against the victim.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Armoury of Madness - Reaction: You declared a Fight ability for this unit`,\r\n          desc: `Effect: If any damage points inflicted by attacks made as part of that Fight ability are allocated to any enemy units, those enemy units cannot use commands until the start of your next turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Royal Bodyguard - Passive`,\r\n          desc: `Effect: While any friendly Flesh-eater Courts Heroes are wholly within this units combat range, both this unit and those Heroes have Ward (5+).`,\r\n          when: [DURING_GAME],\r\n        },\r\n        {\r\n          name: `Morbheg Kinghts: Shrieking Charge`,\r\n          desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of this unit to be the target. \r\n          Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n          when: [CHARGE_PHASE],\r\n        },\r\n        {\r\n          name: `Morbheg Knights: Predator's Pounce - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Deranged Transformation: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to cast this spell, pick another visible unit in this Regiment of Renown wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn:  \r\n          Add 2\" to the targets Move characteristic.  \r\n          Add 1 to wound rolls for the targets combat attacks.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Maddening Radiance - Passive`,\r\n          desc: `Effect: Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown while they are wholly within 12\" of the Ushoran in this Regiment of Renown.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Summon Deluded Throngs - Once Per Battle`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to use this ability, then pick another unit in this Regiment of Renown that has been destroyed to be the target. \r\n          Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 6\" of a battlefield edge and more than 9\" from all enemy units. The replacement unit is part of this Regiment of Renown.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Jerrion`s Delegation': {\r\n    effects: [\r\n      {\r\n        name: `Marrowscroll Herald: The King's Entreaty - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Attack the Apostate!: Friendly Flesh-eater Courts units in combat with the target have Strike-first for the rest of the turn. \r\n        Welcome the Disciple!: The target has the Infected keyword for the rest of the battle. Each time your opponent declares a command, Spell ability or Prayer ability for an Infected unit, roll a dice. On a 5+:  \r\n        If they declared a command, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.  \r\n        If they declared a Spell or Prayer ability, that spell or prayer fails.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Marrowscroll Herald: Don't Shoot the Messenger - Passive`,\r\n        desc: `Effect: While this unit is not in combat and is wholly within the combat ranges of 3 or more other friendly Flesh-eater Courts Infantry models, it is not visible to enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Crypt Ghouls: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Horrors: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Flayers: Escort Courtier - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a friendly Flesh-eater Courts Infantry Hero that does not have Fly and is within this units combat range to be the target. \r\n        Effect: Remove the target from the battlefield. Then, this unit can move a distance up to its Move characteristic. It cannot end that move in combat. Then, set up the target within this units combat range and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Urgent Missive - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown can use Charge abilities even if they used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on units in this Regiment of Renown by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Liche`s Hand': {\r\n    effects: [\r\n      {\r\n        name: `Arkhan: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Razaraks Ebon Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: The Doom of Traitors - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is a Hero, double the amount of mortal damage inflicted.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  FeasterOfSoulsEffect,\r\n      {\r\n        name: `Arkhan: Staff of Spirits - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit. Each time this unit successfully casts a spell, Heal (1) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Curse of Years: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 10 dice. For each 6:  \r\n        Inflict 1 mortal damage on the target.  \r\n        Roll an extra dice. \r\n        For each 5+ on those extra dice, repeat the above bullet points. Then, do the same for each 4+, then each 3+, then each 2+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Mortarch of Sacrament - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Ossiarch Bonereapers unit wholly within 18\" of this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on that unit. This unit can use this ability more than once per phase but only once per Spell ability`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Ebon-Wrought Armour - Passive`,\r\n        desc: `Effect: This unit has Ward (3+) against damage points inflicted by Spell abilities, Prayer abilities and abilities used by Manifestations. If you make a successful ward roll for this unit, or if this unit destroys an enemy Manifestation, give this unit an arcane charge token. This unit cannot have more than 1 arcane charge token at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Discharge Armour`,\r\n        desc: `Declare: If this unit has an arcane charge token, pick a friendly Ossiarch Bonereapers Wizard wholly within 12\" of this unit to be the target. \r\n        Effect: Remove this units arcane charge token, then add 1 to casting rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Harbingers: Harbingers of Death - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Skeletal Splintering: Casting value of 8 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Arkhan the Black in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unholy Sacraments - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making banishment rolls for the Arkhan the Black in this Regiment of Renown, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Scions of the Necropolis': {\r\n    effects: [\r\n      {\r\n        name: `Katakros: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Inda-Khaat is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Katakros: Prime Necrophoros - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Ossiarch Bonereapers units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Katakros: Aviarch Spymaster - Once Per Turn - Reaction: Opponent declared a command for a unit within 18\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 5+, that command has no effect, it still counts as having been used and the command points spent to use it are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Katakros: Command Ability - Supreme Lord of the Bonereaper Legions`,\r\n        desc: `Declare: Pick up to 3 friendly Ossiarch Bonereapers units wholly within 18\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, add 1 to save rolls for the targets while they are wholly within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Immortis Guard: Soulbound Protectors - Passive`,\r\n        desc: `Effect: Add 1 to ward rolls for friendly Ossiarch Bonereapers Heroes within this units combat range. However, each time you make a ward roll of 1 for a friendly Ossiarch Bonereapers Hero within this units combat range, allocate 1 damage point to this unit after the damage sequence for that Hero has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bulwark of the Necropolis`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Subtract 2D6 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Neferata`s Royal Echelon': {\r\n    effects: [\r\n      {\r\n        name: `Neferata: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Nagadrons Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n        {\r\n          name: `Neferata: Twilight's Allure - Passive`,\r\n          desc: `Effect: Subtract 1 from hit rolls for combat attacks that target friendly Soulblight Gravelords units while they are wholly within 6\" of this unit.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Neferata: Mortarch of Blood`,\r\n          desc: `Declare: Pick up to 3 friendly Deathrattle Infantry or Deadwalkers Infantry units to be the targets. \r\n          Effect: Each target can use the Normal Move ability as if it were your movement phase.`,\r\n          when: [DURING_SETUP],\r\n        },\r\n        {\r\n          name: `Neferata: The Adevore - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy Hero that was allocated any damage points inflicted by this units Akmet-har this turn to be the target. \r\n          Effect: Roll a dice. On a 5+, the target is automatically destroyed.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Neferata: Dark Mist: Casting value of 7`,\r\n          desc: `Declare: Pick a visible friendly non-Monster Soulblight Gravelords unit wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n          Effect: Ignore modifiers to save rolls for the target (positive and negative) until the start of your next turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Black Knights: The Deathly Charge - Passive`,\r\n          desc: `Effect: If this unit charged this turn, its Barrow Lances have Crit (Mortal) for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Deathrattle Skeletons: Skeleton Legion`,\r\n          desc: `Effect: You can return D3 slain models to this unit.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Soulpike: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Neferata in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn, each time the target uses a Charge ability, immediately after that ability has been resolved, roll a number of dice equal to the unmodified charge roll for that ability. For each 4+, inflict 1 mortal damage on the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Premeditated Demise - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy unit within 12\" of the Neferata in this Regiment of Renown to be the target. \r\n          Effect: Until the start of your next turn, ward rolls cannot be made for damage points inflicted on the target by attacks made by units in this Regiment of Renown.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `The Blood Queen's Will - Once Per Battle`,\r\n          desc: `Declare: Pick an enemy unit contesting an objective that the Neferata in this Regiment of Renown is contesting to be the target. \r\n          Effect: Roll a dice. On a 2-5, subtract 10 from the control score of the target for the rest of the turn. On a 6, the target has a maximum control score of 1 for the rest of the turn.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: The Sternieste Garrison': {\r\n    effects: [\r\n      {\r\n        name: `Mannfred Von Carstein: Wind of Death: Casting value of 7`,\r\n        desc: `Declare: Pick a point on the battlefield within 18\" of the caster, pick up to 3 visible enemy units within 6\" of that point to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Sword of Unholy Power - Passive`,\r\n        desc: `Effect: If this unit has slain any enemy models this turn, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Deathrattle and Deadwalkers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Mortarch of Night - Reaction: You declared the Redeploy command for a Soulblight Gravelords unit wholly within 12\" of this unit`,\r\n        desc: `Effect: The unit using the Redeploy command can move into combat when using that ability.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Ashigaroths Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Ashigaroth's Hunger - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fell Bats: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n        {\r\n          name: `Fell Bats: Fleet and Fell - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Stalking Blades: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Mannfred von Carstein in this Regiment of Renown to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Inflict 1 mortal damage on the target for each other enemy unit within 3\" of the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Engulfing Shadows - Passive`,\r\n          desc: `Effect: Each time a unit in this Regiment of Renown is set up, add 1 to the Attacks characteristic of that units melee weapons for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Cover of Night - Once Per Turn`,\r\n          desc: `Declare: Pick 1 friendly unit in this Regiment of Renown that is not in combat to be the target. \r\n          Effect: Remove that unit from the battlefield and set it up again more than 6\" from all enemy units.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Veremord`s Shamblers': {\r\n    effects: [\r\n      {\r\n        name: `Corpse Cart: Locus of Undeath - Passive`,\r\n        desc: `Effect: Melee weapons used by other friendly Deadwalkers units have Crit (Auto-wound) while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Deadwalker Zombies: Mindless Ferocity - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 6+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vitiating Vapours - Passive`,\r\n        desc: `Effect: Subtract 1 from ward rolls for enemy units while they are within 12\" of the Corpse Cart in this Regiment of Renown.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Legend Among Graverobbers`,\r\n        desc: `Declare: Pick the Corpse Cart in this Regiment of Renown to use this ability if it is within 3\" of the Deadwalker Zombies unit in this Regiment of Renown. Then, pick each enemy Infantry, Cavalry and Beast unit within 12\" of the Corpse Cart to be the targets. \r\n        Effect: For each target that had any models slain this turn, you can return D3 slain models to the Deadwalker Zombies unit in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import request from 'superagent'\r\nimport { ICurrentArmy } from 'types/army'\r\nimport { TImportFileTypes, TImportParsers } from 'types/import'\r\nimport { ISavedArmy } from 'types/savedArmy'\r\nimport { isDev } from 'utils/env'\r\n\r\nconst devEndpoint = `https://bgj1fpqcj6.execute-api.us-east-1.amazonaws.com/dev`\r\nconst prodEndpoint = `https://mzrv8apqrd.execute-api.us-east-1.amazonaws.com/prod`\r\n\r\nconst api = isDev ? devEndpoint : prodEndpoint\r\n\r\ninterface ICreateError {\r\n  fileTxt: string | string[]\r\n  fileType: TImportFileTypes\r\n  parser: TImportParsers\r\n}\r\n\r\ninterface ICreateItem {\r\n  userName: string\r\n  [key: string]: any\r\n}\r\n\r\ninterface ICreateSavedArmy extends ISavedArmy {\r\n  userName: string\r\n}\r\n\r\ninterface IUpdateItem {\r\n  [key: string]: any\r\n}\r\n\r\nconst createErrorFile = (data: ICreateError) => request.post(`${api}/errors`).send(data)\r\nconst createItem = (data: ICreateItem) => request.post(`${api}/items`).send(data)\r\nconst createLink = (data: Record<string, any>) => request.post(`${api}/links`).send(data)\r\nconst createSavedArmy = (data: ICreateSavedArmy) => request.post(`${api}/items`).send(data)\r\nconst deleteItem = (id: string, userName: string) => request.delete(`${api}/items/${id}/${userName}`)\r\nconst getItem = (id: string) => request.get(`${api}/items/${id}`)\r\nconst getLinkedArmy = (id: string) => request.get(`${api}/links/${id}`)\r\nconst getUserItems = (userName: string) => request.get(`${api}/user/${userName}`)\r\nconst saveArmyToS3 = (data: ICurrentArmy) => request.post(`${api}/save`).send(data)\r\nconst updateItem = (id: string, data: IUpdateItem) => request.post(`${api}/update/`).send({ ...data, id })\r\n\r\nexport const PreferenceApi = {\r\n  createErrorFile,\r\n  createItem,\r\n  createLink,\r\n  createSavedArmy,\r\n  deleteItem,\r\n  getItem,\r\n  getLinkedArmy,\r\n  getUserItems,\r\n  saveArmyToS3,\r\n  updateItem,\r\n}\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  // Lore of the Deathmages\r\n  'Overwhelming Dread (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelming Dread (Deathmages)`,\r\n        desc: `Casting value of 5. Pick an enemy unit within 18\" of the caster that is visible to them. Until your next hero phase, subtract 1 from hit rolls for that unit and subtract 1 from that unit's Bravery characteristic.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fading Vigour (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Fading Vigour (Deathmages)`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 18\" of the caster that is visible to them. Until the start of your next hero phase, subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1), and roll only a single dice when making charge rolls for it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spectral Grasp (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Spectral Grasp (Deathmages)`,\r\n        desc: `Casting value of 6. Pick 1 terrain feature wholly within 18\" of the caster that is visible to them. Until your next hero phase, if an enemy unit starts a normal move within 3\" of that terrain feature, halve the Move characteristic (rounding down) of that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Prison of Grief (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Prison of Grief (Deathmages)`,\r\n        desc: `Casting value of 7. Pick an enemy unit within 12\" of the caster that is visible to them. Until your next hero phase, before a unit affected by any Prison of Grief spells moves, roll a D6. On a 5+ the unit may not move in that phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Decrepify (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Decrepify (Deathmages)`,\r\n        desc: `Casting value of 6. Pick an enemy HERO within 18\" of the caster that is visible to them. Until your next hero phase, subtract 1 from wound rolls made for that model and subtract 1 from the Damage characteristics of that model's melee weapons (to a minimum of 1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul Harvest (Deathmages)': {\r\n    effects: [\r\n      {\r\n        name: `Soul Harvest (Deathmages)`,\r\n        desc: `Casting value of 7. Each enemy unit within 3\" of the caster suffers D3 mortal wounds. Then, roll a D6 for each mortal wound that was allocated to an enemy unit and not negated. For each 5+, heal 1 wound that has been allocated to the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Lore of the Vampires\r\n  'Blades of Shyish (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Blades of Shyish (Vampires)`,\r\n        desc: `Casting value of 5. Roll a D6 for each enemy unit within 12\" of the caster. On a 5+ that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spirit Gale (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Spirit Gale (Vampires)`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 12\" of the caster that is visible to them and roll 3 dice. For each 5+, that unit suffers 1 mortal wound. In addition, if 2 of these dice show the same number, subtract 1 from hit rolls for that unit until your next hero phase. If all 3 dice show the same number, subtract 1 from hit and wound rolls for that unit until your next hero phase instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vile Transference (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Vile Transference (Vampires)`,\r\n        desc: `Casting value of 7. Pick an enemy unit within 12\" of the caster that is visible to them, and a friendly DEATH unit within 6\" of that enemy unit. The enemy unit suffers D3 mortal wounds. Then, for each of these wounds that was allocated and not negated, you can heal 1 wound allocated to the friendly unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amethystine Pinions (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Amethystine Pinions (Vampires)`,\r\n        desc: `Casting value of 5. Until your next hero phase add 5\" to the caster's Move characteristic and the caster can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soulpike (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Soulpike (Vampires)`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 18\" of the caster that is visible to them. Until your next hero phase, after a unit affected by any Soulpike spells makes a charge move, roll a number of dice equal to the result of their charge roll. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amaranthine Orb (Vampires)': {\r\n    effects: [\r\n      {\r\n        name: `Amaranthine Orb (Vampires)`,\r\n        desc: `Casting value of 7. Pick a point on the battlefield within 12\" of the caster and draw an imaginary straight line 1mm wide between that point and the closest part of the caster. Roll a D6 for each unit (friend or foe, apart from the caster) that has any models beneath this line. On a 4+ that unit suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Hand of Dust': {\r\n    effects: [\r\n      {\r\n        name: `Hand of Dust`,\r\n        desc: `Casting value of 8 and range of 3\". Pick 1 enemy model within range and visible to the caster. Then, take a dice and hide it in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one holding the dice, the spell has no effect. If they pick the empty hand or container, the enemy model is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* 'Soul Stealer': {\r\n    effects: [\r\n      {\r\n        name: `Soul Stealer`,\r\n        desc: `Casting value of 6 and range of 24\". Pick 1 enemy unit within range and visible to the caster and roll 2D6. If the roll is greater than that unit's Bravery characteristic, it suffers D3 mortal wounds. If the roll is at least double that unit's Bravery characteristic, it suffers D6 mortal wounds instead. You can heal up to 1 wound that has been allocated to the caster for each mortal wound caused by this spell that is not negated.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  'Curse of Years': {\r\n    effects: [\r\n      {\r\n        name: `Curse of Years`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster and roll 10 dice. For each 6, that unit suffers 1 mortal wound and you can roll another dice. For each 5+ on these extra dice, the target suffers 1 mortal wound and you can roll another dice. Now, for each 4+, the target suffers 1 mortal wound and you can roll another dice. Keep rolling dice in this way, causing mortal wounds and reducing the roll needed to cause them by 1 each time, until either no mortal wounds are caused or the target unit is destroyed. A roll of 1 always fails to cause a mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Wind of Death': {\r\n    effects: [\r\n      {\r\n        name: `Wind of Death`,\r\n        desc: `Casting value of 7. Pick an enemy model within 18\" of the caster that is visible to them. Each enemy unit within 6\" of that model suffers 1 mortal wound, while the model's own unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dark Mist': {\r\n    effects: [\r\n      {\r\n        name: `Dark Mist`,\r\n        desc: `Casting value of 6. Pick a friendly DEATH unit within 18\" of the caster. Until your next hero phase, that unit can fly and you must ignore modifiers (positive or negative) when making save rolls for the unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Quickblood: {\r\n    effects: [\r\n      {\r\n        name: `Quickblood`,\r\n        desc: `Casting value of 7. Add 1 to hit and wound rolls for the caster until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Boil': {\r\n    effects: [\r\n      {\r\n        name: `Blood Boil`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 18\" of the caster that is visible to them. That unit suffers a mortal wound. If a model was allocated any wounds caused by this spell but was not slain, roll another dice. On a 4+ that model suffers another mortal wound. If the model is still not slain, roll another dice. It will suffer another mortal wound on a 4+. Keep rolling dice in this way until either the model is slain or you fail to cause a mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Siphon': {\r\n    effects: [\r\n      {\r\n        name: `Blood Siphon`,\r\n        desc: `Casting value of 6. Pick an enemy HERO within 12\" of the caster that is visible to them and roll a D6. On a 1-3 the hero suffers a mortal wound. On a 4-5 the hero suffers D3 mortal wounds. On a 6 the hero suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Beguile: {\r\n    effects: [\r\n      {\r\n        name: `Beguile`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 12\" of the caster that is visible to them and roll three dice. If the total is higher than that unit's Bravery, then until your next hero phase the caster cannot be selected as the target of any attacks made by that unit or spells cast by that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Vanhel's Danse Macabre\": {\r\n    effects: [\r\n      {\r\n        name: `Vanhel's Danse Macabre`,\r\n        desc: `Casting value of 6. Pick a friendly SUMMONABLE unit within 18\" of the caster. That unit can be chosen to pile in and attack twice in your next combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { ITheme } from 'types/theme'\r\n\r\nconst selectTheme = {\r\n  /*\r\n   * control/backgroundColor\r\n   * menu/backgroundColor\r\n   * option/color(selected)\r\n   */\r\n  neutral0: '#182633', // $themeDarkBlueSecondary in theme.scss\r\n\r\n  /*\r\n   * control/borderColor(disabled)\r\n   * multiValue/backgroundColor\r\n   * indicators(separator)/backgroundColor(disabled)\r\n   */\r\n  neutral10: 'slategrey',\r\n\r\n  /*\r\n   * control/borderColor\r\n   * option/color(disabled)\r\n   * indicators/color\r\n   * indicators(separator)/backgroundColor\r\n   * indicators(loading)/color\r\n   */\r\n  neutral20: 'slategrey',\r\n\r\n  /*\r\n   * placeholder/color\r\n   */\r\n  neutral50: 'white',\r\n\r\n  /*\r\n   * input/color\r\n   * multiValue(label)/color\r\n   * singleValue/color\r\n   * indicators/color(focused)\r\n   * indicators/color:hover(focused)\r\n   */\r\n  neutral80: 'white',\r\n  // neutral90: 'white',\r\n\r\n  /*\r\n   * control/boxShadow(focused)\r\n   * control/borderColor(focused)\r\n   * control/borderColor:hover(focused)\r\n   * option/backgroundColor(selected)\r\n   * option/backgroundColor:active(selected)\r\n   */\r\n  primary: 'white',\r\n\r\n  /*\r\n   * option/backgroundColor(focused)\r\n   */\r\n  primary25: 'slategrey',\r\n\r\n  /*\r\n   * option/backgroundColor:active\r\n   */\r\n  primary50: '#93A9FA', // $themeYellow\r\n}\r\n\r\nconst bgColor = `bg-themeDarkBlueSecondary`\r\n\r\nconst DarkTheme: ITheme = {\r\n  bgColor,\r\n  card: `card border border-dark`,\r\n  cardBody: `card-body ${bgColor}`,\r\n  cardHeader: `card-header bg-themeLightBlue text-white`,\r\n  dropzone: `dropzone-dark`,\r\n  genericButton: `btn btn-outline-light`,\r\n  genericButtonBlock: `btn btn-outline-light btn-block`,\r\n  headerColor: bgColor,\r\n  modalConfirmClass: `btn btn-outline-light`,\r\n  modalDangerClass: `btn btn-danger`,\r\n  modalSuccessClass: `btn btn-outline-success`,\r\n  noteBorder: `NoteBorder-Dark`,\r\n  profileCardHeader: `card-header bg-profileHeader text-dark mb-0 pb-1`,\r\n  reminderHeader: `bg-themeLightBlue`,\r\n  reminderHr: `ReminderHr-Dark`,\r\n  secondaryButton: `btn btn-sm btn-outline-secondary`,\r\n  selectTheme,\r\n  text: `text-white`,\r\n  textMuted: `text-white-75`,\r\n  textOpposite: `text-dark`,\r\n  textSecondary: `text-light`,\r\n  tooltip: 'light',\r\n}\r\n\r\nexport default DarkTheme\r\n","import { ITheme } from 'types/theme'\r\n\r\nconst bgColor = `bg-white`\r\n\r\nconst LightTheme: ITheme = {\r\n  bgColor,\r\n  card: `card`,\r\n  cardBody: `card-body ${bgColor}`,\r\n  cardHeader: `card-header bg-themeLightBlue text-white`,\r\n  dropzone: `dropzone`,\r\n  genericButton: `btn btn-outline-dark`,\r\n  genericButtonBlock: `btn btn-outline-dark btn-block`,\r\n  headerColor: `bg-themeDarkBluePrimary`,\r\n  modalConfirmClass: `btn btn-outline-dark`,\r\n  modalDangerClass: `btn btn-outline-danger`,\r\n  modalSuccessClass: `btn btn-success`,\r\n  noteBorder: `NoteBorder`,\r\n  profileCardHeader: `card-header bg-profileHeader text-dark mb-0 pb-1`,\r\n  reminderHeader: `bg-themeDarkBluePrimary`,\r\n  reminderHr: `ReminderHr`,\r\n  secondaryButton: `btn btn-sm btn-outline-secondary`,\r\n  selectTheme: {},\r\n  text: `text-dark`,\r\n  textMuted: `text-muted`,\r\n  textOpposite: `text-white`,\r\n  textSecondary: `text-secondary`,\r\n  tooltip: 'error',\r\n}\r\n\r\nexport default LightTheme\r\n","import { SubscriptionApi } from 'api/subscriptionApi'\r\nimport { useSubscription } from 'context/useSubscription'\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport DarkTheme from 'theme/dark'\r\nimport LightTheme from 'theme/light'\r\nimport { ITheme, TThemeType } from 'types/theme'\r\nimport { logEvent } from 'utils/analytics'\r\nimport { LocalTheme } from 'utils/localStore'\r\n\r\ninterface IThemeProvider {\r\n  isDark: boolean\r\n  isLight: boolean\r\n  setDarkTheme: () => void\r\n  setLightTheme: () => void\r\n  theme: ITheme\r\n  toggleTheme: () => void\r\n}\r\n\r\nconst ThemeContext = React.createContext<IThemeProvider | void>(undefined)\r\n\r\nconst ThemeProvider = ({ children }: React.PropsWithChildren<{}>) => {\r\n  const { subscription } = useSubscription()\r\n  const [theme, setTheme] = useState(LocalTheme.get() === 'dark' ? DarkTheme : LightTheme)\r\n  const [isDark, setIsDark] = useState(LocalTheme.get() === 'dark')\r\n\r\n  const setLightTheme = useCallback(() => {\r\n    setTheme(LightTheme)\r\n    setIsDark(false)\r\n  }, [])\r\n  const setDarkTheme = useCallback(() => {\r\n    setTheme(DarkTheme)\r\n    setIsDark(true)\r\n  }, [])\r\n\r\n  const toggleTheme = useCallback(() => {\r\n    const theme = isDark ? 'light' : 'dark'\r\n    LocalTheme.set(theme)\r\n    const { id, userName } = subscription\r\n    Promise.resolve(SubscriptionApi.updateTheme({ id, userName, theme }))\r\n    logEvent(`SetTheme-${theme}`)\r\n    return isDark ? setLightTheme() : setDarkTheme()\r\n  }, [subscription, isDark, setDarkTheme, setLightTheme])\r\n\r\n  const setThemeFromValue = useCallback(\r\n    (val: TThemeType | null) => {\r\n      return val === 'dark' ? setDarkTheme() : setLightTheme()\r\n    },\r\n    [setLightTheme, setDarkTheme]\r\n  )\r\n\r\n  // Fetch our theme from the subscription API\r\n  useEffect(() => {\r\n    if (subscription && subscription.theme) {\r\n      LocalTheme.set(subscription.theme) // Update local value\r\n      setThemeFromValue(subscription.theme)\r\n    }\r\n  }, [subscription, setThemeFromValue])\r\n\r\n  // Assign our theme's bgColor to the root element\r\n  useEffect(() => {\r\n    const element = document.getElementById('root')\r\n    if (element) element.className = theme.bgColor\r\n  }, [theme.bgColor])\r\n\r\n  // Fetch our theme from the local store\r\n  useEffect(() => {\r\n    const theme = LocalTheme.get()\r\n    setThemeFromValue(theme)\r\n  })\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      isDark,\r\n      isLight: !isDark,\r\n      setDarkTheme,\r\n      setLightTheme,\r\n      theme,\r\n      toggleTheme,\r\n    }),\r\n    [isDark, setDarkTheme, setLightTheme, theme, toggleTheme]\r\n  )\r\n\r\n  return <ThemeContext.Provider value={value}>{children}</ThemeContext.Provider>\r\n}\r\n\r\nconst useTheme = () => {\r\n  const context = React.useContext(ThemeContext)\r\n  if (context === undefined) {\r\n    throw new Error('useTheme must be used within a ThemeProvider')\r\n  }\r\n  return context\r\n}\r\n\r\nexport { ThemeProvider, useTheme }\r\n","import { SUPPORTED_FACTIONS, TSupportedFaction } from 'meta/factions'\r\nimport { ICurrentArmy } from 'types/army'\r\nimport { IImportedArmy } from 'types/import'\r\nimport { INote } from 'types/notes'\r\nimport { ISavedArmy } from 'types/savedArmy'\r\nimport { IAllySelections } from 'types/selections'\r\nimport { LocalReminderOrder } from 'utils/localStore'\r\n\r\nexport const armyHasEntries = (army: ISavedArmy | ICurrentArmy, notes: INote[]) => {\r\n  const { allySelections, origin_realm, realmscape_feature, realmscape, selections } = army\r\n\r\n  if (notes.length > 0) return true\r\n  if (Object.values(selections).some(x => x.length)) return true\r\n  if (Object.values(allySelections).some(x => Object.values(x as IAllySelections).some(x => x.length)))\r\n    return true\r\n  if (origin_realm || realmscape || realmscape_feature) return true\r\n\r\n  return false\r\n}\r\n\r\n/**\r\n * Prepare an army to be uploaded\r\n * @param army\r\n */\r\nexport const prepareArmy = (army: ISavedArmy, type: 'save' | 'update', include: string[] = []) => {\r\n  const {\r\n    allyFactionNames,\r\n    allySelections,\r\n    armyName,\r\n    factionName,\r\n    subFactionName = '',\r\n    hiddenReminders = [],\r\n    notes = [],\r\n    orderedReminders = LocalReminderOrder.get(),\r\n    origin_realm = null,\r\n    realmscape = null,\r\n    realmscape_feature = null,\r\n    selections,\r\n  } = army\r\n\r\n  const prepared = {\r\n    allyFactionNames,\r\n    allySelections,\r\n    armyName: armyName || 'Untitled',\r\n    factionName,\r\n    subFactionName,\r\n    hiddenReminders,\r\n    notes,\r\n    orderedReminders,\r\n    origin_realm,\r\n    realmscape_feature,\r\n    realmscape,\r\n    selections,\r\n  }\r\n\r\n  if (type === 'save') return prepared\r\n\r\n  // Prepare for update\r\n  return Object.keys(prepared).reduce((a, k) => {\r\n    if (['factionName', 'armyName'].includes(k)) return a // Don't include these in army updates\r\n    if (!include.length) a[k] = prepared[k] // If there's no include array, include everything\r\n    if (include.includes(k)) a[k] = prepared[k] // If there is an include array, only include... included keys\r\n    return a\r\n  }, {})\r\n}\r\n\r\n/**\r\n * Prepares an army to be uploaded to S3 for later analysis\r\n * We don't store \"extra\" data (notes, ordering, visibility) with these payloads.\r\n * @param army\r\n */\r\nexport const prepareArmyForS3 = (army: ISavedArmy | IImportedArmy | ICurrentArmy): ICurrentArmy => {\r\n  const {\r\n    allyFactionNames = [],\r\n    allySelections = {},\r\n    factionName,\r\n    subFactionName,\r\n    origin_realm = null,\r\n    realmscape = null,\r\n    realmscape_feature = null,\r\n    selections,\r\n  } = army\r\n\r\n  return {\r\n    allyFactionNames,\r\n    allySelections,\r\n    factionName,\r\n    subFactionName,\r\n    origin_realm,\r\n    realmscape_feature,\r\n    realmscape,\r\n    selections,\r\n  }\r\n}\r\n\r\nexport const isValidFactionName = (val: any): val is TSupportedFaction => {\r\n  return val && SUPPORTED_FACTIONS.includes(val)\r\n}\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { END_OF_HERO_PHASE, HERO_PHASE } from 'types/phases'\r\n\r\n// Add Endless spells here\r\nconst EndlessSpells = {\r\n  /*'Shyish Reaper': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 6\". Only Nighthaunt Wizards can attempt to summon this endless spell. If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models and other endless spells or invocations.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Predatory`,\r\n        desc: `This endless spell is a predatory endless spell. You can move it up to 8\" and it can fly. Before moving this endless spell, you can pivot the endless spell on the centre of its base so that it is facing in any direction. This pivot is free and does not count towards the distance the endless spell moves. When you move this endless spell, it must move in a straight line in the direction the tip of the blade is pointing.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Soul Reaper`,\r\n        desc: `After this endless spell has moved, roll 2 dice for each unit that it passed across (including models it moved over when it pivoted) and each other unit that is within 1\" of it at the end of its move. Add 1 to the roll if that unit is terrified. For each roll that is equal to or greater than the unit's Save characteristic, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vault of Souls': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 6\". Only Nighthaunt Wizards can attempt to summon this endless spell. If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models and other endless spells or invocations.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Soul Eruption`,\r\n        desc: `After this endless spell has moved, roll a dice for each model within 6\" of it. Add 1 to the roll if that model's unit is terrified. On a 6+, that model's unit suffers 1 mortal wound. Keep track of the number of mortal wounds caused by this endless spell. If the total is 10 or more at the end of any phase, roll a dice for each unit within 6\" of this endless spell. Add 1 to the roll if that unit is terrified. On a 2+, that unit suffers a number of mortal wounds equal to the roll, then this endless spell is dispelled.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortalis Terminexus': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 12\". Only Nighthaunt Wizards can attempt to summon this endless spell. If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models and other endless spells or invocations.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Keeper of Mortality`,\r\n        desc: `After this endless spell has moved, the player who moved it can decide whether the Mortalis Terminexus will reverse time or hasten time.\r\n\r\n        If they choose to reverse time, heal D3 wounds allocated to each unit within 6\" of this endless spell.\r\n\r\n        If they choose to hasten time, roll a dice for each unit within 6\" of this endless spell. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","export const centerContentClass = `d-flex align-items-center justify-content-center`\r\nexport const navbarStyles = {\r\n  btn: `btn btn btn-outline-light btn-sm mx-2`,\r\n  headerClass: `pt-2 d-print-none d-flex justify-content-center align-items-center`,\r\n  link: `font-weight-bold text-light mx-2`,\r\n}\r\n","import armyReducer from 'ducks/army'\r\nimport factionNamesReducer from 'ducks/factionNames'\r\nimport notesReducer from 'ducks/notes'\r\nimport realmscapeReducer from 'ducks/realmscape'\r\nimport selectionsReducer from 'ducks/selections'\r\nimport visibilityReducer from 'ducks/visibility'\r\nimport { combineReducers, createStore } from 'redux'\r\nimport { persistReducer, persistStore } from 'redux-persist'\r\nimport storage from 'redux-persist/lib/storage'\r\nimport DefaultAppState from 'store/initialAppState'\r\nimport { logMigration } from 'utils/analytics'\r\nimport { LocalSavedArmies } from 'utils/localStore'\r\n\r\nconst rootReducer = combineReducers({\r\n  army: armyReducer,\r\n  factionNames: factionNamesReducer,\r\n  notes: notesReducer,\r\n  realmscape: realmscapeReducer,\r\n  selections: selectionsReducer,\r\n  visibility: visibilityReducer,\r\n})\r\n\r\nconst pReducer = persistReducer(\r\n  {\r\n    key: 'root',\r\n    version: 4,\r\n    storage,\r\n    migrate: async (state, currentVersion) => {\r\n      if (!state) return state\r\n\r\n      const { version: oldVersion } = state._persist\r\n\r\n      // pre-v4 -> v4 Migration\r\n      if (!oldVersion || oldVersion < 4 || !currentVersion || currentVersion < 4) {\r\n        const version = 4\r\n        console.warn(\r\n          'Outdated version of AoS Reminders detected (>=4.0.0 required). Wiping the state clean to avoid potentially fatal crashes.'\r\n        )\r\n\r\n        // Tell Google Analytics what we're doing\r\n        logMigration(version)\r\n\r\n        // Handle locally cached data\r\n        LocalSavedArmies.clear()\r\n\r\n        // Blow the current state away\r\n        return {\r\n          ...DefaultAppState,\r\n          _persist: {\r\n            ...state._persist,\r\n            version,\r\n          },\r\n        }\r\n      }\r\n\r\n      return state\r\n    },\r\n  },\r\n  rootReducer\r\n)\r\n\r\nexport const store = createStore(\r\n  pReducer,\r\n  //@ts-ignore\r\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n)\r\n\r\nexport const persistor = persistStore(store)\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { Nagash } from 'factions/nighthaunt/units'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_TURN,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst getDeathlyInvocation = (numUnits: number) => ({\r\n  name: `Deathly Invocation`,\r\n  desc: `At the start of your hero phase, pick up to ${numUnits} different friendly SUMMONABLE units within ${\r\n    numUnits === 4 ? 18 : numUnits === 3 ? 12 : 6\r\n  }\" of this model. You can heal D3 wounds that have been allocated to each unit you picked (roll separately for each unit). If no wounds are currently allocated to a unit you have picked, you may instead return a number of slain models to it that have a combined Wounds characteristic equal to or less than the roll of a D3.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n})\r\nconst getFrightfulTouchEffect = (weapon: 'Blades' | 'Daggers') => ({\r\n  name: `Frightful Touch`,\r\n  desc: `If the unmodified hit roll for an attack made with this model's Spectral Claws and ${weapon} is 6, that attack inflicts 1 mortal wound on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n})\r\nconst ChaliceOfBloodEffect = {\r\n  name: `Chalice of Blood`,\r\n  desc: `If this model has a Chalice of Blood, then once per battle in your hero phase, you can heal D6 wounds that have been allocated to it.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst TheHungerEffect = {\r\n  name: `The Hunger`,\r\n  desc: `At the end of any combat phase in which this model slew any enemy models, you can heal 1 wound that has been allocated to this model.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst FeasterOfSoulsEffect = {\r\n  name: `Feaster of Souls`,\r\n  desc: `Each time this unit fights, after all of its attacks have been resolved, you can heal up to a number of wounds allocated to this unit equal to the number of wounds and mortal wounds caused by those attacks that were allocated to enemy units (to a maximum of 6).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst HeraldsOfTheAccursedOneEffect = {\r\n  name: `Heralds of the Accursed One`,\r\n  desc: `Subtract 1 from the Bravery characteristic of enemy units whilst they are within 6\" of any MORGHASTS.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst StandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `Models in this unit may be Standard Bearers. Subtract 1 from the Bravery characteristic of enemy units that are within 6\" of any DEATH Standard Bearers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst HornblowerEffect = {\r\n  name: `Hornblower`,\r\n  desc: `Models in this unit may be Hornblowers. A unit that includes any Hornblowers can always move up to 6\" when it charges, unless its charge roll is higher.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst WailOfTheDamnedEffect = {\r\n  name: `Wail of the Damned`,\r\n  desc: `When making a Wail of the Damned attack, roll two dice for each enemy unit within the range shown on the damage table. If the total is higher than that unit's Bravery, it suffers D3 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst CryptSwordEffect = {\r\n  name: `Crypt Sword`,\r\n  desc: `Instead of attacking with his Goad or Lash in the combat phase, you may declare that a Corpsemaster with a Cryptsword will attempt to impale his victim's soul. If he does so, pick an enemy unit within 1\" and roll a D6. On a 5+ the unit you picked suffers a mortal wound.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CryptShieldsEffect = {\r\n  name: `Crypt Shields`,\r\n  desc: `Add 1 to save rolls for a unit carrying Crypt Shields against attacks that have a Rend characteristic of '-'.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  ...Nagash,\r\n /* 'Arkhan the Black, Mortarch of Sacrament': {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Curse of Years'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Wizard`,\r\n        desc: `This unit can attempt to cast 3 spells in your hero phase and attempt to unbind 3 spells in the enemy hero phase. If this unit is part of an Ossiarch Bonereapers army, it knows all of the spells from the Lore of Ossian Sorcery in addition to the other spells it knows.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warmaster`,\r\n        desc: `If this unit is included in an Ossiarch Bonereapers army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      FeasterOfSoulsEffect,\r\n      {\r\n        name: `Staff of Spirits`,\r\n        desc: `Add the Staff of Spirits value shown on this unit's damage table to casting, dispelling and unbinding rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `First of the Mortarchs`,\r\n        desc: `Add 6\" to the range of spells cast by friendly DEATH WIZARDS while they are wholly within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Sacrament`,\r\n        desc: `In your hero phase, you can pick up to 3 different friendly OSSIARCH BONEREAPERS units wholly within 24\" of this unit. If that unit is an Immortis Guard or Necropolis Stalkers unit, you can heal up to 3 wounds allocated to that unit, or if no wounds have been allocated to that unit, roll a dice. On a 3+, you can return 1 slain model to that unit with 4 wounds allocated to it.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  }, */\r\n  'Mannfred, Mortarch of Night': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Vigour of Undeath'])],\r\n      spells: [keyPicker(spells, ['Wind of Death'])],\r\n    },\r\n    effects: [\r\n      FeasterOfSoulsEffect,\r\n      getFrightfulTouchEffect(`Daggers`),\r\n      {\r\n        name: `Armour of Templehof`,\r\n        desc: `The first wound or mortal wound allocated to Mannfred each turn is negated.`,\r\n        when: [DURING_TURN],\r\n      },\r\n      {\r\n        name: `Sword of Unholy Power`,\r\n        desc: `If Mannfred causes any wounds to be allocated using Gheistvor in the combat phase, you can add 1 to the next casting or unbinding roll you make for Mannfred.`,\r\n        when: [COMBAT_PHASE, HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Night`,\r\n        desc: `If Mannfred successfully cast any spells during your hero phase, you can add 1 to all hit and wound rolls for Gheistvor until your next hero phase.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE],\r\n      },\r\n      getDeathlyInvocation(4),\r\n      {\r\n        name: `Magic`,\r\n        desc: `Mannfred is a WIZARD. He can attempt to cast two spells in your hero phase, and attempt to unbind two spells in the enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Wind of Death spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Neferata, Mortarch of Blood': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Twilights Allure'])],\r\n      spells: [keyPicker(spells, ['Dark Mist'])],\r\n    },\r\n    effects: [\r\n      getFrightfulTouchEffect(`Daggers`),\r\n      {\r\n        name: `Dagger of Jet`,\r\n        desc: `If a model is allocated any wounds from attacks made using Akmet-har but is not slain, roll a D6 after Neferata has finished making all of her attacks. On a 6+ that model is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Blood`,\r\n        desc: `At the end of any combat phase in which Neferata slew any models, you can heal 2 wounds that have been allocated to her. If Neferata slew any enemy HERO models this turn, you may heal 1 additional wound allocated to her.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      getDeathlyInvocation(4),\r\n      {\r\n        name: `Magic`,\r\n        desc: `Neferata is a WIZARD. She can attempt to cast two spells in your hero phase, and attempt to unbind two spells in the enemy hero phase. She knows the Arcane Bolt, Mystic Shield and Dark Mist spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Prince Vhordrai': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Fist of Nagash'])],\r\n      spells: [keyPicker(spells, ['Quickblood'])],\r\n    },\r\n    effects: [\r\n      TheHungerEffect,\r\n      // Does not use generic ChaliceOfBlood\r\n      {\r\n        name: `Chalice of Blood`,\r\n        desc: `Once per battle, in your hero phase, you can heal D6 wounds that have been allocated to Prince Vhordrai.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodlance Charge`,\r\n        desc: `If Prince Vhordrai completed a charge this turn, increase the Damage characteristic of his Bloodlance to 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Breath of Shyish`,\r\n        desc: `At the start of your shooting phase, pick an enemy unit within 8\" of this model that is visible to it. Then roll a D6, adding 1 to the result if this model slew any enemy models in the previous combat phase. On a 3+ that unit suffers a number of mortal wounds as shown on the damage table above.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n      getDeathlyInvocation(3),\r\n      {\r\n        name: `Magic`,\r\n        desc: `Prince Vhordrai is a WIZARD. He can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Quickblood spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morghast Harbingers': {\r\n    effects: [\r\n      HeraldsOfTheAccursedOneEffect,\r\n      {\r\n        name: `Harbingers of Death`,\r\n        desc: `When making a charge roll for this unit, you may roll 3 dice instead of 2. In addition, you can declare a charge for this unit if it is within 18\" of the enemy rather than 12\".`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morghast Archai': {\r\n    effects: [\r\n      HeraldsOfTheAccursedOneEffect,\r\n      {\r\n        name: `Ebon-wrought Armour`,\r\n        desc: `Each time you allocate a mortal wound to this unit, roll a D6. On a 5+ the mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vampire Lord on Zombie Dragon': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Dread Knight'])],\r\n      spells: [keyPicker(spells, ['Blood Boil'])],\r\n    },\r\n    effects: [\r\n      ...GenericEffects.ZombieDragon,\r\n      TheHungerEffect,\r\n      {\r\n        name: `Deathlance Charge`,\r\n        desc: `If this model completed a charge this turn, increase the Damage characteristic of its Deathlance to 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ancient Shield`,\r\n        desc: `A model with an Ancient Shield has a Save characteristic of 3+.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      ChaliceOfBloodEffect,\r\n      getDeathlyInvocation(3),\r\n      {\r\n        name: `Magic`,\r\n        desc: `A Vampire Lord on Zombie Dragon is a WIZARD. He can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Blood Boil spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Knights': {\r\n    effects: [\r\n      {\r\n        name: `Kastellan`,\r\n        desc: `The leader of this unit is a Kastellan. Add 1 to the Attacks characteristic of a Kastellan's Templar Lance or Blade.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      StandardBearerEffect,\r\n      HornblowerEffect,\r\n      TheHungerEffect,\r\n      {\r\n        name: `Martial Fury`,\r\n        desc: `If this unit completed a charge this turn, increase the Damage characteristic of its Templar Lances or Blades to D3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodshields`,\r\n        desc: `Add 1 to the save rolls for a unit carrying Bloodshields against attacks that have a Rend characteristic of '-'.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Vargheists: {\r\n    effects: [\r\n      {\r\n        name: `Vargoyle`,\r\n        desc: `The leader of this unit is a Vargoyle. Add 1 to the Attacks characteristic of a Vargoyle's Murderous Fangs and Talons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood-Maddened Feeding Frenzy`,\r\n        desc: `Each time a model from this unit slays an enemy model, roll a D6. On a 6+ it can immediately make one additional attack against the same unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bat Swarms': {\r\n    effects: [\r\n      {\r\n        name: `Cloud of Horror`,\r\n        desc: `Subtract 1 from hit rolls for enemy units that are within 12\" of any Bat Swarms in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Suckers`,\r\n        desc: `At the end of any combat phase in which this unit caused any wounds to be allocated to any enemy models, you can heal all wounds that have been allocated to this unit.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fell Bats': {\r\n    effects: [\r\n      {\r\n        name: `Scent of Gore`,\r\n        desc: `If an enemy model is slain within 6\" of this unit, increase the Attacks characteristic of this unit's Elongated Fangs to 6 for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Vampire Lord': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Blood Feast'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Nightmare`,\r\n        desc: `Some Vampire Lords are mounted on a Nightmare steed; these have a Move of 10\" rather than 5\", and can attack with the Nightmare's Hooves and Teeth.`,\r\n        when: [MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Flying Horror`,\r\n        desc: `Some Vampire Lords have membranous wings; these have a Move of 10\" and can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      TheHungerEffect,\r\n      ChaliceOfBloodEffect,\r\n      getDeathlyInvocation(3),\r\n      {\r\n        name: `Magic`,\r\n        desc: `A Vampire Lord is a WIZARD. They can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. They know the Arcane Bolt and Mystic Shield spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodseeker Palanquin': {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Blood Siphon'])],\r\n    },\r\n    effects: [\r\n      getFrightfulTouchEffect(`Blades`),\r\n      {\r\n        name: `A Fine Vintage`,\r\n        desc: `If an enemy HERO is slain within 9\" of this model, add 1 to the Attacks characteristic of any melee weapons used by friendly SOULBLIGHT units within 12\" of this model until your next hero phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      WailOfTheDamnedEffect,\r\n      getDeathlyInvocation(2),\r\n      {\r\n        name: `Magic`,\r\n        desc: `The Sanguinarch on a Bloodseeker Palanquin is a WIZARD. She can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. She knows the Arcane Bolt, Mystic Shield and Blood Siphon spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Coven Throne': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Tactical Insight'])],\r\n      spells: [keyPicker(spells, ['Beguile'])],\r\n    },\r\n    effects: [\r\n      getFrightfulTouchEffect(`Blades`),\r\n      {\r\n        name: `Scrying Pool`,\r\n        desc: `Once per game, you can reroll a single dice roll of your choice for this model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      // Does not fit with generic TheHungerEffect because of the HERO specification\r\n      {\r\n        name: `The Hunger`,\r\n        desc: `At the end of any combat phase in which this model slew any enemy models, you can heal 1 wound that has been allocated to it. If this model slew any enemy HERO models this turn, you may heal 1 additional wound allocated to it.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      getDeathlyInvocation(3),\r\n      {\r\n        name: `Magic`,\r\n        desc: `The Vampire Queen on a Coven Throne is a WIZARD. She can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. She knows the Arcane Bolt, Mystic Shield and Beguile spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortis Engine': {\r\n    effects: [\r\n      WailOfTheDamnedEffect,\r\n      getFrightfulTouchEffect(`Blades`),\r\n      {\r\n        name: `The Reliquary`,\r\n        desc: `Once per battle, in your hero phase, you can declare that the Corpsemaster will unleash the energies stored in the reliquary. When you do so, roll four dice and add the scores together to determine the range of this ability. Each unit within range is struck by a wave of necromantic force. DEATH units that are struck heal D3 wounds that have been allocated to them, while any other unit struck suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bound Necromancer`,\r\n        desc: `Add 1 to casting rolls for DEATH WIZARDS within 12\" of any Mortis Engines. Subtract 1 from casting rolls for ORDER, DESTRUCTION and CHAOS WIZARDS within 12\" of any Mortis Engines.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Necromancer: {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, [\"Vanhel's Danse Macabre\"])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Undead Minions`,\r\n        desc: `Before you allocate a wound or mortal wound to this model, you can pick a friendly Summonable unit within 3\" of this model and roll a D6. On a 4+ the wound or mortal wound is allocated to that unit instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      getDeathlyInvocation(2),\r\n      {\r\n        name: `Magic`,\r\n        desc: `A Necromancer is a WIZARD. He can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Vanhel's Danse Macabre spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Zombies: {\r\n    effects: [\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Noise Maker`,\r\n        desc: `Models in this unit may be Noise Makers. A unit that includes any Noise Makers can always move up to 6\" when it charges, unless its charge roll is higher.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dragged Down and Torn Apart`,\r\n        desc: `You can add 1 to hit and wound rolls for a unit of Zombies if it has 20 or more models, or 2 if it has 40 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Newly Dead`,\r\n        desc: `At the end of the combat phase, roll a D6 for each model slain by this unit. For each roll of a 6, add a Zombie to this unit.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vigour Mortis`,\r\n        desc: `You can add 1 to hit rolls for this unit whilst it is within 9\" of any friendly CORPSE CARTS.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Corpse Cart w/ Unholy Lodestone': {\r\n    effects: [\r\n      {\r\n        name: `Unholy Lodestone`,\r\n        desc: `Add 1 to casting rolls for friendly DEATH WIZARDS within 18\" of any Corpse Carts with an Unholy Lodestone.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Locus of Undeath`,\r\n        desc: `Whilst it is within 6\" of this model, you can reroll the dice to determine how many wounds are healed on a friendly DEATH unit picked as a target of a Deathly Invocation ability.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      CryptSwordEffect,\r\n    ],\r\n  },\r\n  'Corpse Cart w/ Balefire Brazier': {\r\n    effects: [\r\n      {\r\n        name: `Balefire Brazier`,\r\n        desc: `Subtract 1 from casting rolls for enemy WIZARDS that are within 18\" of any Corpse Carts with Balefire Braziers.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Malefic Fumes`,\r\n        desc: `At the start of your hero phase, roll a D6 for each enemy WIZARD within 6\" any Corpse Carts with a Balefire Brazier. On a 4+ that unit suffers a mortal wound.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      CryptSwordEffect,\r\n    ],\r\n  },\r\n  Terrorgheist: {\r\n    effects: [...GenericEffects.Terrorgheist],\r\n  },\r\n  'Zombie Dragon': {\r\n    effects: [...GenericEffects.ZombieDragon],\r\n  },\r\n  'Wight King with Baleful Tomb Blade': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Lord of Bones'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Skeletal Steed`,\r\n        desc: `Some Wight Kings are mounted on Skeletal Steeds. They have a Move of 12\" rather than 4\" and can attack with the steed's Hooves and Teeth.`,\r\n        when: [MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Beheading Strike`,\r\n        desc: `If the wound roll for an attack made with a Baleful Tomb Blade is 6+, that attack has a Damage characteristic of D3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getDeathlyInvocation(2),\r\n    ],\r\n  },\r\n  'Wight King with Black Axe': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Lord of Bones'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Black Axe`,\r\n        desc: `If a model is allocated any wounds from attacks made using the Black Axe but is not slain, roll a D6 after the Wight King has finished making all of its attacks. On a 6+ that model is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Barrow Armour`,\r\n        desc: `Halve the number of wounds allocated to this model from each attack, rounding up (the remainder are negated).`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      getDeathlyInvocation(2),\r\n    ],\r\n  },\r\n  'Black Knights': {\r\n    effects: [\r\n      {\r\n        name: `Hell Knight`,\r\n        desc: `The leader of this unit is a Hell Knight. Add 1 to the Attacks characteristic of a Hell Knight's Barrow Lance.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      StandardBearerEffect,\r\n      HornblowerEffect,\r\n      {\r\n        name: `Deathly Charge`,\r\n        desc: `If this unit completed a charge this turn, add 1 to its wound rolls and add 1 to the Damage characteristic of its Barrow Lances.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      CryptShieldsEffect,\r\n    ],\r\n  },\r\n  'Grave Guard': {\r\n    effects: [\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Seneschal`,\r\n        desc: `The leader of this unit is a Seneschal. Add 1 to the Attacks characteristic of a Seneschal's Wight Blade or Great Wight Blade.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      HornblowerEffect,\r\n      {\r\n        name: `Cursed Weapons`,\r\n        desc: `If the wound roll for an attack made with a Wight Blade or Great Wight Blade is 6+, double the Damage characteristic of that attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      CryptShieldsEffect,\r\n    ],\r\n  },\r\n  'Skeleton Warriors': {\r\n    effects: [\r\n      {\r\n        name: `Skeleton Champion`,\r\n        desc: `The leader of this unit is a Skeleton Champion. Add 1 to the Attacks characteristic of a Skeleton Champion's Ancient Blade or Ancient Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      StandardBearerEffect,\r\n      HornblowerEffect,\r\n      {\r\n        name: `Serve in Death`,\r\n        desc: `Add 1 to hit rolls for Skeleton Warriors units that are within 18\" of any friendly DEATH HEROES.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skeleton Legion`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons if it has 20 or more models. Add 2 instead if it has 30 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      CryptShieldsEffect,\r\n    ],\r\n  },\r\n  'The Sepulchral Guard': {\r\n    effects: [\r\n      {\r\n        name: `The Sepulchral Warden`,\r\n        desc: `You can return D3 slain models to this unit if the Sepulchral Warden is on the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      CryptShieldsEffect,\r\n      {\r\n        name: `Serve in Death`,\r\n        desc: `You can add 1 to hit rolls for this unit if it is wholly within 18\" of any friendly Death HEROES.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Frightening Speed`,\r\n        desc: `You can reroll charge rolls for this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Legion Black Coach': {\r\n    effects: [\r\n      {\r\n        name: `Frightful Touch`,\r\n        desc: `Each time you make a hit roll of 6+ for the Cairn Wraith's Reaper Scythe, that attack inflicts 2 mortal wounds instead of the normal damage (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Reaped Like Corn`,\r\n        desc: `If the target unit has 5 or more models, you can reroll failed hit rolls for the Cairn Wraith's Reaper Scythe.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death`,\r\n        desc: `In your hero phase, roll a D6 for each friendly DEATH WIZARD within 12\" of this model. For each roll of 6, the Black Coach gains a level of power for the rest of the battle; these are cumulative and grant the following abilities:`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death: First Level, Gleaming Scythes`,\r\n        desc: `After this model completes a charge, pick an enemy unit within 1\" of this model. That unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death: Second Level, Unholy Vigour`,\r\n        desc: `This model has a Move characteristic of 14\" instead of 10\".`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death: Third Level, Witch-fire`,\r\n        desc: `Add 1 to hit rolls for this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death: Fourth Level, Howling Winds`,\r\n        desc: `This model can Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Evocation of Death: Fifth Level, Nimbus of Darkness`,\r\n        desc: `This model can attempt to unbind one spell in the enemy hero phase as if it were a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dire Wolves': {\r\n    effects: [\r\n      {\r\n        name: `Doom Wolf`,\r\n        desc: `The leader of this unit is a Doom Wolf. Add 1 to the Attacks characteristic of a Doom Wolf's Rotting Fangs and Claws.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Slavering Charge`,\r\n        desc: `Add 1 to wound rolls for this unit if it completed a charge move this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vigour Necris`,\r\n        desc: `Add 1 to save rolls for this unit if it is within 9\" of any friendly CORPSE CARTS.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { ISubscription } from 'types/subscription'\r\n\r\nexport const isSubscriber = (subscription: ISubscription) => subscription.subscribed\r\n\r\nexport const isActiveSubscriber = (subscription: ISubscription) => {\r\n  if (isPaypal(subscription)) {\r\n    if (subscription.subscriptionStatus === 'pending_activation') return false\r\n    if (hasActiveGrant(subscription)) return true\r\n  }\r\n\r\n  return isSubscriber(subscription) && !subscription.expired\r\n}\r\n\r\nexport const isCanceledSubscriber = (subscription: ISubscription) => {\r\n  return isSubscriber(subscription) && !subscription.active\r\n}\r\n\r\nexport const isGiftedSubscriber = (subscription: ISubscription) => {\r\n  return isActiveSubscriber(subscription) && subscription.planId === 'gifted'\r\n}\r\n\r\nexport const isPendingSubscriber = (subscription: ISubscription) => {\r\n  return subscription.subscriptionStatus === 'pending_activation' || hasActiveGrant(subscription)\r\n}\r\n\r\nexport const hasActiveGrant = (subscription: ISubscription) => {\r\n  return subscription.has_grant === true && subscription.subscriptionStatus === 'temporary_grant'\r\n}\r\n\r\nexport const hasExpiredGrant = (subscription: ISubscription) => {\r\n  return subscription.has_grant === false && subscription.subscriptionStatus === 'temporary_grant'\r\n}\r\n\r\nexport const isStripe = (subscription: ISubscription) => subscription.createdBy === 'stripe'\r\n\r\nexport const isPaypal = (subscription: ISubscription) => subscription.createdBy === 'paypal'\r\n","import { useAuth0 } from '@auth0/auth0-react'\r\nimport { SubscriptionApi } from 'api/subscriptionApi'\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport { ISubscription } from 'types/subscription'\r\nimport {\r\n  hasActiveGrant,\r\n  hasExpiredGrant,\r\n  isActiveSubscriber,\r\n  isCanceledSubscriber,\r\n  isGiftedSubscriber,\r\n  isPaypal,\r\n  isPendingSubscriber,\r\n  isStripe,\r\n  isSubscriber,\r\n} from 'utils/subscriptionUtils'\r\n\r\nconst initialState = {\r\n  createdByPaypal: false,\r\n  createdByStripe: false,\r\n  isActive: false,\r\n  isCanceled: false,\r\n  isGifted: false,\r\n  isNotSubscribed: false,\r\n  isPending: false,\r\n  hasExpiredGrant: false,\r\n  hasActiveGrant: false,\r\n  isSubscribed: false,\r\n  subscription: { id: '', userName: '', subscribed: false },\r\n  subscriptionLoading: false,\r\n}\r\n\r\ninterface ISubscriptionContext {\r\n  cancelSubscription: () => Promise<void>\r\n  getSubscription: () => Promise<void>\r\n  /**\r\n   * Does this user have an active subscription?\r\n   * A user who has cancelled their subscription, but is still in their subscription period\r\n   * is still considered an active subscriber\r\n   */\r\n  isActive: boolean\r\n  /**\r\n   * Has this user cancelled recurring payments?\r\n   */\r\n  isCanceled: boolean\r\n  /**\r\n   * Was this subscription given as a gift?\r\n   */\r\n  isGifted: boolean\r\n  /**\r\n   * This value is only set AFTER Auth0 and the Subscription API have been contacted\r\n   * Don't rely on it for immediate correctness on pageload\r\n   */\r\n  isNotSubscribed: boolean\r\n  /**\r\n   * If this subscription was created by Paypal,\r\n   * there is a 30-60 time period after checkout before their subscription is confirmed.\r\n   */\r\n  isPending: boolean\r\n  /**\r\n   * Does this user exist in the subscription API?\r\n   * This DOES NOT mean they have an active subscription\r\n   */\r\n  isSubscribed: boolean\r\n  createdByPaypal: boolean\r\n  createdByStripe: boolean\r\n\r\n  /**\r\n   * Does this user have an active grant (a ten minute grace period while Paypal completes checkout)\r\n   */\r\n  hasActiveGrant: boolean\r\n  /**\r\n   * If a user has an expired grant, their checkout most likely failed.\r\n   */\r\n  hasExpiredGrant: boolean\r\n\r\n  subscription: ISubscription\r\n  subscriptionLoading: boolean\r\n}\r\n\r\nconst SubscriptionContext = React.createContext<ISubscriptionContext | void>(undefined)\r\n\r\nconst SubscriptionProvider = ({ children }: React.PropsWithChildren<{}>) => {\r\n  const { user, isLoading } = useAuth0()\r\n  const [subscription, setSubscription] = useState<ISubscription>(initialState.subscription)\r\n  const [subscriptionLoading, setSubscriptionLoading] = useState(initialState.subscriptionLoading)\r\n  const [isNotSubscribed, setIsNotSubscribed] = useState(initialState.isNotSubscribed)\r\n\r\n  const createdByPaypal = isPaypal(subscription)\r\n  const createdByStripe = isStripe(subscription)\r\n  const isActive = isActiveSubscriber(subscription)\r\n  const isCanceled = isCanceledSubscriber(subscription)\r\n  const isGifted = isGiftedSubscriber(subscription)\r\n  const isPending = isPendingSubscriber(subscription)\r\n  const isSubscribed = isSubscriber(subscription)\r\n\r\n  useEffect(() => {\r\n    if (isLoading) return\r\n    if (!user) setIsNotSubscribed(true)\r\n  }, [isLoading, user])\r\n\r\n  const getSubscription = useCallback(async () => {\r\n    if (!user?.email) return setSubscription(initialState.subscription)\r\n\r\n    try {\r\n      setSubscriptionLoading(true)\r\n      const response = await SubscriptionApi.getSubscription(user.email)\r\n      const subscription: ISubscription = response.body\r\n      setSubscription(subscription)\r\n      setSubscriptionLoading(false)\r\n    } catch (err) {\r\n      if (err.status === 501) {\r\n        console.log(`${user.email} is not registered with the Subscription API`)\r\n      } else {\r\n        console.log(`There was an unexpected error retrieving ${user.email} from the Subscription API`)\r\n        console.error(err)\r\n      }\r\n      setSubscription(initialState.subscription)\r\n      setIsNotSubscribed(true)\r\n      setSubscriptionLoading(false)\r\n    }\r\n  }, [user])\r\n\r\n  const cancelSubscription = useCallback(async () => {\r\n    try {\r\n      const { userName, subscriptionId = '' } = subscription\r\n      await SubscriptionApi.cancelSubscription({ userName, subscriptionId })\r\n      await getSubscription()\r\n    } catch (err) {\r\n      console.error(err)\r\n    }\r\n  }, [getSubscription, subscription])\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      cancelSubscription,\r\n      createdByPaypal,\r\n      createdByStripe,\r\n      getSubscription,\r\n      hasActiveGrant: hasActiveGrant(subscription),\r\n      hasExpiredGrant: hasExpiredGrant(subscription),\r\n      isActive,\r\n      isCanceled,\r\n      isGifted,\r\n      isNotSubscribed,\r\n      isPending,\r\n      isSubscribed,\r\n      subscription,\r\n      subscriptionLoading,\r\n    }),\r\n    [\r\n      cancelSubscription,\r\n      createdByPaypal,\r\n      createdByStripe,\r\n      getSubscription,\r\n      isActive,\r\n      isCanceled,\r\n      isGifted,\r\n      isNotSubscribed,\r\n      isPending,\r\n      isSubscribed,\r\n      subscription,\r\n      subscriptionLoading,\r\n    ]\r\n  )\r\n\r\n  return <SubscriptionContext.Provider value={value}>{children}</SubscriptionContext.Provider>\r\n}\r\n\r\nconst useSubscription = () => {\r\n  const context = React.useContext(SubscriptionContext)\r\n  if (context === undefined) {\r\n    throw new Error('useSubscription must be used within a SubscriptionProvider')\r\n  }\r\n  return context\r\n}\r\n\r\nexport { SubscriptionProvider, useSubscription }\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_BEASTS_OF_CHAOS: {\r\n    name: 'Battletome: Beasts of Chaos (2023)',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/10/WotnUpw97M7nNtlG.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  START_OF_TURN,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Slitherwrack Helm': {\r\n    effects: [\r\n      {\r\n        name: `Slitherwrack Helm`,\r\n        desc: `After the bearer makes a charge move, pick 1 enemy unit within 1\" of them and roll a dice. On a 2+, the strike-last effect applies to that unit until the end of that turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Brayblast Trumpet': {\r\n    effects: [\r\n      {\r\n        name: `Brayblast Trumpet (Brayherds)`,\r\n        desc: `Once per battle, at the end of your movement phase, you can say that the bearer will sound the brayblast trumpet. If you do so, roll a dice. On a 2+, you can summon a unit to the battlefield from the list below. Set up that unit wholly within 9\" of the battlefield edge and more than 9\" from all enemy units. On a 1, you can still summon 1 of the units listed, but you must do so at the end of your next movement phase instead.\r\n        1 unit of 10 Gors\r\n        1 unit of 10 Ungors\r\n        1 unit of 10 Ungor Raiders`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Knowing Eye': {\r\n    effects: [\r\n      {\r\n        name: `The Knowing Eye (Brayherds)`,\r\n        desc: `If you take the first turn in the current battle round, after the players have received their starting command points, you receive 1 command point that can only be spent during that turn to allow the bearer to issue a command. If you take the second turn in the current battle round, after the players have received their starting command points, the bearer can make a normal move of up to 6\".`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Axe of Morghur': {\r\n    effects: [\r\n      {\r\n        name: `Axe of Morghur`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Ward rolls cannot be made for wounds caused by attacks made with that weapon.`,\r\n        when: [COMBAT_PHASE, WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bleating Gnarlstaff': {\r\n    effects: [\r\n      {\r\n        name: `Bleating Gnarlstaff (Brayherds)`,\r\n        desc: `At the end of your movement phase, you can pick 1 objective or terrain feature within 6\" of the bearer and roll a dice. On a 2+, each unit within 6\" of that objective or terrain feature suffers D3 mortal wounds. This ability has no effect on BEASTS OF CHAOS units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BEASTS_OF_CHAOS } from 'meta/factions'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  DURING_SETUP,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n  TURN_TWO_END_OF_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [BEASTS_OF_CHAOS]: {\r\n    effects: [\r\n      {\r\n        name: `Beastherd Ambush`,\r\n        desc: `During deployment, instead of setting up a BEASTS OF CHAOS unit on the battlefield, you can place it to one side and say that it is set up in ambush as a reserve unit.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Brayherd Ambush`,\r\n        desc: `At the end of your first and second movement phases, you can set up any friendly reserve units that are in ambush on the battlefield. wholly within 9\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [TURN_ONE_END_OF_MOVEMENT_PHASE, TURN_TWO_END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Brayherd Ambush`,\r\n        desc: `Add 1 to charge rolls for friendly BEASTS OF CHAOS units that are set up on the battlefield in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `MASTERS OF THE WILDERNESS`,\r\n        desc: `In your hero phase, if the model picked to be your general is in reserve at the start of that phase, you receive 1 command point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rituals of Ruin`,\r\n        desc: `In your hero phase, you can carry out 1 of the heroic actions from the table below with each friendly BEASTS OF CHAOS HERO that is on the battlefield in addition to any other heroic actions you can carry out with those HEROES. If you do so, before resolving the effect of that heroic action, you must allocate D3 mortal wounds that cannot be negated to that HERO or to another friendly BEASTS OF CHAOS unit within 3\" of that HERO. If those mortal wounds slay that HERO, the heroic action has no effect. In addition, in your hero phase, you can carry out 1 of the heroic actions from the table below with 1 friendly BEASTS OF CHAOS HERO that is in reserve. If the heroic action instructs you to pick an enemy unit, you must also pick 1 point on the battlefield edge. That point is considered to be the HERO carrying out that heroic action for the purposes of measuring range and visibility. If the heroic action instructs you to pick a friendly unit, you must pick the HERO carrying out that heroic action. The same heroic action from the table below cannot be carried out more than once per phase.\r\n          \r\n          Warping Curse: Pick 1 enemy unit within 12\" of the BEASTS OF CHAOS HERO carrying out this heroic action and visible to them. That unit suffers D6 mortal wounds.\r\n          Blood Taunt: Pick 1 enemy unit within 12\" of the BEASTS OF CHAOS HERO carrying out this heroic action that is more than 3\" from all friendly units and is visible to that HERO. Your opponent must make a 2D6\" move with that unit. All of the models in that unit must finish that move as close as possible to the BEASTS OF CHAOS HERO carrying out this heroic action and more than 3\" from all other units in your army.\r\n          Brand of Wild Fury: Pick 1 friendly BEASTS OF CHAOS HERO wholly within 12\" of The BEASTS OF CHAOS HERO carrying out this heroic action and visible to them. Until the end of this turn, friendly BEASTS OF CHAOS units have a ward of 6+ while they are wholly within 12\" of the HERO you picked.\r\n          Alphabeast Instinct: Pick 1 friendly BEASTS OF CHAOS unit wholly within 12\" of the BEASTS OF CHAOS HERO Carrying out this heroic action and visible to them. Do not take battleshock tests for that unit this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Brand of Wild Fury`,\r\n        desc: `When active, friendly BEASTS OF CHAOS units have a ward of 6+ while they are wholly within 12\" of the HERO you picked.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Alphabeast Instinct`,\r\n        desc: `When active, the picked unit does not battleshock tests.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE, TURN_ONE_START_OF_HERO_PHASE, TURN_TWO_START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n  'In the Shadow of the Herdstone': {\r\n    effects: [\r\n      {\r\n        name: `In the Shadow of the Herdstone`,\r\n        desc: `Pick 1 enemy unit within 12\" of your Herdstone. You complete this battle tactic if that unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bestial Wrath': {\r\n    effects: [\r\n      {\r\n        name: `Bestial Wrath`,\r\n        desc: `You can pick this battle tactic only in your first or second turn. You complete this tactic if your general and 2 or more other friendly BEASTS OF CHAOS units are within 3\" of any enemy units at the end of this turn.`,\r\n        when: [TURN_ONE_START_OF_HERO_PHASE, TURN_TWO_START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rampaging Beastherd': {\r\n    effects: [\r\n      {\r\n        name: `Rampaging Beastherd`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if you control that objective at the end of this turn and that objective is contested by a friendly unit that has 10 or more models.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reduced to Savagery': {\r\n    effects: [\r\n      {\r\n        name: `Reduced to Savagery`,\r\n        desc: `Pick 1 enemy unit on the battlefield. You complete this tactic if that unit is picked as the target of a heroic action from the Rituals of Ruin battle trait (pg 62-63) and is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Trampled to Mulch': {\r\n    effects: [\r\n      {\r\n        name: `Trampled to Mulch`,\r\n        desc: `You complete this tactic if any enemy units are destroyed during this turn by mortal wounds allocated in your charge phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aid of the Wilderness': {\r\n    effects: [\r\n      {\r\n        name: `Aid of the Wilderness`,\r\n        desc: `You complete this tactic if there are 2 or more friendly BEASTS OF CHAOS units in cover wholly outside of your territory at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n/*  \"Slaughterer's Call\": {\r\n    effects: [\r\n      {\r\n        name: `Slaughterer's Call`,\r\n        desc: `You can use this command ability at the start of the combat phase. This unit must issue the command and the unit that receives the command must be a friendly WARHERD unit within 12\" of an enemy unit and more than 3\" from all enemy units. If you do so, you must attempt a charge with that unit.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Bestial Cunning': {\r\n    effects: [\r\n      {\r\n        name: `Bestial Cunning`,\r\n        desc: `After deployment, you can pick 1 friendly BEASTS OF CHAOS reserve unit. When you set up that unit at the end of your movement phase, you can set it up anywhere on the battlefield more than 7\" from all enemy units. This ability can be used while this unit is set up in ambush as a reserve unit.`,\r\n        when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Propagator of Ruin': {\r\n    effects: [\r\n      {\r\n        name: `Propagator of Ruin`,\r\n        desc: `If this general is on the battlefield and you pick them to carry out a heroic action from the Rituals of Ruin battle trait (pg 62-63), you can carry out a second different heroic action from the Rituals of Ruin battle trait with this general in that phase, and you do not have to allocate mortal wounds to this general before resolving the effect of that second heroic action.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skullfray Gorehorn': {\r\n    effects: [\r\n      {\r\n        name: `Skullfray Gorehorn`,\r\n        desc: `While this general is within 3\" of any enemy units, add 1 to the Attacks characteristic of melee weapons used by friendly BEASTS OF CHAOS BRAYHERD units wholly within 12\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Twist fray Cursebeast': {\r\n    effects: [\r\n      {\r\n        name: `Twist fray Cursebeast`,\r\n        desc: `Add the number of the current battle round to casting rolls for this general.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rotfray Plaguepelt': {\r\n    effects: [\r\n      {\r\n        name: `Rotfray Plaguepelt`,\r\n        desc: `At the start of the combat phase, roll a dice for each enemy unit within 3\" of this general. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slakefray Reveller': {\r\n    effects: [\r\n      {\r\n        name: `Slakefray Reveller`,\r\n        desc: `If this general is on the battlefield at the start of your movement phase, add 3\" to the Move characteristic of friendly BEASTS OF CHAOS units that start a normal move within 6\" of a terrain feature until the end of that phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\n// Endless spells.\r\nconst EndlessSpells = {\r\n  'Ravening Direflock': {\r\n    effects: [\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and range of 12\". If successfully cast, set up the parts of the endless spell within 3\" of each other, wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only BEASTS OF CHAOS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbingers of Dark Omens`,\r\n        desc: `Models cannot issue the Rally or Inspiring Presence commands while they are within 6\" of this endless spell. This ability has no effect on BEASTS OF CHAOS units.`,\r\n        when: [START_OF_HERO_PHASE, BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Doomblast Dirgehorn': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and range of 12\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only BEASTS OF CHAOS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Booming Cacophony`,\r\n        desc: `After this endless spell is set up, its range is 6\". At the start of each subsequent battle round, its range is increased by 6\".\r\n\r\n        Subtract 1 from wound rolls for attacks made by units within range of any endless spells with this ability. This ability has no effect on hit rolls for attacks made by BEASTS OF CHAOS units.\r\n\r\n        Designer's Note: If this endless spell is removed from play, the next time it is set up, its range resets to 6\".`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wildfire Taurus': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7 and range of 6\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only BEASTS OF CHAOS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Twelve_Inches,\r\n      {\r\n        name: `Whirlwind of Destruction`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across and each other unit that is within 1\" of it at the end of its move. On a 2+, that unit suffers D3 mortal wounds. In addition, the strike-last effect applies to units within 3\" of this endless spell. This ability has no effect on BEASTS OF CHAOS units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Whirlwind of Destruction`,\r\n        desc: `The strike-last effect applies to units that within 3\" of this endless spell. This ability has no effect on BEASTS OF CHAOS units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Feast on Flesh': {\r\n    effects: [\r\n      {\r\n        name: `Feast on Flesh`,\r\n        desc: `You can carry out this monstrous rampage instead of any others with this unit. Improve the Rend characteristic of this unit's melee weapons by 1 until the end of the following combat phase. In addition, until the end of the following combat phase, if any enemy models are slain by attacks made by this unit, you can heal up to 3 wounds allocated to this unit after all of its attacks have been resolved.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Consume Endless Spell': {\r\n    effects: [\r\n      {\r\n        name: `Consume Endless Spell`,\r\n        desc: `You can carry out this monstrous rampage instead of any others with this unit. Pick 1 endless spell within 6\" of this unit and roll 2D6. If the roll is greater than the casting value of the endless spell, that endiess spell is dispelled and you can heal a number of wounds allocated to this unit equal to the 2D6 roll.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aura of Madness': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Madness`,\r\n        desc: `You can carry out this monstrous rampage instead of any others with this unit. Pick 1 enemy HERO within 3\" of this unit and roll a dice. On a 2-5, worsen the Save characteristic of that HERO by 1 (to a minimum of 6+) until the end of the following combat phase. On a 6, worsen the Save characteristic of that HERO by 2 (to a minimum of 6t) until the end of the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Thricefold Savagery': {\r\n    effects: [\r\n      {\r\n        name: `Thricefold Savagery`,\r\n        desc: `You can carry out this monstrous rampage instead of any others with this unit. Until the end of the following combat phase, add 1 to the Attacks characteristic of this unit's melee weapons, but all of the attacks made with this unit's melee weapons must target the same enemy unit.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  DURING_GAME,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  Allherd: {\r\n    effects: [\r\n      {\r\n        name: `Bestial Might`,\r\n        desc: `At the end of the battleshock phase, you can return D3+3 slain models to each friendly ALLHERD GOR HERD, ALLHERD UNGORS and ALLHERD UNGOR RAIDERS unit on the battlefield.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gavespawn: {\r\n    effects: [\r\n      {\r\n        name: `Gibbering Congregations`,\r\n        desc: `You can include Gibbering Congregations in your army.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Darkwalkers: {\r\n    effects: [\r\n      {\r\n        name: `Shadowbeasts`,\r\n        desc: `At the end of your movement phase, you can pick 1 friendly DARKWALKERS GOR HERD, DARKWALKERS UNGORS or DARKWALKERS UNGOR RAIDERS unit that is wholly within 9\" of the battlefield edge and say that it will slink into the shadows. If you do so, remove that unit from the battlefield and set it up again wholly within 9\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Quakefray: {\r\n    effects: [\r\n      {\r\n        name: `Living Idols of Ruin`,\r\n        desc: `Friendly QUAKEFRAY CYGOR units gain the PRIEST keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Living Idols of Ruin`,\r\n        desc: `Earthshatter is a prayer, answer value of 3. Pick 1 objective within 12\" and visible to the chanter. Each unit within 6\" of that objective suffers D3 mortal wounds, and, until your next hero phase, when determining the number of models in units that are contesting that objective, that number must be halved (rounding down). This prayer has no effect on BEASTS OF CHAOS units.`,\r\n        when: [HERO_PHASE],\r\n        prayer: true,\r\n      },\r\n      {\r\n        name: `Living Idols of Ruin`,\r\n        desc: `Effected enemy units count as half when contesting the picked objective (rounding down). This prayer has no effect on BEASTS OF CHAOS units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n  'Protect the Herdstone': {\r\n    effects: [\r\n      {\r\n        name: `Protect the Herdstone`,\r\n        desc: `You complete this grand strategy if there are no enemy units within 9\" of your Herdstone and vour Herdstone was not affected by a rule that said you could not use the scenery rules on its warscroll during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Desecrating Brayherd': {\r\n    effects: [\r\n      {\r\n        name: `Desecrating Brayherd`,\r\n        desc: `You complete this grand strategy if you control 2 or more objectives and those objectives are contested by any friendly BRAYHERD units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Flanking Warherd': {\r\n    effects: [\r\n      {\r\n        name: `Flanking Warherd`,\r\n        desc: `You complete this grand strategy if there are 2 or more friendly WARHERD units on the battlefield wholly within 9\" of the battlefield edge.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Age of the Beast': {\r\n    effects: [\r\n      {\r\n        name: `Age of the Beast`,\r\n        desc: `You complete this grand strategy if 2 or more friendly CYGORS or GHORGONS are on the battlefield and none of those units have a number of wounds allocated to them that exceeds half of their Wounds characteristic.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { COMBAT_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n  Herdstone: {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Entropic Lodestone`,\r\n        desc: `From the start of the 2nd battleround, improve the Rend characteristic of melee weapons used by all friendly BEASTS OF CHAOS units on the battlefield by 1. From the start of the 4th battle round, improve the Rend characteristic of melee weapons used by all friendly BEASTS OF CHAOS units on the battlefield by 2 instead of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  // Twisted Wilds\r\n  Viletide: {\r\n    effects: [\r\n      {\r\n        name: `Viletide`,\r\n        desc: `Casting value of 6. Pick an enemy unit within 12\" of the caster that is visible to them. That unit suffers D3 mortal wounds and cannot receive commands until the end of that turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vicious Stranglethorns': {\r\n    effects: [\r\n      {\r\n        name: `Vicious Stranglethorns`,\r\n        desc: `Casting value of 5. pick 1 enemy unit within 18\" and visible to the caster. That enemy unit cannot make pile-in moves until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Primal Dominance': {\r\n    effects: [\r\n      {\r\n        name: `Primal Dominance`,\r\n        desc: `Casting value of 5. Pick 1 enemy MONSTER within 18\" and visible to the caster. Until your next hero phase, that MONSTER counts as 1 model for the purposes of contesting objectives and cannot carry out monstrous rampages.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tendrils of Atrophy': {\r\n    effects: [\r\n      {\r\n        name: `Tendrils of Atrophy`,\r\n        desc: `Casting value of 7. Pick 1 enemy unit within 12\" and visible to the caster. Add 1 to the damage inflicted by each successful attack made with a melee weapon that targets that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wild Rampage': {\r\n    effects: [\r\n      {\r\n        name: `Wild Rampage`,\r\n        desc: `Casting value of 7. Pick 1 friendly BEASTS OF CHAOS unit wholly within 12\" and visible to the caster. Until your next hero phase, if the unmodified hit roll for an attack made with a melee weapon by that unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wild Rampage`,\r\n        desc: `If active, 6s to hit score 2 hits instead of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Titanic Fury': {\r\n    effects: [\r\n      {\r\n        name: `Titanic Fury`,\r\n        desc: `Casting value of 6. Pick 1 friendly BEASTS OF CHAOS MONSTER wholly within 12\" and visible to the caster. Until your next hero phase, add 1 to the Attacks characteristic of that MONSTER'S melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Dark Storms\r\n  Hailstorm: {\r\n    effects: [\r\n      {\r\n        name: `Hailstorm`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit within 21\" and visible to the caster. Until your next hero phase, halve the Move characteristic of that unit, and halve run rolls and charge rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hailstorm`,\r\n        desc: `If active, halve the movement, run, and charge rolls for the picked unit.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fulgurous Blades': {\r\n    effects: [\r\n      {\r\n        name: `Fulgurous Blades`,\r\n        desc: `Casting value of 6. Pick 1 friendly BEASTS OF CHAOS unit wholly within 18\" and visible to the caster. Until your next hero phase, subtract 1 from the Attacks characteristic of melee weapons that target that unit (to a minimum of 1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Thunderwave: {\r\n    effects: [\r\n      {\r\n        name: `Thunderwave`,\r\n        desc: `Casting value of 5. Each unit within 3\" of the caster suffers D3 mortal wounds. THUNDERSCORN units are not affected by this spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Furious Gale': {\r\n    effects: [\r\n      {\r\n        name: `Furious Gale`,\r\n        desc: `Casting value of 6. Until your next hero phase, subtract 1 from the Attacks characteristic of missile weapons used by enemy units while they are within 18\" of the caster (to a minimum of 1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Furious Gale`,\r\n        desc: `If active, subtract 1 from the Attacks characteristic of missile weapons used by enemy units while they are within 18\" of the caster (to a minimum of 1).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Raging Storm': {\r\n    effects: [\r\n      {\r\n        name: `Raging Storm`,\r\n        desc: `Casting value of 8. Heal 1 wound allocated to each friendly THUNDERSCORN unit on the battlefield. In addition, each enemy unit on the battlefield suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit Spells\r\n  Devolve: {\r\n    effects: [\r\n      {\r\n        name: `Devolve`,\r\n        desc: `Casting value of 7. Pick 1 enemy unit within 18\" and visible to the caster. Until your next hero phase, roll 3D6 before that unit makes a normal move, runs, retreats or makes a charge move. If the roll is greater than that unit's Bravery characteristic, the maximum distance of that move is halved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Devolve`,\r\n        desc: `If active, roll 3D6 before the picked unit makes a normal move, runs, retreats or makes a charge move. If the roll is greater than that unit's Bravery characteristic, the maximum distance of that move is halved.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Summon Lightning': {\r\n    effects: [\r\n      {\r\n        name: `Summon Lightning`,\r\n        desc: `Casting value of 7. Pick up to D3 friendly THUNDERSCORN unit within 24\" of the caster and visible to them. You can heal D3 wounds allocated to those units (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Boon of Mutation': {\r\n    effects: [\r\n      {\r\n        name: `Boon of Mutation`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. For each model that is slain by a mortal wound caused by this spell, you can add 1 Tzaangor model that is not a Tzaangor Champion or Tzaangor Mutant to a friendly Tzaangor Host within 12\" of the caster. Set up models that are added to a unit one at a time within 1\" of the unit they are being added to. Models that are added to a unit can only be set up within 3\" of an enemy unit if a model from their unit is already within 3\" of that enemy unit. The models added to a unit can take it above its maximum size.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Savage Bolt': {\r\n    effects: [\r\n      {\r\n        name: `Savage Bolt`,\r\n        desc: `Casting value of 7. Pick 1 enemy unit within 18\" of the caster that is visible to them. That unit suffers D3 mortal wounds. Units that attack the target unit in the next combat phase get +1 to their hit rolls.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst PropagatorOfDevolutionEffect = {\r\n  name: `Propagator of Devolution`,\r\n  desc: `This unit can run and still charge later in the turn.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst InfuseWithBestialVigorEffect = {\r\n  name: `Infuse with Bestial Vigour`,\r\n  desc: `Add 6\" to the range of heroic actions from the Rituals of Ruin battle trait that you carry out with this unit. This ability can be used while this unit is set up in ambush as a reserve unit.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst BrayhornEffect = {\r\n  name: `Brayhorn`,\r\n  desc: `A unit that includes any Brayhorns can add 1 to run and charge rolls.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst BrayStandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `1 in every 10 models in this unit can be a Banner Bearer. If this unit receives the Rally command while it includes any Banner Bearers, when you roll a dice for a slain model from this unit, you can return 1 slain model to this unit on a 5+ instead of only a 6.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst ChampionEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be a Champion. Add 1 to the attacks characteristic of melee weapons for the champion.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst DespoilersEffect = {\r\n  name: `Despoilers`,\r\n  desc: `Add 1 to wound rolls for attacks made with melee weapons by this unit while it is within 3\" of any enemy units that received the All-out Defence command in the same phase.`,\r\n  when: [COMBAT_PHASE],\r\n  rule_sources: [\r\n    rule_sources.BATTLETOME_BEASTS_OF_CHAOS,\r\n    meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n  ],\r\n  shared: true,\r\n}\r\nconst BloodgreedEffect = {\r\n  name: `Bloodgreed`,\r\n  desc: `Each unmodified hit roll for an attack made with a melee weapon by this unit is 6, that attack causes a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends (do not make a wound roll or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst BeneathTheTempestEffect = {\r\n  name: `Beneath the Tempest`,\r\n  desc: `At the end of the combat phase, roll a dice for this unit. On a 2+, you can heal up to D3 wounds allocated to this unit. In addition, at the end of the combat phase, roll a dice for each enemy unit within 3\" of any friendly units with this ability. On a 2+, that unit suffers D3 mortal wounds.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst TzaangorChampionEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be an Aviarch. Add 1 to the Attacks characteristic of that model's Tzeentchian Spear.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst BabblingStreamOfSecretsEffect = {\r\n  name: `Babbling Stream of Secrets`,\r\n  desc: `In the combat phase, enemy units within 3\" of any friendly units with this ability cannot receive commands.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst GuidedByThePastEffect = {\r\n  name: `Guided by the Past`,\r\n  desc: `You can add 1 to wound rolls for attacks made with melee weapons by friendly units with this ability if you are taking the second turn in the current battleround. This ability does not affect attacks made by a mount.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  Beastlord: {\r\n    effects: [\r\n      {\r\n        name: `Dual Axes`,\r\n        desc: `If the unmodified hit roll for an attack made with a melee weapon by this unit is 6, that attack causes a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Call of Battle`,\r\n        desc: `In the combat phase, when you pick this unit to fight for the first time in that phase, you can pick 1 other friendly BRAYHERD unit that is not a HERO, that is wholly within 12\" of this unit and that has not yet fought in that phase. This unit and that other BRAYHERD unit can fight one after the other in the order of your choice.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hatred of Heroes`,\r\n        desc: `If this unit is within 3\" of any enemy HEROES, add 1 to hit rolls and wound rolls for attacks made with melee weapons by friendly BEASTS OF CHAOS units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Great Bray-Shaman': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Devolve'])],\r\n    },\r\n    effects: [GenericEffects.WizardOneSpellEffect, InfuseWithBestialVigorEffect],\r\n  },\r\n  Gors: {\r\n    effects: [\r\n      BrayhornEffect,\r\n      BrayStandardBearerEffect,\r\n      ChampionEffect,\r\n      {\r\n        name: `Gor Stampede`,\r\n        desc: `At the end of your charge phase, if this unit made a charge move in the same turn, you can pick 1 enemy unit within 1\" of this unit that has fewer models than this unit and roll a dice. On a 3+, the strike-last effect applies to that enemy unit in the following combat phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Shield`,\r\n        desc: `If this unit is armed with Hacking Blades and Beastshields, it has a Save characteristic of 4+ instead of 5+.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ungors: {\r\n    effects: [\r\n      BrayhornEffect,\r\n      BrayStandardBearerEffect,\r\n      ChampionEffect,\r\n      {\r\n        name: `Fleet of Hoof`,\r\n        desc: `In the combat phase, when you pick this unit to fight, you can say that it will evade the enemy. If you do so, this unit retreats instead of fighting.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bestigors: {\r\n    effects: [\r\n      BrayhornEffect,\r\n      BrayStandardBearerEffect,\r\n      ChampionEffect,\r\n      DespoilersEffect,\r\n      {\r\n        name: `Bestial Charge`,\r\n        desc: `Subtract 1 from wound rolls for attacks that target this unit if the attack was made with a missile weapon by an enemy unit that received the Unleash Hell command in the same phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ungor Raiders': {\r\n    effects: [\r\n      BrayStandardBearerEffect,\r\n      {\r\n        name: `Vile Invaders`,\r\n        desc: `After armies are set up, but before the first battle round begins, this unit can move up to 6\".`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Musician`,\r\n        desc: `1 in every 10 models in this unit can be a Brayhorn Blower. This unit can run and still shoot later in the turn if it includes any Brayhorn Blowers.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hidden Volley`,\r\n        desc: `Once per battle, at the start of your movement phase, if this unit is in reserve, you can pick a point on the battlefield edge and say that this unit will unleash a hidden volley. If you do so, this unit can shoot in that phase, but it must target the closest enemy unit to that point. If more than 1 enemy unit is tied to be the closest, you can pick which unit is the target.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tuskgor Chariots': {\r\n    effects: [\r\n      {\r\n        name: `Tuskgor Charge`,\r\n        desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a number of dice equal to the unmodified charge roll for that charge move. Add 1 to each roll if that enemy unit has a Wounds characteristic of 1 or 2. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `CHAMPION`,\r\n        desc: `If this unit has 2 or more models, 1 model in this unit can be a Charioteer Alpha. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Centigors: {\r\n    effects: [\r\n      BrayhornEffect,\r\n      ChampionEffect,\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `1 in every 5 models in this unit can be a Banner Bearer. This unit can retreat and still charge later in the turn if it includes any Banner Bearers.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Unruly Hooligans`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons while it is wholly within 9\" of any objectives that you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Drunken Revelry`,\r\n        desc: `The first 2 wounds or mortal wounds caused to this unit in the combat phase are negated. In addition, if a model in this unit would flee as a result of a failed battleshock test, you can roll a dice. On a 2+, that model does not flee.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Drunken Revelry`,\r\n        desc: `If a model in this unit would flee as a result of a failed battleshock test, you can roll a dice. On a 2+, that model does not flee.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Razorgors: {\r\n    effects: [\r\n      {\r\n        name: `Baited Charge`,\r\n        desc: `If this unit is within 3\" of any friendly UNGORS units at the end of your charge phase, and this unit made a charge move in the same turn, double the Attacks characteristic of this unit's melee weapons until the end of that turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Feed on Mangled Remains`,\r\n        desc: `At the end of each phase, you can heal 1 wound allocated to this unit if it is within 6\" of any enemy units that have had any models slain in that phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Slaangor Fiendbloods': {\r\n    effects: [\r\n      ChampionEffect,\r\n      {\r\n        name: `Slaughter at Any Cost`,\r\n        desc: `At the end of any phase, if any wounds or mortal wounds were allocated to this unit in that phase, and this unit is more than 9\" from all enemy units, this unit can move up to D6\".`,\r\n        when: [END_OF_ANY_PHASE],\r\n      },\r\n      {\r\n        name: `Obsessive Violence`,\r\n        desc: `Once per battle, in the combat phase, after this unit has fought for the first time in that phase, you can say that it will continue its obsessive onslaught. If you do so, this unit can fight for a second time in that phase. The strike-last effect applies to this unit when it fights for that second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Doombull: {\r\n /*   mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, [\"Slaughterer's Call\"])],\r\n    }, */\r\n    effects: [\r\n      BloodgreedEffect,\r\n      {\r\n        name: `Alpha Charge`,\r\n        desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that unit suffers D3 mortal wounds at the end of that phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bullgors: {\r\n    effects: [\r\n      ChampionEffect,\r\n      BloodgreedEffect,\r\n      {\r\n        name: `Warherd Charge`,\r\n        desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that unit suffers 1 mortal wound at the end of that phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Warherd Drummer`,\r\n        desc: `Add 1 to charge rolls for a unit that includes any Warherd Drummers.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Warherd Banner Bearer`,\r\n        desc: `1 in every 3 models in this unit can be a Warherd Banner Bearer. if it includes any Warherd Banner Bearers, you can reroll the dice that determines whether an enemy unit suffers 1 mortal wound from the Warherd Charge.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dual Axes`,\r\n        desc: `You can reroll hit rolls of 1 for attacks made with a pair of Bullgor Axes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bullshields`,\r\n        desc: `If this unit is armed with Cleaving Axes and Bullshields, it has a Save characteristic of 4+ instead of 5+.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ghorgon: {\r\n   /* mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Feast on Flesh'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Swallow Whole`,\r\n        desc: `After this unit makes a pile-in move, you can pick a number of enemy models within 3\" of this unit equal to or less than the Swallow Whole value shown on this unit's damage table, and roll a dice for each. If the roll is greater than that model's Wounds characteristic, it is slain. If an enemy model is slain by this ability, you can heal a number of wounds allocated to this unit equal to the Wounds characteristic of that slain model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Cygor: {\r\n   /* mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Consume Endless Spell'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Soul-eater`,\r\n        desc: `This unit can attempt to unbind 2 spells in the enemy hero phase in the same manner as a WIZARD. In addition, each time an enemy WIZARD within 30\" of any friendly units with this ability successfully casts a spell and that spell is not unbound, the caster suffers 1 mortal wound after the effect of that spell has been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dragon Ogor Shaggoth': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Summon Lightning'])],\r\n    },\r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      BeneathTheTempestEffect,\r\n      {\r\n        name: `Scion of the Primordial Storm`,\r\n        desc: `Each time this unit is affected by a spell or the abilities of an endless spell, you can roll a dice. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on this unit.`,\r\n        when: [HERO_PHASE, END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dragon Ogors': {\r\n    effects: [\r\n      GenericEffects.Elite,\r\n      BeneathTheTempestEffect,\r\n      {\r\n        name: `Storm Rage`,\r\n        desc: `If this unit made a charge move in the same turn, if the unmodified hit roll for an attack made by this unit is 6, that attack wounds the target automatically (do not make a wound roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Warhounds': {\r\n    effects: [\r\n      {\r\n        name: `Outrunners of Chaos`,\r\n        desc: `When you make a charge roll for this unit, you can change 1 of the dice in that roll to a 4.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chaos Spawn': {\r\n    effects: [\r\n      {\r\n        name: `Writhing Tentacles`,\r\n        desc: `If you roll a double when determining the number of attacks, add 1 to hit rolls and wound rolls for attacks made by this unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      PropagatorOfDevolutionEffect,\r\n    ],\r\n  },\r\n  Jabberslythe: {\r\n   /* mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Aura of Madness'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Spurting Bile Blood`,\r\n        desc: `Roll a dice each time a melee wound is allocated to this unit. On a 4+ the attacker suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Cockatrice: {\r\n    effects: [\r\n      {\r\n        name: `Petrifying Gaze`,\r\n        desc: `At the start of the combat phase, you can pick 1 enemy unit within 6\" of this unit and roll a dice. On a 4+, that unit suffers D3 mortal wounds.\r\n        In addition, if any mortal wounds caused by this ability are allocated to a unit, until the end of that phase, only unmodified hit rolls of 6 for attacks made with melee weapons by that unit score a hit. The same unit cannot be affected by this ability more than once per phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Petrifying Gaze`,\r\n        desc: `If active, only unmodified hit rolls of 6 for attacks made with melee weapons by that unit score a hit for the enemy unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Maddened Ferocity`,\r\n        desc: `Double the Attacks characteristic of this unit's melee weapons if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Chimera: {\r\n   /* mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Thricefold Savagery'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Fiery Breath`,\r\n        desc: `Do not use the attack sequence for an attack made with Fiery Breath. Instead the target suffers D3 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Shaman': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Boon of Mutation'])],\r\n    },\r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Sorcerous Elixir`,\r\n        desc: `Once per battle, in your hero phase, this unit can attempt to cast 1 extra spell. If it does so, you can add 3 to the casting roll for that spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Skyfires': {\r\n    effects: [\r\n      ChampionEffect,\r\n      {\r\n        name: `Guided by the Future`,\r\n        desc: `Ignore negative modifiers to hit or wound rolls for attacks made with missile weapons by this unit, and ignore positive modifiers to save rolls for attacks made with missile weapons by this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Judgement from Afar`,\r\n        desc: `If the unmodified hit roll for an attack made with an Arrow of Fate is 6, the target suffers D3 mortal wounds and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Enlightened': {\r\n    effects: [TzaangorChampionEffect, BabblingStreamOfSecretsEffect, GuidedByThePastEffect],\r\n  },\r\n  'Tzaangor Enlightened on Discs of Tzeentch': {\r\n    effects: [TzaangorChampionEffect, BabblingStreamOfSecretsEffect, GuidedByThePastEffect],\r\n  },\r\n  Tzaangors: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be an Twistbray. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Standard Bearer`,\r\n        desc: `1 in every 10 models in this unit can be an Icon Bearer. While this unit includes any Icon Bearers, it can use the Ornate Totems ability.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Musician`,\r\n        desc: `1 in every 10 models in this unit can be a Brayhorn Blower. While this unit includes any Brayhorn Blowers, it can run and still charge later in the turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Tzaangor Mutant`,\r\n        desc: `1 in every 5 models in this unit can be a Tzaangor Mutant armed with a pair of Savage Blades and Vicious Beak. Add 1 to the Attacks characteristic of that model's pair of Savage Blades.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Savagery Unleashed`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's Vicious Beaks if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ornate Totem`,\r\n        desc: `While this unit includes any Icon Bearers, at the start of your hero phase, you can pick 1 enemy unit within 18\" of this unit and roll a dice for each Wizard that is within 9\" of this unit. For each 4+, the unit you picked suffers 1 mortal wound.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morghurite Chaos Spawn': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Insanity`,\r\n        desc: `Subtract 1 from the Attacks characteristic of weapons used by enemy units while they are within 1\" of this unit (to a minimum of 1).`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      PropagatorOfDevolutionEffect,\r\n    ],\r\n  },\r\n  'Chaos Gargant': {\r\n    effects: [\r\n      ...GenericEffects.Gargant,\r\n      {\r\n        name: `Stuff 'Em In Me Bag`,\r\n        desc: `After this unit makes a pile-in move, pick 1 enemy model within 3\" of it and roll a dice. If the roll is at least double that model's Wounds characteristic, it is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of Foulness`,\r\n        desc: `Subtract 1 from save rolls for enemy units within 3\" of any friendly units with this ability.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Whipped into a Frenzy`,\r\n        desc: `If this unit is within 6\" of any friendly BEASTS OF CHAOS HEROES, add 1 to the Attacks characteristic of this unit's melee weapons until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grashrak Fellhoof': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Savage Bolt'])],\r\n    },\r\n    effects: [InfuseWithBestialVigorEffect, GenericEffects.WizardOneSpellEffect],\r\n  },\r\n  \"Grashrak's Despoilers\": {\r\n    effects: [\r\n      {\r\n        name: `Violent Despoilers`,\r\n        desc: `Add 1 to hit rolls for attacks made by the Despoilers' unit while it is wholly outside your territory.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Grashrak's Savage Herd`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly GRASHRAK FELLHOOF within 3\" of this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly GRASHRAK FELLHOOF within 3\" of this unit, roll a dice. On a 4+, that wound or mortal wound must be allocated to this unit instead of GRASHRAK FELLHOOF.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: The Coven of Thryx': {\r\n    effects: [\r\n      {\r\n        name: `Magister: Magic-Touched`,\r\n        desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n        Add 1 to this units power level.  \r\n        If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pink Horrors: Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tome of Eyes: Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      }, \r\n      {\r\n        name: `Burning SIgil of Tzeentch: Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sparks of Profane Potential - Once Per Battle`,\r\n        desc: `Effect: If the Magister in the Regiment of Renown has been deployed, set up one of the following Manifestations within 1\" of them:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Skilled Summoner: Casting value of 6`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick 1 of the Manifestations from the list below that is not on the battlefield, then make a casting roll of 2D6:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum \r\n        Effect: If there is already a friendly Manifestation from the list above on the battlefield, it is immediately banished. Then, set up the Manifestation you picked within 1\" of the caster and visible to them. If that Manifestation is a Daemonic Simulacrum, it must also be set up more than 9\" away from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flickering Wyrdflame - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points inflicted on it this turn by Wyrdflame Spell abilities or attacks made with weapons that have the Wyrdflame weapon ability to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { BEASTS_OF_CHAOS } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst SubFactions = {\r\n  [BEASTS_OF_CHAOS]: {\r\n    effects: pickEffects(BattleTraits, [BEASTS_OF_CHAOS]),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n      monstrous_rampages: [MonstrousRampages],\r\n      scenery: [Scenery],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default SubFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { BEASTS_OF_CHAOS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const BeastOfChaosFaction = new Faction(\r\n  BEASTS_OF_CHAOS,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Greatfrays',\r\n  rule_sources.BATTLETOME_BEASTS_OF_CHAOS\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_CITIES_OF_SIGMAR: {\r\n    name: 'Battletome: Cities of Sigmar',\r\n    type: 'battletome',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_ANY_PHASE,\r\n  DURING_GAME,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Artifacts = {\r\n  \"Sacred Tome\": {\r\n    effects: [\r\n      {\r\n        name: `Sacred Tome`,\r\n        desc: `Effect: If this unit is not a Priest, it has Priest (1). If this unit is already a Priest, add 1 to chanting rolls for this unit. If this unit is a Wizard, it cannot use Spell abilities and Prayer abilities in the same phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glimmering': {\r\n    effects: [\r\n      {\r\n        name: `Glimmering`,\r\n        desc: `Effect: Each phase, you can re-roll 1 hit roll, or 1 wound roll, or 1 save roll for this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n/*  Glimmering: {\r\n    effects: [\r\n      {\r\n        name: `Glimmering`,\r\n        desc: `Once per phase, you can reroll 1 hit roll or 1 wound roll for an attack made by the bearer, or 1 save roll for an attack that targets the bearer.`,\r\n        when: [DURING_ANY_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n  'Brazier of Holy Flame': {\r\n    effects: [\r\n      {\r\n        name: `Brazier of Holy Flame`,\r\n        desc: `Declare: Pick a friendly non-Hero Cities of Sigmar Infantry unit that is not in combat and wholly within 12\" of this unit. \r\n        Effect: You can return up to D3 slain models to that unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* \"Shemtek's Grimoire\": {\r\n    effects: [\r\n      {\r\n        name: `Shemtek's Grimoire`,\r\n        desc: `WIZARD only. Once per battle, at the start of the enemy hero phase, you can say that the bearer will conjure a storm. If you do so, roll a D3. Until the end of that phase, subtract the amount of that roll from casting rolls made for enemy WIZARDS.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sigmarite Warhammer': {\r\n    effects: [\r\n      {\r\n        name: `Sigmarite Warhammer`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Improve the Rend characteristic of that weapon by 1 and add 1 to the Damage characteristic of that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Flask of Lethisian Darkwater': {\r\n    effects: [\r\n      {\r\n        name: `Flask of Lethisian Darkwater`,\r\n        desc: `Once per battle, at the end of any phase, you can say that the bearer will sip from the flask. If you do so, you can heal up to D6 wounds allocated to the bearer.`,\r\n        when: [END_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Book of Grudges': {\r\n    effects: [\r\n      {\r\n        name: `Book of Grudges`,\r\n        desc: `At the start of your hero phase, if the bearer is more than 3\" from all enemy units, you can say they will read from the Book of Grudges. If you do so, pick 1 enemy unit that is visible to the bearer and roll a dice. On a 4+, a grudge is found. Add 1 to hit rolls for attacks made by friendly CITIES OF SIGMAR DUARDIN units that target that enemy unit until the next grudge is found.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Piledriver Gauntlets': {\r\n    effects: [\r\n      {\r\n        name: `Piledriver Gauntlets`,\r\n        desc: `At the start of the combat phase, if this unit is within 3\" of any enemy units, you can say it will strike the ground. If you do so, the bearer cannot fight this phase; however, roll a dice for each enemy unit within 3\" of the bearer. On a 4+, the strike-last effect applies to that enemy unit until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Heavy Metal Ingot': {\r\n    effects: [\r\n      {\r\n        name: `Heavy Metal Ingot`,\r\n        desc: `Ignore negative modifiers to save rolls for attacks that target the bearer if the bearer has not made a move in the same turn.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shadowshroud Ring': {\r\n    effects: [\r\n      {\r\n        name: `Shadowshroud Ring`,\r\n        desc: `Once per battle, at the start of your hero phase, you can say that the bearer will use the ring. If you do so, until the start of your next hero phase, the bearer is not visible to enemy units that are more than 12\" away.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Anklet of Epiphany': {\r\n    effects: [\r\n      {\r\n        name: `Anklet of Epiphany`,\r\n        desc: `WIZARD only. Add 6\" to the range of spells cast by the bearer while the bearer is wholly on a terrain feature and/or is contesting an objective.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { CITIES_OF_SIGMAR } from 'meta/factions'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_ROUND,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SHOOTING_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTraits = {\r\n  [CITIES_OF_SIGMAR]: {\r\n    effects: [\r\n      {\r\n        name: `Advance in Formation - Officar's Order`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Hero that has not used an Officars Order ability this turn to use this ability, then pick a friendly Cities of Sigmar unit wholly within 12\" of that Hero and not in combat to be the target. \r\n        If the target is Human, you can pick an additional Cities of Sigmar unit wholly within 12\" of that Hero and not in combat to be a target. \r\n        Effect: Each target can move 3\". Each target cannot move into combat during any part of that move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Strike Them Down - Officar's Order`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Hero that has not used an Officars Order ability this turn to use this ability, then pick a friendly Cities of Sigmar unit that charged this turn that is wholly within 12\" of that Hero to be the target. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn. \r\n        In addition, if the target is an Aelf unit, add 1 to hit rolls for the targets combat attacks for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Suppressing Fire - Officar's Order`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Hero that has not used an Officars Order ability this turn to use this ability, then pick a friendly Cities of Sigmar unit wholly within 12\" of that Hero to be the target. \r\n        Effect: Each time the target uses a Shoot ability this phase, if all of its attacks targeted the same enemy unit, after that ability has been resolved, roll a dice. If the result is equal to or less than the number of models in that enemy unit that were slain by shooting attacks this phase, that enemy unit has Strike-last for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hold the Line - Officar's Order`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Hero that has not used an Officars Order ability this turn to use this ability, then pick a friendly Cities of Sigmar unit wholly within 12\" of that Hero and that did not charge this turn to be the target. \r\n        Effect: The target has Strike-last and Ward (5+) for the rest of the turn. \r\n        In addition, if the target is Duardin, subtract 1 from hit rolls for combat attacks that target that unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      \r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport prayers from './prayers'\r\n\r\nconst CommandTraits = {\r\n  'Master of Balistics': {\r\n    effects: [\r\n      {\r\n        name: `Master of Balistics'`,\r\n        desc: `Effect: If a friendly Cities of Sigmar unit uses the All-out Attack command in the shooting phase while it is within this units combat range, add 1 to wound rolls for that units shooting attacks in that phase. This effect is in addition to the effect of All-out Attack.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grizzled Veteran': {\r\n    effects: [\r\n      {\r\n        name: `Grizzled Veteran`,\r\n        desc: `Effect: If the unmodied wound roll for an attack that targets this unit is a 1-3, the attack fails and the attack sequence ends.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Fiery Temper': {\r\n    effects: [\r\n      {\r\n        name: `Fiery Temper`,\r\n        desc: `Effect: If this unit charged this turn, you can re-roll charge rolls for friendly Cities of Sigmar units while they are wholly within 18\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Fiery Temper': {\r\n    effects: [\r\n      {\r\n        name: `Fiery Temper`,\r\n        desc: `You can reroll charge rolls for this general. In addition, if this general made a charge move in the same turn, you can reroll charge rolls for friendly CITIES OF SIGMAR HUMAN units while they are wholly within 18\" of this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Of Mighty Lineage': {\r\n    effects: [\r\n      {\r\n        name: `Of Mighty Lineage`,\r\n        desc: `At the start of the combat phase, you can say that this general will issue a challenge. If you do so, pick 1 enemy HERO within 3\" of this general. Until the end of that phase, the strike-first effect applies to this general, but all of the attacks they make in that phase must target that enemy HERO.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Insurmountable Resilience': {\r\n    effects: [\r\n      {\r\n        name: `Insurmountable Resilience`,\r\n        desc: `At the end of each combat phase, roll a dice for each wound currently allocated to this general. On a 3+, that wound is healed.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master of Ancient Lore': {\r\n    effects: [\r\n      {\r\n        name: `Master of Ancient Lore`,\r\n        desc: `This general becomes a PRIEST. If this general is already a DUARDIN PRIEST, they know 1 additional prayer from the Rune Lore prayer scripture.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unparalleled Duellist': {\r\n    effects: [\r\n      {\r\n        name: `Unparalleled Duellist`,\r\n        desc: `For each hit roll for an attack made with a melee weapon that targets this general that does not score a hit, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Draconic Blood-pact': {\r\n    effects: [\r\n      {\r\n        name: `Draconic Blood-pact`,\r\n        desc: `HERO mounted on Black Dragon only. At the start of the combat phase, you can say that this general will draw power from their draconic blood-pact. If you do so, this general suffers 1 mortal wound that cannot be negated. However, until the end of that phase, add 1 to the Attacks characteristic of the weapons this general's mount is armed with.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Divine Champion': {\r\n    mandatory: {\r\n      prayers: [keyPicker(prayers, ['Hammer of Sigmar'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Divine Champion`,\r\n        desc: `This general becomes a PRIEST if they are not already a PRIEST. In addition, they know the Hammer of Sigmar prayer in addition to any other prayers they know:`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport prayers from './prayers'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Dawnbringer Crusade': {\r\n    effects: [\r\n      {\r\n        name: `Forward, Dawnders! - Passive`,\r\n        desc: `Effect: Add 2\" to the Move characteristic of friendly Cities of Sigmar units in the rst battle round.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ironweld Guild Army': {\r\n    effects: [\r\n      {\r\n        name: `Faith and Firepower - Passive`,\r\n        desc: `Effect: Add 3\" to the Range characteristic of ranged weapons used by friendly Cities of Sigmar units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fortress-City Defenders': {\r\n    effects: [\r\n      {\r\n        name: `Bulwark Zone - Passive`,\r\n        desc: `Effect: Friendly Cities of Sigmar units that have the Fortify Position ability start the rst battle round in a fortified position. \r\n        In addition, in the rst battle round, subtract 1 from wound rolls for attacks that target friendly Cities of Sigmar units while they are wholly within friendly territory.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Collegiate Arcane Expedition': {\r\n    effects: [\r\n      {\r\n        name: `Eldritch Expertise - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Cities of Sigmar Wizards.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Hallowheart: {\r\n    effects: [\r\n      {\r\n        name: `Wild Magic`,\r\n        desc: `When you attempt to cast a spell with a friendly HALLOWHEART WIZARD, you can say they will harness wild magic. If you do so, roll 3 dice instead of 2 for that casting roll. However, on an unmodified roll of 10+, the caster suffers D3 mortal wounds after any effects of the spell have been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Tempest's Eye\": {\r\n    effects: [\r\n      {\r\n        name: `Rapid Redeploy`,\r\n        desc: `Friendly TEMPEST'S EYE and allied KHARADRON OVERLORDS SKYVESSEL units (including units embarked in them), can retreat and still shoot in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Misthavn: {\r\n    effects: [\r\n      {\r\n        name: `Shadowed Approach`,\r\n        desc: `At the end of your hero phase, you can pick up to 3 different friendly MISTHVN units that are more than 12\" from all enemy units. Each of those units can make a move of up to D6\" (roll separately for each). If the unit has a mount/s (not including crew and/or companions), it can make a move of up to 2D6\" instead of D6\". Units can finish this move within 3\" of enemy units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  \"Settler's Gain\": {\r\n    effects: [\r\n      {\r\n        name: `Expert Instruction`,\r\n        desc: `Add 1 to casting rolls for friendly SETTLER'S GAIN WIZARDS.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Expert Instruction`,\r\n        desc: `At the start of each hero phase, you receive 1 additional command point if the model picked to be your general is within 3\" of any friendly allied LUMINETH REALM-LORDS HEROES.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Excelsis: {\r\n    effects: [\r\n      {\r\n        name: `Fearsome Breeds`,\r\n        desc: `Add 1 to the Wounds characteristic of friendly EXCELSIS MONSTERS. In addition, each time a friendly EXCELSIS FREEGUILD CAVALIERS unit fights, after all of its attacks have been resolved, pick 1 enemy unit within 3\" of that FREEGUILD CAVALIERS unit and roll a dice for each model in that FREEGUILD CAVALIERS unit. For each roll of 4+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Fearsome Breeds`,\r\n        desc: `Each time a friendly EXCELSIS FREEGUILD CAVALIERS unit fights, after all of its attacks have been resolved, pick 1 enemy unit within 3\" of that FREEGUILD CAVALIERS unit and roll a dice for each model in that FREEGUILD CAVALIERS unit. For each roll of 4+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Vindicarum: {\r\n    effects: [\r\n      {\r\n        name: `Unyielding Faith`,\r\n        desc: `Friendly VINDICARUM units can receive the Rally command while they are within 3\" of any enemy units. In addition, when a friendly VINDICARUM FLAGELLANTS unit receives the Rally command, you can return 1 slain model to that unit for each 5+ instead of each 6.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Lethis: {\r\n    mandatory: {\r\n      prayers: [keyPicker(prayers, [\"Morrda's Embrace\"])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `The Raven Priests`,\r\n        desc: `Friendly LETHIS HUMAN HEROES that are not WIZARDS become PRIESTS. In addition, friendly LETHIS HUMAN PRIESTS and friendly allied STORMCAST ETERNALS PRIESTS know the \"Morrda's Embrace\" prayer in addition to any others they know.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Prayers = {\r\n /* Forgefire: {\r\n    effects: [\r\n      {\r\n        name: `Forgefire`,\r\n        desc: `Answer value of 4 and a range of 18\". If answered, pick 1 friendly CITIES OF SIGMAR DUARDIN unit wholly within range and visible to the chanter. Until the start of your next hero phase, improve the Rend characteristic of that unit's melee weapons by 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Scriptures of Sigmar': {\r\n    effects: [\r\n      {\r\n        name: `Wrath and Ruin: Chant value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Priest to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modiers to save rolls for the target until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unfaltering Aim: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Priest to chant this prayer, pick a visible friendly Cities of Sigmar unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Add 1 to hit rolls for the targets shooting attacks for the rest of the turn. In addition, if the chanting roll was 10+, add 1 to wound rolls for the targets shooting attacks for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Oath and Steel: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Priest to chant this prayer, pick a visible friendly Cities of Sigmar unit wholly within 12\" of them to be the target, then make a chanting roll of D6. Add 1 to the roll if the chanter is Duardin. \r\n        Effect: Subtract 1 from wound rolls for attacks that target that unit until the start of your next turn. In addition, if the chanting roll was 10+, add 1 to save rolls for the target until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Rune of Oath and Steel': {\r\n    effects: [\r\n      {\r\n        name: `Rune of Oath and Steel`,\r\n        desc: `Rune of Oath and Steel is a prayer with an answer value of 3 and a range of 12\". If answered, pick 1 friendly CITIES OF SIGMAR DUARDIN unit wholly within range and visible to the chanter. Subtract 1 from wound rolls for attacks that target that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rune of Wrath and Ruin': {\r\n    effects: [\r\n      {\r\n        name: `Rune of Wrath and Ruin`,\r\n        desc: `Rune of Wrath and Ruin is a prayer with an answer value of 3 and a range of 18\". If answered, pick 1 enemy unit within range and visible to the chanter. Roll 6 dice. For each roll of 5+, that enemy unit suffers 1 mortal wound. In addition, if a unit suffers 3 or more mortal wounds when this prayer is answered, that unit is ruined until the start of your next hero phase. While a unit is ruined, ignore positive modifiers to save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vessel of Sigmar': {\r\n    effects: [\r\n      {\r\n        name: `Vessel of Sigmar`,\r\n        desc: `Vessel of Sigmar is a prayer with an answer value of 3. If answered, and this unit is within your territory, pick 1 of the effects below to apply until the start of your next hero phase. If answered and this unit is not within your territory, pick 2 of the effects below to apply until the start ofyour next hero phase instead of 1:\r\n\r\n        Hallowed Ground: Friendly CITIES OF SIGMAR HUMAN units have a ward of 5+ while they are wholly within 18\" of this unit.\r\n        \r\n        The Great Wheel Turns: Add 2\" to the Move characteristic of friendly CITIES OF SIGMAR HUMAN units on the battlefield.\r\n        \r\n        Cast Out Evil: Roll a dice for each enemy WIZARD and PRIEST on the battlefield. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hammer of Sigmar': {\r\n    effects: [\r\n      {\r\n        name: `Hammer of Sigmar`,\r\n        desc: `Answer value of 4 and a range of 12\". If answered, until the start of your next hero phase, add 1 to wound rolls for attacks made with melee weapons by friendly CITIES OF SIGMAR HUMAN units while they are wholly within range of the chanter.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Morrda's Embrace\": {\r\n    effects: [\r\n      {\r\n        name: `Morrda's Embrace`,\r\n        desc: `Morrda's Embrace is a prayer with an answer value of 4 and a range of 12\". If answered, pick 1 enemy unit within range and visible to the chanter. Ward saves cannot be made for that enemy unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst Spells = {\r\n  'Spells of the Collegiate Arcane': {\r\n    effects: [\r\n      {\r\n        name: `Elemental Lightning: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Wizard to cast this spell, pick a visible enemy unit within 18\" of them that has not been picked to be the target of this ability this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target. Then, roll a dice for each other enemy unit within the targets combat range. On a 4+, inflict D3 mortal damage on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Speed of the Twin-Tailed Comet: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Wizard to cast this spell, pick a visible friendly Cities of Sigmar unit wholly within 12\" to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, add 1 to the number of dice rolled when making charge rolls for the target, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cindercloud: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from the Attacks characteristic of the targets melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }\r\n /* Wildform: {\r\n    effects: [\r\n      {\r\n        name: `Wildform`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 friendly CITIES OF SIGMAR HUMAN unit that is wholly within range and visible to the caster. Until the start of your next hero phase, you can attempt a charge with that unit if it is within 18\" of the enemy instead of 12\". In addition, roll 3D6 instead of 2D6 for charge rolls made for that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* Fireball: {\r\n    effects: [\r\n      {\r\n        name: `Fireball`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Roll 1 dice for each model in that unit. For each roll of 6, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mystifying Miasma': {\r\n    effects: [\r\n      {\r\n        name: `Mystifying Miasma`,\r\n        desc: `Casting value of 5 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. That unit cannot run until your next hero phase. In addition, subtract 2 from charge rolls for that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pall of Doom': {\r\n    effects: [\r\n      {\r\n        name: `Pall of Doom`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That enemy unit cannot issue or receive commands until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Pha's Protection\": {\r\n    effects: [\r\n      {\r\n        name: `Pha's Protection`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 friendly CITIES OF SIGMAR HUMAN unit wholly within range and visible to the caster. Until the start of your next hero phase, ignore modifiers (positive and negative) to save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Transmutation of Lead': {\r\n    effects: [\r\n      {\r\n        name: `Transmutation of Lead`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy within range and visible to the caster. Roll a number of dice equal to the number of models in that unit. For each roll that equals or exceeds that unit's Save characteristic, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amber Spear': {\r\n    effects: [\r\n      {\r\n        name: `Amber Spear`,\r\n        desc: `Casting value of 7. Pick 1 point on the battlefield within 18\" of the caster that is visible to them and draw a straight line between that point and the closest point on the caster's base. Roll a dice for each unit that has any models passed across by that line. On a 2+, that unit suffers D3 mortal wounds or 3 mortal wounds if it is a MONSTER.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Burning Gaze': {\r\n    effects: [\r\n      {\r\n        name: `Burning Gaze`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. Double the number of mortal wounds caused if that unit has 10 or more models, or triple the number of mortal wounds caused if that unit has 20 or more models.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Word of Pain': {\r\n    effects: [\r\n      {\r\n        name: `Word of Pain`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. In addition, subtract 1 from hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bladestorm: {\r\n    effects: [\r\n      {\r\n        name: `Bladestorm`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster and roll 9 dice. For each roll that is less than that unit's Save characteristic, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blazing Weapons': {\r\n    effects: [\r\n      {\r\n        name: `Blazing Weapons`,\r\n        desc: `Casting value of 7 and a range of 12\". If successfully cast, until the start of your next hero phase, friendly CITIES OF SIGMAR HUMAN units have blazing weapons while they are wholly within 12\" of this unit. While a unit has blazing weapons, each unmodified hit roll of 6 for an attack made by that unit with a melee weapon causes 1 mortal wound to the target in addition to any damage it inflicts.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_CITIES_OF_SIGMAR,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'Rain of Jade': {\r\n    effects: [\r\n      {\r\n        name: `Rain of Jade`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 friendly CITIES OF SIGMAR HUMAN model wholly within range and visible to the caster. Roll a dice for each wound currently allocated to that model. On a 5+, that wound is healed.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Umbral Hex': {\r\n    effects: [\r\n      {\r\n        name: `Umbral Hex`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until the start of your next hero phase, each time a battleshock roll is made for that unit, 2D6 must be rolled instead of 1 dice.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tenebrael Blades': {\r\n    effects: [\r\n      {\r\n        name: `Tenebrael Blades`,\r\n        desc: `Casting value of 7 and a range of 9\". Pick 1 friendly CITIES OF SIGMAR AELF unit wholly within range and visible to the caster. Until the start of your next hero phase, when making save rolls for attacks made with melee weapons by that CITIES OF SIGMAR AELF unit, the target's Save characteristic is '-'.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport prayers from './prayers'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport monstrous_rampages from './monstrous_rampages'\r\n\r\nconst CelestialHurricanumEffects = [\r\n  {\r\n    name: `Portents of Battle`,\r\n    desc: `Add 1 to hit rolls for attacks made by friendly CITIES OF SIGMAR HUMAN units wholly within 9\" of any friendly units with this ability.`,\r\n    when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Storm of Shemtek`,\r\n    desc: `In your hero phase, you can pick 1 enemy unit within 18\" of this unit and roll a number of dice equal to the number of the current battle round. For each roll of 2+, that enemy unit suffers D3 mortal wounds.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst LuminarkEffects = [\r\n  {\r\n    name: `Aura of Protection`,\r\n    desc: `Friendly CITIES OF SIGMAR HUMAN units have a ward of 6+ while they are wholly within 9\" of any friendly units with this ability.`,\r\n    when: [WARDS_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Searing Beam of Light`,\r\n    desc: `Do not use the attack sequence for an attack made with Searing Beam of Light. Instead, pick 1 point on the battlefield within range of the shooting model that is visible to it and draw a straight line between that point and the closest point on the shooting model's base. Roll a dice for each unit that has any models passed across by that line. For each roll of 2+, that unit suffers D3 mortal wounds.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst SteamTankEffects = [\r\n  {\r\n    name: `More Pressure!`,\r\n    desc: `In your hero phase, you can say that this unit will overpressure its boiler. If you do so, roll 2D6. If the roll is less than the number of wounds currently allocated to this unit, this unit suffers D3 mortal wounds. Ifthe roll is equal or greater than the number of wounds currently allocated to this unit, pick 1 of the following effects to apply to this unit until the start of your next hero phase:\r\n\r\n    Power the Wheels: This unit can run and shoot and/or charge in the same turn.\r\n    \r\n    Power the Guns: Add 1 to the Attacks characteristic of this unit's Steam Cannon and add D6 to the Attacks characteristic of this unit's Steam Gun.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Steel Behemoth`,\r\n    desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst BloodSacrificeEffect = {\r\n  name: `Blood Sacrifice`,\r\n  desc: `At the start of your hero phase, you can pick 1 friendly DARKLING COVENS model within 3\" of this unit to be slain. If you do so, add 2 to casting rolls for this unit until the end of that phase.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst NoxiousBreathEffect = {\r\n  name: `Noxious Breath`,\r\n  desc: `The Attacks characteristic of Noxious Breath is equal to the number of models in the target unit (to a maximum Attacks characteristic of 10).`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst GrimResolveEffect = {\r\n  name: `Grim Resolve`,\r\n  desc: `This unit has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst WeaponsOfBanishmentEffect = {\r\n  name: `Weapons of Banishment`,\r\n  desc: `Double the Damage characteristic of an attack made with this model's weapons if the target of that attack is a WIZARD or DAEMON. In addition, when this model fights or shoots, you can choose an endless spell to be the target of any of its attacks. If you do so, roll a dice to see if that attack scores a hit. If it does, do not make a wound or save roll. Instead, roll 2D6. If the roll is greater than the casting value of that endless spell, that endless spell is dispelled.`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CinderblastBombEffect = {\r\n  name: `Cinderblast Bomb`,\r\n  desc: `If this unit includes a model armed with a Cinderblast Bomb, once per battle, in your shooting phase, that model can throw it. If it does so, pick 1 enemy unit within 6\" of that model and roll a dice. On a 2+, that unit suffers D3 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  Battlemage: {\r\n    effects: [\r\n      // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Magic of the Realms`,\r\n        desc: `Effect: Pick a Spell ability that this unit can use. For the rest of the battle, add 1 to casting rolls for this unit when it uses that Spell ability.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Battlemage on Griffon': {\r\n    /* mandatory: {\r\n       spells: [keyPicker(spells, ['Amber Spear'])],\r\n     }, */\r\n    effects: [\r\n      // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Grions Razor Claws and Twin Beaks is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ghurish Ferocity - Once Per Turn`,\r\n        desc: `Effect: Roll a dice. On a 2+, add 1 to the Damage characteristic of this units Grions Razor Claws and Twin Beaks for attacks that target enemy Monsters for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Battlemage on Celestial Hurricanum': {\r\n    /* mandatory: {\r\n       spells: [keyPicker(spells, ['Chain Lightning'])],\r\n     }, */\r\n    //[GenericEffects.WizardOneSpellEffect, ...CelestialHurricanumEffects],\r\n    effects: [\r\n      {\r\n        name: `Portents of Battle - Once Per Turn`,\r\n        desc: `Declare: Pick up to D3 visible friendly Cities of Sigmar Human units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to hit rolls for the targets combat attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Storm of Shemtek - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target. \r\n        Effect: Make a number of D3 rolls equal to the current battle round number. For each 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ]\r\n  },\r\n\r\n  'Celestial Hurricanum': {\r\n   // [...CelestialHurricanumEffects], // updated 2024\r\n    effects: [\r\n      {\r\n        name: `Portents of Battle - Once Per Turn`,\r\n        desc: `Declare: Pick up to D3 visible friendly Cities of Sigmar Human units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to hit rolls for the targets combat attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Storm of Shemtek - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target. \r\n        Effect: Make a number of D3 rolls equal to the current battle round number. For each 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ]\r\n  },\r\n  'Battlemage on Luminark of Hysh': {\r\n    /*  mandatory: {\r\n        spells: [keyPicker(spells, ['Burning Gaze'])],\r\n      }, */\r\n    //[...LuminarkEffects],\r\n    effects: [\r\n      {\r\n        name: `Aura of Protection - Passive`,\r\n        desc: `Effect: Friendly Cities of Sigmar units have Ward (6+) while they are wholly within 12\" of this unit`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Searing Beam of Light - Passive`,\r\n        desc: `Effect: Each time this unit attacks with its Searing Beam of Light, pick a point on the battlefield within range to be the target. If the attack scores a hit, draw a straight line between that point and the closest point on this units base. Inflict D3 mortal damage on each visible unit (friendly and enemy) that the line passes across.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ]\r\n  },\r\n  'Luminark of Hysh': {\r\n   // [...LuminarkEffects],\r\n    effects: [\r\n      {\r\n        name: `Aura of Protection - Passive`,\r\n        desc: `Effect: Friendly Cities of Sigmar units have Ward (6+) while they are wholly within 12\" of this unit`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Searing Beam of Light - Passive`,\r\n        desc: `Effect: Each time this unit attacks with its Searing Beam of Light, pick a point on the battlefield within range to be the target. If the attack scores a hit, draw a straight line between that point and the closest point on this units base. Inflict D3 mortal damage on each visible unit (friendly and enemy) that the line passes across.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ]\r\n  },\r\n  Flagellants: {\r\n    effects: [\r\n      {\r\n        name: `Glorious Martyrs`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. Add 1 to the roll if this unit is wholly within 12\" of a friendly Pontifex Zenestra. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Steelhelms': {\r\n    effects: [\r\n      {\r\n        name: `Consecrate the Land - Once Per Turn`,\r\n        desc: `Declare: If this unit is contesting an objective you control that is not contested by any enemy models, roll a dice. \r\n        Effect: On a 3+, that objective is considered by you to be consecrated. While each model in a friendly Cities of Sigmar Human unit is contesting a consecrated objective, that unit has Ward (5+). If your opponent gains control of a consecrated objective, it is no longer consecrated.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Marshal on Griffon': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Grions Razor Claws and Deadly Beak is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tactical Acumen - Reaction: You declared the Redeploy command for a friendly Cities of Sigmar Human unit wholly within 12\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Piercing Bloodroar - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 4+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Marshal and Relic Envoy': {\r\n    effects: [\r\n      {\r\n        name: `Attendant Relic Envoy`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Human wholly within 18\" of this unit to be the target. \r\n        Effect: Place this units Relic Envoy next to the target (if this units Relic Envoy is currently next to a different friendly unit, move it next to the target). \r\n        While the target has a Relic Envoy next to it, it can be picked to be the target of an Officars Order ability even if it is not wholly within 12\" of the friendly Hero using that ability. \r\n        If this unit is destroyed, remove its Relic Envoy from the battlefield.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Rousing Orator - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Cities of Sigmar Human units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Command Corps': {\r\n    effects: [\r\n      {\r\n        name: `The Marshal's Retinue - Passive`,\r\n        desc: `Effect: While any friendly Freeguild Marshal and Relic Envoy units are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Freeguild Adjutants - Once Per Battle Round`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Human unit wholly within 12\" of this unit to be the target. \r\n        Effect: For the rest of the turn, the rst time the target uses the Redeploy, Rally, Covering Fire or Counter- charge command, you can pick another friendly Cities of Sigmar Human unit wholly within 12\" of this unit and that has not used a command this phase to use the same command immediately after the rst has been resolved (this is an exception to Commands, 1.2). You must still spend command points as normal to use the command a second time.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dispatch Spies - Once Per Battle - Reaction: Opponent declared a command for a unit within 12\" of this unit`,\r\n        desc: `Effect: Unless your opponent spends 1 additional command point to use that command, the command has no effect, it still counts as having been used and the command points spent to use the command are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Cavaliers': {\r\n    effects: [\r\n      {\r\n        name: `Devastating Charge`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a dice for each model in this unit that is in combat. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Fusiliers': {\r\n    effects: [\r\n      {\r\n        name: `Fusiliers, Fire! - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, if it is in a fortified position, use the Fortified Position weapon characteristics for all the attacks it makes with its Fusil-cannon. If it is not in a fortified position, use the Mobile weapon characteristics.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Fortify Position`,\r\n        desc: `Effect: This unit establishes a fortified position and remains in a fortified position until it either uses a Move ability or is removed from the battlefield. While this unit is in a fortified position, subtract 1 from the Rend characteristic of weapons used for attacks that target this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Blackpowder Squire - Passive`,\r\n        desc: `Effect: This unit has a Blackpowder Squire token. Each time this unit uses a Shoot ability, if this units Blackpowder Squire is on the battlefield, you can re-roll 1 hit roll. If a hit roll re-rolled in this manner is 1, remove this units Blackpowder Squire from the battlefield.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Freeguild Cavalier-Marshal': {\r\n    effects: [\r\n      {\r\n        name: `For Sigmar, Charge! - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for this unit and for friendly Freeguild Cavaliers units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Run Down the Foe - Once Per Battle`,\r\n        desc: `Declare: If this unit charged this turn, pick a friendly Cities of Sigmar Human Cavalry unit that charged this turn and is wholly within 12\" of this unit to be the target. Effect: This unit and the target have Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warden King': {\r\n    effects: [\r\n      {\r\n        name: `Ancestral Grudgebearer - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in your opponents army to bear a grudge against. You can pick an enemy unit that is in reserve. \r\n        Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by friendly Cities of Sigmar Duardin units that target that unit.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Fearless Leader - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Cities of Sigmar Duardin unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Runelord: {\r\n    /*  mandatory: {\r\n        prayers: [keyPicker(prayers, ['Forgefire'])],\r\n      }, */\r\n    effects: [\r\n      {\r\n        name: `Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Longbeards: {\r\n    effects: [\r\n      {\r\n        name: `I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Ironbreakers: {\r\n    effects: [\r\n     // CinderblastBombEffect,\r\n      {\r\n        name: `Gromril Shieldwall - Passive`,\r\n        desc: `Effect: While this unit is aected by the Hold the Line Officars Order ability, it has Ward (4+) instead of Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Irondrakes: {\r\n    effects: [\r\n      {\r\n        name: `Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Hammerers: {\r\n    effects: [\r\n      {\r\n        name: `Oathsworn - Passive`,\r\n        desc: `Effect: While any friendly Cities of Sigmar Duardin Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Steam Tank': {\r\n    effects: [\r\n      // ...SteamTankEffects,\r\n      {\r\n        name: `More Pressure!`,\r\n        desc: `Effect: Roll 2D6. If the roll is less than the number of damage points this unit has, inflict D3 mortal damage on this unit. Otherwise, pick 1 of the following effects to apply to this unit until the start of your next turn: \r\n        Power the Wheels: This unit can use a Run ability and still use Shoot and/or Charge abilities later in the turn.\r\n        Power the Guns: Add 3 to the Attacks characteristic of this units Steam Gun.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Steam Tank Commander': {\r\n    effects: [\r\n     // ...SteamTankEffects,\r\n     {\r\n      name: `More Pressure!`,\r\n      desc: `Effect: Roll 2D6. If the roll is less than the number of damage points this unit has, inflict D3 mortal damage on this unit. Otherwise, pick 1 of the following effects to apply to this unit until the start of your next turn: \r\n      Power the Wheels: This unit can use a Run ability and still use Shoot and/or Charge abilities later in the turn.\r\n      Power the Guns: Add 3 to the Attacks characteristic of this units Steam Gun.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Division Commander - Once Per Battle`,\r\n      desc: `Declare: Pick up to 2 friendly Steam Tank units to be the targets. \r\n      Effect: For the rest of the turn, add 1 to hit rolls for shooting attacks made by this unit and by each target.`,\r\n      when: [SHOOTING_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  Cogsmith: {\r\n    effects: [\r\n      {\r\n        name: `Direct the Gyrocorps - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 visible friendly Gyrocopter or Gyrobomber units wholly within 18\" of this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, add 1 to hit rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Steamtank: {\r\n    effects: [...SteamTankEffects], // updated 2024\r\n  }, */\r\n  Gyrobomber: {\r\n    effects: [\r\n      {\r\n        name: `Grudgebuster Bombs`,\r\n        desc: `Declare: If this unit used a Move ability this phase, pick an enemy unit that does not have Fly and that this unit passed across this turn to be the target. \r\n        Effect: Pick 1 of the following effects: \r\n        Tactical Bombing: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. \r\n        Drop It All!: Make 2 rolls of D3. For each 2+, inflict an amount of mortal damage on the target equal to the roll. Then, roll a D3 for each unit (friendly and enemy) within the targets combat range that does not have Fly. On a 2+, inflict an amount of mortal damage on that unit equal to the roll. Once the Drop It All! effect of this ability has been resolved, this unit cannot use this ability again for the rest of the battle.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gyrocopters: {\r\n    effects: [\r\n      {\r\n        name: `Guild Bombs - Once Per Battle`,\r\n        desc: `Declare: If this unit used a Move ability this phase, pick an enemy unit that does not have Fly and that this unit passed across this turn to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Sorceress: {\r\n    /*  mandatory: {\r\n        spells: [keyPicker(spells, ['Word of Pain'])],\r\n      },  [GenericEffects.WizardOneSpellEffect, BloodSacrificeEffect], */ \r\n    effects: [\r\n      {\r\n        name: `Cruel Sacrifice - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Aelf unit wholly within 6\" of this unit to be the target. \r\n        Effect: Add 1 to casting rolls for this unit for the rest of the turn. Then, roll a dice. On a 4+, 1 model in the target unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Word of Pain - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from hit rolls and wound rolls for the targets attacks until the start of your next turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ]\r\n  },\r\n  'Sorceress on Black Dragon': {\r\n    /* mandatory: {\r\n       spells: [keyPicker(spells, ['Bladestorm'])],\r\n     }, */\r\n    effects: [\r\n      // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Black Dragons Fearsome Jaws and Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Command Underlings`,\r\n        desc: `Declare: Pick up to 3 friendly Cities of Sigmar Aelf Infantry units wholly within 12\" of this unit to be targets. \r\n        Effect: Add 3\" to the Move characteristic of each target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Feed on Life Force - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If any enemy models are slain by this ability, place a dark sorcery token next to this unit for the rest of the battle, to a maximum of 3 tokens.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Dark Sorcery - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit for each dark sorcery token it has.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      // NoxiousBreathEffect,\r\n    ],\r\n  },\r\n  Dreadspears: {\r\n    effects: [\r\n      {\r\n        name: `Coven Guard`,\r\n        desc: `Effect: If this unit did not charge this turn, add 1 to wound rolls for this units attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bleakswords: {\r\n    effects: [\r\n      {\r\n        name: `Merciless Conquerors - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons while it is contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Darkshards: {\r\n    effects: [\r\n      {\r\n        name: `Storm of Iron-tipped Bolts`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to the Attacks characteristic of this units Master-craed Repeater Crossbows for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Guard': {\r\n    effects: [\r\n      {\r\n        name: `Steel and Sorcery - Passive`,\r\n        desc: `Effect: While any friendly Cities of Sigmar Aelf Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Executioners: {\r\n    effects: [\r\n      {\r\n        name: `Severing Strike - Passive`,\r\n        desc: `Effect: If this unit charged this turn, this units attacks score critical hits on unmodied hit rolls of 5+.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreadlord on Black Dragon': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Black Dragons Fearsome Jaws and Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Under the Shadow of Black Wings - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Cities of Sigmar Aelf Cavalry units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      //NoxiousBreathEffect,\r\n      {\r\n        name: `Indiscriminate Slaughter - Once Per Turn`,\r\n        desc: `Declare: Pick all units (friendly and enemy) within this units combat range, excluding this unit, to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Drakespawn Knights': {\r\n    effects: [\r\n      {\r\n        name: `Bestial Instincts`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units Drakespawns Ferocious Jaws while it is in combat with any damaged enemy units or while it is in combat with any enemy units that have had any models slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Drakespawn Chariots': {\r\n    effects: [\r\n      {\r\n        name: `Scythed Runners`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'War Hydra': {\r\n    effects: [\r\n      {\r\n        name: `Six-Headed Strike - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Make 6 rolls of D3. For each roll that exceeds the targets Health characteristic, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sever One Head, Another Takes Its Place - Once Per Turn`,\r\n        desc: `Effect: Heal (6) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Assassin: {\r\n    effects: [\r\n      {\r\n        name: `Hidden Murderer - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Infantry unit that has 5 or more models and this unit is not in combat, this unit is not visible to enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `In For the Kill - Passive`,\r\n        desc: `Effect: This unit has Strike-first if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dark Riders': {\r\n    effects: [\r\n      {\r\n        name: `Sow Havoc`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+:  \r\n        Inflict D3 mortal damage on the target.\r\n        This unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Black Ark Fleetmaster': {\r\n    effects: [\r\n      {\r\n        name: `'At Them, You Curs! - Reaction: You declared a Fight ability for this unit'`,\r\n        desc: `Effect: Pick a friendly Black Ark Corsairs unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Ark Corsairs': {\r\n    effects: [\r\n      {\r\n        name: `Skilled Swashbucklers - Passive`,\r\n        desc: `Effect: Each time you make an unmodied save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scourgerunner Chariots': {\r\n    effects: [\r\n      {\r\n        name: `Lay the Beast Low - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units shooting attacks that target enemy Monsters.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Kharibdyss: {\r\n    effects: [\r\n      {\r\n        name: `Abyssal Howl - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 5 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Doralia Ven Denst': {\r\n    // [GrimResolveEffect, WeaponsOfBanishmentEffect],\r\n    effects: [\r\n    {\r\n      name: `Weapeans of Banishment - Passive`,\r\n      desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n      when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n    },\r\n  ]\r\n  },\r\n  'Galen Ven Denst': {\r\n    effects: [\r\n     // GrimResolveEffect,\r\n      {\r\n        name: `Guardian and Mentor - Passive`,\r\n        desc: `Effect: While a friendly Doralia ven Denst is wholly within this units combat range, this unit has Strike-first and both this unit and that Doralia ven Denst have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Weapeans of Banishment - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n     // WeaponsOfBanishmentEffect,\r\n    ],\r\n  },\r\n  'Tahlia Vedra, Lioness of the Parch': {\r\n    /* mandatory: {\r\n       monstrous_rampages: [keyPicker(monstrous_rampages, ['Paralysing Venom'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Infernadines Leonine Jaws is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unparalleled Tactician - Passive`,\r\n        desc: `Effect: When this unit uses an Officars Order ability, you can pick an additional friendly Cities of Sigmar unit wholly within 12\" of this unit to be a target of that ability.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lead From the Front - Once Per Battle`,\r\n        desc: `Declare: If this unit is in combat, pick up to 3 other friendly Cities of Sigmar units wholly within 12\" of this unit to be the targets. \r\n        Effect: For each target, you can return a number of slain models to that unit with a combined Health characteristic of up to 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Paralysing Venom - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Alchemite Warforger': {\r\n    /* mandatory: {\r\n       spells: [keyPicker(spells, ['Blazing Weapons'])],\r\n     }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Runic Crucible`,\r\n        desc: `Effect: Pick a friendly Cities of Sigmar Human unit wholly within 12\" of this unit and roll a dice. On a 3+, add 1 to save rolls for that unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fusil-Major on Ogor Warhulk': {\r\n    effects: [\r\n      {\r\n        name: `Mark Targets`,\r\n        desc: `Declare: Pick an enemy unit that was targeted by this units shooting attacks this turn to be the target. \r\n        Effect: Add 1 to hit rolls for shooting attacks made by friendly Cities of Sigmar Human units that target that unit for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Fortify Position`,\r\n        desc: `Effect: This unit establishes a fortified position and remains in a fortified position until it either uses a Move ability or is removed from the battlefield. While this unit is in a fortified position, subtract 1 from the Rend characteristic of weapons used for attacks that target this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Haskel Hexbane': {\r\n    effects: [\r\n      GrimResolveEffect,\r\n      {\r\n        name: `Hunt with Conviction`,\r\n        desc: `After deployment but before the start of the first battle round, pick 1 enemy HERO or MONSTER on the battlefield to be the target of the witch hunt. If there are any enemy WIZARD HEROES on the battlefield, 1 of those units must be picked to be the target of the witch hunt. Add 1 to the damage inflicted by attacks made by this unit that target that unit.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Flamewood Stakes`,\r\n        desc: `At the end of the combat phase, you can pick 1 enemy unit within 1\" of this unit and roll a dice. Add 1 to the roll if that unit has the DEATH, DAEMON or WIZARD keyword. On a 3+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Hexbane's Hunters\": {\r\n    effects: [\r\n      GrimResolveEffect,\r\n      {\r\n        name: `Agents of the Order`,\r\n        desc: `Add 1 to the damage inflicted by attacks made by this unit that target the unit you picked to be the target of the witch hunt (see the Haskel Hexbane warscroll).`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Flamewood Stakes`,\r\n        desc: `At the end of the combat phase, you can pick 1 enemy unit within 1\" of this unit and roll a dice. Add 1 to the roll if that unit has the DEATH, DAEMON or WIZARD keyword. On a 3+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Ironweld Great Cannon': {\r\n    effects: [\r\n      {\r\n        name: `Shot and Shell - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, if it is in a fortified position, pick either the Cannonball or Grapeshot weapon characteristics for all the attacks it makes with its Great Cannon. If it is not in a fortified position, use the Grapeshot weapon characteristics.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Fortify Position`,\r\n        desc: `Effect: This unit establishes a fortified position and remains in a fortified position until it either uses a Move ability or is removed from the battlefield. While this unit is in a fortified position, subtract 1 from the Rend characteristic of weapons used for attacks that target this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wildercorps Hunters': {\r\n    effects: [\r\n      {\r\n        name: `Expert Trackers`,\r\n        desc: `Effect: This unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Hidden and Dangerous`,\r\n        desc: `Effect: This unit is not visible to enemy units more than 12\" from it while it is aected by the Cover terrain ability. In addition, add 1 to hit rolls for this units shooting attacks while it is wholly within 3\" of a terrain feature.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Callis and Toll': {\r\n    effects: [\r\n     {\r\n       name: `Right Tools for the Job - Passive`,\r\n       desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n       when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n     },\r\n     {\r\n       name: `Wily to the Last - Passive`,\r\n       desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n       when: [DURING_GAME],\r\n     },\r\n     {\r\n       name: `Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n       desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n       when: [COMBAT_PHASE],\r\n     },\r\n   ],\r\n  },\r\n'Toll\\'s Companions': {\r\n    effects: [\r\n     {\r\n      name: `Hidden Agents`,\r\n      desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n      Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n      when: [DURING_SETUP],\r\n     },\r\n     {\r\n      name: `Saviours of Cinderfall - Passive`,\r\n      desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n      when: [DURING_GAME],\r\n     },\r\n     {\r\n       name: `Emerge from the Shadows`,\r\n       desc: `Declare: Pick this unit if it is in the shadows. \r\n       Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n       when: [MOVEMENT_PHASE],\r\n     },\r\n   ],\r\n  },\r\n  'Pontifex Zenestra, Matriarch of the Great Wheel': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Vessel of Sigmar: Chant value of 5`,\r\n        desc: `Declare: Make a chanting roll of D6. \r\n        Effect: Pick 1 of the following eects to apply until the start of your next turn. Pick up to 2 different effects instead if the chanting roll was 10+. \r\n        The Great Wheel Turns: Add 2\" to the Move characteristic of friendly Cities of Sigmar Human units if they are wholly within 12\" of this unit at the start of the move. \r\n        Hallowed Ground: Friendly Cities of Sigmar Human units have Ward (5+) while they are wholly within 12\" of this unit. \r\n        Cast Out Evil: Roll a D3 for each enemy Wizard and Priest on the battlefield. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Voice of the God-King - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Fjori`s Flamebearers': {\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Paralysing Venom': {\r\n    effects: [\r\n      {\r\n        name: `Paralysing Venom`,\r\n        desc: `Pick 1 enemy MONSTER that made a charge move this turn and is within 3\" of this unit. Roll a dice. On a 3+, the strike-last effect applies to that enemy MONSTER until the end of the turn.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SlayersBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst Battalions = {\r\n /* 'Castelite Formation': {\r\n    effects: [OneDropDeploymentEffect, SlayersBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Bring Full Arms to Bear': {\r\n    effects: [\r\n      {\r\n        name: `Bring Full Arms to Bear`,\r\n        desc: `Pick 1 enemy unit. You complete this battle tactic if that unit is destroyed this turn and was suppressed as a result of the 'Suppressing Fire' order.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Raise the Banner': {\r\n    effects: [\r\n      {\r\n        name: `Raise the Banner`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if you control that objective at the end of this turn and a friendly FREEGUILD COMMAND CORPS that includes a Great Herald contests it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blackpowder Bombardment': {\r\n    effects: [\r\n      {\r\n        name: `Blackpowder Bombardment`,\r\n        desc: `You complete this battle tactic if 3 or more enemy units are destroyed in your shooting phase this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mount the Charge': {\r\n    effects: [\r\n      {\r\n        name: `Mount the Charge`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if you control that objective at the end of this turn and every friendly unit that contests it has a mount/s and made a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Strike Without Warning': {\r\n    effects: [\r\n      {\r\n        name: `Strike Without Warning`,\r\n        desc: `You complete this battle tactic if 3 or more friendly CITIES OF SIGMAR AELF units made a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Iron Might': {\r\n    effects: [\r\n      {\r\n        name: `Iron Might`,\r\n        desc: `You complete this battle tactic at the end of the turn if 3 or more friendly CITIES OF SIGMAR DUARDIN units fought this turn and no friendly CITIES OF SIGMAR DUARDIN units were destroyed this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Exemplar of the Acadamae Martial': {\r\n    effects: [\r\n      {\r\n        name: `Exemplar of the Acadamae Martial`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed this battle was from the 'For Honour and Glory' list below.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Reclaim for Sigmar!': {\r\n    effects: [\r\n      {\r\n        name: `Reclaim for Sigmar!`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is at least 1 friendly CITIES OF SIGMAR unit wholly within each large quarter of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Hold the High Ground': {\r\n    effects: [\r\n      {\r\n        name: `Hold the High Ground`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any friendly units within 12\" of the centre of the battlefield and no enemy units within 12\" of the centre of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Banners Held High': {\r\n    effects: [\r\n      {\r\n        name: `Banners Held High`,\r\n        desc: `When the battle ends, each player totals the number of Standard Bearers and units with the TOTEM keyword in their army that are on the battlefield. If your total is higher, you complete this grand strategy.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { CITIES_OF_SIGMAR } from 'meta/factions'\r\nimport DaughtersUnits from '../daughters_of_khaine/units'\r\nimport KharadronUnits from '../kharadron_overlords/units'\r\nimport LuminethUnits from '../lumineth_realmlords/units'\r\nimport { pickEffects } from '../metatagger'\r\nimport StormcastUnits from '../stormcast_eternals/units'\r\nimport SylvanethUnits from '../sylvaneth/units'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport Prayers from './prayers'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport battalions from './battalions'\r\nimport battle_tactics from './battle_tactics'\r\nimport grand_strategies from './grand_strategies'\r\n\r\nconst subFactions = {\r\n  [CITIES_OF_SIGMAR]: {\r\n    effects: pickEffects(BattleTraits, [CITIES_OF_SIGMAR]),\r\n    available: {\r\n     // allied_units: [StormcastUnits, KharadronUnits, SylvanethUnits, DaughtersUnits, LuminethUnits],\r\n      artifacts: [Artifacts],\r\n      battalions: [battalions],\r\n      battle_tactics: [battle_tactics],\r\n      command_traits: [CommandTraits],\r\n      flavors: [Flavors],\r\n      grand_strategies: [grand_strategies],\r\n      monstrous_rampages: [monstrous_rampages],\r\n      prayers: [Prayers],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { CITIES_OF_SIGMAR } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const CitiesOfSigmarFaction = new Faction(\r\n  CITIES_OF_SIGMAR,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_CITIES_OF_SIGMAR\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_DAUGHTERS_OF_KHAINE: {\r\n    name: 'Battletome: Daughters of Khaine',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/DiOjGMyi3tGkZuOm.pdf',\r\n  },\r\n  ERRATA_DECEMBER_2022: {\r\n    name: 'Errata (December 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/4IQvpkhYMBDojDZ6.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Crown of Woe': {\r\n    effects: [\r\n      {\r\n        name: `Crown of Woe - Passive`,\r\n        desc: `Effect: Subtract 2 from the control scores of enemy units while they are within 9\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Crone Blade': {\r\n    effects: [\r\n      {\r\n        name: `Crone Blade`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If the unmodified hit roll for an attack made with that weapon is a 6, you can heal 1 wound allocated to the bearer after all of the bearer's attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodbane Venom': {\r\n    effects: [\r\n      {\r\n        name: `Bloodbane Venom`,\r\n        desc: `Pick 1 of the bearer's melee weapons. After the bearer fights, if any wounds caused by attacks made with that weapon in that phase were allocated to an enemy model and that enemy model has not been slain, roll a dice. If the roll is equal to or greater than that model's Wounds characteristic, that model is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shadow Stone': {\r\n    effects: [\r\n      {\r\n        name: `Shadow Stone`,\r\n        desc: `Add 1 to casting rolls for the bearer when they attempt to cast a spell from the Lore of Shadows (pg 70).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Sevenfold Shadow': {\r\n    effects: [\r\n      {\r\n        name: `Sevenfold Shadow  - Once Per Battle`,\r\n        desc: `Effect: If this unit is not in combat, remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Crystal Heart': {\r\n    effects: [\r\n      {\r\n        name: `Crystal Heart`,\r\n        desc: `When the bearer attempts to cast a spell that summons an endless spell, the range of that spell is doubled.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Sigil': {\r\n    effects: [\r\n      {\r\n        name: `Blood Sigil`,\r\n        desc: `You can pick 1 extra prayer for the bearer from the Prayers of the Khainite Cult (pg 71).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rune of Khaine': {\r\n    effects: [\r\n      {\r\n        name: `Rune of Khaine`,\r\n        desc: `The first time the bearer is slain, the bearer can fight before they are removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Khainite Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Khainite Pendant - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Priest wholly within 12\" of this unit. \r\n        Effect: Give that unit D6 ritual points.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { MagnificentBattalionEffect, SwiftBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst Battalions = {\r\n /* 'Vyperic Guard': {\r\n    effects: [MagnificentBattalionEffect],\r\n  },\r\n  'Shadow Patrol': {\r\n    effects: [OneDropDeploymentEffect, SwiftBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Manifestations of Khaine': {\r\n    effects: [\r\n      {\r\n        name: `Clash of Arms`,\r\n        desc: `You complete this tactic if 3 or more friendly units make a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE,\r\n          rule_sources.ERRATA_DECEMBER_2022,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DAUGHTERS_OF_KHAINE } from 'meta/factions'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  // Daughters of Khaine Allegiance\r\n  [DAUGHTERS_OF_KHAINE]: {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - All Out Slaughter - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Infantry unit that is in combat to use this ability. \r\n        Effect: That unit can use 2 Fight abilities this phase. After the first is used, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rites - Passive`,\r\n        desc: `Effect: A different effect applies to friendly Daughters of Khaine units each battle round, as shown below. The effects of all previous battle rounds also apply to those units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Blood Rites - Battle Round 1`,\r\n        desc: `Add 1 to Run rolls for this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rites - Battle Round 2`,\r\n        desc: `Add 1 to Charge rolls for this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rites - Battle Round 3`,\r\n        desc: `Add 1 to Hit rolls for this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rites - Battle Round 4`,\r\n        desc: `Add 1 to Wound rolls for this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rites - Battle Round 5`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, END_OF_MOVEMENT_PHASE, HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandAbilities = {\r\n  // DoK Allegiance Ability\r\n /* 'All-out Slaughter': {\r\n    effects: [\r\n      {\r\n        name: `All-out Slaughter`,\r\n        desc: `You can use this command ability when a friendly DAUGHTERS OF KHAINE unit is picked to fight in the combat phase. The command must be issued by a friendly DAUGHTERS OF KHAINE unit and received by the unit that has been picked to fight. If the unmodified hit roll for an attack made by that unit in that phase is a 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit command abilities\r\n 'Orgy of Slaughter': {\r\n    effects: [\r\n      {\r\n        name: `Orgy of Slaughter`,\r\n        desc: `You can use this command ability in your hero phase if this unit is part of your army and on the battlefield. The command can only be issued by this unit, and the unit that receives the command must be a friendly DAUGHTERS OF KHAINE unit within 3\" of any enemy units. That unit can fight.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Worship Through Bloodshed': {\r\n    effects: [\r\n      {\r\n        name: `Worship Through Bloodshed`,\r\n        desc: `You can use this command ability in your hero phase if this unit is part of your army and on the battlefield. The command can only be issued by this unit, and the unit that receives the command must be a friendly DAUGHTERS OF KHAINE unit. That unit can shoot or, if it is within 3\" of any enemy units, it can fight.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath of the Scathborn': {\r\n    effects: [\r\n      {\r\n        name: `Wrath of the Scathborn`,\r\n        desc: `You can use this command ability in your charge phase if this unit is part of your army and on the battlefield. The command can only be issued by this unit, and the unit that receives the command must be a friendly MELUSAI unit. That unit can attempt a charge even if it ran in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n  // Khailebron Flavor\r\n  'Masters of the Shadowpaths': {\r\n    effects: [\r\n      {\r\n        name: `Masters of the Shadowpaths`,\r\n        desc: `You can use this command ability at the end of your movement phase. The command can only be issued by a friendly KHAILEBRON HERO, and the unit that receives the command must be a friendly KHAILEBRON unit. Remove the unit that receives this command from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Bathed in Blood': {\r\n    effects: [\r\n      {\r\n        name: `Bathed in Blood`,\r\n        desc: `Effect: Heal (3) this unit if it is in combat.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Zealous Orator': {\r\n    effects: [\r\n      {\r\n        name: `Zealous Orator - Passive`,\r\n        desc: `Effect: If a friendly unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Sacrificial Overseer': {\r\n    effects: [\r\n      {\r\n        name: `Sacrificial Overseer`,\r\n        desc: `After this general has fought for the first time in the combat phase, if any enemy models were slain by wounds caused by this general's attacks in that phase, this general is said to be revelling in murder until the end of the phase. If this general is revelling in murder, they can fight for a second time in that phase. The strike-last effect applies to this general when they fight for that second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Master of Poisons': {\r\n    effects: [\r\n      {\r\n        name: `Master of Poisons`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by this units combat attacks to be the target. \r\n        Effect: For the rest of the battle:  \r\n        The target cannot be healed.  \r\n        Slain models cannot be returned to the target unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  /* 'True Believer': {\r\n    effects: [\r\n      {\r\n        name: `True Believer`,\r\n        desc: `Add 1 to the number of the current battle round when determining the abilities gained by this general from the Blood Rites battle trait (pg 66). This ability and other similar abilities are cumulative.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Arcane Mastery': {\r\n    effects: [\r\n      {\r\n        name: `Arcane Mastery`,\r\n        desc: `WIZARD only. This general knows all of the spells from the Lore of Shadows (pg 70) in addition to the other spells it knows.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fuelled by Revenge': {\r\n    effects: [\r\n      {\r\n        name: `Fuelled by Revenge`,\r\n        desc: `MELUSAI IRONSCALE only. Once per battle, at the start of the combat phase, you can say that this general will wreak Khaine's vengeance. If you do so, until the end of that phase, add 1 to the Attacks characteristic of melee weapons used by friendly MELUSAI units wholly within 12\" of this general.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\n// Endless spells.\r\nconst EndlessSpells = {\r\n  Bladewind: {\r\n    effects: [\r\n      GenericEffects.Predatory.Twelve_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 9\". If successfully cast, set up this endless spell wholly within range of the caster. Only Daughters of Khaine Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unnatural Edge`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across and for each other unit that is within 1\" of it at the end of its move. On a 2+, that unit suffers 1 mortal wound. In addition, do not apply the cover modifier to save rolls for attacks that target units within 12\" of this endless spell.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unnatural Edge`,\r\n        desc: `Do not apply the cover modifier to save rolls for attacks that target units within 12\" of this endless spell.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodwrack Viper': {\r\n    effects: [\r\n      GenericEffects.Predatory.Nine_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7 and a range of 9\". If successfully cast, set up this endless spell wholly within range of the caster. Only Daughters of Khaine Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Fanged Strike`,\r\n        desc: `After this endless spell has moved, the commanding player must pick 1 unit within 1\" of it and roll 3 dice. For each roll that is equal to or greater than that unit's Wounds characteristic, 1 model in that unit is slain.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Monster of Blood`,\r\n        desc: `At the end of the charge phase, the commanding player can count this endless spell as a MONSTER for the purposes of the Monstrous Rampage rules (core rules, 21.1) but they can only carry out a Stomp or Smash To Rubble monstrous rampage with it. It cannot be picked to be the target of a monstrous rampage.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Heart of Fury': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 3 and a range of 12\". If answered, set up this invocation wholly within range and visible to the chanter. Only Daughters of Khaine Priests can attempt to summon this invocation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Locus of the Murder God`,\r\n        desc: `At the start of the combat phase, if this invocation is on the battlefield, the commanding player must roll a dice.\r\n\r\n        On a 1-5, until the end of that phase, subtract 1 from the damage inflicted (to a minimum of 1) by each successful attack that targets a Daughters of Khaine unit in the commanding player's army wholly within 12\" of this invocation.\r\n\r\n        On a 6, until the end of that phase, subtract 1 from the damage inflicted (to a minimum of 1) by each successful attack that targets a Daughters of Khaine unit in the commanding player's army wholly within 12\" of this invocation and add 1 to the Attacks characteristic of melee weapons used by Daughters of Khaine units in the commanding player's army wholly within 12\" of this invocation.\r\n\r\n        In addition, if the roll was a 6, this invocation is removed from play at the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Scathcoven': {\r\n    effects: [\r\n      {\r\n        name: `Speed of the Scathborn - Passive`,\r\n        desc: `Effect: If the unmodified charge roll for a friendly Melusai or Khinerai unit is 8+, that unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shadow Patrol': {\r\n    effects: [\r\n      {\r\n        name: `Shadowpaths`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Infantry unit that is not in combat to use this ability. \r\n        Effect: Roll a dice. On a 3+, remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cauldron Guard': {\r\n    effects: [\r\n      {\r\n        name: `Frenzied Devotees - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Daughters of Khaine Infantry or War Machine units that are in combat to be the targets. \r\n        Effect: For each target:  \r\n        Make a pile-in move.  \r\n        Then, pick an enemy unit in combat with the target and roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* Khailebron: {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Masters of the Shadowpaths'])],\r\n    }, \r\n    effects: [],\r\n  }, */\r\n  'Slaughter Troupe': {\r\n    effects: [\r\n      {\r\n        name: `Gladiatorial Acrobatics - Once Per Turn - Reaction: You declared a Charge ability for a friendly Daughters of Khaine Aelf unit`,\r\n        desc: `Effect: Change one of the dice in the charge roll to a 4.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Zainthar Kai': {\r\n    effects: [\r\n      {\r\n        name: `Khaine's Essence`,\r\n        desc: `Each time a model in a friendly ZAINTHAR KAI MELUSAI unit is slain by an attack made with a melee weapon, that model can fight before it is removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME, END_OF_SETUP } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* Bloodbath: {\r\n    effects: [\r\n      {\r\n        name: `Bloodbath`,\r\n        desc: `When the battle ends, you complete this grand strategy if all enemy HEROES and MONSTERS either have at least 1 wound allocated to them or have been slain and if all other enemy units on the battlefield have had at least 1 model slain.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Conquered in the Name of Khaine': {\r\n    effects: [\r\n      {\r\n        name: `Conquered in the Name of Khaine`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is a friendly AVATAR OF KHAINE or CAULDRON OF BLOOD wholly within enemy territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodthirsty Zealots': {\r\n    effects: [\r\n      {\r\n        name: `Bloodthirsty Zealots`,\r\n        desc: `When the battle ends, you complete this grand strategy if all friendly units either fought at least once during the battle or have been destroyed.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Naught But Destruction': {\r\n    effects: [\r\n      {\r\n        name: `Naught But Destruction`,\r\n        desc: `If you pick this grand strategy, after deployment, pick 1 defensible terrain feature wholly within enemy territory. If there are no defensible terrain features wholly within enemy territory, your opponent picks 1 defensible terrain feature anywhere on the battlefield. When the battle ends, you complete this grand strategy if that terrain feature has been demolished.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Naught But Destruction`,\r\n        desc: `When the battle ends, you complete this grand strategy if that terrain feature has been demolished.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Prayers = {\r\n /* 'Catechism of Murder': {\r\n    effects: [\r\n      {\r\n        name: `Catechism of Murder`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Until your next hero phase, if the unmodified hit roll for an attack made with a melee weapon by that unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Catechism of Murder`,\r\n        desc: `If active, if the unmodified hit roll for an attack made with a melee weapon by that unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blessing of Khaine': {\r\n    effects: [\r\n      {\r\n        name: `Blessing of Khaine`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Until your next hero phase, you can reroll Fanatical Faith rolls (pg 66) for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Blessing of Khaine`,\r\n        desc: `If active, you can reroll Fanatical Faith rolls (pg 66) for that unit.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Martyr's Sacrifice\": {\r\n    effects: [\r\n      {\r\n        name: `Martyr's Sacrifice`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Until your next hero phase, each time a model from that unit is slain by an attack made with a melee weapon, before the slain model is removed from play, pick 1 enemy unit within 3\" of the slain model and roll a dice. On a 5+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Martyr's Sacrifice`,\r\n        desc: `If active, each time a model from that unit is slain by an attack made with a melee weapon, before the slain model is removed from play, pick 1 enemy unit within 3\" of the slain model and roll a dice. On a 5+, that unit suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crimson Rejuvenation': {\r\n    effects: [\r\n      {\r\n        name: `Crimson Rejuvenation`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Heal up to D3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Covenant of the Iron Heart': {\r\n    effects: [\r\n      {\r\n        name: `Covenant of the Iron Heart`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Until your next hero phase, do not take battleshock tests for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Covenant of the Iron Heart`,\r\n        desc: `If active, do not take battleshock tests for that unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sacrament of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Sacrament of Blood`,\r\n        desc: `Answer value of 3 and a range of 14\". If this prayer is answered, pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the chanter. Until your next hero phase, add 1 to the number of the current battle round when determining the abilities gained by that unit from the Blood Rites battle trait (pg 66). This ability and other similar abilities are cumulative.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Unit prayers\r\n  'Touch of Death': {\r\n    effects: [\r\n      {\r\n        name: `Touch of Death`,\r\n        desc: `Answer value of 3 and a range of 3\". If answered, pick 1 enemy unit within range and visible to the chanter. That enemy unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Murder of Crows': {\r\n    effects: [\r\n      {\r\n        name: `Murder of Crows`,\r\n        desc: `Answer value of 4 and a range of 18\". If answered, pick 1 enemy unit within range and visible to the chanter. That unit suffers D3 mortal wounds. Then, roll a dice. If the roll is equal to or higher than the Wounds characteristic of that enemy unit, subtract 1 from hit rolls for attacks made by that unit for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dance of Doom': {\r\n    effects: [\r\n      {\r\n        name: `Dance of Doom`,\r\n        desc: `Answer value of 3. If answered, the strike-first effect applies to this unit in the following combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dance of Doom`,\r\n        desc: `If active, the strike-first effect applies to this unit in the following combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Prayers of the Khainite Cult': {\r\n    effects: [\r\n      {\r\n        name: `Sacrament of Blood: Chant value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Priest to chant this prayer, pick a visible friendly Daughters of Khaine unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, add 1 to the current battle round number when determining which effects of the Blood Rites ability apply to the target. If the chanting roll was 10+, until the start of your next turn, treat the current battle round number as 5 when determining which effects of the Blood Rites ability apply to the target instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Martyr's Sacrifice: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Priest to chant this prayer, pick a visible friendly Daughters of Khaine unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, each time a model in the target unit is slain by a combat attack, before removing the model from play, pick an enemy unit in combat with the target and roll a dice. If the chanting roll was 8+, roll 2 dice instead of 1. For each 5+, inflict 1 mortal damage on that enemy unit after the Fight ability has been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Covenant of the Iron Heart: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Priest to chant this prayer, pick a visible friendly Daughters of Khaine unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Ignore negative modifiers to the targets control score until the start of your next turn. In addition, if the chanting roll was 8+, add 5 to the targets control score until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Spells = {\r\n  // Lore of Shadows\r\n /* 'Steed of Shadows': {\r\n    effects: [\r\n      {\r\n        name: `Steed of Shadows`,\r\n        desc: `Casting value of 6. If successfully cast, until your next hero phase, the caster has a Move characteristic of 16\" and can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pit of Shades': {\r\n    effects: [\r\n      {\r\n        name: `Pit of Shades`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster and roll 2D6. If the roll is higher than that unit's Move characteristic, that unit suffers a number of mortal wounds equal to the difference between its Move characteristic and the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mirror Dance': {\r\n    effects: [\r\n      {\r\n        name: `Mirror Dance`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 2 friendly DAUGHTERS OF KHAINE HEROES that are wholly within range, visible to the caster and each more than 3\" from all enemy units. Remove those HEROES from the battlefield. Then, set each model up again within 1\" of the location that had been occupied by the other model before it was removed from the battlefield and more than 3\" from all enemy units. If it is not possible to set up either of the picked HEROES on the battlefield, return both HEROES to their original positions.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n  'The Withering': {\r\n    effects: [\r\n      {\r\n        name: `The Withering`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Add 1 to wound rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Mindrazor: {\r\n    effects: [\r\n      {\r\n        name: `Mindrazor`,\r\n        desc: `Casting value of 8 and a range of 18\". Pick 1 friendly DAUGHTERS OF KHAINE unit wholly within range and visible to the caster. Improve the Rend characteristic of that unit's melee weapons by 1 until your next hero phase. In addition, until your next hero phase, add 1 to the Damage characteristic of that unit's melee weapons if it made a charge move in the same turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shroud of Despair': {\r\n    effects: [\r\n      {\r\n        name: `Shroud of Despair`,\r\n        desc: `Casting value of 4 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from that unit's Bravery characteristic until your next hero phase. If the casting roll was 8+, subtract D3 from that unit's Bravery characteristic instead of 1 until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Unit spells\r\n  'Enfeebling Foe': {\r\n    effects: [\r\n      {\r\n        name: `Enfeebling Foe`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Enfeebling Foe`,\r\n        desc: `If active, subtract 1 from wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Black Horror of Ulgu': {\r\n    effects: [\r\n      {\r\n        name: `Black Horror of Ulgu`,\r\n        desc: `Casting value of 7 and a range of 36\". Pick 1 enemy unit within range and visible to the caster, then roll a dice. On a 1, that unit suffers 1 mortal wound. On a 2-3, it suffers D3 mortal wounds. On a 4+, it suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Doomfire: {\r\n    effects: [\r\n      {\r\n        name: `Doomfire`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. If the caster's unit has fewer than 5 models, that enemy unit suffers D3 mortal wounds. If the caster's unit has 5-9 models, that enemy unit suffers D6 mortal wounds. If the caster's unit has 10 or more models, that enemy unit suffers 6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lore of Shadows': {\r\n    effects: [\r\n      {\r\n        name: `Steed of Shadows: Casting value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Wizard to cast this spell, pick a visible friendly Daughters of Khaine unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The target can use Charge abilities this turn even if it used a Run ability in the same turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Doomfire: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target unit has fewer than 10 models, inflict D3 mortal damage on the target. If the target unit has 10-19 models, inflict D6 mortal damage on the target. If the target unit has 20 or more models, inflict 6 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mindrazor: Casting value of 8`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Wizard to cast this spell, pick a visible friendly Daughters of Khaine unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Add 1 to the Rend characteristic of the targets melee weapons until the start of your next turn. In addition, if the target charged this turn, add 1 to the Damage characteristic of its melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Prayers from './prayers'\r\nimport rule_sources from './rule_sources'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport prayers from './prayers'\r\n\r\nconst MorathiEffect = {\r\n  name: `One Soul, Two Bodies/ Two Bodies, One Soul`,\r\n  desc: `If the Shadow Queen is on the battlefield, after making ward rolls for wounds or mortal wounds that would be allocated to this unit, any wounds or mortal wounds that have not been negated are instead allocated to the Shadow Queen and have no effect on this unit. Wounds and mortal wounds allocated to the Shadow Queen in this way cannot be negated.\r\n\r\n  In addition, if the Shadow Queen is on the battlefield and the effect of an ability or spell would cause this unit to be destroyed without any wounds being allocated, then this unit is not destroyed and 3 wounds are allocated to the Shadow Queen instead. Wounds allocated to the Shadow Queen in this way cannot be negated.\r\n\r\n  If the Shadow Queen is destroyed, after removing that unit from play, this unit is also destroyed.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE, rule_sources.ERRATA_DECEMBER_2022],\r\n  shared: true,\r\n}\r\n\r\nconst WitchbrewEffect = {\r\n  name: `Witchbrew`,\r\n  desc: `At the start of your hero phase, you can pick a friendly Daughters of Khaine unit wholly within 12\" of this model to drink witchbrew. A unit cannot drink witchbrew more than once in the same hero phase. If you do so, add 1 to the number of the current battle round when determining the abilities gained by that unit from the Blood Rites battle trait until the end of that turn. This ability and other similar abilities are cumulative.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst StandardBearerAndMusicianEffects = [\r\n  {\r\n    name: `Standard Bearer`,\r\n    desc: `1 in every 5 models in this unit can be a Death Pennant Bearer. You can reroll failed battleshock tests for this unit if it includes any Death Pennant Bearers.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Hornblower`,\r\n    desc: `1 in every 5 models in this unit can be a Hornblower. This unit can run and still charge later in the turn if it includes any Hornblowers.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst DescendToBattleEffects = [\r\n  {\r\n    name: `Descend to Battle`,\r\n    desc: `Instead of setting up this unit on the battlefield, you can place it to one side and say that it is circling high above as a reserve unit. If you do so, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n    when: [DURING_SETUP],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Descend to Battle`,\r\n    desc: `If this unit is still circling high, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n    when: [END_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst FightAndFlightEffect = {\r\n  name: `Fire and Flight`,\r\n  desc: `After this unit shoots, this unit can make a normal move of 6\".`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst BladedBucklersEffects = [\r\n  {\r\n    name: `Shield`,\r\n    desc: `If this unit is armed with Bladed Bucklers, it has a Save characteristic of 5+ instead of 6+.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Bladed Bucklers`,\r\n    desc: `If the unmodified save roll for an attack made with a melee weapon that targets a unit armed with Bladed Bucklers is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst BloodshieldEffect = {\r\n  name: `Bloodshield`,\r\n  desc: `Add 1 to save rolls for attacks that target friendly Daughters of Khaine units wholly within range of any friendly units with this ability. The range of this unit's Bloodshield ability is shown on its damage table.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst BladedImpactEffect = {\r\n  name: `Bladed Impact`,\r\n  desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst HeartseekersEffect = {\r\n  name: `Heartseekers`,\r\n  desc: `If the unmodified hit roll for an attack made with a Heartseeker Bow is 6, the target suffers 1 mortal wound and the attack sequence ends (do not make a wound roll or save roll).`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst TurnedToCrystalEffect = {\r\n  name: `Turned to Crystal`,\r\n  desc: `At the end of the combat phase, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that enemy unit suffers 1 mortal wound.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst AltarOfKhaineEffect = {\r\n  name: `Altar of Khaine`,\r\n  desc: `Add 1 to chanting rolls for friendly Daughters of Khaine Priests wholly within 9\" of any friendly units with this ability.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DanceOfDeathEffect = {\r\n  name: `Dance of Death`,\r\n  desc: `This unit is eligible to fight in the combat phase if it is within 6\" of an enemy unit instead of 3\", and it can move an extra 3\" when it piles in.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst baseHagQueen = {\r\n /* mandatory: {\r\n    prayers: [keyPicker(Prayers, ['Touch of Death'])],\r\n  },\r\n  effects: [WitchbrewEffect], */\r\n} \r\n\r\nconst baseSlaughterQueen = {\r\n /* mandatory: {\r\n    prayers: [keyPicker(Prayers, ['Dance of Doom'])],\r\n    command_abilities: [keyPicker(CommandAbilities, ['Orgy of Slaughter'])],\r\n  }, */\r\n}\r\n\r\nconst baseBloodwrack = {\r\n/*  mandatory: {\r\n    spells: [keyPicker(Spells, ['Enfeebling Foe'])],\r\n  }, */\r\n  effects: [\r\n    {\r\n      name: `Bloodwrack Stare`,\r\n      desc: `Do not use the attack sequence for an attack made with a Bloodwrack Stare. Instead, roll a number of dice equal to the number of models in the target unit that are within range of the attack. For each 5+, the target unit suffers 1 mortal wound.`,\r\n      when: [SHOOTING_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Melusai Kin`,\r\n      desc: `At the start of your combat phase, you can pick 1 friendly Melusai unit wholly within 12\" of this unit. Add 1 to the number of the current battle round when determining the abilities gained by that unit from the Blood Rites battle trait until the end of that phase. This ability and other similar abilities are cumulative.`,\r\n      when: [START_OF_COMBAT_PHASE],\r\n      shared: true,\r\n    },\r\n    {\r\n      name: `Wizard`,\r\n      desc: `This unit can attempt to cast 1 spell in your hero phase and attempt to unbind 2 spells in the enemy hero phase.`,\r\n      when: [HERO_PHASE],\r\n      shared: true,\r\n    },\r\n  ],\r\n}\r\n\r\nconst ShadowLeapEffect = {\r\n /* name: `Shadow Leap`,\r\n  desc: `In your movement phase, instead of making a normal move or retreat with this unit, you can say that it will shadow leap. If you do so, remove this unit from the battlefield and set it up again anywhere on the battlefield more than 9\" from all enemy units.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true, */\r\n} \r\n\r\nconst Morathi = {\r\n  'Morathi-Khaine': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Black Horror of Ulgu'])],\r\n      command_abilities: [keyPicker(CommandAbilities, ['Worship Through Bloodshed'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Mirror Dance: Casting value of 7`,\r\n        desc: `Declare: If a friendly Shadow Queen is on the battlefield, make a casting roll of 2D6. \r\n        Effect: Place 2 tokens on the battlefield, one directly underneath the centre of this units base and one directly underneath the centre of a friendly Shadow Queens base. Then, remove this unit and that Shadow Queen from the battlefield. Set up each unit again with its base overlapping the centre of the other token, then remove the tokens. If it is not possible to set up either of the units on the battlefield, return both units to their original positions. Each unit can only be set up in combat with units that the other unit was already in combat with.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Once Soul, Two Bodies - Passive`,\r\n        desc: `Effect: Each time a damage point would be allocated to this unit, it is instead allocated to a friendly The Shadow Queen (you cannot make any further ward rolls for that damage point). If this unit would be automatically destroyed by another ability, it is not automatically destroyed. Instead, allocate 3 damage points to a friendly The Shadow Queen (ward rolls cannot be made for those damage points). If a friendly The Shadow Queen is destroyed, this unit is automatically destroyed.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Sorceress Supreme - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // MorathiEffect,\r\n    ],\r\n  },\r\n  'The Shadow Queen': {\r\n    effects: [\r\n      {\r\n        name: `Fury of the Shadow Queen - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If any models are slain by this ability, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Khinerai and Melusai units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // MorathiEffect,\r\n      {\r\n        name: `Iron Heart of Khaine - Passive`,\r\n        desc: `Effect: You cannot allocate more than 3 damage points to this unit each turn. Once 3 points have been allocated to this unit in a turn, any further damage points that would be allocated to it are ignored. \r\n        Damage points allocated to this unit cannot be healed. \r\n        If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 3 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n}\r\n\r\nconst Units = {\r\n  'Morathi-Khaine': {\r\n    ...Morathi['Morathi-Khaine'],\r\n    /*mandatory: {\r\n      ...Morathi['Morathi-Khaine'].mandatory,\r\n      units: [keyPicker(Morathi, ['The Shadow Queen'])],\r\n    }, */\r\n  },\r\n  'The Shadow Queen': {\r\n    ...Morathi['The Shadow Queen'],\r\n   /* mandatory: {\r\n      units: [keyPicker(Morathi, ['Morathi-Khaine'])],\r\n    },*/\r\n  },\r\n  'Hag Queen': {\r\n    ...baseHagQueen,\r\n    effects: [\r\n      {\r\n        name: `Witchbrew - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Ward (5+) for the rest of the turn..`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ], \r\n  }, \r\n  'Hag Queen on Cauldron of Blood': {\r\n    /*mandatory: {\r\n      prayers: [...baseHagQueen.mandatory.prayers],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Altar of Khaine - Passive`,\r\n        desc: `Effect: Add 1 to save rolls for friendly Daughters of Khaine Infantry units while they are wholly within 9\" of this unit. \r\n        In addition, add 1 to chanting rolls for friendly Daughters of Khaine Priests while they are wholly within 9\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bladed Impact`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Witchbrew - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Ward (5+) for the rest of the turn..`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  'High Gladiatrix': {\r\n    effects: [\r\n      //DanceOfDeathEffect,\r\n      {\r\n        name: `Killing Stroke - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll 2D6. If the roll exceeds the targets Health characteristic, it is automatically destroyed.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Paragon of Slaughter`,\r\n        desc: `Declare: If this unit is in combat, pick a visible friendly Daughters of Khaine Aelf non-Hero Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, add 1 to the Rend characteristic of melee weapons used by the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slaughter Queen': {\r\n   /* mandatory: {\r\n      command_abilities: [...baseSlaughterQueen.mandatory.command_abilities],\r\n      prayers: [...baseSlaughterQueen.mandatory.prayers],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Orgy of Slaughter - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Aelf Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ], \r\n  }, \r\n  'Avatar of Khaine': {\r\n    effects: [\r\n      // AltarOfKhaineEffect,\r\n      {\r\n        name: `Wrath of Khaine - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is a Monster, double the amount of mortal damage inflicted.`,\r\n        when: [CHARGE_PHASE],\r\n        shared: true,\r\n      },\r\n    ],\r\n  },\r\n  'Witch Aelves with Bladed Bucklers': {\r\n    effects: [\r\n      //...StandardBearerAndMusicianEffects,\r\n      //...BladedBucklersEffects,\r\n      {\r\n        name: `Bladed Bucklers - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Witch Aelves with Paired Sciansa': {\r\n    effects: [\r\n      //...StandardBearerAndMusicianEffects,\r\n      //...BladedBucklersEffects,\r\n      {\r\n        name: `Frenzied Fervour - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons for the rest of the turn if this unit charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sisters of Slaughter with Sacrificial Knives': {\r\n    effects: [\r\n      {\r\n        name: `Dance of Death - Enemy Combat Phase`,\r\n        desc: `Effect: This unit can move 3\". It can pass through the combat ranges of enemy units and can end that move in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      //...StandardBearerAndMusicianEffects,\r\n      //...BladedBucklersEffects,\r\n      //DanceOfDeathEffect,\r\n    ],\r\n  },\r\n    'Sisters of Slaughter with Bladed Bucklers': {\r\n    effects: [\r\n      {\r\n        name: `Dance of Diversion - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks that target this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bladed Bucklers - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slaughter Queen on Cauldron of Blood': {\r\n   /* mandatory: {\r\n      prayers: [...baseSlaughterQueen.mandatory.prayers],\r\n      command_abilities: [...baseSlaughterQueen.mandatory.command_abilities],\r\n    }, */\r\n    effects: [\r\n    /*  AltarOfKhaineEffect,\r\n      BladedImpactEffect,\r\n      BloodshieldEffect, */\r\n      {\r\n        name: `Altar of Khaine - Passive`,\r\n        desc: `Effect: Add 1 to save rolls for friendly Daughters of Khaine Infantry units while they are wholly within 9\" of this unit. \r\n        In addition, add 1 to chanting rolls for friendly Daughters of Khaine Priests while they are wholly within 9\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Orgy of Slaughter - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Daughters of Khaine Aelf Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bladed Impact`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodwrack Shrine': {\r\n  /*  mandatory: {\r\n      spells: [...baseBloodwrack.mandatory.spells],\r\n    }, */\r\n    effects: [\r\n     // ...baseBloodwrack.effects,\r\n     // BladedImpactEffect,\r\n      {\r\n        name: `Aura of Agony`,\r\n        desc: `Declare: Pick up to 3 different enemy units within 9\" of this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bladed Impact`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodwrack Stare - Passive`,\r\n        desc: `Effect: Each time this unit attacks with its Bloodwrack Stare, if the attack scores a hit, roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on that unit. You cannot pick the same enemy unit to be targeted by attacks made with a Bloodwrack Stare more than once per phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Sisters': {\r\n    effects: [\r\n      {\r\n        name: `Crystal Touch`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Health characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  TurnedToCrystalEffect,\r\n    ],\r\n  },\r\n  'Blood Stalkers': {\r\n    effects: [\r\n      {\r\n        name: `Heartseekers`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, this units shooting attacks score critical hits on unmodified hit rolls of 5+ for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n     // HeartseekersEffect,\r\n    ],\r\n  },\r\n  'Bloodwrack Medusa': {\r\n //   ...baseBloodwrack,\r\n effects: [\r\n  {\r\n    name: `Bloodwrack Stare - Passive`,\r\n    desc: `Effect: Each time this unit attacks with its Bloodwrack Stare, if the attack scores a hit, roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on that unit. You cannot pick the same enemy unit to be targeted by attacks made with a Bloodwrack Stare more than once per phase.`,\r\n    when: [SHOOTING_PHASE],\r\n  },\r\n // GenericEffects.WizardOneSpellEffect,\r\n  {\r\n    name: `Melusai Kin - Reaction: You declared a Fight ability for this unit`,\r\n    desc: `Effect: Pick a friendly non-Hero Melusai unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately aer the Fight ability used by this unit has been resolved.`,\r\n    when: [COMBAT_PHASE],\r\n  },\r\n],\r\n  },\r\n  'Doomfire Warlocks': {\r\n   // mandatory: { spells: [keyPicker(Spells, ['Doomfire'])] },\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Outmanoeuvre - Passive`,\r\n        desc: `Effect: When this unit uses the Redeploy command, if you roll a 1-3 when determining the distance this unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Khinerai Heartrenders': {\r\n    effects: [\r\n      {\r\n        name: `Circling in the Skies Above`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve in the skies. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Death from Above`,\r\n        desc: `Declare: Pick this unit if it is in the skies. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Fire and Flight`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      //...DescendToBattleEffects,\r\n      //FightAndFlightEffect,\r\n    ],\r\n  },\r\n  'Khinerai Lifetakers': {\r\n    effects: [\r\n      {\r\n        name: `Circling in the Skies Above`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve in the skies. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Death from Above`,\r\n        desc: `Declare: Pick this unit if it is in the skies. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Fight and Flight - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: After resolving the effect of that Fight ability, this unit can immediately move D6\". It cannot end that move in combat with any units that it was not already in combat with at the start of the move.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ...DescendToBattleEffects,\r\n     // FightAndFlightEffect,\r\n    ],\r\n  },\r\n  /*'Morgwaeth the Bloodied': {\r\n    effects: [\r\n      //...baseHagQueen.effects\r\n      ],\r\n  }, */\r\n  /*'The Blade-coven': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Kyrae is the unit champion. That model has a Wounds characteristic of 3.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n     // HeartseekersEffect,\r\n      {\r\n        name: `Zealots of the First Temple`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly Morgwaeth the Bloodied within 3\" of this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly Morgwaeth the Bloodied within 3\" of this unit, you can roll a dice. On a 2+, that wound or mortal wound is allocated to this unit instead of Morgwaeth the Bloodied and cannot be negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Khainite Shadowstalkers': {\r\n    effects: [\r\n      {\r\n        name: `Shadow Leap`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Melusai Ironscale': {\r\n   // mandatory: { command_abilities: [keyPicker(CommandAbilities, ['Wrath of the Scathborn'])] },\r\n    effects: [\r\n      {\r\n        name: `Wrath of the Scathborn - Passive`,\r\n        desc: `Effect: You can re-roll charge rolls for friendly Melusai units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Gory Offering - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Melusai unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // TurnedToCrystalEffect,\r\n    ],\r\n  },\r\n /* 'Slythael Shadestalker': {\r\n    effects: [\r\n     // ShadowLeapEffect,\r\n      {\r\n        name: `Impenetrable Darkness`,\r\n        desc: `While this unit is more than 9\" from all enemy units, this unit and friendly THE SHADEBORN units wholly within 9\" of this unit have a ward of 4+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Mask of Shadowed Mirrors`,\r\n        desc: `At the end of the charge phase, you can pick 1 enemy unit within 3\" of this unit and roll 2D6. If the score exceeds that enemy unit's Bravery characteristic, that enemy unit cannot issue or receive commands until the end of the turn.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n /* 'The Shadeborn': {\r\n    effects: [\r\n    //  ShadowLeapEffect\r\n    ],\r\n  }, */\r\n /* \"Gryselle's Arenai\": {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Gryselle, the Slaughterer, is the unit champion and has a Wounds characteristic of 3. That model can issue commands to their own unit.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      DanceOfDeathEffect,\r\n      {\r\n        name: `Acrobatic Bloodshed`,\r\n        desc: `If the unmodified hit rolls of 3 or more attacks made by this unit that target the same enemy unit in the same phase are 6, the strike-last effect applies to that enemy unit until the end of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Krethusa The Croneseer': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, ['Murder of Crows'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Burnt Offerings - Once Per Turn`,\r\n        desc: `Declare: If this unit is within the combat range of a friendly Cauldron of Blood, pick a visible friendly Daughters of Khaine Aelf non-Hero Infantry unit wholly within 18\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply to the target. \r\n        Prophecy of Silence: Until the start of your next turn, enemy units cannot use commands while they are in combat with the target. \r\n        Prophecy of Dark Wings: The target can use the Normal Move ability as if it were your movement phase. That unit counts as having used a Run ability this turn. \r\n        Prophecy of Reclamation: For the rest of the turn, while the target is contesting an objective, subtract 10 from the control scores of enemy units contesting that objective that do not have the Hero or Monster keyword.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Murder of Crows: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Roll a D3. If the chanting roll was 8+, roll a D6 instead. Inflict an amount of mortal damage on the target equal to the roll. In addition, if the roll exceeds the targets Health characteristic, subtract 1 from hit rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Fjori`s Flamebearers': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport { DAUGHTERS_OF_KHAINE } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Prayers from './prayers'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [DAUGHTERS_OF_KHAINE]: {\r\n    effects: pickEffects(BattleTraits, [DAUGHTERS_OF_KHAINE]),\r\n\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['All-out Slaughter'])],\r\n    }, */\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n      prayers: [Prayers],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { DAUGHTERS_OF_KHAINE } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const DaughtersOfKhaineFaction = new Faction(\r\n  DAUGHTERS_OF_KHAINE,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_DAUGHTERS_OF_KHAINE\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  SAVES_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Heavy Metal Ingot': {\r\n    effects: [\r\n      {\r\n        name: `Heavy Metal Ingot`,\r\n        desc: `You can reroll failed save rolls for the bearer as long as they have not made a move in the same turn.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ancestral Pickaxe': {\r\n    effects: [\r\n      {\r\n        name: `Ancestral Pickaxe`,\r\n        desc: `Once per the battle, at the start of your movement phase, you can remove the bearer and up to 1 other friendly DISPOSSESSED unit within 6\" of the bearer from the battlefield. They may be set up at the end of your next movement phase.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ancestral Pickaxe`,\r\n        desc: `Units removed in your last movement phase may be set up anywhere on the battlefield, wholly within 6\" of each other and more than 9\" away from enemy models.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Teardrop of Grungni': {\r\n    effects: [\r\n      {\r\n        name: `Teardrop of Grungni`,\r\n        desc: `Once per battle, at the start of your shooting phase, pick an enemy unit within 6\" of the bearer. That unit suffers D3 mortal wounds. In addition, if the target is a HERO or MONSTER, it must halve its Move characteristic in its next movement phase.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grudge Rune': {\r\n    effects: [\r\n      {\r\n        name: `Grudge Rune`,\r\n        desc: `After set up is complete but before the battle begins, pick an enemy HERO. You can reroll failed hit and wound rolls for the bearer if the target of the attack is the enemy HERO you picked.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Grudge Rune`,\r\n        desc: `You can reroll failed hit and wound rolls for the bearer if the target of the attack is the enemy HERO you picked before the battle begun.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Piledriver Gauntlets': {\r\n    effects: [\r\n      {\r\n        name: `Piledriver Gauntlets`,\r\n        desc: `At the start of the combat phase, you can declare that the bearer will strike the ground instead of attacking. If you do so, in that combat phase, subtract 1 from hit rolls for attacks made by enemy models that are within 6\" of the bearer when they attack.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Resounding Gromrilhorn': {\r\n    effects: [\r\n      {\r\n        name: `Resounding Gromrilhorn`,\r\n        desc: `Once per battle, at the start of your hero phase, the bearer can use this artifact. If they do so, add 2 to the Bravery characteristic of friendly DISPOSSESSED units until your next hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME, END_OF_SETUP } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  'Stubborn to the End': {\r\n    effects: [\r\n      {\r\n        name: `Stubborn to the End`,\r\n        desc: `If you roll a 1, 2 or 3 (before modifiers are applied) when taking a battleshock test for a friendly DISPOSSESSED unit, that unit is treated as having passed the battleshock test irrespective of any modifiers to the battleshock test or their Bravery characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Grudgebound: {\r\n    effects: [\r\n      {\r\n        name: `Grudgebound`,\r\n        desc: `After set-up is complete, but before the battle begins, choose or roll for a grudge from the table below. The rules for that grudge apply to all friendly DISPOSSESSED units for the duration of the battle.\r\n\r\n    1: Stuck-up - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack is an enemy HERO.\r\n\r\n    2: Speed Merchants - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack has a Move characteristic of 10+.\r\n\r\n    3: Monstrous Cheaters - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack is an enemy MONSTER.\r\n\r\n    4: Cowardly Hordes - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack is in an enemy unit that had twenty or more models when it was set up.\r\n\r\n    5: Shoddy Craftsmanship - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack has a Save characteristic of 2+, 3+, or 4+ .\r\n\r\n    6: Sneaky Ambushers - You can reroll hit rolls of 1 for friendly DISPOSSESSED units if the target of the attack is in cover, or did not start the battle set up on the battlefield.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Grudgebound`,\r\n        desc: `Refer to the grudge you chose (or rolled for) in the \"End of Setup\" section.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Ancestral Grudge': {\r\n    effects: [\r\n      {\r\n        name: `Ancestral Grudge`,\r\n        desc: `If a Warden King uses this ability, pick one enemy unit within 16\". Until your next hero phase, you can add 1 to wound rolls for all attacks made by DISPOSSESSED models that target that unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_GAME, HERO_PHASE } from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  Resolute: {\r\n    effects: [\r\n      {\r\n        name: `Resolute`,\r\n        desc: `Friendly DISPOSSESSED units wholly within 12\" of this general pass battleshock tests on a roll of 1 to 4, rather than only on a roll of 1 to 3 (see the Stubborn to the End battle trait).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Resilient: {\r\n    effects: [\r\n      {\r\n        name: `Resilient`,\r\n        desc: `Add 1 to this general's Wounds characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Siegemaster: {\r\n    effects: [\r\n      {\r\n        name: `Siegemaster`,\r\n        desc: `Do not add 1 to the save rolls of enemy units that are in cover if they are attacked by this general or a friendly DISPOSSESSED unit wholly within 12\" of this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Unforgiving: {\r\n    effects: [\r\n      {\r\n        name: `Unforgiving`,\r\n        desc: `Add 1 to wound rolls for attacks made by this general if the target is from a unit that has inflicted any wounds on this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Battle Fury': {\r\n    effects: [\r\n      {\r\n        name: `Battle Fury`,\r\n        desc: `Roll a D6 after this general completes their attacks in the combat phase; on a roll of 6+ they can fight again (do not roll again after completing the second set of attacks).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Grudgebearer: {\r\n    effects: [\r\n      {\r\n        name: `Grudgebearer`,\r\n        desc: `Once per battle, if your general has not been slain, you can pick a new grudge in your hero phase to replace the original grudge you chose for your army (see \"End of Setup\").`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst ThrongMusiciansAndStandardBearerEffects = [\r\n  {\r\n    name: `Throng Musician`,\r\n    desc: `When a unit containing any Hornblowers or Drummers runs, they can 'Sound the Advance'. If they do so, do not roll a D6 to see how far the unit runs; instead, they can move up to an extra 4\".`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Standard Bearer`,\r\n    desc: `If you fail a battleshock test for a unit that has any Standard Bearers, halve the number of models that flee (rounding up).`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst RunicIconAndClanBannerEffects = [\r\n  GenericEffects.ClanBannerEffect,\r\n  {\r\n    name: `Runic Icon`,\r\n    desc: `Roll a D6 if an enemy spell affects a unit with any Runic Icons. On a roll of 5 or more, that spell has no effect on the unit (but it will affect other units normally).`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst GromrilShieldsEffects = [\r\n  {\r\n    name: `Gromril Shields`,\r\n    desc: `This unit can create a shield wall instead of running or charging in its turn. If it does so, reroll all failed save rolls for the unit in the combat phase until its next movement phase.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Gromril Shields`,\r\n    desc: `If active, reroll all failed save rolls for the unit in the combat phase until its next movement phase.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst HornblowersEffect = {\r\n  name: `Hornblowers`,\r\n  desc: `When a unit containing any Hornblowers runs, they can 'Sound the Advance'. If they do so, do not roll a D6 to see how far the unit runs; instead, they can move up to an extra 4\".`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst DrummersEffect = {\r\n  name: `Drummers`,\r\n  desc: `When a unit containing any Drummers runs, they can 'Sound the Advance'. If they do so, do not roll a D6 to see how far the unit runs; instead, they can move up to an extra 4\".`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst DuardinBucklersEffects = [\r\n  {\r\n    name: `Duardin Bucklers`,\r\n    desc: `If a unit is equipped with Duardin Bucklers, it can create a shield wall instead of running or charging in its turn. If it does so, reroll all failed save rolls for the unit in the combat phase until its next movement phase.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Duardin Bucklers`,\r\n    desc: `If active, reroll all failed save rolls for the unit in the combat phase until its next movement phase.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst IconBearerEffect = {\r\n  name: `Icon Bearer`,\r\n  desc: `Roll a D6 if an enemy spell affects a unit with any Icon Bearers. On a roll of 5 or more, that spell has no effect on the unit (but it will affect other units normally).`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst ForgeProvenGromrilArmorEffect = {\r\n  name: `Forge-proven Gromril Armour`,\r\n  desc: `When you make save rolls for this unit, ignore the enemy's Rend characteristic unless it is -2 or better.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst CinderblastBombEffect = {\r\n  name: `Cinderblast Bomb`,\r\n  desc: `Once per battle, a model with a Cinderblast Bomb can throw it in your shooting phase. To do so pick a unit within 6\" and roll a D6; on a 2 or more, that unit suffers D3 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  'Warden King': {\r\n    mandatory: { command_abilities: [keyPicker(command_abilities, ['Ancestral Grudge'])] },\r\n    effects: [\r\n      {\r\n        name: `Ancestor Shield`,\r\n        desc: `You can reroll all failed saves for a Warden King.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Oath Stone`,\r\n        desc: `In the hero phase, a Warden King can use this ability. If he does so, he cannot move until his next hero phase, but all DISPOSSESSED units from your army within 18\" in the battleshock phase may use the Warden King's Bravery instead of their own.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Runelord: {\r\n    effects: [\r\n      {\r\n        name: `Runes of Spellbreaking`,\r\n        desc: `A Runelord can attempt to unbind one enemy spell in the enemy hero phase as if he were a wizard. You can add 2 to any unbinding rolls for a Runelord.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rune Lore`,\r\n        desc: `In your hero phase a Runelord can use this ability. If he does so, pick a DISPOSSESSED unit within 16\", select a power and roll a D6; on a 1 the Runelord has failed and nothing happens. On a roll of 2 or more the runes hammered into his allies' wargear glow white-hot with rune magic and the power takes effect.\r\n\r\n        Ancestral Shield: Until your next hero phase, you can roll a D6 whenever a model in this unit suffers a wound or a mortal wound. On a 6, that wound or mortal wound is ignored.\r\n\r\n        Forgefire: Until your next hero phase, increase the Rend characteristics of the unit's weapons by 1 (i.e. '-' becomes -1, -1 becomes -2 and so on).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Unforged: {\r\n    effects: [\r\n      {\r\n        name: `Runic Axes`,\r\n        desc: `You can reroll all hit rolls of 1 for an Unforged.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Epic Deathblow`,\r\n        desc: `If an Unforged is slain in the combat phase, roll a D6 before it is removed. On a roll of 4 or more, you can inflict D3 mortal wounds on the enemy unit that struck the fatal blow (inflict D6 mortal wounds instead if a Chaos model struck the final blow).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nemesis`,\r\n        desc: `Attacks made by an Unforged inflict double Damage against CHAOS units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Bigger They Are...`,\r\n        desc: `You can add 1 to any wound rolls for an Unforged if the target of the attack has a Wounds characteristic of more than 1.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Hammerers: {\r\n    effects: [\r\n      ...ThrongMusiciansAndStandardBearerEffects,\r\n      {\r\n        name: `Kingsguard`,\r\n        desc: `You do not need to take battleshock tests for this unit if it is within 16\" of a DISPOSSESSED HERO from your army in the battleshock phase.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ironbreakers: {\r\n    effects: [\r\n      IconBearerEffect,\r\n      DrummersEffect,\r\n      CinderblastBombEffect,\r\n      ...GromrilShieldsEffects,\r\n      ForgeProvenGromrilArmorEffect,\r\n    ],\r\n  },\r\n  Irondrakes: {\r\n    effects: [\r\n      IconBearerEffect,\r\n      HornblowersEffect,\r\n      ForgeProvenGromrilArmorEffect,\r\n      {\r\n        name: `Grudgehammer Torpedo`,\r\n        desc: `A Grudgehammer Torpedo inflicts D6 Damage instead of D3 if the target has the MONSTER keyword.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      CinderblastBombEffect,\r\n      {\r\n        name: `Blaze Away`,\r\n        desc: `You can add 1 to the Attacks characteristic of this unit's missile weapons if it has at least 10 models and is more than 3\" from of any enemy units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Longbeards: {\r\n    effects: [\r\n      ...ThrongMusiciansAndStandardBearerEffects,\r\n      ...GromrilShieldsEffects,\r\n      {\r\n        name: `Old Grumblers`,\r\n        desc: `In your hero phase, pick one of the grumblings listed below. The effects last until your next hero phase.\r\n\r\n        \"I thought duardin were made of sterner stuff!\": Roll a D6 each time a DISPOSSESSED model from your army flees whilst within 8\" of this unit; on a 5 or more that model stands firm under the Longbeards' stern gaze and does not flee.\r\n\r\n        \"Who does this beardling think he is?\": Friendly DISPOSSESSED HEROES within 8\" of this unit are treated as if they were your general when working out the range of command abilities.\r\n\r\n        \"Grots are weedier these days!\": You can reroll wound rolls of 1 for DISPOSSESSED models from your army that are within 8\" of this unit when they attack in the combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Quarrellers: {\r\n    effects: [\r\n      DrummersEffect,\r\n      ...RunicIconAndClanBannerEffects,\r\n      {\r\n        name: `Volley Fire`,\r\n        desc: `You can add 1 to the Attacks characteristic of this unit's missile weapons if it has at least 20 models and is more than 3\" from any enemy units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      ...DuardinBucklersEffects,\r\n    ],\r\n  },\r\n  Thunderers: {\r\n    effects: [\r\n      DrummersEffect,\r\n      ...RunicIconAndClanBannerEffects,\r\n      {\r\n        name: `Precision Fire`,\r\n        desc: `You can add 1 to all hit rolls for a Thunderer if its unit has 20 or more models and there are no enemy models within 3\".`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      ...DuardinBucklersEffects,\r\n    ],\r\n  },\r\n  Warriors: {\r\n    effects: [\r\n      HornblowersEffect,\r\n      ...RunicIconAndClanBannerEffects,\r\n      {\r\n        name: `Resolute in Defence`,\r\n        desc: `You can reroll failed wound rolls of 1 when attacking with a Warrior in your opponent's combat phase. You can instead reroll all failed wound rolls for a Warrior if its unit has 20 or more models when it attacks in your opponent's combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ...DuardinBucklersEffects,\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { DISPOSSESSED } from 'meta/factions'\r\nimport { pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [DISPOSSESSED]: {\r\n    effects: pickEffects(BattleTraits, ['Grudgebound', 'Stubborn to the End']),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { DISPOSSESSED } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const DispossessedFaction = new Faction(DISPOSSESSED, ORDER, SubFactions, 'Flavors')\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_FLESH_EATER_COURTS: {\r\n    name: 'Battletome: Flesh-Eater Courts',\r\n    type: 'battletome',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_ROUND,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Artifacts = {\r\n  'Charnel Vestments': {\r\n    effects: [\r\n      {\r\n        name: `Charnel Vestments - Passive`,\r\n        desc: `Effect: If this unit is not a Priest, it has Priest (1). If this unit is already a Priest, add 1 to chanting rolls for this unit. If this unit is a Wizard, it cannot use Spell abilities and Prayer abilities in the same phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Grim Garland': {\r\n    effects: [\r\n      {\r\n        name: `The Grim Garland - Passive`,\r\n        desc: `Effect: Subtract 2 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Heart of the Gargant': {\r\n    effects: [\r\n      {\r\n        name: `Heart of the Gargant - Once Per Battle`,\r\n        desc: `Effect: If this unit is in combat, add 1 to the Attacks characteristic of its melee weapons for the rest of the turn. This ability also affects Companion weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Grim Garland': {\r\n    effects: [\r\n      {\r\n        name: `The Grim Garland`,\r\n        desc: `Subtract 2 from the Bravery characteristic of enemy units while they are within 9\" of the bearer.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Heart of the Gargant': {\r\n    effects: [\r\n      {\r\n        name: `Heart of the Gargant`,\r\n        desc: `Once per battle, at the start of the combat phase, the bearer can use this artefact. If they do so, add 1 to the Attacks characteristic of melee weapons used by the bearer and their mount in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Medal of Madness': {\r\n    effects: [\r\n      {\r\n        name: `Medal of Madness`,\r\n        desc: `Once per battle round, the bearer can issue a command without a command point being spent, and they are treated as if they were a general when they do so.`,\r\n        when: [DURING_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'The Flayed Pennant': {\r\n    effects: [\r\n      {\r\n        name: `The Flayed Pennant`,\r\n        desc: `You can reroll charge rolls for friendly FLESH-EATER COURTS units while they are wholly within 12\" of the bearer.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Charnel Vestments': {\r\n    effects: [\r\n      {\r\n        name: `Charnel Vestments`,\r\n        desc: `The bearer gains the PRIEST keyword.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { FLESH_EATER_COURTS } from 'meta/factions'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTraits = {\r\n  [FLESH_EATER_COURTS]: {\r\n    effects: [\r\n      {\r\n        name: `Muster Guard`,\r\n        desc: `Declare: Pick a friendly Courtier Hero that has 1 or more noble deeds points to use this ability, then pick a friendly unit wholly within 12\" of it to be the target. \r\n        Effect: Spend any of that Heros noble deeds points. If the target is a Serfs unit, for each noble deeds point spent, return 1 slain model to it. If the target is a Knights unit, for every 2 noble deeds points spent, return 1 slain model to it.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Feeding Frenzy - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of melee weapons, including Companion weapons, used by friendly Flesh-eater Courts units while they are wholly within 12\" of any friendly Heroes that have 6 noble deeds points.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Noble Deeds - Passive`,\r\n        desc: `Effect: Each friendly Flesh-eater Courts Hero starts the battle with 0 noble deeds points and can have a maximum of 6 noble deeds points at once. \r\n        Each time a friendly Flesh-eater Courts Hero uses a Fight ability, after that ability has been resolved, give that Hero a number of noble deeds points equal to the number of damage points inflicted by that ability. Do not count attacks made with Companion weapons. \r\n        Each time a friendly Flesh-eater Courts Priest Hero uses a Prayer ability and the prayer is answered, after that ability has been resolved, give that Hero 1 noble deeds point. \r\n        Each time a friendly Flesh-eater Courts Wizard Hero uses a Spell ability and the spell is successfully cast, after that ability has been resolved, give that Hero 1 noble deeds point.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Summon Loyal Subjects`,\r\n        desc: `Declare: Pick a friendly Abhorrant Hero that has 6 noble deeds points to use this ability, then pick a friendly Serfs or Knights unit that has been destroyed to be the target. \r\n        Effect: Spend all of that Heros noble deeds points. Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 6\" of a battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Royal Blood - Once Per Turn`,\r\n        desc: `Declare: Pick any number of friendly Abhorrants to be the targets. \r\n        Effect: Heal (D3) each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Charnel Throne (Faction Terrain) - Steward of the Realm - Passive`,\r\n        desc: `Effect: While this terrain feature has a Steward:  \r\n        The Steward cannot use Move abilities.  \r\n        Instead of measuring range or visibility to the Steward, measure to this terrain feature instead.  \r\n        All attacks that would target the Steward target this terrain feature instead.  \r\n        If this terrain feature is destroyed, before removing it from the battlefield, inflict D3 mortal damage on the Steward. Then, set up the Steward on the battlefield within 3\" of this terrain feature and not in combat. That unit is no longer the Steward. If it is not possible to set up the Steward, it is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Charnel Throne (Faction Terrian) - Reigning Champion`,\r\n        desc: `Declare: If this terrain feature does not have a Steward, pick a friendly Flesh-eater Courts Infantry Hero within 3\" of it to be the target. \r\n        Effect: Place the target on this terrain feature. The target is now the Steward (see Steward of the Realm).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Charnel Throne (Faction Terrian) - Duty Calls`,\r\n        desc: `Effect: If this terrain feature has a Steward, set up the Steward on the battlefield wholly within 6\" of this terrain feature and not in combat. That unit is no longer the Steward.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Charnel Throne (Faction Terrian) - Ruler of All They Survey`,\r\n        desc: `Effect: Give D3 noble deeds points to this terrain features Steward.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandTraits = {\r\n  'Cruel Taskmaster': {\r\n    effects: [\r\n      {\r\n        name: `Cruel Taskmaster - Passive`,\r\n        desc: `Effect: Each time a friendly unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Savage Beyond Reason': {\r\n    effects: [\r\n      {\r\n        name: `Savage Beyond Reason - Passive`,\r\n        desc: `Effect: While this unit has fewer than 6 noble deeds points, its melee weapons have Crit (2 Hits). While it has 6 noble deeds points, its melee weapons have Crit (Mortal).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stronger in Madness': {\r\n    effects: [\r\n      {\r\n        name: `Stronger in Madness - Passive`,\r\n        desc: `Effect: Add 2 to this units Health characteristic. In addition, while this unit has 6 noble deeds points, it has Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n /* 'Feverish Scholar': {\r\n    effects: [\r\n      {\r\n        name: `Feverish Scholar`,\r\n        desc: `Add 1 to casting rolls, dispelling rolls and unbinding rolls for this general. If this general has 6 noble deeds points, add 2 to casting rolls, dispelling rolls and unbinding rolls for this general instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master of the Menagerie': {\r\n    effects: [\r\n      {\r\n        name: `Master of the Menagerie`,\r\n        desc: `When using the Summon Loyal Subjects battle trait, you can pick 1 friendly FLESH-EATER COURTS MONSTER that is not a HERO and that has been destroyed, instead of a unit of SERFS or KNIGHTS. Set up a replacement unit as described in the battle trait and allocate 6 wounds to that replacement MONSTER that cannot be negated. In addition, when that unit is set up, it can be set up wholly within 7\" of the edge of the battlefield instead of 6\".`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stronger in Madness': {\r\n    effects: [\r\n      {\r\n        name: `Stronger in Madness`,\r\n        desc: `Add 2 to this general's Wounds characteristic.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Stronger in Madness`,\r\n        desc: `While this general has 6 noble deeds points, they have a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Savage Beyond Reason': {\r\n    effects: [\r\n      {\r\n        name: `Savage Beyond Reason`,\r\n        desc: `If the unmodified hit roll for an attack made with a melee weapon by this general is 6, that attack scores 2 hits on the target instead of 1. If this general has 6 noble deeds points, that attack scores 3 hits on the target instead of 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Cruel Taskmaster': {\r\n    effects: [\r\n      {\r\n        name: `Cruel Taskmaster`,\r\n        desc: `If this general uses the Muster Guard ability to return models to a unit, reduce the noble deeds cost of each returned model by 1, or if the cost was already 1, you can bring back 1 additional model instead.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  DURING_GAME,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst EndlessSpells = {\r\n  /*'Corpsemare Stampede': {\r\n    effects: [\r\n      GenericEffects.Predatory.Twelve_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7 and a range of 3D6\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only FLESH-EATER COURTS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Trampled Underfoot`,\r\n        desc: `After this endless spell has moved, roll 6 dice for each unit that has any models it passes across. For each roll that is greater than that unit's Wounds characteristic, that unit suffers 1 mortal wound. For each 6, that unit instead suffers 1 mortal wound regardless of its Wounds characteristic.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chalice of Ushoran': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 24\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only FLESH-EATER COURTS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Soul Stealer`,\r\n        desc: `Keep track of the number of models that are slain within 12\" of this endless spell each turn. At the end of each turn, roll a dice for each model that was slain within 12\" of this endless spell during that turn. For each 4+, the commanding player can heal 1 wound allocated to 1 FLESH-EATER COURTS model within 12\" of this endless spell or return 1 slain model to 1 FLESH-EATER COURTS unit that has a Wounds characteristic of 1 that is wholly within 12\" of this endless spell.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Soul Stealer`,\r\n        desc: `Keep track of the number of models that are slain within 12\" of this endless spell each turn.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cadaverous Barricade': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 24\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, terrain features, other endless spells and invocations. Only FLESH-EATER COURTS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Grasping Hands`,\r\n        desc: `Enemy units within 3\" of this terrain feature cannot run or retreat. In addition, if an enemy model starts a move within 3\" of this terrain feature, halve the distance that model can move when it makes that move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Terrain Feature`,\r\n        desc: `After it is set up, this endless spell is treated as a terrain feature that has the Grasping Hands scenery rule, except that it can still be dispelled as if it were an endless spell.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { COMBAT_PHASE, DURING_GAME, END_OF_TURN, HERO_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Cannibal Court': {\r\n    effects: [\r\n      {\r\n        name: `A Hunger for Glory - Once Per Turn`,\r\n        desc: `Effect: Give 1 noble deeds point to each friendly Flesh-eater Courts Hero wholly outside friendly territory.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Lords of the Manor': {\r\n    effects: [\r\n      {\r\n        name: `Raise the Banners - Passive`,\r\n        desc: `Effect: Each time a friendly unit uses an ability that returns any slain models to a friendly Serfs or Knights unit, add 1 to the number of slain models returned to that unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Ghoul Patrol': {\r\n    effects: [\r\n      {\r\n        name: `Gore-Splattered Hunters - Passive`,\r\n        desc: `Effect: When players are alternating picking units to use a Fight ability, when it is your turn to pick a unit, you can pick 2 Crypt Ghouls units instead of 1. Neither unit can have Strike-last. Resolve the second Fight ability immediately after the first.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Menagerie': {\r\n    effects: [\r\n      {\r\n        name: `Meat for the Beast - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Monster to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /*  Morgaunt: {\r\n    effects: [\r\n      {\r\n        name: `Morgaunt Kingdoms`,\r\n        desc: `Give 1 noble deeds point to each friendly MORGAUNT FLESH-EATER COURTS HERO at the end of the turn if that HERO is contesting an objective.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Hollowmourne: {\r\n    effects: [\r\n      {\r\n        name: `Grisly Cavaliers`,\r\n        desc: `Add 1 to the Damage characteristic of melee weapons used by friendly HOLLOWMOURNE KNIGHTS units that have made a charge move in the same turn. This ability has no effect on attacks made by mounts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Blisterskin: {\r\n    effects: [\r\n      {\r\n        name: `Pious Nobility`,\r\n        desc: `Friendly ABHORRANTS gain the PRIEST keyword but they cannot cast spells and chant prayers in the same hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gristlegore: {\r\n    effects: [\r\n      {\r\n        name: `Savage Strike`,\r\n        desc: `At the start of your combat phase, you can pick 1 friendly GRISTLEGORE MONSTER on the battlefield. The strike-first effect applies to that MONSTER until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst MountTraits = {\r\n /* 'Gruesome Bite': {\r\n    effects: [\r\n      {\r\n        name: `Gruesome Bite`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's Fanged Maw.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Baneful Breath': {\r\n    effects: [\r\n      {\r\n        name: `Baneful Breath`,\r\n        desc: `Improve the Rend characteristic of this unit's Pestilential Breath by 1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Horribly Resilient': {\r\n    effects: [\r\n      {\r\n        name: `Horribly Resilient`,\r\n        desc: `This unit's Royal Blood ability heals up to 2D3 wounds instead of up to D3 wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Death From The Skies': {\r\n    effects: [\r\n      {\r\n        name: `Death From The Skies`,\r\n        desc: `Instead of setting up this unit on the battlefield, you can place it to one side and say that it is soaring in the skies in reserve. If you do so, at the end of your first movement phase, you must set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP, TURN_ONE_END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Venerated Zombie Dragon': {\r\n    effects: [\r\n      {\r\n        name: `Venerated Zombie Dragon`,\r\n        desc: `Add 1 to hit rolls for friendly FLESH-EATER COURTS MONSTERs while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Morbheg's Swiftness\": {\r\n    effects: [\r\n      {\r\n        name: `Morbheg's Swiftness`,\r\n        desc: `This unit can retreat and still charge later in the turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MountTraits, 'mount_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { BATTLESHOCK_PHASE, DURING_GAME, START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Scenery = {\r\n /* 'Charnel Throne': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      {\r\n        name: `Defensible`,\r\n        desc: `This terrain feature is a defensible terrain feature that can be garrisoned by 1 FLESH-EATER COURTS HERO that has a Wounds characteristic of up to 7.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Ruler of All He Surveys`,\r\n        desc: `At the start of your hero phase, add D3 noble deeds points to any friendly FLESH-EATER COURTS HERO that is garrisoning this terrain feature.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ghoulish Landmark`,\r\n        desc: `While an enemy unit is within 12\" of this terrain feature, it cannot be affected by any abilities that allow units to ignore battleshock tests.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Spells = {\r\n  'Lore of Madness': {\r\n    effects: [\r\n      {\r\n        name: `Deranged Transformation: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Wizard to cast this spell, pick a visible friendly Flesh-eater Courts Infantry or Cavalry unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn:  Add 2\" to the targets Move characteristic.  Add 1 to wound rolls for the targets combat attacks.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Miasma of Madness: Casting value of 5`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 7 dice and apply the corresponding effect: \r\n        Ravaged Mind: If 2 or more dice have the same value, inflict 1 mortal damage on the target. \r\n        Gory Visions: If 3 or more dice have the same value, in addition to the effect of Ravaged Mind, subtract 1 from hit rolls for the targets attacks until the start of your next turn. \r\n        Drooling Stupor: If 4 or more dice have the same value, in addition to the effects of Ravaged Mind and Gory Visions, subtract 1 from wound rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Charnel Feast: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target. Then, you can pick a friendly Flesh-eater Courts Infantry unit within 6\" of the target. For each damage point allocated to the target by this ability, you can return 1 slain model to that friendly unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Deranged Transformation': {\r\n    effects: [\r\n      {\r\n        name: `Deranged Transformation`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick 1 friendly FLESH-EATER COURTS unit wholly within range and visible to the caster that has a Wounds characteristic of 7 or less. Until your next hero phase, add 2\" to that unit's Move characteristic and add 1 to wound rolls for attacks made by that unit. If the casting roll was 10 or more, you can pick up to 3 different friendly units to be affected by the spell instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ferocious Hunger': {\r\n    effects: [\r\n      {\r\n        name: `Ferocious Hunger`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 friendly ROYAL TERRORGHEIST wholly within range. You can reroll hit rolls for attacks made with that unit's Fanged Maw until your next hero phase.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crimson Victuals': {\r\n    effects: [\r\n      {\r\n        name: `Crimson Victuals`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range of the caster, and a friendly FLESH-EATER COURTS unit that has a Wounds characteristic of 1 and is within 6\" of that enemy unit. The enemy unit suffers D3 mortal wounds. Then, for each mortal wound that was caused to the enemy unit and not negated, you can return 1 slain model to the friendly unit. If the casting roll was 10 or more, the enemy unit suffers 2D3 mortal wounds instead of D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Monstrous Hunger': {\r\n    effects: [\r\n      {\r\n        name: `Monstrous Hunger`,\r\n        desc: `Casting value of 6 and a range of 18\". If successfully cast, friendly FLESH-EATER COURTS MONSTERS wholly within range of the caster are filled with monstrous hunger until your next hero phase. A unit filled with monstrous hunger can run and still charge later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glimpse of Delusion': {\r\n    effects: [\r\n      {\r\n        name: `Glimpse of Delusion`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy model within range and visible to the caster. Then, pick 1 melee weapon that enemy model is armed with and pick 1 other enemy unit within range of that weapon. That enemy model immediately makes combat attacks with that weapon targeting that other enemy unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Carrion Call': {\r\n    effects: [\r\n      {\r\n        name: `Carrion Call`,\r\n        desc: `Casting value of 6. If successfully cast, in the following movement phase, friendly FLESH-EATER COURTS units that are set up at the end of the movement phase can immediately move D6\".`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unnatural Speed': {\r\n    effects: [\r\n      {\r\n        name: `Unnatural Speed`,\r\n        desc: `Casting value of 6. If successfully cast, this unit can immediately attempt a charge and you can roll 3D6 for the charge roll. If the charge is successful, the strike-first effect applies to this unit in the following combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Winds of Shyish': {\r\n    effects: [\r\n      {\r\n        name: `Winds of Shyish`,\r\n        desc: `Casting value of 6 and a range of 9\". Pick 1 friendly FLESH-EATER COURTS unit that can fly and is wholly within range and visible to the caster. Remove this unit and the unit you picked from the battlefield and set them up again more than 9\" from all enemy units and wholly within 9\" of each other. Neither unit can move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport prayers from './prayers'\r\n\r\n/*const NobleBloodEffect = {\r\n  name: `Noble Blood`,\r\n  desc: `In your hero phase, you can heal up to D3 wounds allocated to this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst RoyalBloodEffect = {\r\n  name: `Royal Blood`,\r\n  desc: `In your hero phase, you can heal up to D3 wounds allocated to this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst ChosenOfTheKingEffect = {\r\n  name: `Chosen of the King`,\r\n  desc: `Improve the Rend characteristic of this unit's melee weapons by 1 while it is wholly within 6\" of any friendly COURTIERS or 18\" of any friendly ABHORRANTS.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  'Nagash, Supreme Lord of the Undead': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, subtract 3 from its power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Staff of Power - Passive`,\r\n        desc: `Effect: Add 2 to casting rolls for this unit while it has not miscast any spells this turn. If this unit miscasts a spell, ignore the restriction that would stop this unit from casting any more spells this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hand of Dust - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy Hero or Monster in combat with this unit to be the target. \r\n        Effect: Hide a dice in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one hiding the dice, this ability has no effect. If they pick the empty one, the target is automatically destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Supreme Lord of the Undead - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero non-Unique Death unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit identical to the target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Invocation of Nagash: Casting value of 7`,\r\n        desc: `Declare: This unit can cast this spell more than once per phase. Pick a visible unit wholly within 18\" of this unit that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target is an enemy unit, inflict D3 mortal damage on it. If the target is a friendly Death unit, pick 1 of the following effects:  \r\n        Return a number of slain models to the target unit with a combined Health characteristic of up to 3.  The target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ushoran, Mortarch of Delusion': {\r\n    /*mandatory: {\r\n      spells: [keyPicker(spells, ['Glimpse of Delusion'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Monstrous Talons is 6.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Epicentre of Delusion`,\r\n        desc: `Effect: Pick 1 of the following effects to apply until the start of your next turn: \r\n        The Royal Hunt: Add 1 to wound rolls for attacks made by friendly Flesh-eater Courts units that target a Monster. \r\n        Crusading Army: Add 1 to run rolls and charge rolls for friendly Flesh-eater Courts units. \r\n        Defenders of the Realm: Add 1 to save rolls for friendly Flesh-eater Courts units while they are contesting an objective you control. \r\n        The Grand Tournament: Add 1 to hit rolls for attacks made by other friendly Flesh-eater Courts Heroes if they charged in the same turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Carrion King - Passive`,\r\n        desc: `Effect: While this unit has 6 noble deeds points, the effect of the Feeding Frenzy ability applies to friendly Flesh-eater Courts units while they are wholly within 24\" of this unit instead of 12\".`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shroudcage Fragment - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a dice for each target. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Glimpse of Delusion: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy model within 18\" of this unit to be the target, pick another enemy unit within the targets combat range to be the victim, then make a casting roll of 2D6. \r\n        Effect: Pick 1 of the targets melee weapons. Immediately resolve combat attacks made with that weapon against the victim.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Abhorrant Ghoul King': {\r\n    /*mandatory: {\r\n      spells: [keyPicker(spells, ['Unnatural Speed'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     // RoyalBloodEffect,\r\n      {\r\n        name: `Code of Honour`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: For the rest of the turn, add 1 to the Damage characteristic of this units melee weapons, but all of this units attacks must target that Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unnatural Speed`,\r\n        desc: `Effect: If this unit charged this phase, it has Strike-first for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Abhorrant Ghoul King on Royal Terrorgheist': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Ferocious Hunger'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Gaping Maw - Passive`,\r\n        desc: `Effect: Each time an attack made with this units Terrorgheists Fanged Maw scores a critical hit, that attack inflicts 6 mortal damage on the target unit and the attack sequence ends.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ferocious Hunger - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, attacks made with this units Terrorgheists Fanged Maw that target that enemy unit score critical hits on unmodified hit rolls of 5+ for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Terrorgheists Skeletal Talons is 4.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n    //  GenericEffects.WizardOneSpellEffect, ...GenericEffects.Terrorgheist, RoyalBloodEffect\r\n    ],\r\n  },\r\n  'Abhorrant Ghoul King on Royal Zombie Dragon': {\r\n    /*mandatory: {\r\n      spells: [keyPicker(spells, ['Monstrous Hunger'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     // RoyalBloodEffect,\r\n      {\r\n        name: `Draconic Terror - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Monstrous Hunger - Passive`,\r\n        desc: `Effect: While they are wholly within 12\" of this unit, friendly non-Hero Flesh-eater Courts Monsters can use Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Draconic Claws is 5.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'Grand Justice Gormayne': {\r\n    effects: [\r\n     // RoyalBloodEffect,\r\n      {\r\n        name: `Delusion of Justice Served - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the following effects to apply to the target until the start of your next turn: \r\n        Petty Transgression: Add 1 to wound rolls for combat attacks that target that unit. \r\n        Dishonourable Conduct in Battle: Friendly non-Monster Flesh-eater Courts units can use Charge abilities even if they used a Run ability in the same turn, but if they do so, they must end the charge move within 1/2\" of the target. \r\n        Grievous Insult to the Court: While the target is in combat with a friendly Abhorrant, add 1 to hit rolls for attacks made by friendly Flesh-eater Courts units that target that unit. \r\n        Regicide: If the target destroyed a friendly Abhorrant this battle, add 1 to the Damage characteristic of melee weapons used by friendly Flesh-eater Courts units that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Crypt Ghast Courtier': {\r\n    effects: [\r\n      {\r\n        name: `Marshal of the Peasantry`,\r\n        desc: `In the combat phase, after this unit has fought for the first time in that phase, you can pick 1 friendly SERFS unit that has not yet fought in that phase, is within 3\" of an enemy unit and is wholly within 9\" of this unit. That unit can fight immediately.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Crypt Haunter Courtier': {\r\n    effects: [\r\n     // NobleBloodEffect,\r\n      {\r\n        name: `Knightly Exemplar - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Crypt Horrors unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Noble Blood`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crypt Infernal Courtier': {\r\n    effects: [\r\n      {\r\n        name: `Mind-Shattering Cacophony - Passive`,\r\n        desc: `Effect: If any enemy models were slain by this units Piercing Death Screech this turn, for the rest of the turn, add 1 to the Damage characteristic of ranged weapons used by friendly Crypt Flayers units while they are wholly within 12\" of this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Varghulf Courtier': {\r\n    effects: [\r\n      {\r\n        name: `Bounding Strides - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Victory Feast`,\r\n        desc: `Effect: If any models were slain by this unit this turn:  \r\n        Heal (D6) this unit.  \r\n        This unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Abhorrant Archregent': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Carrion Call'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      //RoyalBloodEffect,\r\n      {\r\n        name: `Countless Servants`,\r\n        desc: `Declare: Pick a friendly Serfs or Knights unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+:  \r\n        If the target is a Serfs unit, you can return up to 3 slain models to that unit.  \r\n        If the target is a Knights unit, you can return 1 slain model to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Carrion Call: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: The first friendly Flesh-eater Courts unit to be set up in the following movement phase can immediately move D6\". That unit cannot move into combat during any part of that move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Abhorrant Cardinal': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, ['Speak in Tongues'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Rousing Oration`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Hero wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, give the target a number of noble deeds points equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  RoyalBloodEffect\r\n    ],\r\n  },\r\n  'Abhorrant Gorewarden': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Winds of Shyish'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n     // RoyalBloodEffect,\r\n      {\r\n        name: `Royal Hunting Party`,\r\n        desc: `Declare: If this unit is not in combat, you can pick up to 2 friendly Crypt Flayers or Morbheg Knights units that are not in combat and are wholly within 12\" of this unit to be the targets. \r\n        Effect: Remove this unit and the targets (if any) from the battlefield. Set up this unit again on the battlefield more than 9\" from all enemy units. Then, set up each target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crypt Ghouls': {\r\n    effects: [\r\n      {\r\n        name: `Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crypt Horrors': {\r\n    effects: [\r\n      {\r\n        name: `Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  NobleBloodEffect,\r\n    //  ChosenOfTheKingEffect,\r\n    {\r\n      name: `Noble Blood`,\r\n      desc: `Effect: Heal (D3) this unit.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Crypt Flayers': {\r\n    effects: [\r\n      {\r\n        name: `Escort Courtier - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a friendly Flesh-eater Courts Infantry Hero that does not have Fly and is within this units combat range to be the target. \r\n        Effect: Remove the target from the battlefield. Then, this unit can move a distance up to its Move characteristic. It cannot end that move in combat. Then, set up the target within this units combat range and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // 'Duke Crakmarrow': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Muster the Grymwatch`,\r\n  //       desc: `Pick 1 friendly Grymwatch unit within 3\" of this model and roll 6 dice. For each 2+ you can return 1 slain model to that unit.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Gallant Champion`,\r\n  //       desc: `Add 1 to the damage inflicted by each successful attack made by this model that targets a monster.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // 'The Grymwatch': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Royal Retinue`,\r\n  //       desc: `Roll a D6 before you allocate a wound or mortal wound to a friendly Duke Crakmarrow while he is within 3\" of this unit. On a 4+, that wound is allocate to this unit instead.`,\r\n  //       when: [WOUND_ALLOCATION_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Quest to Slay the Monster`,\r\n  //       desc: `Add 1 to the damage inflicted by each successful attack made by this unit that targets a monster.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  'Royal Terrorgheist': {\r\n    effects: [\r\n    //  ...GenericEffects.Terrorgheist\r\n    {\r\n      name: `Gaping Maw - Passive`,\r\n      desc: `Effect: Each time an attack made with this units Terrorgheists Fanged Maw scores a critical hit, that attack inflicts 6 mortal damage on the target unit and the attack sequence ends.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    {\r\n      name: `Death Shriek - Once Per Turn`,\r\n      desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n      Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target by this ability, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Terrorgheists Skeletal Talons is 4.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Zombie Dragon': {\r\n    effects: [\r\n    //  ...GenericEffects.ZombieDragon\r\n    {\r\n      name: `Soaring Terror - Once Per Turn`,\r\n      desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit can move 2D6\". It can pass through the combat ranges of enemy units but must end that move in combat. Then, pick an enemy unit that this unit passed across during that move. Inflict D3 mortal damage on that enemy unit.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    {\r\n      name: `Vantage Point`,\r\n      desc: `Declare: Pick this unit if it has not been deployed. \r\n      Effect: Set up this unit in reserve high above the battlefield. It has now been deployed.`,\r\n      when: [DURING_SETUP],\r\n    },\r\n    {\r\n      name: `Loathsome Descent`,\r\n      desc: `Declare: Pick this unit if it is high above the battlefield. \r\n      Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Draconic Claws is 5.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Marrowscroll Herald': {\r\n    effects: [\r\n      {\r\n        name: `The King's Entreaty - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Attack the Apostate!: Friendly Flesh-eater Courts units in combat with the target have Strike-first for the rest of the turn. \r\n        Welcome the Disciple!: The target has the Infected keyword for the rest of the battle. Each time your opponent declares a command, Spell ability or Prayer ability for an Infected unit, roll a dice. On a 5+:  \r\n        If they declared a command, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.  \r\n        If they declared a Spell or Prayer ability, that spell or prayer fails.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Don't Shoot the Messenger - Passive`,\r\n        desc: `Effect: While this unit is not in combat and is wholly within the combat ranges of 3 or more other friendly Flesh-eater Courts Infantry models, it is not visible to enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Decapitator': {\r\n    effects: [\r\n      {\r\n        name: `Executioner's Entourage - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Serfs unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Off with their Head!`,\r\n        desc: `Declare: Pick an enemy Infantry Hero that had any damage points allocated to it this turn by this units attacks to be the target. \r\n        Effect: Roll a dice. On a 5+, the target is automatically destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Cryptguard: {\r\n    effects: [\r\n      {\r\n        name: `Armoury of Madness - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: If any damage points inflicted by attacks made as part of that Fight ability are allocated to any enemy units, those enemy units cannot use commands until the start of your next turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Royal Bodyguard - Passive`,\r\n        desc: `Effect: While any friendly Flesh-eater Courts Heroes are wholly within this units combat range, both this unit and those Heroes have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Morbheg Knights': {\r\n    effects: [\r\n      {\r\n        name: `Shrieking Charge`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Predator's Pounce - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Beastflayers': {\r\n    effects: [\r\n      {\r\n        name: `Royal Flaymaster`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Add 1 to the amount of mortal damage inflicted, if any, if the target is a Monster or Beast unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hunter's Instincts - Passive`,\r\n        desc: `Effect: Enemy Monsters cannot use Rampage abilities while they are in combat with this unit. In addition, subtract 1 from the Damage characteristic of melee weapons used by enemy Monsters and Beast units while they are in combat with this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Liche`s Hand': {\r\n    effects: [\r\n      {\r\n        name: `Arkhan: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Razaraks Ebon Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: The Doom of Traitors - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is a Hero, double the amount of mortal damage inflicted.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  FeasterOfSoulsEffect,\r\n      {\r\n        name: `Arkhan: Staff of Spirits - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit. Each time this unit successfully casts a spell, Heal (1) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Curse of Years: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 10 dice. For each 6:  \r\n        Inflict 1 mortal damage on the target.  \r\n        Roll an extra dice. \r\n        For each 5+ on those extra dice, repeat the above bullet points. Then, do the same for each 4+, then each 3+, then each 2+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Mortarch of Sacrament - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Ossiarch Bonereapers unit wholly within 18\" of this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on that unit. This unit can use this ability more than once per phase but only once per Spell ability`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Ebon-Wrought Armour - Passive`,\r\n        desc: `Effect: This unit has Ward (3+) against damage points inflicted by Spell abilities, Prayer abilities and abilities used by Manifestations. If you make a successful ward roll for this unit, or if this unit destroys an enemy Manifestation, give this unit an arcane charge token. This unit cannot have more than 1 arcane charge token at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Discharge Armour`,\r\n        desc: `Declare: If this unit has an arcane charge token, pick a friendly Ossiarch Bonereapers Wizard wholly within 12\" of this unit to be the target. \r\n        Effect: Remove this units arcane charge token, then add 1 to casting rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Harbingers: Harbingers of Death - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Skeletal Splintering: Casting value of 8 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Arkhan the Black in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unholy Sacraments - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making banishment rolls for the Arkhan the Black in this Regiment of Renown, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Scions of the Necropolis': {\r\n    effects: [\r\n      {\r\n        name: `Katakros: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Inda-Khaat is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Katakros: Prime Necrophoros - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Ossiarch Bonereapers units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Katakros: Aviarch Spymaster - Once Per Turn - Reaction: Opponent declared a command for a unit within 18\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 5+, that command has no effect, it still counts as having been used and the command points spent to use it are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Katakros: Command Ability - Supreme Lord of the Bonereaper Legions`,\r\n        desc: `Declare: Pick up to 3 friendly Ossiarch Bonereapers units wholly within 18\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, add 1 to save rolls for the targets while they are wholly within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Immortis Guard: Soulbound Protectors - Passive`,\r\n        desc: `Effect: Add 1 to ward rolls for friendly Ossiarch Bonereapers Heroes within this units combat range. However, each time you make a ward roll of 1 for a friendly Ossiarch Bonereapers Hero within this units combat range, allocate 1 damage point to this unit after the damage sequence for that Hero has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bulwark of the Necropolis`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Subtract 2D6 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Sorrowmourn Choir': {\r\n    effects: [\r\n      {\r\n        name: `Lady Olynder: Grief-Stricken: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore positive modifiers to hit rolls, wound rolls and save rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lady Olynder: Mortarch of Grief - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Lady Olynder: No Rest For the Wicked - Once Per Battle`,\r\n        desc: `Declare: Pick any number of friendly Nighthaunt units on the battlefield to be the targets. \r\n        Effect: For each target, you can return a number of slain models to that unit with a combined Health characteristic of up to D3+3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Myrmourn Banshees: Spell-Eaters - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Nighthaunt unit wholly within 12\" of this unit was picked to be the target of that spell, this unit can use the Unbind ability as if it had Wizard (1). Add 1 to the unbinding roll for that ability. If the spell is unbound, inflict D3 mortal damage on the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Harrowing Shriek - Passive`,\r\n        desc: `Effect: If this unit charged in the same turn, subtract 1 from wound rolls for attacks made by enemy units while they are in combat with this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Murderous Bloodlust - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units combat attacks while it is in combat with any damaged enemy units or while it is in combat with any enemy units that had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ghostly Paths: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Lady Olynder in this Regiment of Renown to cast this spell, pick a visible friendly unit in this Regiment of Renown that is wholly within 12\" of them, that is not in combat and that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Insubstantial - Passive`,\r\n        desc: `Effect: Ignore modifiers to save rolls (positive and negative) for units in the Regiment of Renown.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Harvesters of Sorrow - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Neferata`s Royal Echelon': {\r\n    effects: [\r\n      {\r\n        name: `Neferata: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Nagadrons Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n        {\r\n          name: `Neferata: Twilight's Allure - Passive`,\r\n          desc: `Effect: Subtract 1 from hit rolls for combat attacks that target friendly Soulblight Gravelords units while they are wholly within 6\" of this unit.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Neferata: Mortarch of Blood`,\r\n          desc: `Declare: Pick up to 3 friendly Deathrattle Infantry or Deadwalkers Infantry units to be the targets. \r\n          Effect: Each target can use the Normal Move ability as if it were your movement phase.`,\r\n          when: [DURING_SETUP],\r\n        },\r\n        {\r\n          name: `Neferata: The Adevore - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy Hero that was allocated any damage points inflicted by this units Akmet-har this turn to be the target. \r\n          Effect: Roll a dice. On a 5+, the target is automatically destroyed.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Neferata: Dark Mist: Casting value of 7`,\r\n          desc: `Declare: Pick a visible friendly non-Monster Soulblight Gravelords unit wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n          Effect: Ignore modifiers to save rolls for the target (positive and negative) until the start of your next turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Black Knights: The Deathly Charge - Passive`,\r\n          desc: `Effect: If this unit charged this turn, its Barrow Lances have Crit (Mortal) for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Deathrattle Skeletons: Skeleton Legion`,\r\n          desc: `Effect: You can return D3 slain models to this unit.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Soulpike: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Neferata in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn, each time the target uses a Charge ability, immediately after that ability has been resolved, roll a number of dice equal to the unmodified charge roll for that ability. For each 4+, inflict 1 mortal damage on the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Premeditated Demise - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy unit within 12\" of the Neferata in this Regiment of Renown to be the target. \r\n          Effect: Until the start of your next turn, ward rolls cannot be made for damage points inflicted on the target by attacks made by units in this Regiment of Renown.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `The Blood Queen's Will - Once Per Battle`,\r\n          desc: `Declare: Pick an enemy unit contesting an objective that the Neferata in this Regiment of Renown is contesting to be the target. \r\n          Effect: Roll a dice. On a 2-5, subtract 10 from the control score of the target for the rest of the turn. On a 6, the target has a maximum control score of 1 for the rest of the turn.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: The Sternieste Garrison': {\r\n    effects: [\r\n      {\r\n        name: `Mannfred Von Carstein: Wind of Death: Casting value of 7`,\r\n        desc: `Declare: Pick a point on the battlefield within 18\" of the caster, pick up to 3 visible enemy units within 6\" of that point to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Sword of Unholy Power - Passive`,\r\n        desc: `Effect: If this unit has slain any enemy models this turn, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Deathrattle and Deadwalkers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Mortarch of Night - Reaction: You declared the Redeploy command for a Soulblight Gravelords unit wholly within 12\" of this unit`,\r\n        desc: `Effect: The unit using the Redeploy command can move into combat when using that ability.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Ashigaroths Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Ashigaroth's Hunger - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fell Bats: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n        {\r\n          name: `Fell Bats: Fleet and Fell - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Stalking Blades: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Mannfred von Carstein in this Regiment of Renown to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Inflict 1 mortal damage on the target for each other enemy unit within 3\" of the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Engulfing Shadows - Passive`,\r\n          desc: `Effect: Each time a unit in this Regiment of Renown is set up, add 1 to the Attacks characteristic of that units melee weapons for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Cover of Night - Once Per Turn`,\r\n          desc: `Declare: Pick 1 friendly unit in this Regiment of Renown that is not in combat to be the target. \r\n          Effect: Remove that unit from the battlefield and set it up again more than 6\" from all enemy units.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Veremord`s Shamblers': {\r\n    effects: [\r\n      {\r\n        name: `Corpse Cart: Locus of Undeath - Passive`,\r\n        desc: `Effect: Melee weapons used by other friendly Deadwalkers units have Crit (Auto-wound) while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Deadwalker Zombies: Mindless Ferocity - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 6+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vitiating Vapours - Passive`,\r\n        desc: `Effect: Subtract 1 from ward rolls for enemy units while they are within 12\" of the Corpse Cart in this Regiment of Renown.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Legend Among Graverobbers`,\r\n        desc: `Declare: Pick the Corpse Cart in this Regiment of Renown to use this ability if it is within 3\" of the Deadwalker Zombies unit in this Regiment of Renown. Then, pick each enemy Infantry, Cavalry and Beast unit within 12\" of the Corpse Cart to be the targets. \r\n        Effect: For each target that had any models slain this turn, you can return D3 slain models to the Deadwalker Zombies unit in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n/*  'Delectable Appetisers': {\r\n    effects: [\r\n      {\r\n        name: `Delectable Appetisers`,\r\n        desc: `Pick 1 enemy unit that has a Wounds characteristic of 2 or less and is within 3\" of this unit and roll a dice. On a 3+, that enemy unit suffers D3 mortal wounds. Then, for each mortal wound that was caused to that enemy unit and not negated, this unit heals 1 wound.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodcurdling Shriek': {\r\n    effects: [\r\n      {\r\n        name: `Bloodcurdling Shriek`,\r\n        desc: `Pick 1 enemy unit within 3\" of this unit and roll a dice. On a 3+, subtract 2 from the Bravery characteristic of that enemy unit until the end of the turn.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Prayers = {\r\n  'Rites of Delusion': {\r\n    effects: [\r\n      {\r\n        name: `Blessed Feast: Chant value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Priest to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, each time a model in the target unit is slain, Heal (1) a friendly Flesh-eater Courts unit in combat with the target. If the chanting roll was 10+, Heal (D3) that friendly unit instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Summerking's Favour: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Priest to chant this prayer, pick a visible friendly Flesh-eater Courts Hero wholly within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, each time an enemy model is slain by a combat attack made by the target, give the target 1 additional noble deeds point after the Fight ability has been resolved. If the chanting roll was 10+, until the start of your next turn, each time an enemy model is slain by a combat attack made by the target, give all friendly Flesh-eater Courts Heroes wholly within 18\" of the target 1 additional noble deeds point after the Fight ability has been resolved instead of only the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Charnel Conviction: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Flesh-eater Courts Priest to chant this prayer, pick a visible friendly Flesh-eater Courts unit wholly within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Until the start of your next turn, the target has Ward (5+). If the chanting roll was 10+, pick another friendly Flesh-eater Courts unit wholly within 18\" of the target. That unit also has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* \"The Summerking's Favour\": {\r\n    effects: [\r\n      {\r\n        name: `The Summerking's Favour`,\r\n        desc: `Answer value of 3 and a range of 18\". If answered, pick 1 friendly FLESH-EATER COURTS HERO wholly within range and visible to the chanter. Until your next hero phase, that Hero gains 1 additional noble deeds point each time they slay an enemy model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Charnel Conviction': {\r\n    effects: [\r\n      {\r\n        name: `Charnel Conviction`,\r\n        desc: `Answer value of 3 and a range of 18\". If answered, pick 1 friendly FLESH-EATER COURTS unit wholly within range and visible to the chanter. That unit has a ward of 5+ until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Speak in Tongues': {\r\n    effects: [\r\n      {\r\n        name: `Speak in Tongues`,\r\n        desc: `Answer value of 3 and a range of 18\". If answered, pick 1 enemy unit within range and visible to the chanter. Until your next hero phase, roll a dice each time that enemy unit receives a command. On a 4+, that command has no effect.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Legendary Exploits': {\r\n    effects: [\r\n      {\r\n        name: `Legendary Exploits`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are at least 3 friendly FLESH-EATER COURTS HEROES on the battlefield that each have 6 noble deeds points.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Expand the Kingdom': {\r\n    effects: [\r\n      {\r\n        name: `Expand the Kingdom`,\r\n        desc: `When the battle ends, you complete this grand strategy if a friendly ABHORRANT is wholly within enemy territory and the enemy general is not wholly within enemy territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Defend the Throne': {\r\n    effects: [\r\n      {\r\n        name: `Defend the Throne`,\r\n        desc: `When the battle ends, you complete this grand strategy if a friendly Charnel Throne is on the battlefield, it is garrisoned by a friendly FLESH-EATER COURTS HERO, and there are no enemy units within 6\" of it.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Screamed to Death': {\r\n    effects: [\r\n      {\r\n        name: `Screamed to Death`,\r\n        desc: `Pick 1 enemy unit on the battlefield. You complete this battle tactic if that unit is destroyed this turn by an attack made with a missile weapon used by a friendly CRYPT FLAYERS unit, CRYPT INFERNAL COURTIER or ROYAL TERRORGHEIST.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Valiant Slaying': {\r\n    effects: [\r\n      {\r\n        name: `Valiant Slaying`,\r\n        desc: `Pick 1 enemy MONSTER on the battlefield. You complete this battle tactic if that unit is destroyed during this turn by an attack made by a friendly ABHORRANT.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Overrun: {\r\n    effects: [\r\n      {\r\n        name: `Overrun`,\r\n        desc: `You complete this battle tactic if every enemy unit on the battlefield is within 3\" of a friendly FLESH-EATER COURTS unit at the end of the turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glorious Feast': {\r\n    effects: [\r\n      {\r\n        name: `Glorious Feast`,\r\n        desc: `You complete this battle tactic if every friendly unit on the battlefield is wholly within 12\" of a friendly FLESH-EATER COURTS HERO that has 6 noble deeds points at the end of the turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lance Formation': {\r\n    effects: [\r\n      {\r\n        name: `Lance Formation`,\r\n        desc: `You complete this battle tactic if 2 or more friendly KNIGHTS units made a charge move this turn and the charge roll for each of those units was 7 or more.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Ties of Chivalry': {\r\n    effects: [\r\n      {\r\n        name: `The Ties of Chivalry`,\r\n        desc: `Pick 1 objective on the battlefield that your opponent controls. You complete this battle tactic if you control that objective at the end of your turn and it is contested by at least 1 friendly SERFS model, 1 friendly KNIGHTS model and 1 friendly COURTIER model.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { FLESH_EATER_COURTS } from 'meta/factions'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport MountTraits from './mount_traits'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport prayers from './prayers'\r\nimport grand_strategies from './grand_strategies'\r\nimport battle_tactics from './battle_tactics'\r\nimport LoNUnits from '../nighthaunt/units'\r\n\r\nconst subFactions = {\r\n  [FLESH_EATER_COURTS]: {\r\n    effects: pickEffects(BattleTraits, [FLESH_EATER_COURTS]),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battle_tactics: [battle_tactics],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      grand_strategies: [grand_strategies],\r\n      mount_traits: [MountTraits],\r\n      monstrous_rampages: [monstrous_rampages],\r\n      prayers: [prayers],\r\n      flavors: [Flavors],\r\n      scenery: [Scenery],\r\n      spells: [Spells],\r\n      units: [Units, keyPicker(LoNUnits, ['Nagash, Supreme Lord of the Undead'])],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { FLESH_EATER_COURTS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const FleshEaterCourtsFaction = new Faction(\r\n  FLESH_EATER_COURTS,\r\n  DEATH,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_FLESH_EATER_COURTS\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_FYRESLAYERS: {\r\n    name: 'Battletome: Fyreslayers',\r\n    type: 'battletome',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n /* 'Master Rune of Unbreakable Resolve': {\r\n    effects: [\r\n      {\r\n        name: `Master Rune of Unbreakable Resolve`,\r\n        desc: `Once per battle, at the start of a phase, you can say that the bearer will use their master rune. If you do so, the bearer has a ward of 3+ until the end of that phase.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magnetised Runes': {\r\n    effects: [\r\n      {\r\n        name: `Magnetised Runes`,\r\n        desc: `Add 2 to charge rolls made for the bearer.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Fiery Ring': {\r\n    effects: [\r\n      {\r\n        name: `The Fiery Ring`,\r\n        desc: `Once per battle, in your shooting phase, you can pick 1 enemy unit within 6\" of the bearer and roll a dice. On a 2+, that unit suffers D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Draught of the Finest Magmalt': {\r\n    effects: [\r\n      {\r\n        name: `Draught of the Finest Magmalt - One Per Battle`,\r\n        desc: `Effect: Add 3 to the Attacks characteristic of this units melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Axe of Grimnir': {\r\n    effects: [\r\n      {\r\n        name: `The Axe of Grimnir`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Improve the Rend characteristic of that weapon by 1 and add 1 to the Damage characteristic of that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Ash-cloud Rune': {\r\n    effects: [\r\n      {\r\n        name: `Ash-cloud Rune - Once Per Battle`,\r\n        desc: `Effect: Until the start of your next turn, friendly Infantry units cannot be targeted by shooting attacks while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Volatile Brazier': {\r\n    effects: [\r\n      {\r\n        name: `Volatile Brazier`,\r\n        desc: `When the bearer attempts to summon an invocation, you can reroll chanting rolls for the bearer and the range of the prayer is doubled.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Droth-helm': {\r\n    effects: [\r\n      {\r\n        name: `Droth-helm - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for Companion weapons used by friendly Fyreslayers units while they are wholly within 12\" of this unit..`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'The Daemon Slayer': {\r\n    effects: [\r\n      {\r\n        name: `The Daemon Slayer`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Ward rolls cannot be made for wounds and mortal wounds caused by attacks made with that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nulsidian Icon': {\r\n    effects: [\r\n      {\r\n        name: `Nulsidian Icon`,\r\n        desc: `This artefact of power can only be given to a BATTLESMITH. Each time a friendly FYRESLAYERS unit wholly within 12\" of the bearer is affected by a spell or the abilities of an endless spell, you can roll a dice. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mastery Over Monsters': {\r\n    effects: [\r\n      {\r\n        name: `Mastery Over Monsters`,\r\n        desc: `While the bearer is contesting an objective, each enemy MONSTER contesting that objective counts as 2 models regardless of any other abilities that would allow that enemy MONSTER to count as more models (such as Mightier Makes Rightier).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { FYRESLAYERS } from 'meta/factions'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_TURN,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [FYRESLAYERS]: {\r\n    effects: [\r\n      {\r\n        name: `Ur-Gold Rune - Rune of Fury - Once Per Battle`,\r\n        desc: `Effect: You can only use this ability if you have not used any Ur-gold Rune abilities this battle round. For the rest of the battle round, friendly Fyreslayers units have Strike-first while they are in combat with an enemy unit that charged in the same turn.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n      {\r\n        name: `Ur-Gold Rune - Rune of Farsight - Once Per Battle`,\r\n        desc: `Declare: You can only use this ability if you have not used any Ur-gold Rune abilities this battle round. Pick any number of enemy units within 10\" of any visible friendly Fyreslayers units to be targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Ur-Gold Rune - Rune of Fiery Determination - Once Per Battle`,\r\n        desc: `Effect: You can only use this ability if you have not used any Ur-gold Rune abilities this battle round. Friendly Fyreslayers units have Ward (5+) for the rest of the battle round.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ur-Gold Rune - Rune of Relentless Zeal - Once Per Battle`,\r\n        desc: `Effect: You can only use this ability if you have not used any Ur-gold Rune abilities this battle round. For the rest of the battle round, friendly Fyreslayers units can use Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Ur-Gold Rune - Rune of Searing Heat - Once Per Battle`,\r\n        desc: `Effect: You can only use this ability if you have not used any Ur-gold Rune abilities this battle round. Melee weapons used by friendly Fyreslayers units have Crit (Mortal) for the rest of the battle round.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Magmic Battleforge (Faction Terrain) - Spending the Forge - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Fyreslayers Priest within this terrain features combat range to expend the power of the forge. \r\n        Effect: Heal (D3) each friendly Fyreslayers unit on the battlefield. Once this ability has been used, this terrain feature cannot use the Molten Blessing abiity for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magmic Battleforge (Faction Terrian) - Molten Blessing`,\r\n        desc: `Declare: Pick a friendly Fyreslayers Priest within this terrain features combat range to be the target. \r\n        Effect: Add 1 to chanting rolls for the target for the rest of the turn. In addition, the target can use the Unbind ability this turn as if it had Wizard (1).`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Lofnir Drothkeepers': {\r\n    effects: [\r\n     /* {\r\n        name: `Daring Tamers`,\r\n        desc: `The strike-last effect applies to enemy MONSTER units while they are within 3\" of 2 or more friendly VULKYN FLAMESEEKERS units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Honourbound Drothmasters`,\r\n        desc: `Friendly VULKYN FLAMESEEKERS units have the Battleline battlefield role. In addition, for each VULKYN FLAMESEEKERS unit included in your army, you can include 1 Auric Runeson on Magmadroth as a Battleline unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Flame-filled Beasts`,\r\n        desc: `You can pick up to 3 LOFNIR DROTHKEEPERS units in your army to have different mount traits instead of 1.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Skilled Drothwranglers`,\r\n        desc: `Once per turn, in your movement phase, you can pick 1 friendly VULKYN FLAMESEEKERS unit wholly within 6\" of a friendly MAGMADROTH that has not yet moved in that phase and say that it will hitch a lift on that MAGMADROTH. If you do so, after you have moved that MAGMADROTH, instead of making a move with that unit, remove it from the battlefield and set it up again on the battlefield wholly within 6\" of that MAGMADROTH and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Protective Family`,\r\n        desc: `While a friendly VULKYN FLAMESEEKERS Kyndledroth is within 1\" of a friendly MAGMADROTH, that VULKYN FLAMESEEKERS unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      }, */\r\n    ], \r\n  }, \r\n\r\n 'Ur-Gold Runes': {\r\n    effects: [\r\n    /*  {\r\n        name: `Ur-Gold Runes`,\r\n        desc: `At the start of your hero phase, you can activate of the following 6 types of ur-gold rune. To do so, state which rune will be activated and make an activation roll by rolling a dice. On a 1-5, the standard effect applies. On a 6, the enhanced effect also applies. The effects last until the start of your next hero phase.\r\n          \r\n        Each ur-gold rune can only be activated once per battle, and no more than 1 rune can be activated at the same time. Once you have used a rune, you can choose a new one to activate in your next hero phase, but you cannot activate the same one again.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Fury`,\r\n        desc: `Standard effect: Add 1 to hit rolls for attacks made with melee weapons by friendly FYRESLAYERS units.\r\n\r\n        Enhanced effect: Add 1 to the Attacks characteristic of melee weapons used by friendly FYRESLAYERS units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Searing Heat`,\r\n        desc: `Standard effect: If the unmodified wound roll for attack made by a friendly FYRESLAYERS unit is 6, that attack causes 1 mortal wound to the target in addition to any damage it inflicts.\r\n\r\n        Enhanced effect: When this rune is activated, roll a dice for each enemy unit within of any friendly FYRESLAYERS units. On a 2+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Awakened Steel`,\r\n        desc: `Standard effect: Improve the Rend characteristic of melee weapons used by friendly FYRESLAYERS units by 1.\r\n\r\n        Enhanced effect: Improve the Rend characteristic of melee weapons used by friendly FYRESLAYERS units by a further 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Fiery Determination`,\r\n        desc: `Standard effect: Friendly FYRESLAYERS units have a ward of 6+.\r\n\r\n        Enhanced effect: Friendly FYRESLAYERS HEROES have a ward of 5+.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Relentless Zeal`,\r\n        desc: `Standard effect: Add 2\" to the Move characteristic of friendly FYRESLAYERS units.\r\n\r\n        Enhanced effect: Add 2 to charge rolls for friendly FYRESLAYERS units.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Rune of Farsight`,\r\n        desc: `Standard effect: Add 1 to hit rolls for attacks made with Fyresteel Throwing Axes by friendly FYRESLAYERS units.\r\n          \r\n        Enhanced effect: Add 1 to wound rolls for attacks made with Fyresteel Throwing Axes by friendly FYRESLAYERS units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },*/\r\n    ],\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n  /*'Circle the Magmadroths': {\r\n    effects: [\r\n      {\r\n        name: `Circle the Magmadroths`,\r\n        desc: `You complete this tactic if, at the end of this turn, any friendly LOFNIR DROTHKEEPERS units are within 6\" of the centre of the battlefield and there are 1 or more friendly LOFNIR DROTHKEEPERS units wholly within each large quarter of the battlefield.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sulphur Seam': {\r\n    effects: [\r\n      {\r\n        name: `Sulphur Seam`,\r\n        desc: `Pick 1 objective that is partially or wholly within enemy territory and 1 terrain feature or faction terrain feature that is partially or wholly within enemy territory and more than 6\" from that objective. You complete this tactic if you control both that objective and that terrain feature at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Igneous Wranglers': {\r\n    effects: [\r\n      {\r\n        name: `Igneous Wranglers`,\r\n        desc: `Pick 1 objective partially or wholly in enemy territory and 1 other objective anywhere on the battlefield. You complete this tactic if you control both objectives at the end of this turn and both are contested by friendly VULKYN FLAMESEEKERS units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Settle a Grudge': {\r\n    effects: [\r\n      {\r\n        name: `Settle a Grudge`,\r\n        desc: `Each time a friendly unit is destroyed by wounds caused by an attack, make a note of the enemy unit that made that attack (in a 'Book of Grudges', if you wish). When you pick this battle tactic, pick 1 of those enemy units that is still on the battlefield. You complete this tactic if that unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Beastslayer: {\r\n    effects: [\r\n      {\r\n        name: `Beastslayer`,\r\n        desc: `Pick 1 enemy MONSTER and 1 friendly HERO. You complete this tactic if that MONSTER is slain by wounds caused by attacks made by that HERO during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grimnir Knows No Mercy': {\r\n    effects: [\r\n      {\r\n        name: `Grimnir Knows No Mercy`,\r\n        desc: `You complete this tactic at the end of this turn if there are any friendly VULKITE BERZERKERS units on the battlefield and all of them are within 3\" of any enemy units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'An Honourable Death': {\r\n    effects: [\r\n      {\r\n        name: `An Honourable Death`,\r\n        desc: `Pick 1 friendly HERO. You complete this tactic if that friendly HERO is slain during this turn and any enemy models were also slain by wounds caused by attacks made by that HERO during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Seize by Force': {\r\n    effects: [\r\n      {\r\n        name: `Seize by Force`,\r\n        desc: `You can pick this tactic only if you control fewer objectives than your opponent. You complete this tactic if you control more objectives than your opponent at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'An Ignominious Death': {\r\n    effects: [\r\n      {\r\n        name: `An Ignominious Death`,\r\n        desc: `Pick 1 enemy HERO. You complete this tactic if that enemy HERO is slain by wounds caused by an attack made with a Fyresteel Throwing Axe during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* 'Fierce Counter-Attack': {\r\n    effects: [\r\n      {\r\n        name: `Fierce Counter-Attack`,\r\n        desc: `You can use this command ability at the start of the enemy combat phase. The unit that receives the command must be an Auric Hearthguard, Hearthguard Berzerkers or Vulkite Berzerkers unit that is within 3\" of an enemy unit that made a charge move in the same turn and not within 3\" of any enemy units that have not made a charge move in the same turn. The strike-first effect applies to that unit until the end of that phase. A unit cannot receive this command more than once per battle.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },*/\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Blood of the Berzerker': {\r\n    effects: [\r\n      {\r\n        name: `Blood of the Berzerker - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Fyreslayers units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ash-Beard': {\r\n    effects: [\r\n      {\r\n        name: `Ash-Beard - Passive`,\r\n        desc: `Efect: If this unit is not a Priest, they have Priest (1). If this unit was already a Priest, add 1 to this units chanting rolls.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fiercely Competitive': {\r\n    effects: [\r\n      {\r\n        name: `Fiercely Competitive - Passive`,\r\n        desc: `Effect: If this unit is in combat with an enemy unit that has Strike-first, this unit has Strike-first. If this unit is in combat with an enemy unit that uses the All-out Attack command, add 1 to hit rolls for this units attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Blood of the Berzerker': {\r\n    effects: [\r\n      {\r\n        name: `Blood of the Berzerker`,\r\n        desc: `Once per battle, in the combat phase, after this general has fought for the first time in that phase, you can say that they will go berserk. If you do so, this general can fight for a second time in that phase. The strike-last effect applies to this general when they fight for that second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ash-beard': {\r\n    effects: [\r\n      {\r\n        name: `Ash-beard`,\r\n        desc: `This general knows 2 prayers from the Zharrgrim Blessings prayer scripture (pg 60) instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master Priest': {\r\n    effects: [\r\n      {\r\n        name: `Master Priest`,\r\n        desc: `Once per battle, at the start of your hero phase, if this general is on the battlefield, you can activate 1 ur-gold rune that has already been activated using the Ur-gold Runes battle trait (pg 57) instead of 1 that has not yet been activated.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Avatar of Vulcatrix': {\r\n    effects: [\r\n      {\r\n        name: `Avatar of Vulcatrix`,\r\n        desc: `If this general is slain and there is not a Molten Infernoth invocation under your command on the battlefield, before removing this general from play, you can set up 1 Molten Infernoth within 6\" of this general. If you do not have a Molten Infernoth in your army, this new Molten Infernoth is added to your army. After the invocation has been set up, remove this general from play and then apply the effects of the Molten Infernoth's Burning Tide ability.\r\n\r\n        If this general is slain and there is a Molten Infernoth invocation under your command on the battlefield, remove this general from play and then apply the effects of the Molten Infernoth's Burning Tide ability as if the invocation has just been set up.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Raised Around Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Raised Around Beasts`,\r\n        desc: `Improve the Rend characteristic of melee weapons used by friendly LOFNIR DROTHKEEPERS units that do not have the MAGMADROTH keyword and are wholly within 9\" of this general by 2 if the target is a MONSTER.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME, HERO_PHASE, START_OF_HERO_PHASE, START_OF_SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst EndlessSpells = {\r\n  'Molten Infernoth': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 4 and a range of 12\". If answered, set up the invocation wholly within range and visible to the chanter, and more than 1\" from all models, terrain features, other invocations and endless spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Tide`,\r\n        desc: `After this invocation is set up, the commanding player can immediately move it up to 2D6\". In addition, at the start of each of their subsequent hero phases, if this invocation is still on the battlefield, the commanding player can move it up to 2D6\".`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Erupting Inferno`,\r\n        desc: `After this invocation has moved, the commanding player rolls 12 dice for each unit within 3\" of it. For each 6, that unit suffers 1 mortal wound. If the roll to determine how far this invocation moved in this phase was a double, that unit suffers D3 mortal wounds for each 6 instead of 1 and at the end of the phase, this invocation is removed from play. FYRESLAYERS units are not affected by this ability.`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Runic Fyrewall': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 3 and a range of 18\". If answered, set up the invocation wholly within range and visible to the chanter, and more than 1\" from all models, terrain features, other invocations and endless spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Roaring Rune-fire`,\r\n        desc: `Models cannot move across or through this invocation unless they have the MAGMADROTH keyword or can fly.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Awakened Runes`,\r\n        desc: `At the start of each phase, the commanding player can pick 1 friendly FYRESLAYERS unit wholly within 12\" of this invocation to draw upon its power. If they do so, the commanding player rolls a dice. On a 1-5, that unit has a ward of 6+ until the end of the phase. On a 6, that unit has a ward of 4+ until the end of the phase and this invocation is removed from play at the end of the phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Zharrgron Flame-spitter': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 3 and a range of 6\". If answered, set up the invocation wholly within range and visible to the chanter, and more than 1\" from all models, terrain features, other invocations and endless spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magma Blast`,\r\n        desc: `At the start of the commanding player's shooting phase, if there are any friendly FYRESLAYERS PRIESTS within 6\" of this invocation, the commanding player can pick 1 enemy unit within 24\" of this invocation and roll 12 dice. Add 1 to the roll if that unit has 10 or more models. Add 2 to the roll instead if that unit has 20 or more models. For each 6+, that unit suffers 1 mortal wound. If the commanding player rolls 4 or more unmodified 6s, after the mortal wounds have been allocated to that unit, this invocation is removed from play.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, DURING_GAME, END_OF_TURN, START_OF_SETUP, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  /*Vostarg: {\r\n    effects: [\r\n      {\r\n        name: `Fearsome Surge`,\r\n        desc: `Add 1 to hit rolls and wound rolls for attacks made with melee weapons by friendly VOSTARG VULKITE BERZERKERS units that made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Greyfyrd: {\r\n    effects: [\r\n      {\r\n        name: `Spoils of Victory`,\r\n        desc: `Add 1 to the Wounds characteristic of friendly GREYFYRD HEROES that do not have a mount.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Spoils of Victory`,\r\n        desc: `You can pick 2 additional artefacts of power (pg 59) and give them to 2 GREYFYRD HEROES in your army that do not have a mount.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  Hermdar: {\r\n    effects: [\r\n      {\r\n        name: `Seize by Force`,\r\n        desc: `If a friendly HERMDAR unit wholly within enemy territory or wholly within 12\" of an objective fails a battleshock test, halve the number of models that flee (rounding up).`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Lofnir: {\r\n    effects: [\r\n      {\r\n        name: `Venerators of Vulcatrix`,\r\n        desc: `Add 2 to the Wounds characteristic of friendly LOFNIR MAGMADROTH units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Venerators of Vulcatrix`,\r\n        desc: `Up to 3 LOFNIR MAGMADROTH units in your army can be given a different mount trait (pg 60) instead of only 1.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n  'Warrior Kinbad': {\r\n    effects: [\r\n      {\r\n        name: `Berserk Kindred - Passive`,\r\n        desc: `Effect: Add 1 to wound rolls for combat attacks made by friendly Fyreslayers Infantry units that charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Forge Brethren': {\r\n    effects: [\r\n      {\r\n        name: `Bulwark of Moletenstone - Passive`,\r\n        desc: `Effect: Add 1 to save rolls for friendly Infantry units while they are wholly within friendly territory.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Scales of Vulcatrix': {\r\n    effects: [\r\n      {\r\n        name: `Ancient Bloodlines - Passive`,\r\n        desc: `Effect: Add 2 to the Health characteristic of friendly Magmadroth units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Lords of the Lodge': {\r\n    effects: [\r\n      {\r\n        name: `Martial Pride and Stubborn Will - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of friendly Fyreslayers Heroes. In addition, the control scores of Fyreslayers Heroes cannot be modied by enemy abilities.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Guarded Lineage': {\r\n    effects: [\r\n      {\r\n        name: `Guarded Lineage`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is 1 friendly AURIC RUNEFATHER and 1 or more friendly AURIC RUNESONS on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Defend the Lodge': {\r\n    effects: [\r\n      {\r\n        name: `Defend the Lodge`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no enemy units wholly within your territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Oath-takers and Skull-breakers': {\r\n    effects: [\r\n      {\r\n        name: `Oath-takers and Skull-breakers`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed this battle was from the 'Oaths of Battle' list on page 75.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Masters of the Forge': {\r\n    effects: [\r\n      {\r\n        name: `Masters of the Forge`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any invocations under your command on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Clear the Corral': {\r\n    effects: [\r\n      {\r\n        name: `Clear the Corral`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no enemy MONSTERS in your territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Prayers = {\r\n  'Zharrgrim Blessings': {\r\n    effects: [\r\n      {\r\n        name: `Prayer of Ash: Chant value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Fyreslayers Priest to chant this prayer, pick a visible friendly Fyreslayers unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract 1 from wound rolls for attacks that target that friendly unit until the start of your next turn. If the chanting roll was 8+, also subtract 1 from the Rend characteristic of attacks that target that friendly unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Prayer of Grimnir's Fury: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Fyreslayers Priest to chant this prayer, pick a visible friendly Fyreslayers Infantry Hero wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: The target can use 2 Fight abilities this turn. After the first is used, however, the target has Strike-last for the rest of the turn. If the chanting roll was 8+, also add 1 to wound rolls for the targets combat attacks for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wrath of Vulcatrix: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Fyreslayers Priest to chant this prayer, pick a visible friendly Magmadroth unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: For the rest of the turn, the Battle Damaged ability has no effect on the target and add 1 to the Attacks characteristic of the targets Companion weapons. If the chanting roll was 8+, add 1 to the Attacks characteristic of the targets Companion weapons for every 4 damage points the target has.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Ember Storm': {\r\n    effects: [\r\n      {\r\n        name: `Ember Storm`,\r\n        desc: `Answer value of 3 and a range of 18\". If answered, pick 1 friendly HEARTHGUARD BERZERKERS or VULKITE BERZERKERS unit wholly within range and visible to the chanter. That unit can run and still charge later in this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Prayer of Grimnir's Fury\": {\r\n    effects: [\r\n      {\r\n        name: `Prayer of Grimnir's Fury`,\r\n        desc: `Answer value of 3 and a range of 12\". If answered, pick 1 friendly FYRESLAYERS HERO that does not have a mount that is within range, within 3\" of an enemy unit and visible to the chanter. That HERO can fight.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath of Vulcatrix': {\r\n    effects: [\r\n      {\r\n        name: `Wrath of Vulcatrix`,\r\n        desc: `Answer value of 3 and a range of 12\". If answered, pick 1 friendly MAGMADROTH unit within range and visible to the chanter. Until the start of your next hero phase, use the top row on that unit's damage table, regardless of how many wounds it has suffered.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Unit prayers\r\n  \"Volcano's Call\": {\r\n    effects: [\r\n      {\r\n        name: `Volcano's Call`,\r\n        desc: `Answer value of 3 and a range of 18\". As the chanter is carrying a Runic Iron, you can reroll the chanting roll. If answered, pick 1 terrain feature wholly within range and visible to the chanter. Roll a dice for each model within 1\" of that terrain feature. For each 6, that model's unit suffers 1 mortal wound. In addition, until your next hero phase, that terrain feature blocks visibility in the same manner as a wyldwood.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Runic Empowerment': {\r\n    effects: [\r\n      {\r\n        name: `Runic Empowerment`,\r\n        desc: `Answer value of 3 and a range of 12\" if the chanter is carrying a Runic Iron or 18\" if the chanter is carrying a Forge Key. If the chanter is carrying a Runic Iron, you can reroll the chanting roll. If answered, pick 1 friendly Fyreslayers unit wholly within range and visible to the chanter. Add 1 to wound rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SHOOTING_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport Prayers from './prayers'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst MagmadrothEffects = [\r\n /* {\r\n    name: `Roaring Fyrestream`,\r\n    desc: `The Attacks characteristic of a Roaring Fyrestream is equal to the number of models in the target unit (to a maximum Attacks characteristic of 10).`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Roaring Fyrestream`,\r\n    desc: `At the end of your shooting phase, if this unit did not make an attack with its Roaring Fyrestream in that phase, you can say that an inferno is raging inside this unit. If an inferno is raging inside this unit, improve the Rend characteristic of its Roaring Fyrestream by 2. After the next attack made with this unit's Roaring Fyrestream has been resolved, an inferno is no longer raging inside this unit.`,\r\n    when: [END_OF_SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Lashing Tail`,\r\n    desc: `At the end of the combat phase, roll a dice for each enemy unit within 3\" of this unit. If the roll is equal to or less than the number of models in that enemy unit, that unit suffers D3 mortal wounds.`,\r\n    when: [END_OF_COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Volcanic Blood`,\r\n    desc: `Roll a dice each time a wound caused by an attack made with a melee weapon is allocated to this unit. On a 4+, the attacking unit suffers 1 mortal wound.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  }, */\r\n]\r\nconst WhirlwindOfDestructionEffect = {\r\n/*  name: `Whirlwind of Destruction`,\r\n  desc: `Add 1 to the Attacks characteristic of this unit's melee weapons if this unit made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n} \r\nconst BerserkFuryEffect = {\r\n /* name: `Berserk Fury`,\r\n  desc: `Once per battle, at the start of the combat phase, you can say that this unit will unleash its berserk fury. If you do so, until the end of that phase, if a model in this unit is slain, that model can fight before it is removed from play.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst LordOfTheLodgeEffect = {\r\n /* name: `Lord of the Lodge`,\r\n  desc: `Once per battle, at the start of your combat phase, you can pick 1 friendly unit on the battlefield with this ability to unleash the wrath of Grimnir. If you do so, until the end of that phase, add 1 to the Attacks characteristic of melee weapons used by friendly FYRESLAYERS units while they are wholly within 12\" of that unit.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst AuricRetinueEffect = {\r\n /* name: `Retinue`,\r\n  desc: `At the start of the first battle round, before determining who has the first turn, you can pick 1 friendly AURIC HEARTHGUARD or HEARTHGUARD BERZERKERS unit on the battlefield that is not another unit's retinue to be this unit's retinue.`,\r\n  when: [TURN_ONE_START_OF_ROUND],\r\n  shared: true, */\r\n}\r\nconst RoyalRetinueEffect = {\r\n /* name: `Royal Retinue`,\r\n  desc: `Before you allocate a wound or mortal wound to this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to this unit, if this unit is within 3\" of its retinue, you can roll a dice. On a 1-2, that wound or mortal wound is allocated to this unit as normal. On a 3+, that wound or mortal wound is allocated to this unit's retinue instead. If the retinue has a ward, you can make a ward roll before allocating that wound or mortal wound to it.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true, */\r\n}\r\nconst DauntlessAssaultEffect = {\r\n /* name: `Dauntless Assault`,\r\n  desc: `After this unit has fought in the combat phase for the first time, if its retinue has not yet fought in that combat phase, is within 3\" of an enemy unit and is wholly within 12\" of this unit, this unit's retinue can fight immediately.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst VyingForGloryEffect = {\r\n /* name: `Vying for Glory`,\r\n  desc: `If the unmodified hit roll for an attack made by this unit that targets a MONSTER is 6, that attack causes a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\nconst ChampionEffect = {\r\n /* name: `Champion`,\r\n  desc: `1 model in this unit can be a Karl. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst VulkiteBezerkersBaseEffects = [\r\n /* ChampionEffect,\r\n  {\r\n    name: `Musician`,\r\n    desc: `1 in every 5 models in this unit can be a Hornblower of Grimnir. Add 1 to charge rolls for this unit if it includes any Hornblowers of Grimnir.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true, \r\n  }, */\r\n  BerserkFuryEffect,\r\n]\r\n\r\nconst Units = {\r\n  'Auric Runefather': {\r\n    effects: [\r\n      // AuricRetinueEffect, RoyalRetinueEffect, DauntlessAssaultEffect, LordOfTheLodgeEffect\r\n      {\r\n        name: `Royal Retinue - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero Fyreslayers Infantry unit within this units combat range to be the royal retinue. \r\n        Effect: For the rest of the battle, while the royal retinue is wholly within 6\" of this unit, add 1 to hit rolls for attacks made by the royal retinue and this unit has Ward (4+).`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Commanding Presence`,\r\n        desc: `Effect: Add the current battle round number to the control scores of friendly Fyreslayers Infantry units wholly within 12\" of this unit for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Auric Runefather on Magmadroth': {\r\n    effects: [\r\n      //...MagmadrothEffects, LordOfTheLodgeEffect\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Magmadroths Claws and Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Raging Inferno - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from save rolls for the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Warrior-Kings - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Fyreslayers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Volcanic Blood - Passive`,\r\n        desc: `Effect: If you make an unmodified save roll of 1 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'Auric Runeson': {\r\n    effects: [\r\n      //AuricRetinueEffect, RoyalRetinueEffect, DauntlessAssaultEffect, VyingForGloryEffect\r\n      {\r\n        name: `Dauntless Assault - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Fyreslayers Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fearless Charge - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to charge rolls for friendly Fyreslayers Infantry units while they are wholly within 18\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      }, \r\n    ],\r\n  },\r\n  'Auric Runeson on Magmadroth': {\r\n    effects: [\r\n      //...MagmadrothEffects, VyingForGloryEffect\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Magmadroths Claws and Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vying for Glory - Passive`,\r\n        desc: `Effect: Each time this unit destroys a Monster, add 1 to the Attacks characteristic of this units Ancestral Weapons for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Dominating Roar - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: If this unit has fewer damage points than the target, subtract 10 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Volcanic Blood - Passive`,\r\n        desc: `Effect: If you make an unmodified save roll of 1 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      }, \r\n    ],\r\n  },\r\n  'Auric Runesmiter': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Runic Empowerment'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Magmic Tunneling`,\r\n        desc: `Declare: Pick this unit and up to 1 unit in its regiment if neither unit has been deployed. \r\n        Effect: Set up those units in reserve underground. They have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Emergence`,\r\n        desc: `Declare: Pick this unit if it is underground. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the other unit that was set up underground with it (if any) wholly within 6\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Auric Runesmiter on Magmadroth': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Runic Empowerment'])],\r\n    }, */\r\n    effects: [\r\n      //...MagmadrothEffects\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Magmadroths Claws and Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Runic Empowerment`,\r\n        desc: `Declare: Pick a friendly Fyreslayers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lashing Tail - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 2D6. If the roll is equal to or less than the number of models in the target unit, inflict D3+3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Volcanic Blood - Passive`,\r\n        desc: `Effect: If you make an unmodified save roll of 1 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      }, \r\n    ],\r\n  }, \r\n  'Auric Flamekeeper': {\r\n    effects: [\r\n      {\r\n        name: `Masterflame Rune - Once Per Turn`,\r\n        desc: `Declare: If any friendly units have been destroyed during the battle, pick a friendly Fyreslayers Infantry unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll is equal to or less than the number of Fyreslayers units that have been destroyed during the battle, pick 1 of the following effects to apply until the start of your next turn: \r\n        Grimnirs Grit: The target has Ward (5+). \r\n        Grimnirs Resolve: Add 2 to charge rolls for the target. \r\n        Grimnirs Vengeance: Add 1 to the Damage characteristic of the targets melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Fjul-Grimnir': {\r\n    effects: [\r\n      {\r\n        name: `Retinue`,\r\n        desc: `This unit's retinue is the The Chosen Axes unit in your army.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      DauntlessAssaultEffect,\r\n      RoyalRetinueEffect, \r\n    ], \r\n  }, */\r\n /* 'The Chosen Axes': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Tefk Flamebearer is the unit champion. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      BerserkFuryEffect,\r\n      WhirlwindOfDestructionEffect, \r\n    ], \r\n  }, */\r\n  Battlesmith: {\r\n    effects: [\r\n      {\r\n        name: `Icon of Grimnir - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to the control scores of friendly Fyreslayers units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bard of the Lodge - Passive`,\r\n        desc: `Effect: If a friendly unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Auric Runemaster': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, [\"Volcano's Call\"])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `High Priest of the Zharrgrim - Passive`,\r\n        desc: `Effect: Each time a Prayer chanted by this unit is answered, this unit gains a magmic power token.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Reaction: You declared an Ur-Gold Rune ability`,\r\n        desc: `Effect: Remove 3 of this units magmic power tokens. If you do so, apply the effect below that corresponds to the Ur-gold Rune ability that was used:`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Rune of Fury`,\r\n        desc: `Rune of Fury: For the rest of the battle round, add 1 to wound rolls for combat attacks made by friendly Fyreslayers units while they have Strike-first.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Rune of Fiery Determination`,\r\n        desc: `Rune of Fiery Determination: Add 1 to save rolls for friendly Fyreslayers units for the rest of the battle round.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Rune of Relentless Zeal`,\r\n        desc: `Rune of Relentless Zeal: Add 1 to run rolls and charge rolls for friendly Fyreslayers units for the rest of the battle round.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Rune of Searing Heat`,\r\n        desc: `Rune of Searing Heat: Add 1 to the Rend characteristic of melee weapons used by friendly Fyreslayers units for the rest of the battle round.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Runes - Rune of Farsight`,\r\n        desc: `Rune of Farsight: Increase the range of the Rune of Farsight ability to 16\".`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grimwrath Berzerker': {\r\n    effects: [\r\n      {\r\n        name: `Battle-fury - Once Per Battle`,\r\n        desc: `Effect: If this unit is in combat, it can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimwrath Oaths`,\r\n        desc: `Effect: Pick 1 of the following oaths for this unit to swear: \r\n        I will guard them with my life!: While this unit is wholly within 6\" of another friendly Fyreslayers Hero:  Add 1 to hit rolls for this units attacks.  Add 1 to ward rolls for this unit. If a friendly Fyreslayers Hero wholly within 6\" of this unit is destroyed, this effect no longer applies. \r\n        I will not be stopped!: Add 1 to charge rolls for this unit, and add 1 to save rolls for this unit while it is in combat. If this unit uses the Retreat or Rally abilities, this effect no longer applies.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  Doomseeker: {\r\n    effects: [\r\n      {\r\n        name: `Oathbound`,\r\n        desc: `Declare: Pick an enemy unit to be this units quarry. You can pick a unit that has been deployed in reserve. \r\n        Effect: Add 1 to hit rolls and wound rolls for attacks made by this unit that target its quarry. If this unit is destroyed while it is in combat with its quarry, inflict 3 mortal damage on this units quarry immediately after the ability that destroyed this unit has been resolved.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Runic Power - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons while this unit has 1 damage point. Add 2 to the Damage characteristic of this units melee weapons instead while this unit has 2 or more damage points.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vulkite Berzerkers with Bladed Slingshields': {\r\n    effects: [\r\n     // ...VulkiteBezerkersBaseEffects,\r\n      {\r\n        name: `Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vulkite Berzerkers with Fyresteel Handaxes': {\r\n    effects: [\r\n      //...VulkiteBezerkersBaseEffects, WhirlwindOfDestructionEffect\r\n      {\r\n        name: `Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Auric Hearthguard': {\r\n    effects: [\r\n      {\r\n        name: `Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hearthguard Berzerkers with Flamestrike Poleaxes': {\r\n    effects: [\r\n     // ChampionEffect,\r\n      {\r\n        name: `Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n'Hearthguard Berzerkers with Bezerker Broadaxes': {\r\n  effects: [\r\n   // ChampionEffect,\r\n    {\r\n      name: `Duty Unto Death - Passive`,\r\n      desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n      when: [DURING_GAME],\r\n    },\r\n    {\r\n      name: `Fires of Vengeance - Passive`,\r\n      desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n  ],\r\n},\r\n  'Vulkyn Flameseekers': {\r\n    effects: [\r\n      {\r\n        name: `Drothmaster`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract D3 from the Damage characteristic of the targets Companion melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grimhold Exile': {\r\n    effects: [\r\n      {\r\n        name: `Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n      {\r\n        name: `Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_1],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport { FYRESLAYERS } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport MountTraits from './mount_traits'\r\nimport Prayers from './prayers'\r\nimport Scenery from './scenery'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/* const baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    mount_traits: [MountTraits],\r\n    prayers: [Prayers],\r\n    scenery: [Scenery],\r\n    units: [Units],\r\n  },\r\n /* mandatory: {\r\n    command_abilities: [keyPicker(CommandAbilities, ['Fierce Counter-Attack'])],\r\n  }, \r\n} satisfies IItemDescription */\r\n\r\nconst subFactions = {\r\n  [FYRESLAYERS]: {\r\n    //  ...baseSubfaction,\r\n      effects: pickEffects(BattleTraits, [FYRESLAYERS]),\r\n  \r\n      available: {\r\n        artifacts: [Artifacts],\r\n       // battalions: [Battalions],\r\n        battle_tactics: [BattleTactics],\r\n        command_abilities: [CommandAbilities],\r\n        command_traits: [CommandTraits],\r\n        endless_spells: [EndlessSpells],\r\n        flavors: [Flavors],\r\n        grand_strategies: [GrandStrategies],\r\n        prayers: [Prayers],\r\n        //spells: [Spells],\r\n        units: [Units],\r\n      },\r\n    }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { FYRESLAYERS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const FyreslayersFaction = new Faction(\r\n  FYRESLAYERS,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_FYRESLAYERS\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_GLOOMSPITE_GITZ: {\r\n    name: 'Battletome: Gloomspite Gitz (2023)',\r\n    type: 'battletome',\r\n  },\r\n  GROTMAS_GITZ: {\r\n    name: 'Games Workshop: Grotsmas Gitz',\r\n    type: 'other_book',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/11/sRwk1m7XKIa5fjyQ.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  \"Backstabber's Blade\": {\r\n    effects: [\r\n      {\r\n        name: `Backstabber's Blade - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'The Clammy Cowl': {\r\n    effects: [\r\n      {\r\n        name: `The Clammy Cowl - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`, // updated for 2023\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Leering Gitshield': {\r\n    effects: [\r\n      {\r\n        name: `Leering Gitshield - Passive`,\r\n        desc: `Efect: Each time an unmodified hit roll for an attack that targets this unit is 1, inflict 1 mortal damage on the attacking unit after the Attack ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Loonstone Teefcaps': {\r\n    effects: [\r\n      {\r\n        name: `Loonstone Teefcaps`,\r\n        desc: `SQUIG HERO with mount or companion only. Improve the Rend characteristic of the bearer's Fang-filled Gob, Massive Fang-filled Gob or Huge Fang-filled Gobs by 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Moonface Mommet': {\r\n    effects: [\r\n      {\r\n        name: `Moonface Mommet`,\r\n        desc: `WIZARD only. At the start of the combat phase, pick 1 enemy unit within 12\" of the bearer. Subtract 1 from save rolls for attacks that target that unit until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Moonface Mommet`,\r\n        desc: `If active, subtract 1 from save rolls for attacks that target that unit until the end of the phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Staff of Sneaky Stealin': {\r\n    effects: [\r\n      {\r\n        name: `Staff of Sneaky Stealin'`,\r\n        desc: `WIZARD only. Add 1 to casting rolls for the bearer. Each time the bearer unbinds a spell, add 1 to casting rolls for the bearer for the rest of the battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Totem of the Spider God': {\r\n    effects: [\r\n      {\r\n        name: `Totem of the Spider God`,\r\n        desc: `While other friendly SPIDERFANG units are wholly within 12\" of the bearer, add 1 to the number of mortal wounds caused by the Spider Venom ability of those units if the unmodified hit roll was 6.\r\n\r\n        Designer's Note: If a unit is affected by the Light of the Bad Moon, this artefact of power does not affect unmodified hit rolls of 5; it only affects unmodified hit rolls of 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Headdress of Many Eyes': {\r\n    effects: [\r\n      {\r\n        name: `Headdress of Many Eyes`,\r\n        desc: `SCUTTLEBOSS only. Only unmodified hit rolls of 5 or 6 successfully score a hit for attacks that target the bearer.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Nibbla's 'Itty Ring\": {\r\n    effects: [\r\n      {\r\n        name: `Nibbla's 'Itty Ring`,\r\n        desc: `WIZARD only. Once per battle, at the start of your hero phase, you can say the bearer will call upon the ring's power. If you do so, roll a dice and add the result to casting rolls made by the bearer until the end of the phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Glowy Howzit': {\r\n    effects: [\r\n      {\r\n        name: `Glowy Howzit`,\r\n        desc: `The bearer has a ward of 4+. At the end of each phase, if the bearer was allocated any wounds in that phase that were not negated, roll a dice. On a 1, the bearer eats the Glowy Howzit and it cannot be used again for the rest of the battle.`,\r\n        when: [WARDS_PHASE, DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Speaky-skull Fetish': {\r\n    effects: [\r\n      {\r\n        name: `Speaky-skull Fetish`,\r\n        desc: `At the start of your hero phase roll 3 dice. For each 6, you receive 1 extra command point. In addition, the bearer can issue the same command up to 2 times in the same phase (a command point is spent each time a command is issued by the bearer as normal).`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pet Gribbly': {\r\n    effects: [\r\n      {\r\n        name: `Pet Gribbly`,\r\n        desc: `Add 1 to the bearer's Wounds characteristic. In addition, each time a wound is allocated to the bearer and not negated, roll a dice. On a 1, the Pet Gribbly is squished. When the Pet Gribbly is squished, the bearer becomes enraged for the rest of the battle. Add 1 to hit rolls and wound rolls for attacks made by the bearer while they are enraged.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Trugg's Troggherd\r\n  'Thwackwheezer Club': {\r\n    effects: [\r\n      {\r\n        name: `Thwackwheezer Club`,\r\n        desc: `Subtract 1 from hit rolls and wound rolls for attacks that target the bearer if they have been picked to fight in the same phase.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Crunchy Shinies': {\r\n    effects: [\r\n      {\r\n        name: `Crunchy Shinies`,\r\n        desc: `The bearer has a Move characteristic of D6+5\"`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Loonstone Teef': {\r\n    effects: [\r\n      {\r\n        name: `Loonstone Teef`,\r\n        desc: `The bearer gains the MONSTER keyword. If the bearer already has the MONSTER keyword, you can carry out 2 different monstrous rampages with it in the same phase instead of 1.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { MagnificentBattalionEffect } from 'generic_rules/core_battalions'\r\n\r\nconst Battalions = {\r\n /* 'Troggherd Heavies': {\r\n    effects: [MagnificentBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Follow da Moon': {\r\n    effects: [\r\n      {\r\n        name: `Follow da Moon`,\r\n        desc: `You cannot pick this tactic in the first battle round. You complete this tactic if at the end of this turn every friendly GLOOMSPITE GITZ unit on the battlefield is affected by the Light of the Bad Moon and you control more objectives than your opponent.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glory Grabbers': {\r\n    effects: [\r\n      {\r\n        name: `Glory Grabbers`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if at the end of this turn you control that objective and a friendly GLOOMSPITE GITZ unit that was added to your army as a replacement unit using the Bad Moon Loonshrine's Moonclan Lairs ability is contesting it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Venomous Assault': {\r\n    effects: [\r\n      {\r\n        name: `Venomous Assault`,\r\n        desc: `You complete this tactic if at least 8 mortal wounds were caused by the Spider Venom ability of friendly SPIDERFANG units during this turn and not negated.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Stab 'Em in the Dark\": {\r\n    effects: [\r\n      {\r\n        name: `Stab 'Em in the Dark`,\r\n        desc: `Pick 1 enemy unit on the battlefield. You complete this tactic if that unit was destroyed by an attack made by a friendly GLOOMSPITE GITZ unit during this turn while it was not affected by the Light of the Bad Moon.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Moonlight Raid': {\r\n    effects: [\r\n      {\r\n        name: `Moonlight Raid`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if at the end of this turn you control that objective and every friendly GLOOMSPITE GITZ unit that is contesting it is affected by the Light of the Bad Moon.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"You Ain't So Big\": {\r\n    effects: [\r\n      {\r\n        name: `You Ain't So Big`,\r\n        desc: `Pick 1 enemy MONSTER on the battlefield. You complete this tactic if that MONSTER was slain by an attack made by a friendly GLOOMSPITE GITZ TROGGOTH unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Don't Like Dat One!\": {\r\n    effects: [\r\n      {\r\n        name: `Don't Like Dat One!`,\r\n        desc: `Pick 1 enemy HERO. You complete this battle tactic if that HERO was destroyed during this turn by an attack made by a friendly TRUGG.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Feels Funny': {\r\n    effects: [\r\n      {\r\n        name: `Feels Funny`,\r\n        desc: `You complete this battle tactic if a friendly TRUGG'S TROGGHERD unit destroyed an enemy unit during this turn while it was affected by the Aura of Haywire Magic battle trait (pg 76).`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  \"Wot's Dat Glowy Fing?\": {\r\n    effects: [\r\n      {\r\n        name: `Wot's Dat Glowy Fing?`,\r\n        desc: `Pick 1 objective you do not control. You complete this battle tactic if you control that objective at the end of this turn and 2 or more friendly TRUGG'S TROGGHERD units that are affected by the Light of the Bad Moon are contesting that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GLOOMSPITE_GITZ } from 'meta/factions'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  TURN_ONE_START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n /* 'The Bad Moon': {\r\n    effects: [\r\n      {\r\n        name: `The Bad Moon Setup`,\r\n        desc: `If any of the armies in a battle are Gloomspite Gitz armies, in the first battle round, after players have received their starting command points but before the start of the first turn, the player commanding the Gloomspite Gitz army picks 1 large quarter of the battlefield (core rules 28.2.8) as the Bad Moon's starting location. If more than 1 player in the battle is commanding a Gloomspite Gitz army, then those players roll off and the winner picks which large quarter is the Bad Moon's starting location.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `The Bad Moon Movement`,\r\n        desc: `During the battle, the Bad Moon will move and its location will change. The Bad Moon starts in a large quarter of the battlefield. The first time it moves, it moves to the centre of the battlefield. Then it moves to the large quarter diagonally opposite the large quarter in which it started. Finally, it moves off the battlefield.\r\n\r\n        At the start of the second and each subsequent battle round, before the priority roll, the player commanding the Gloomspite Gitz army rolls a dice. If more than 1 player in the battle is commanding a Gloomspite Gitz army, then those players roll off and the winner rolls the dice. On a 1-3, the Bad Moon does not move and instead stays at its current location. On a 4+, it moves to the next location. When the Bad Moon moves off the battlefield, it has no further effect on the battle.\r\n        \r\n        The location of the Bad Moon determines which GLOOMSPITE GITZ units are affected by the Light of the Bad Moon. While the Bad Moon is located in a large quarter of the battlefield, all GLOOMSPITE GITZ units wholly within the same large quarter are affected. While it is located in the centre of the battlefield, all GLOOMSPITE GITZ units on the battlefield are affected.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  [GLOOMSPITE_GITZ]: {\r\n    effects: [\r\n      {\r\n        name: `Under the Light of the Bad Moon - Passive`,\r\n        desc: `Effect: During the battle, an area of the battlefield will be the Bad Moons location (see The Bad Moons Orbit). The Bad Moons location will be either a quarter of the battlefield or the centre of the battlefield. \r\n        While the Bad Moons location is a quarter of the battlefield, all Gloomspite Gitz units (friendly and enemy) wholly within that quarter are under the light of the Bad Moon. \r\n        While the Bad Moons location is the centre of the battlefield, all Gloomspite Gitz units (friendly and enemy) on the battlefield are under the light of the Bad Moon. \r\n        While a friendly Gloomspite Gitz unit is under the light of the Bad Moon, the appropriate effect below applies to it: \r\n        Frothing Zealots: If the unit is a non-Squig Moonclan unit, add 3 to its control score. \r\n        Lunar Squigs: If the unit is a Squig unit, you can re-roll the random characteristic roll for its Move characteristic. \r\n        Moonlit Hide: If the unit is a Troggoth unit, add 1 to save rolls for it. \r\n        Spiderfang Venom: If the unit is a Spiderfang unit, its combat attacks score critical hits on unmodified hit rolls of 5+. This ability also affects Companion weapons.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Bad Moon's Orbit - Once Per Battle Round`,\r\n        desc: `Declare: You must use this ability at the start of the battle round. If multiple players are commanding a Gloomspite Gitz army, then instead, at the start of the battle round, those players roll off and only the winner declares and uses this ability this battle round. \r\n        Effect: If it is the first battle round, pick a quarter of the battlefield to be the Bad Moons starting location. \r\n        If it is the second or subsequent battle round, roll a dice. On a 1-3, the Bad Moon stays at its current location. On a 4+, the Bad Moon moves. \r\n        The first time the Bad Moon moves, it moves to the centre of the battlefield. The second time it moves, it moves to the quarter diagonally opposite the quarter in which it started. The third time it moves, it moves off the battlefield and has no further effect on the battle.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Bad Moon Loonshrine (Faction Terrain) - Effigy of Da Bad Moon - Passive`,\r\n        desc: `Effect: Friendly Gloomspite Gitz units are under the light of the Bad Moon while they are wholly within 12\" of this terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Command Ability - Bad Moon LoonShrine (Faction Terrain) - Moonclan Lairs - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly non-Hero non-Monster non-War Machine Gloomspite Gitz unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this terrain feature and more than 3\" from all enemy units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n\r\n      // Heroic Actions\r\n    ],\r\n  },\r\n\r\n /* \"Trugg's Troggherd\": {\r\n    effects: [\r\n      {\r\n        name: `Moonlit Hide`,\r\n        desc: `Add 1 to save rolls for attacks that target friendly TRUGG'S TROGGHERD units while they are affected by the Light of the Bad Moon.`,\r\n        when: [SAVES_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n      {\r\n        name: `Aura of Haywire Magic`,\r\n        desc: `At the start of your hero phase, if you use a friendly TRUGG'S Malfunctioning Leystone ability, the effect you pick applies to all other friendly TRUGG'S TROGGHERD units until the start of your next hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n      {\r\n        name: `The King's Wreckerz`,\r\n        desc: `Friendly TRUGG'S TROGGHERD units that do not have the HERO keyword gain the Battleline battlefield role.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  /*\"I'm Da Boss, Now Stab 'Em Good!\": {\r\n    effects: [\r\n      {\r\n        name: `I'm Da Boss, Now Stab 'Em Good!`,\r\n        desc: `When this unit issues the All-out Attack command to a friendly Moonclan unit in the combat phase, until the end of that phase, if the unmodified wound roll for an attack made by that Moonclan unit is 6, the attack causes 1 mortal wound to the target in addition to any damage it inflicts.\r\n\r\n        Designer's Note: This effect is in addition to the normal effect of All-out Attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Fight Another Day': {\r\n    effects: [\r\n      {\r\n        name: `Fight Another Day`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 3+, this unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Clammy Hand': {\r\n    effects: [\r\n      {\r\n        name: `The Clammy Hand - Passive`,\r\n        desc: `Effect: Each time a friendly Gloomspite Gitz unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Loontouched': {\r\n    effects: [\r\n      {\r\n        name: `Loontouched - Passive`,\r\n        desc: `Effect: If this unit is not a Wizard, it has Wizard (1). Otherwise, add 1 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Supa-nasty Venom': {\r\n    effects: [\r\n      {\r\n        name: `Supa-nasty Venom`,\r\n        desc: `SPIDERFANG HERO with mount only. Double the number of mortal wounds that are inflicted by this general's Spider Venom ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Squig Whisperer': {\r\n    effects: [\r\n      {\r\n        name: `Squig Whisperer`,\r\n        desc: `SQUIG HERO with mount only. Add 1 to hit rolls and wound rolls for attacks made by this general's mount.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Alpha Trogg': {\r\n    effects: [\r\n      {\r\n        name: `Alpha Trogg`,\r\n        desc: `Add 2 to this general's Wounds characteristic. In addition, this general gains the MONSTER keyword.`,\r\n        when: [WOUND_ALLOCATION_PHASE, DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Trogg Smash': {\r\n    effects: [\r\n      {\r\n        name: `Trogg Smash`,\r\n        desc: `Once per battle, when this general fights, after all of their attacks have been resolved, you can say they will perform a Trogg Smash. If you do so, roll a dice for each enemy unit within 3\" of this general. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Loonskin: {\r\n    effects: [\r\n      {\r\n        name: `Loonskin`,\r\n        desc: `If your general has this command trait, you can include 1 of the following endless spells in your army without spending any points to do so: Mork's Mighty Mushroom, Scuttletide or Malevolent Moon. In addition, in your hero phase, this general can attempt to cast the spell that summons that endless spell in the same manner as a WIZARD.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Loonskin`,\r\n        desc: `In your hero phase, this general can attempt to cast the spell that summons that endless spell in the same manner as a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Trugg's Troggherd\r\n  'Ceaseless Growth': {\r\n    effects: [\r\n      {\r\n        name: `Ceaseless Growth`,\r\n        desc: `When you roll the dice that determines the number of wounds you can heal with a friendly TRUGG'S TROGGHERD unit's Regeneration or Greater Regeneration ability, add 1 to the number.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Prized Trogglet': {\r\n    effects: [\r\n      {\r\n        name: `Prized Trogglet`,\r\n        desc: `Roll a dice each time an enemy model within 12\" of this general issues a command. On a 5+, that command is not received (it still counts as having been used) and the command point that was spent to issue that command is lost.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  },\r\n  'Living Landmark': {\r\n    effects: [\r\n      {\r\n        name: `Living Landmark`,\r\n        desc: `During deployment, instead of setting up this general on the battlefield, you can place them to one side and say that they are set up in ambush as a reserve unit. At the end of your first movement phase, you can set them up on the battlefield, within 3\" ofa terrain feature and more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n      {\r\n        name: `Living Landmark`,\r\n        desc: `If you set this unit up as a reserve unit, at the end of your first movement phase, you can set them up on the battlefield, within 3\" ofa terrain feature and more than 9\" from all enemy units.`,\r\n        when: [TURN_ONE_END_OF_MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  CHARGE_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\n// Endless spells.\r\nconst EndlessSpells = {\r\n /* 'Malevolent Moon': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 12\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Gloomspite Gitz Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Twelve_Inches,\r\n      {\r\n        name: `Malevolent Intentions`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit within 3\" of it. On a 2+, that unit suffers D3 mortal wounds. Gloomspite Gitz units are not affected by this ability.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lurid Light`,\r\n        desc: `While this endless spell is controlled by a model in a Gloomspite Gitz army, Gloomspite Gitz units in the same army are affected by the Light of the Bad Moon while they are wholly within 12\" of this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Mork's Mighty Mushroom\": {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 6D6\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Gloomspite Gitz Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mutating Spores`,\r\n        desc: `At the start of the shooting phase, roll a number of dice for each unit within 8\" of this endless spell equal to the number of models in that unit that are within 8\" of this endless spell. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Scrapskuttle's Arachnacauldron\": {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 1\". If successfully cast, set up this endless spell within range and visible to the caster, and more than 1\" from all other models, other endless spells and invocations. Only Gloomspite Gitz Wizards can attempt to summon this endless spell. A Wizard in a garrison cannot attempt to summon this endless spell, and if this endless spell is summoned, the Wizard that summoned it cannot join a garrison until this endless spell has been removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Linked`,\r\n        desc: `This endless spell must remain within 1\" of the model that summoned it. For rules purposes, this endless spell and the model that summoned it are treated as a single model that uses that model's warscroll, with the addition of the abilities on this warscroll.\r\n\r\n        If the model that summoned this endless spell is slain, then this endless spell is immediately removed from play. If this endless spell is dispelled and the model that summoned it has not been slain, remove this endless spell from play but leave the model that summoned it on the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Linked`,\r\n        desc: `If the model that summoned this endless spell is slain, then this endless spell is immediately removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Blessings of the Cauldron`,\r\n        desc: `The model that summoned this endless spell can attempt to cast 1 additional spell while this endless spell is on the battlefield. In addition, if the model that summoned this endless spell is a Moonclan unit in a Gloomspite Gitz army, it knows all of the spells from the Lore of the Moonclans while this endless spell is on the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodslither Pact`,\r\n        desc: `After this endless spell is set up and at the start of each of their hero phases, the commanding player must pick 1 unit within 3\" of the model that summoned this endless spell. That unit suffers 1 mortal wound that cannot be negated.\r\n\r\n        Designer's Note: If there are no other units within 3\", then the model that summoned this endless spell must be picked to suffer the mortal wound. `,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Scuttletide: {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7. Add 1 to casting rolls for this spell if the caster is a Spiderfang Wizard. If successfully cast, set up this endless spell within 8\" of a terrain feature that is visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Gloomspite Gitz Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Predatory`,\r\n        desc: `This endless spell is a predatory endless spell. It can be moved up to 8\".`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scuttling Horde`,\r\n        desc: `After this endless spell has moved, the commanding player can pick 1 unit within 1\" of this endless spell and roll 8 dice. For each 5+, that unit suffers 1 mortal wound. In addition, roll 8 dice for each unit that finishes a normal move, run, retreat or charge move within 6\" of this endless spell. For each 5+, that unit suffers 1 mortal wound. Spiderfang units are not affected by this ability.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scuttling Horde`,\r\n        desc: `Roll 8 dice for each unit that finishes a normal move, run, retreat or charge move within 6\" of this endless spell. For each 5+, that unit suffers 1 mortal wound. Spiderfang units are not affected by this ability.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Endless Terrors`,\r\n        desc: `While this endless spell is wholly within 12\" of any Arachnarok units, it can only be dispelled with a dispelling roll of 9+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Ensnaring Webbing': {\r\n    effects: [\r\n      {\r\n        name: `Ensnaring Webbing`,\r\n        desc: `Only an ARACHNAROK unit can carry out this monstrous rampage. Pick 1 enemy HERO within 3\" of this ARACHNAROK unit that is not a MONSTER and roll a dice. If the score equals or exceeds that HERO's Wounds characteristic, that hero cannot fight in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Giant Boing!': {\r\n    effects: [\r\n      {\r\n        name: `Giant Boing!`,\r\n        desc: `Only a MANGLER SQUIGS unit that has made a charge move this turn can carry out this monstrous rampage. This MANGLER SQUIGS unit can make a 3D6\" move but it must finish that move within 3\" of any enemy units.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { COMBAT_PHASE, DURING_SETUP, END_OF_TURN, HERO_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Squigalanche': {\r\n    effects: [\r\n      {\r\n        name: `Bouncing Fury - Passive`,\r\n        desc: `Effect: Each time a friendly Squig unit charges, add 1 to the Attacks characteristic of its Fang-filled Gobs, Massive Fang-filled Gobs or Huge Fang-filled Gobs for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Troggherd\": {\r\n    effects: [\r\n      {\r\n        name: `Herd Healing - Passive`,\r\n        desc: `Effect: Each time a friendly Troggoth unit uses a Fight ability, after that ability has been resolved, Heal (D3) that unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Moonclan Skrap\": {\r\n    effects: [\r\n      {\r\n        name: `Spreading Loonacy - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly non-Squig Moonclan units in combat to be the targets. \r\n        Effect: For each target:  \r\n        Make a pile-in move with the target.  \r\n        Then, pick an enemy unit in combat with the target and roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  \"Spiderfang Stalktribe\": {\r\n    effects: [\r\n      {\r\n        name: `Realmweb Ambush - Passive`,\r\n        desc: `Effect: Each time a friendly Skitterstrand Arachnarok uses the Realmweb Lurker ability, you can pick another friendly Spiderfang unit to also use that ability. \r\n        In addition, each time a friendly Skitterstrand Arachnarok uses the Ambush from Beyond ability, you can pick another friendly Spiderfang unit that is skittering through tunnels in reality to also use that ability. That unit must be set up wholly within 12\" of the Skitterstrand Arachnarok using the ability.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n\r\n/*  Grimscuttle: {\r\n    effects: [\r\n      {\r\n        name: `Through the Cracks they Creep`,\r\n        desc: `During deployment, if any friendly GRIMSCUTTLE SKITTERSTRAND ARACHNAROKS have been set up in ambush as reserve units using the Ambush From Beyond ability, instead of setting up another friendly GRIMSCUTTLE SPIDERFANG unit, you can place that unit to one side and say that it will join a friendly GRIMSCUTTLE SKITTERSTRAND ARACHNAROK in ambush as a reserve unit. Up to 2 units can join each friendly GRIMSCUTTLE SKITTERSTRAND ARACHNAROK as a reserve unit. When a friendly GRIMSCUTTLE SKITTERSTRAND ARACHNAROK is set up on the battlefield for the first time, set up all units that joined it wholly within 12\" of it and more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Da King's Gitz\": {\r\n    effects: [\r\n      {\r\n        name: `Lairs of the Loonking's Ladz`,\r\n        desc: `If you command a KING'S GITZ army, you can reroll the dice roll when using the Bad Moon Loonshrine's Moonclan Lairs ability.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Badsnatchers: {\r\n    effects: [\r\n      {\r\n        name: `Harbingers of the Everdank`,\r\n        desc: `Each time a casting roll is made for a friendly BADSNATCHERS MOONCLAN WIZARD, if that WIZARD is wholly within 9\" of any other friendly BADSNATCHERS MOONCLAN WIZARDS, you can reroll 1 of the dice in that casting roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'A Scheme for Every Occasion': {\r\n    effects: [\r\n      {\r\n        name: `A Scheme for Every Occasion`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and all of the battle tactics you completed were from the 'Nasty Tricks' list.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Chasing the Moon': {\r\n    effects: [\r\n      {\r\n        name: `Chasing the Moon`,\r\n        desc: `When the battle ends, you complete this grand strategy if the model picked to be your general has not been slain and they have been affected by the Light of the Bad Moon in at least 3 battle rounds.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Protect da Shrine!': {\r\n    effects: [\r\n      {\r\n        name: `Protect da Shrine!`,\r\n        desc: `When the battle ends, you complete this grand strategy there is a Bad Moon Loonshrine from your army on the battlefield, there are no enemy models within 12\" of it and it was not affected by a successful Smash To Rubble monstrous rampage.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Superior Spell-flinger': {\r\n    effects: [\r\n      {\r\n        name: `Superior Spell-flinger`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 2 or more friendly Gloomspite Gitz endless spells on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Leave Me Alone!': {\r\n    effects: [\r\n      {\r\n        name: `Leave Me Alone!`,\r\n        desc: `When the battle ends, you complete this grand strategy if a friendly TRUGG is on the battlefield and no enemy HEROES are on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { DURING_GAME, END_OF_TURN } from 'types/phases'\r\n\r\nconst Scenery = {\r\n  /*'Bad Moon Loonshrine': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup_Removable,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Moonclan Lairs`,\r\n        desc: `At the end of each of your turns, you can pick 1 friendly Gloomspite Gitz unit that has been destroyed. The unit picked cannot be a Hero, cannot be Unique, and must have a Wounds characteristic of 5 or less. After you pick a unit that has been destroyed, roll a dice. On a 4+, a replacement unit with half of the models from the unit that was destroyed (rounding up) is added to your army. Set up that unit wholly within 12\" of a Bad Moon Loonshrine in your army and more than 3\" from all enemy units. Each destroyed unit can only be replaced once, and replacement units cannot themselves be replaced. Replacement Moonclan Stabbas and Moonclan Shootas can include up to half as many Netters as the destroyed unit (rounding up).`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Effigy of Da Bad Moon`,\r\n        desc: `Gloomspite Gitz units are affected by the light of the Bad Moon while they are wholly within 12\" of this terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of the Clammy Dank': {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Distraction: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Gloomspite Gitz Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for attacks made by enemy units while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Hand of Gork: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Gloomspite Gitz Wizard to cast this spell, pick a visible friendly unit wholly within 12\" of them and not in combat to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield wholly within 24\" of the caster and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spore Maws: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Gloomspite Gitz Wizard to cast this spell, pick up to 3 visible enemy units within 12\" of them to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Hand of Gork': {\r\n    effects: [\r\n      {\r\n        name: `The Hand of Gork`,\r\n        desc: `Casting value of 7 and a range of 24\". Pick 1 friendly GLOOMSPITE GITZ unit more than 3\" from all enemy units and that is wholly within range and visible to the caster. Remove that unit from the battlefield and set it up again anywhere on the battlefield more than 9\" from all enemy units. It cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Squig Lure': {\r\n    effects: [\r\n      {\r\n        name: `Squig Lure`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 friendly SQUIG unit wholly within range and visible to the caster. Until your next hero phase, you can reroll charge rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scuttling Terrors': {\r\n    effects: [\r\n      {\r\n        name: `Scuttling Terrors`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly SPIDERFANG unit wholly within range and visible to the caster. That unit can make a normal move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sneaky Distraction': {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Distraction`,\r\n        desc: `Casting value of 7 and a range of 12\". If successfully cast, until your next hero phase, subtract 1 from hit rolls for attacks made by enemy units while they are within range of the caster.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Curse of da Spider God': {\r\n    effects: [\r\n      {\r\n        name: `Curse of da Spider God`,\r\n        desc: `Casting value of 7 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. Until the start of your next hero phase, hit rolls for attacks made by that unit always fail on an unmodified roll of 1 or 2 instead of only a 1, and save rolls for attacks that target that unit always fail on an unmodified roll of 1 or 2 instead of only a 1.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit spells\r\n  'Nikkit! Nikkit!': {\r\n    effects: [\r\n      {\r\n        name: `Nikkit! Nikkit!`,\r\n        desc: `Casting value of 8 and a range of 12\". Pick 1 enemy model within range and visible to the caster. That model's unit suffers D3 mortal wounds. In addition, if that model bears an artefact of power and the unmodified casting roll was 10+, that model's artefact of power can no longer be used (if it was used to enhance a weapon, that weapon reverts to its normal form)`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Night Shroud': {\r\n    effects: [\r\n      {\r\n        name: `Night Shroud`,\r\n        desc: `Casting value of 5 and a range of 12\". Pick 1 friendly Gloomspite Gitz unit wholly within range and visible to the caster. Until the start of your next hero phase, subtract 1 from hit rolls for attacks made with missile weapons that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spore Maws': {\r\n    effects: [\r\n      {\r\n        name: `Spore Maws`,\r\n        desc: `Casting value of 7 and a range of 6\". If successfully cast, each enemy unit within range suffers D6 mortal wounds (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fangz of da Bad Moon': {\r\n    effects: [\r\n      {\r\n        name: `Fangz of da Bad Moon`,\r\n        desc: `Casting value of 3 and a range of 24\". Pick 1 enemy unit within range and visible to the caster and roll a number of dice equal to the unmodified casting roll. For each 3+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Face of Da Bad Moon': {\r\n    effects: [\r\n      {\r\n        name: `Face of Da Bad Moon`,\r\n        desc: `Casting value of 5 and a range of 9\". Pick 1 enemy unit within range and visible to the caster. That unit must retreat. If it is impossible for the unit to retreat for any reason, it suffers D6 mortal wounds instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Venom of the Spider God': {\r\n    effects: [\r\n      {\r\n        name: `Venom of the Spider God`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly Spiderfang unit wholly within range and visible to the caster. Until the start of your next hero phase, add 1 to the number of mortal wounds caused by the 'Spider Venom' ability of that unit if the unmodified hit roll was 6. If the casting roll was 10 or more, pick up to D3 different friendly Spiderfang units instead of 1. Designer's Note: If a unit is affected by the Light of the Bad Moon, this spell does not affect unmodified hit rolls of 5; it only affects unmodified hit rolls of 6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Speed of the Spider God': {\r\n    effects: [\r\n      {\r\n        name: `Speed of the Spider God`,\r\n        desc: `Casting value of 4 and a range of 24\". Pick 1 friendly Spiderfang unit wholly within range and visible to the caster. Until your next hero phase, that unit can run and still shoot and/or charge later in the turn. If the casting roll was 8 or more, pick up to D3 friendly Spiderfang units instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Jealous Hex': {\r\n    effects: [\r\n      {\r\n        name: `Jealous Hex`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy Hero within range and visible to the caster. Until the start of your next hero phase, ignore positive modifiers to hit rolls and wound rolls for attacks made by that Hero, and ignore positive modifiers to save rolls for attacks that target that Hero.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hag Curse': {\r\n    effects: [\r\n      {\r\n        name: `Hag Curse`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, subtract 1 from hit rolls for attacks made by that unit and subtract 1 from save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Mesmerise: {\r\n    effects: [\r\n      {\r\n        name: `Mesmerise`,\r\n        desc: `Casting value of 6 and a range of 12\". Only this unit's Boggleye knows this spell and can attempt to cast it. Pick 1 enemy unit within range and visible to the caster. Until the start of your next hero phase, that unit cannot issue or receive commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fungoid Cloud': {\r\n    effects: [\r\n      {\r\n        name: `Fungoid Cloud`,\r\n        desc: `Casting value of 6 and a range of 12\". Only this unit's Shroomancer knows this spell and can attempt to cast it. If successfully cast, until the start of your next hero phase, subtract 1 from hit rolls for attacks that target friendly Gloomspite Gitz units while they are wholly within range of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SHOOTING_PHASE,\r\n  START_OF_TURN,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const ArachnarokSpiderVenomEffect = {\r\n  name: `Spider Venom`,\r\n  desc: `If the unmodified hit roll for an attack made with this model's Monstrous Fangs is 6, that attack inflicts 3 mortal wounds on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DeadTricksyEffect = {\r\n  name: `Dead Tricksy`,\r\n  desc: `This unit has a ward of 6+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst FerociousPounceEffect = {\r\n  name: `Ferocious Pounce`,\r\n  desc: `This unit is eligible to fight in the combat phase if it is within 6\" of an enemy unit instead of 3\", and it can move an extra 3\" when it piles in.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst NettersEffect = {\r\n  name: `Netters`,\r\n  desc: `Subtract 1 from hit rolls for attacks made by enemy units while they are within 1\" of any friendly units that include any models armed with a Barbed Net.`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst GrotBaseEffects = [\r\n  {\r\n    name: `Musician`,\r\n    desc: `1 in every 20 models in this unit can be a Gong Basher. Add 1 to run rolls for this unit if it includes any Gong Bashers.`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Standard Bearer`,\r\n    desc: `1 in every 20 models in this unit can be a Bad Moon Icon Bearer. Add 1 to save rolls for attacks made with missile weapons that target this unit if it includes any Bad Moon Icon Bearers.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n  NettersEffect,\r\n]\r\nconst WhirlingDeathEffect = {\r\n  name: `Whirling Death`,\r\n  desc: `This unit fights at the start of the combat phase, before the players pick any other units to fight in that combat phase. This unit cannot fight again in the combat phase unless an ability or spell allows it to fight more than once.`,\r\n  when: [START_OF_CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst HallucinogenicFungusBrewsEffect = {\r\n  name: `Hallucinogenic Fungus Brews`,\r\n  desc: `In the first battle round, this unit has a ward of 4+. In the second battle round, this unit has a ward of 5+. In the third and subsequent battle rounds, this unit has a ward of 6+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst WatchOutEffect = {\r\n  name: `Watch Out!`,\r\n  desc: `If this model is slain, before it is removed from play, roll a dice for each other unit within 3\" of this model. On a 4+, that unit suffers D3 mortal wounds.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true,\r\n}\r\nconst KersplatEffect = {\r\n  name: `Ker-splat!`,\r\n  desc: `After this unit makes a charge move, pick 1 enemy unit within 1\" of this unit and roll a dice for each model in that unit, to a maximum of 10 dice. For each 4+, that unit suffers 1 mortal wound.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst SquigsGoneWildEffect = {\r\n  name: `Squigs Gone Wild`,\r\n  desc: `Each time a Cave Squig in this unit flees as a result of a failed battleshock test, before that model is removed from play, roll a dice. On a 3+, you can pick the closest enemy unit within 9\" of that model. That unit suffers 1 mortal wound. If multiple units are tied to be the closest within 9\" of it, you can pick which suffers the mortal wound.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  rule_sources: [\r\n    rule_sources.BATTLETOME_GLOOMSPITE_GITZ,\r\n    meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n  ],\r\n  shared: true,\r\n}\r\nconst WallCrawlerEffect = {\r\n  name: `Wall Crawler`,\r\n  desc: `When this model makes a move, it can pass across terrain features in the same manner as a model that can fly.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst RegenerationEffect = {\r\n  name: `Regeneration`,\r\n  desc: `At the start of the hero phase, you can heal up to D3 wounds allocated to this unit.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst MagicalResistanceEffect = {\r\n  name: `Magical Resistance`,\r\n  desc: `Each time this unit is affected by a spell or the abilities of an endless spell, you can roll a dice. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst SquigglyBeastFollowersEffect = {\r\n  name: `Squiggly-beast Followers`,\r\n  desc: `At the start of the combat phase, roll 1 dice for each enemy unit within 3\" of any friendly units with this ability. If the roll is equal to or greater than the number of models in that enemy unit, that enemy unit suffers 1 mortal wound.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CrushingGripEffect = {\r\n  name: `Crushing Grip`,\r\n  desc: `At the end of the combat phase, pick 1 enemy model within 1\" of this unit and roll a dice. If the roll is equal to or greater than that model's Wounds characteristic, it is slain.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in a Gloomspite Gitz army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n} */\r\n\r\n// TODO: Make sure we have Kragnos available\r\n\r\nconst Units = {\r\n  'Kragnos': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of The Dread Mace is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 3+, ignore the effect of that spell on this unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this phase, pick 1 of the following effects:  \r\n        Roll a dice for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.  \r\n        Pick an enemy Monster in combat with this unit and roll 2D6. On a 7, this ability has no effect. Otherwise, inflict an amount of mortal damage on that unit equal to the results on the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal damage (2x6).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The End of Empires - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for friendly Destruction units while they are wholly within 12\" of this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skragrott, The Loonking': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Fangz of da Bad Moon'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     // WarmasterEffect,\r\n      {\r\n        name: `Fangz of Da Bad Moon: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the unmodified casting roll. For each 3+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Babbling Wand - Reaction: You declared the Redeploy command for a friendly Moonclan unit wholly within 12\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `The Loonking's Entreaty - Once Per Battle - Reaction: You declared The Bad Moon's Orbit ability`,\r\n        desc: `Effect: You can choose whether the Bad Moon moves to the next location or stays in its current location instead of rolling the dice.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  Loonboss: {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, [\"I'm Da Boss, Now Stab 'Em Good!\"])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Let's Get Stabbin'! - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Moonclan Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'm Da Boss`,\r\n        desc: `Declare: Pick a visible friendly Moonclan Stabbas unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, pick one of the following effects: \r\n        Get Back Ere!: If the target is not in combat, you can return D6 slain models to it. \r\n        Stab Em Good!: Add 1 to wound rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  DeadTricksyEffect\r\n    ],\r\n  },\r\n  'Loonboss on Mangler Squigs': {\r\n    effects: [\r\n      {\r\n        name: `Bite Da Moon! - Once Per Battle`,\r\n        desc: `Declare: Pick this unit and all friendly Squig units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to wound rolls for the targets Fang-filled Gobs, Massive Fang-filled Gobs and Huge Fang-filled Gobs for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Rage - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Huge Fang-filled Gobs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Watch Out! - Passive`,\r\n        desc: `Effect: If this unit is destroyed, before removing it from play, roll a dice for each enemy unit within this units combat range. On a 4+, infict D3 mortal damage on that unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ker-Splat! - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a dice for each model in the target unit, to a maximum of 10. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  WatchOutEffect,\r\n    //  KersplatEffect,\r\n    ],\r\n  },\r\n  'Loonboss on Giant Cave Squig': {\r\n    effects: [\r\n      {\r\n        name: `Let's Get Bouncin'! - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Squig Cavalry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Loonboss with Giant Cave Squig': {\r\n    effects: [\r\n     // DeadTricksyEffect,\r\n      {\r\n        name: `Goin' Somewhere?`,\r\n        desc: `At the start of the battleshock phase, you can pick 1 other friendly Gloomspite Gitz Grot unit within 3\" of this unit and say that the Loonboss will set his Cave Squig loose on them. If you do so, that unit suffers D3 mortal wounds, but for each mortal wound it suffers, add 3 to its Bravery characteristic until the end of the phase.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Gobbled Up`,\r\n        desc: `At the end of the combat phase, pick 1 enemy model within 1\" of this unit and roll a dice. If the roll is equal or greater than that model's Wounds characteristic, it is slain.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* 'Madcap Shaman': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Night Shroud'])],\r\n    }, \r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Madcap Mushroom`,\r\n        desc: `Once per battle, in your hero phase, you can say this unit will eat its Madcap Mushroom. If you do so, this unit can attempt to cast 1 additional spell in that phase. If it does so and the casting roll is a double, this unit suffers D3 mortal wounds after the effect of the spell has been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Fungoid Cave-Shaman': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Spore Maws'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Deffcap Mushroom - Once Per Battle`,\r\n        desc: `Effect: Add 1 to this units power level for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Zarbag: {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Face of Da Bad Moon', 'Jealous Hex'])],\r\n    },\r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Sniffer Spite`,\r\n        desc: `At the start of your hero phase, roll a dice. On a 4+, this unit can attempt to cast 1 additional spell in that phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Zarbag's Gitz\": {\r\n    effects: [\r\n      {\r\n        name: `Loonsmasha Fanatic`,\r\n        desc: `A Loonsmasha Fanatic unit consisting of 1 model lurks with Zarbag's Gitz.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      NettersEffect,\r\n      {\r\n        name: `'Protect Da Boss!'`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly Zarbag, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly Zarbag, if this unit is within 3\" of that friendly Zarbag, you can roll a dice. On a 1-2, that wound or mortal wound is allocated to that Zarbag as normal. On a 3+, that wound or mortal wound is allocated to this unit instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Snirk Sourtongue`,\r\n        desc: `The first time this unit is set up on the battlefield, 1 Loonsmasha Fanatics unit consisting of 1 model is added to your army and hidden within this unit as a reserve unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  'Moonclan Stabbas': {\r\n    effects: [\r\n     // ...GrotBaseEffects,\r\n      {\r\n        name: `Netters`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Moonclan Shootas': {\r\n    effects: [\r\n     // ...GrotBaseEffects,\r\n     {\r\n      name: `Netters`,\r\n      desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n      Effect: Roll a dice. On a 3+, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Loonsmasha Fanatics': {\r\n    effects: [\r\n      {\r\n        name: `Release the Fanatics!`,\r\n        desc: `Declare: Pick this unit if it is hidden among the mobs. Then, pick a friendly Moonclan Shootas or Moonclan Stabbas unit that has 10 or more models to be the target. \r\n        Effect: Set up this unit anywhere on the battlefield wholly within 6\" of the target and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Hidden Loons`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve hidden among the mobs. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Whirling Death - Passive`,\r\n        desc: `Effect: This unit has Strike-first.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  WhirlingDeathEffect,\r\n    ],\r\n  },\r\n  'Sporesplatta Fanatics': {\r\n    effects: [\r\n      {\r\n        name: `Puffshroom Frenzy - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of melee weapons used by other friendly Moonclan units while they are wholly within 12\" of this unit. Subtract 1 from the Attacks characteristic of weapons used by enemy units while they are in combat with this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `A Prod in the Right Direction`,\r\n        desc: `Effect: This unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Squig Hoppers': {\r\n    effects: [\r\n      {\r\n        name: `Boing! Boing! Boing!`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Boingrot Bounderz': {\r\n    effects: [\r\n      {\r\n        name: `Boing! Smash!`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sneaky Snufflers': {\r\n    effects: [\r\n      {\r\n        name: `Looncap Mushrooms - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible friendly Moonclan unit wholly within 12\" of it to be the target. \r\n        Effect: Roll a dice. Add 1 to the roll if this unit is under the light of the Bad Moon. On a 3+, the target has Ward (5+) until the start of your next turn. On a 6+, also add 1 to the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Squig Herd': {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Squigs Gone Wild - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // SquigsGoneWildEffect,\r\n      {\r\n        name: `Herding Squigs`,\r\n        desc: `Effect: Roll a dice for each Squig Herder in this unit. For each 2+, you can return D3 slain Cave Squigs to this unit. For each 1, 1 Squig Herder in this unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mangler Squigs': {\r\n    effects: [\r\n      {\r\n        name: `Squig Rage - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Huge Fang-filled Gobs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Watch Out! - Passive`,\r\n        desc: `Effect: If this unit is destroyed, before removing it from play, roll a dice for each enemy unit within this units combat range. On a 4+, infict D3 mortal damage on that unit.`,\r\n        when: [COMBAT_PHASE],\r\n      }, \r\n      {\r\n        name: `Giant Boing! - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit can move 3D6\" but must end that move in combat.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  KersplatEffect, WatchOutEffect\r\n    ],\r\n  },\r\n /* 'Colossal Squig': {\r\n    effects: [\r\n      {\r\n        name: `Crazed Charge`,\r\n        desc: `Roll a dice for each enemy unit that is within 1\" of this model after this model makes a charge move. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Fungoid Squig Explosion`,\r\n        desc: `If this model is slain, before removing this model from play, roll a dice for each enemy unit within 3\" of it. On a 2+, that enemy unit suffers D3 mortal wounds. Then, you can add 1 Squig Herd unit of up to 5 models to your army. Set up the Squig Herd unit wholly within 9\" of this model and more than 3\" from all enemy models. This model is then removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Puff Spores`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Swallowed Whole`,\r\n        desc: `If the unmodified hit roll for an attack made with this model's Enormous Jaws is 6, that attack causes D3 mortal wounds to the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Squig Gobba': {\r\n    effects: [\r\n      {\r\n        name: `Arcing Spit`,\r\n        desc: `When this model makes an attack with Spitsquigs, it can target an enemy unit that is not visible to it. In addition, add 1 to hit rolls for attacks made with Spit-squigs if the target has more than 5 models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Webspinner Shaman on Arachnarok Spider': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Venom of the Spider God'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Chitinous Legs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wall Crawler - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ensnaring Webbing - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry Hero within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ArachnarokSpiderVenomEffect,\r\n    //  WallCrawlerEffect,\r\n      {\r\n        name: `Catchweb Spidershrine - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Spiderfang Wizards while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Scuttleboss on Gigantic Spider': {\r\n    effects: [\r\n      {\r\n        name: `Spider Venom`,\r\n        desc: `If the unmodified hit roll for an attack made by this model is 6, that attack causes 2 mortal wounds on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // WallCrawlerEffect,\r\n      {\r\n        name: `'Scuttle Away!'`,\r\n        desc: `Once per battle, at the end of the combat phase, you can say this unit will order his warriors to scuttle away. If you do so, you can pick 1 friendly Spider Riders unit wholly within 12\" of this unit. This unit and the unit you picked can retreat, one after the other in the order of your choice.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Webspinner Shaman': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Speed of the Spider God'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Speed of the Spider God: Casting value of 6`,\r\n        desc: `Declare: Pick a visible friendly Spiderfang unit wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: The target can use a Run ability this turn and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Web Slingshot`,\r\n        desc: `Declare: Pick a friendly Spiderfang unit or terrain feature within 18\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, remove this unit from the battlefield and set it up again wholly within 3\" of the target and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spider Riders': {\r\n    effects: [\r\n      {\r\n        name: `Wall Crawler - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    //  WallCrawlerEffect,\r\n    ],\r\n  },\r\n  'Arachnarok Spider with Flinger': {\r\n    effects: [\r\n      {\r\n        name: `Flinger - Passive`,\r\n        desc: `Effect: If any attacks made with this units Flinger score a hit, after the Shoot ability has been resolved, roll a dice. On a 2+, the target unit is entangled until the start of your next turn. Halve the Move characteristic of a unit while it is entangled.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Binding Webbing - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from the Attacks characteristic of the targets Companion weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Chitinous Legs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wall Crawler - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    //  WallCrawlerEffect,\r\n    ],\r\n  },\r\n  'Arachnarok Spider with Spiderfang Warparty': {\r\n    effects: [\r\n     // ArachnarokSpiderVenomEffect,\r\n     // WallCrawlerEffect,\r\n      {\r\n        name: `Voracious Predator - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units within 1\" of this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage equal to the roll on that target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Chitinous Legs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wall Crawler - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skitterstrand Arachnarok': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Chitinous Legs is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wall Crawler - Passive`,\r\n        desc: `Effect: This unit can pass across terrain features as if it had Fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Realmweb Lurker`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve skittering through tunnels in reality. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n     // WallCrawlerEffect,\r\n      {\r\n        name: `Ambush From Beyond`,\r\n        desc: `Declare: Pick this unit if it is skittering through tunnels in reality. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Scuttling Terror - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit can move 2D6\". It can pass through the combat ranges of enemy units and can pass through models in enemy Infantry units, but it must end that move in combat. \r\n        Then, pick an enemy Infantry unit that this unit passed across during that move. Inflict D3 mortal damage on that enemy unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Troggoth Hag': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Hag Curse'])],\r\n    }, \r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Hag Regeneration`,\r\n        desc: `In your hero phase, you can heal up to D6 wounds allocated to this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spell-spite`,\r\n        desc: `Each time this model successfully unbinds a spell, you can roll a dice. On a 4+, the caster of that spell suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Terrible Stench`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Dankhold Troggboss': {\r\n    effects: [\r\n     // CrushingGripEffect,\r\n      {\r\n        name: `Greater Regeneration`,\r\n        desc: `Effect: Heal (D6) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    //  MagicalResistanceEffect,\r\n     // SquigglyBeastFollowersEffect,\r\n      {\r\n        name: `Shepherd of Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 3+, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Troggoth units while they are within this units combat range.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Magical Resistance - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Mollog: {\r\n    effects: [\r\n      {\r\n        name: `Companions`,\r\n        desc: `Mollog is accompanied by a Bat Squig, Spiteshroom and Stalagsquig. Mollog and his companions are treated as a single model that uses the characteristics above. His companions must remain within 1\" of him. Before you allocate a wound or mortal wound to this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to this unit, you can choose to remove 1 of its companions. If you do so, that wound or mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Bat Squig`,\r\n        desc: `At the start of your shooting phase, you can pick 1 enemy unit within 18\" of this unit and roll a dice. On a 2+, that enemy unit suffers 1 mortal wound. This ability cannot be used if the Bat Squig companion has been removed.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    //  RegenerationEffect,\r\n      {\r\n        name: `Spiteshroom`,\r\n        desc: `At the start of the combat phase, you can pick 1 enemy unit within 3\" of this unit and roll a dice. On a 5+, subtract 1 from hit rolls for attacks made by that unit in that phase. This ability cannot be used if the Spiteshroom companion has been removed.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stalagsquig`,\r\n        desc: `If you choose to remove this companion, roll a dice. On a 5+, this companion is not removed, but the wound or mortal wound is still negated. This roll is not a ward roll.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Fellwater Troggoths': {\r\n    effects: [\r\n    //  RegenerationEffect,\r\n      {\r\n        name: `Regeneration`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n      {\r\n        name: `Noxious Vomit - Passive`,\r\n        desc: `Effect: If any damage points are allocated to an enemy unit by attacks made with this units Noxious Vomit, that unit is drenched in vomit until the start of your next turn. While a unit is drenched in vomit:  \r\n        Subtract 1 from save rolls for that unit.  \r\n        Ignore positive modifiers to save rolls for that unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Sourbreath Troggoths': {\r\n    effects: [\r\n      {\r\n        name: `Regeneration`,\r\n        desc: `In your hero phase, you can roll a dice for this unit. If you do so, on a 4+, heal up to D3 wounds allocated to this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Too Dumb to Die`,\r\n        desc: `This unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Rockgut Troggoths': {\r\n    effects: [\r\n   //   RegenerationEffect,\r\n   {\r\n    name: `Regeneration`,\r\n    desc: `Effect: Heal (D3) this unit.`,\r\n    when: [START_OF_TURN],\r\n  },\r\n    ],\r\n  },\r\n  'Dankhold Troggoths': {\r\n    effects: [\r\n      {\r\n        name: `Greater Regeneration`,\r\n        desc: `Effect: Heal (D6) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n      {\r\n        name: `Magical Resistance - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wade and Smash - Once Per Turn`,\r\n        desc: `Effect: If this unit is in combat, it can move 6\" but must end that move in combat. Then, roll a D3 for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  CrushingGripEffect, MagicalResistanceEffect, RegenerationEffect, SquigglyBeastFollowersEffect\r\n    ],\r\n  },\r\n/*  'Aleguzzler Gargant': {\r\n    effects: [\r\n      {\r\n        name: `Drunken Stagger`,\r\n        desc: `You can attempt a charge with this unit if it is within 18\" of the enemy instead of 12\". In addition, roll 3D6 instead of 2D6 when making a charge roll for this unit. However, if a charge roll for this unit includes three dice that show the same number before modifiers are applied, this unit cannot make a charge move in that phase and the players must roll off. The winner must pick a point on the battlefield 3\" from this unit. Each unit within 2\" of that point suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff Em In Me Bag`,\r\n        desc: `After this model piles in, you can pick 1 enemy model within 3\" of this model and roll a dice. If the roll is equal to or greater than double that model's Wounds characteristic, it is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ...GenericEffects.Gargant,\r\n    ],\r\n  },\r\n  \"Rippa's Snarlfangs\": {\r\n    effects: [\r\n      {\r\n        name: `Vindictive Attackers`,\r\n        desc: `Add 1 to hit rolls and wound rolls for attacks made by this unit that target a unit that has 1 or more wounds allocated to it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      FerociousPounceEffect,\r\n    ],\r\n  }, */\r\n  'Snarlfang Riders': {\r\n    effects: [\r\n      {\r\n        name: `'Can't Catch Us!' - Once Per Turn`,\r\n        desc: `Effect: If this unit is not in combat, this unit can move D6\". It cannot end that move in combat.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gobbapalooza: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Mesmerise', 'Fungoid Cloud'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Hallucinogenic Fungus Brews - Passive`,\r\n        desc: `Effect: In the first battle round, this unit has Ward (4+). In the second battle round, this unit has Ward (5+). In the third and subsequent battle rounds, this unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // HallucinogenicFungusBrewsEffect,\r\n      {\r\n        name: `Gobbapalooza Know-Wotz`,\r\n        desc: `Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Glareface Dance: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to run rolls and charge rolls for that unit until the start of your next turn. \r\n        Nasty Poisons: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to the Rend characteristic of that units weapons until the start of your next turn. \r\n        Mesmerise: Pick a visible enemy unit within 12\" of this unit. Until the start of your next turn, that unit cannot use commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Grinkrak the Great': {\r\n    effects: [\r\n      DeadTricksyEffect,\r\n      {\r\n        name: `'I Dub Thee...'`,\r\n        desc: `At the start of the combat phase, you can pick 1 other friendly Moonclan unit within 3\" of this unit to be dubbed. If you do so, until the end of that phase, if any models in that unit are slain, those models can fight before they are removed from play.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Grinkrak's Looncourt\": {\r\n    effects: [\r\n      {\r\n        name: `The Looncourt's Quest`,\r\n        desc: `After this unit has been set up on the battlefield for the first time, you can pick 1 objective or 1 terrain feature in enemy territory to be the object of this unit's quest. If you gain control of that objective or terrain feature while this unit is contesting it, this unit completes its quest. Once the quest is complete, for the rest of the battle, this unit has a ward of 4+.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Looncourt's Quest`,\r\n        desc: `Once the quest is complete, for the rest of the battle, this unit has a ward of 4+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Grinkrak's Toadies`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly Grinkrak, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly Grinkrak, if this unit is within 3\" of that friendly Grinkrak, you can roll a dice. On a 1-2, that wound or mortal wound is allocated to that Grinkrak as normal. On a 3+, that wound or mortal wound is allocated to this unit instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Squigboss: {\r\n    effects: [\r\n      {\r\n        name: `Feedin' Time - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Squig unit within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply for the rest of the turn: \r\n        Crimson Decap: Add 3\" to the targets Move characteristic. \r\n        Yellow Lurka: The targets Fang-filled Gobs, Huge Fang-filled Gobs or Massive Fang-filled Gobs have Crit (Mortal).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Trugg the Troggoth King': {\r\n    effects: [\r\n    //  WarmasterEffect,\r\n      {\r\n        name: `Malfunctioning Leystone`,\r\n        desc: `Effect: Roll 3 dice. You must pick 1 of those dice and apply the effect that corresponds to its value. Effects 2-6 persist until the start of your next turn. \r\n        1 Glyph of Shyish: Inflict D3 mortal damage on this unit. \r\n        2 Glyph of Ghur: Add 1 to the Attacks characteristic of melee weapons used by friendly Troggoth units while they are wholly within 12\" of this unit. \r\n        3 Glyph of Aqshy: Add 1 to the Rend characteristic of melee weapons used by friendly Troggoth units while they are wholly within 12\" of this unit. \r\n        4 Glyph of Hysh: This unit can use Unbind abilities as if it had Wizard (1). \r\n        5 Glyph of Ulgu: Subtract 1 from hit rolls for shooting attacks that target friendly Troggoth units while they are wholly within 12\" of this unit. \r\n        6 Glyph of Chamon: This unit has Ward (5+).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, when it uses the Malfunctioning Leystone ability, roll 1 dice instead of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Crushing Grip - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll equals or exceeds the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Greater Regeneration`,\r\n        desc: `Effect: Heal (D6) this unit.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Rabble-Rowza': {\r\n    effects: [\r\n      {\r\n        name: `Secret Tunnels`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve in a secret tunnel. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Emerge from the Depths`,\r\n        desc: `Declare: Pick this unit if it is in a secret tunnel. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Neh Neh Na-Neh Neh! Can't Catch me! - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Monster or Beast unit to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn, but each time it uses a Move ability, it must end the move closer to this unit. \r\n        In addition, for the rest of the turn, the first time the target ends a move within this units combat range, inflict D6 mortal damage on this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Grotmas Gitz': {\r\n    effects: [\r\n      {\r\n        name: `Bludgeoning Cheer`,\r\n        desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a number of dice equal to the unmodified charge roll for that charge move. For each 4+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.GROTMAS_GITZ],\r\n      },\r\n      {\r\n        name: `Giftz for All!`,\r\n        desc: `After this unit has made a normal move, run or retreated, pick 1 enemy unit that this unit passed across and roll a dice. On a 4+, subtract 1 from the Damage characteristic of that unit's melee weapons (to a minimum of 1) until the start of your next hero phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.GROTMAS_GITZ],\r\n      },\r\n      {\r\n        name: `'Oh! Grotmas bellz, Skragrott smellz'`,\r\n        desc: `Subtract 1 from hit rolls for attacks made by friendly Gloomspite Gitz units while they are wholly within 6\" of this unit. Add 1 to the Damage characteristic of melee weapons used by friendly Gloomspite Gitz units while they are wholly within 6\" of this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n        rule_sources: [rule_sources.GROTMAS_GITZ],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: Big Grikk`s Kruleshots': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Skewer Killbow: Skewering Bolts - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, the Damage characteristic of this units Beast-Skewer Bolts is 6 if the target is a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Skewer Killbow: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Man-Skewer Crossbows - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, pick either the Hasty Shot or Aimed Shot weapon characteristics for all the attacks it makes with its Man-skewer Crossbows.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Skewer It Again! - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster that had any damage points allocated to it this phase by a shooting attack made by the Beast-skewer Killbow in this Regiment of Renown. Then, pick any number of Man-skewer Boltboyz units in this Regiment of Renown to focus fire. \r\n        Effect: For the rest of the turn, add 1 to the Attacks characteristic of the ranged weapons used by the units you picked to focus fire but all of their attacks must target the enemy Monster you picked.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Odo Godswallow': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Breaking Strike`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 5D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Behemoth Brawler - Passive`,\r\n        desc: `Effect: Subtract 1 from the Attacks characteristic of enemy Monsters while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Menhir Club is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mighty Walloper - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { GLOOMSPITE_GITZ } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  'Gloomspite Gitz': {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [GLOOMSPITE_GITZ,]),\r\n  },\r\n\r\n /* \"Trugg's Troggherd\": {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [\"Trugg's Troggherd\", 'The Bad Moon']),\r\n  },*/\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { GLOOMSPITE_GITZ } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const GloomspiteGitzFaction = new Faction(\r\n  GLOOMSPITE_GITZ,\r\n  DESTRUCTION,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_GLOOMSPITE_GITZ\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Waaagh!': {\r\n    effects: [\r\n      {\r\n        name: `Waaagh!`,\r\n        desc: `You can use this command ability in the combat phase. If you do so, until the end of that phase, add 1 to the Attacks characteristic of melee weapons used by friendly Orruk units while they are wholly within 18\" of a friendly model with this command ability. The same unit cannot benefit from this command ability more than once per turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Gaze of Mork': {\r\n    effects: [\r\n      {\r\n        name: `Gaze of Mork`,\r\n        desc: `Casting value of 6. Select up to 3 visible enemy units within 20\". Roll a D6 for each unit chosen; on a 2-5 it suffers 1 mortal wound, and on a 6 it suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst WarbossBaseEffects = [\r\n  {\r\n    name: `Choppa Boss`,\r\n    desc: `If this model is equipped with a pair of Boss Choppas, they make 8 attacks instead of 6.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Boss Shield`,\r\n    desc: `You can reroll all failed save rolls for a model with a Boss Shield.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst WaaaghDrummersEffect = {\r\n  name: `Waaagh! Drummers`,\r\n  desc: `You can add 2 to the charge rolls of a unit that includes any Waaagh! Drummers.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst TuskerChargeEffect = {\r\n  name: `Tusker Charge`,\r\n  desc: `You can reroll failed wound rolls when attacking with a War Boar's Tusks if its unit charged in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  'Orruk Warboss on Wyvern': {\r\n    mandatory: { command_abilities: [keyPicker(command_abilities, ['Waaagh!'])] },\r\n    effects: [\r\n      {\r\n        name: `Agonising Venom`,\r\n        desc: `If an enemy model suffers a wound from a Wyvern's Barbed, Venomous tail, but is not slain, roll a D6 at the end of the turn. On a 4+, that model suffers a mortal wound.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      ...WarbossBaseEffects,\r\n    ],\r\n  },\r\n  'Orruk Warboss': {\r\n    mandatory: { command_abilities: [keyPicker(command_abilities, ['Waaagh!'])] },\r\n    effects: [\r\n      {\r\n        name: `War Boar`,\r\n        desc: `Some Orruk Warbosses ride to battle on War Boars; these models have Move 9\" instead of 5\" and gain the War Boar's Tusks attack.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Great Waaagh! Banner`,\r\n        desc: `An Orruk Warboss with a Great Waaagh! Banner gains the Totem keyword. You can reroll wound rolls of 1 for attacks made with melee weapons by friendly Orruk units while they are wholly within 16\" of a friendly Orruk Warboss with a Great Waaagh! Banner.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ...WarbossBaseEffects,\r\n    ],\r\n  },\r\n  'Orruk Great Shaman': {\r\n    mandatory: { command_abilities: [keyPicker(spells, ['Gaze of Mork'])] },\r\n    effects: [\r\n      {\r\n        name: `Waaagh! Energy`,\r\n        desc: `Add 1 to casting rolls made by an Orruk Great Shaman that is within 8\" of 20 or more Orruk models.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mercenary Orruks': {\r\n    effects: [\r\n      {\r\n        name: `Trophy Pole`,\r\n        desc: `Add 1 to the Bravery of this unit while it includes a trophy pole.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Trophy Pole`,\r\n        desc: `Roll a D6 whenever this model suffers a wound or a mortal wound; on a 4+ it is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      WaaaghDrummersEffect,\r\n      {\r\n        name: `Shoot 'em Again, Boyz!`,\r\n        desc: `While the Mercenary Boss is alive, you can shoot twice with this unit if it is more than 3\" away from enemy units, and did not move in the preceding movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Orruks: {\r\n    effects: [\r\n      WaaaghDrummersEffect,\r\n      {\r\n        name: `Orruk Banner`,\r\n        desc: `You can add 2 to the Bravery of all models in a unit that includes any Orruk Banners as long as there is an enemy model within 3\" of the unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Skull Icon`,\r\n        desc: `If a model flees from a unit that includes any Skull Icons, roll a D6; on a 6 the Icon Bearer thumps some courage back into the cowardly Orruk - it returns to the fight and doesn't flee.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Choppas`,\r\n        desc: `You can reroll hit rolls of 1 for a model attacking with two Choppas.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mob Rule`,\r\n        desc: `Orruks make 1 extra attack with their melee weapons if their unit has 20 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Waaagh! Shield`,\r\n        desc: `You can reroll save rolls for a unit with Waaagh! Shields in the combat phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Ready Boyz! Aim! Fire!`,\r\n        desc: `You can add 1 to the hits rolls of Orruk Bows if the unit using them is more than 3\" away from any enemy units, and did not move in the preceding movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Boar Chariots': {\r\n    effects: [\r\n      TuskerChargeEffect,\r\n      {\r\n        name: `Scythed Wheels`,\r\n        desc: `Roll a D6 after an Orruk Boar Chariot has successfully charged during its turn: on a 4 or more it inflicts D3 mortal wounds on an enemy unit within 1\".`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orruk Boarboys': {\r\n    effects: [\r\n      TuskerChargeEffect,\r\n      {\r\n        name: `Glyph Bearers`,\r\n        desc: `You can add 2 to the Bravery of all models in a unit that includes any Glyph Bearers as long as there is an enemy model within 3\" of the unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Waaagh! Horns`,\r\n        desc: `You can add 2 to the charge rolls of a unit that includes any Waaagh! Horns.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Tusker Shield`,\r\n        desc: `You can reroll save rolls for a unit with Tusker Shields in the combat phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { GREENSKINZ } from 'meta/factions'\r\nimport CommandAbilities from './command_abilities'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [GREENSKINZ]: {\r\n    effects: [],\r\n    available: {\r\n      command_abilities: [CommandAbilities],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { GREENSKINZ } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const GreenskinzFaction = new Faction(GREENSKINZ, DESTRUCTION, SubFactions)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_IDONETH_DEEPKIN: {\r\n    name: 'Battletome: Idoneth Deepkin',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/12/qkG61VSGT2FmXoIY.pdf',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/12/uuihArRNKxeFtWfb.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  // Faction artifacts\r\n /* 'Disharmony Stones': {\r\n    effects: [\r\n      {\r\n        name: `Disharmony Stones`,\r\n        desc: `Once per battle, at the start of your hero phase, pick up to 2 enemy HEROES within 12\" of the bearer. Your opponent must then choose 1 of the following options:\r\n\r\n        a) Roll a dice for each HERO you picked. On a 3+, that HERO suffers 1 mortal wound.\r\n\r\n        b) Roll a dice for each HERO you picked. On a 5+, that HERO suffers D3 mortal wounds.\r\n\r\n        c) Each HERO you picked suffers D3 mortal wounds. Then, roll a dice. On a 4+, the bearer suffers D3 mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sanguine Pearl': {\r\n    effects: [\r\n      {\r\n        name: `Sanguine Pearl`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to the bearer that was caused by a melee weapon. On a 5+ the wound is negated.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Potion of Hateful Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Potion of Hateful Frenzy`,\r\n        desc: `Once per battle, at the start of your hero phase, you can say the bearer will drink this potion. If you do so, until the end of that turn, add 1 to hit rolls and wound rolls for attacks made by the bearer, add 1 to the Attacks characteristic of the bearer's melee weapons and add 1 to run rolls and charge rolls for the bearer. However, at the start of the next hero phase, the bearer suffers D3 mortal wounds and cannot pile-in until the end of that turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ankusha Spur': {\r\n    effects: [\r\n      {\r\n        name: `Ankusha Spur`,\r\n        desc: `Add 3\" to the bearer's Move characteristic.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ankusha Spur`,\r\n        desc: `Reroll wound rolls of 1 for attacks made by the bearer's mount.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Armour of the Cythai': {\r\n    effects: [\r\n      {\r\n        name: `Armour of the Cythai - Passive`,\r\n        desc: `Effect: Other than the Companion weapon ability, weapon abilities for attacks that target this unit have no effect.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Bio-shock Shell': {\r\n    effects: [\r\n      {\r\n        name: `Bio-shock Shell`,\r\n        desc: `Once per battle, at the start of the combat phase, you can say the bearer will use the Bio-shock Shell. If you do so, pick 1 enemy HERO within 9\" of the bearer that is visible to them and roll 3D6. If the roll is greater than that enemy HERO's Bravery characteristic, the strike-last effect applies to that enemy HERO until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Abyssal Blade': {\r\n    effects: [\r\n      {\r\n        name: `Abyssal Blade`,\r\n        desc: `Pick a weapon carried by the bearer to be the Abyssal Blade. Improve the Rend characteristic of that weapon by 1. In addition, add 1 to the Damage characteristic of that weapon if the target has the SLAANESH keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rune of the Surging Gloomtide': {\r\n    effects: [\r\n      {\r\n        name: `Rune of the Surging Gloomtide`,\r\n        desc: `Once per battle, at the end of your first movement phase, you can say that the bearer will summon a Gloomtide Shipwreck from the ethersea. If you do so, you can set up 1 Gloomtide Shipwreck wholly within 12\" of the bearer and more than 3\" from all models, objectives, other terrain features, endless spells and invocations, and add it to your army.`,\r\n        when: [TURN_ONE_END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Whorlshell: {\r\n    effects: [\r\n      {\r\n        name: `Whorlshell`,\r\n        desc: `Once per battle, at the start of the combat phase, you can say the bearer will unleash the power of the Whorlshell. If you do so, until the end of that phase, if the unmodified hit roll for an attack made with a melee weapon that targets the bearer is 1 or 2, that attack fails and the attack sequence ends.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Dritchleech: {\r\n    effects: [\r\n      {\r\n        name: `Dritchleech - Passive`,\r\n        desc: `Effect: Subtract 1 from casting rolls for enemy Wizards while they are within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Delicious Morsels': {\r\n    effects: [\r\n      {\r\n        name: `Delicious Morsels - Once Per Turn`,\r\n        desc: `Effect: Heal (D3) each friendly Idoneth Deepkin Cavalry unit within this units combat range.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n/*  'Kraken Tooth': {\r\n    effects: [\r\n      {\r\n        name: `Kraken Tooth`,\r\n        desc: `Once per battle, in your shooting phase, you can pick 1 enemy unit within 12\" of the bearer that is visible to them and roll a dice. Then, look up the result below:\r\n\r\n        1 None Binds the Kraken: The bearer suffers D3 mortal wounds.\r\n\r\n        2-5 The Kraken is Released: The target suffers D3 mortal wounds.\r\n\r\n        6 A Tasty Morsel: Pick 1 model from the target unit. If that model has a Wounds characteristic of less than 10, it is slain. If that model has a Wounds characteristic of 10 or more, that model suffers 2D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { IDONETH_DEEPKIN } from 'meta/factions'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, DURING_SETUP, MOVEMENT_PHASE, SHOOTING_PHASE, TURN_ONE_START_OF_TURN } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [IDONETH_DEEPKIN]: {\r\n    effects: [\r\n      {\r\n        name: `Ethersea Voyagers`,\r\n        desc: `Declare: Pick a friendly regiment led by an Idoneth Deepkin Hero. No units in that regiment can have already been deployed. \r\n        Effect: Set up those units in reserve travelling the ethersea. They have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Tides of Death - Passive`,\r\n        desc: `Effect: A different effect applies to friendly Idoneth Deepkin units each battle round, as shown below. For the fifth battle round onwards, repeat the sequence, starting with Low Tide.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tides of Death - Battle Round 1`,\r\n        desc: `Low Tide: For the rest of the battle round, subtract 1 from hit rolls for shooting attacks that target this unit and subtract 1 from hit rolls for combat attacks that target this unit if it did not use any Charge abilities this turn.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tides of Death - Battle Round 2`,\r\n        desc: `Flood Tide: For the rest of the battle round, this unit can use a Run ability and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Tides of Death - Battle Round 3`,\r\n        desc: `High Tide: For the rest of the battle round, this unit has Strike-first.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tides of Death - Battle Round 4`,\r\n        desc: `Ebb Tide: For the rest of the battle round, this unit can use a Retreat ability and still use Shoot and/or Charge abilities later in the turn. In addition, for the rest of the battle round, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Raiders from the Deep`,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin unit that is travelling the ethersea to use this ability. \r\n        Effect: Set up that unit on the battlefield wholly within 9\" of a battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gloomtide Shipwreck (Faction Terrain) - Rise from the Depths`,\r\n        desc: `Effect: Set up this faction terrain either as 1 terrain feature consisting of 2 scenery pieces (that must be set up within 3\" of each other) or as 2 separate terrain features. Set up each terrain feature wholly within friendly territory and more than 3\" from all objectives and other terrain features. After you have done so, it has been deployed. \r\n        If this faction terrain is set up as 1 terrain feature consisting of 2 scenery pieces, it has a Health characteristic of 14 instead of 7.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Gloomtide Shipwreck (Faction Terrain) - Guardians of the Deep - Passive`,\r\n        desc: `Effect: Add 1 to save rolls for friendly Idoneth Deepkin Infantry and Cavalry units while they are wholly within 6\" of this terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Assassins of the High Tide': {\r\n    effects: [\r\n      {\r\n        name: `Assassins of the High Tide`,\r\n        desc: `You complete this battle tactic if 2 or more enemy units are destroyed during this turn by attacks made by friendly IDONETH DEEPKIN units that are affected by the High Tide ability.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Predators of the Deep': {\r\n    effects: [\r\n      {\r\n        name: `Predators of the Deep`,\r\n        desc: `Pick 1 unit in your that has a Wounds characteristic of 8 or more and that has 0 wounds allocated to it. You complete this tactic if that unit is destroyed during this turn by a friendly AKHELIAN ALLOPEXES unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Revenge of the Namarti': {\r\n    effects: [\r\n      {\r\n        name: `Revenge of the Namarti`,\r\n        desc: `You complete this battle tactic if an enemy HERO or MONSTER is destroyed during this turn by an attack made by a friendly NAMARTI unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Deny Trespassers': {\r\n    effects: [\r\n      {\r\n        name: `Deny Trespassers`,\r\n        desc: `Pick 1 Gloomtide Shipwreck in your army that is within 12\" of any enemy units. You complete this battle tactic if that Gloomtide Shipwreck is more than 12\" from all enemy units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Trapped in the Undercurrents': {\r\n    effects: [\r\n      {\r\n        name: `Trapped in the Undercurrents`,\r\n        desc: `You complete this battle tactic if 3 or more friendly IDONETH DEEPKIN units retreated and made a charge move during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Isharann Defiance': {\r\n    effects: [\r\n      {\r\n        name: `Isharann Defiance`,\r\n        desc: `When you reveal this battle tactic, pick 1 objective wholly within enemy territory. At the end of this turn, you complete this battle tactic if you control that objective and there is a friendly ISHARANN unit within 6\" of that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandTraits = {\r\n /* 'Merciless Raider': {\r\n    effects: [\r\n      {\r\n        name: `Merciless Raider`,\r\n        desc: `If the unmodified hit roll for an attack made by this general is 6, that attack automatically wounds the target (do not make a wound roll).`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Hunter of Souls': {\r\n    effects: [\r\n      {\r\n        name: `Hunter of Souls - Passive`,\r\n        desc: `Effect: This units melee weapons have Anti-Hero (+1 Rend).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Unstoppable Fury': {\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Fury`,\r\n        desc: `While this general is affected by the High Tide ability from the Tides of Death table (pg 64), for each enemy unit within 3\" of them when they fight in the combat phase, add 2 to the Attacks characteristic of their melee weapons until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_IDONETH_DEEPKIN, rule_sources.ERRATA_JULY_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Born From Agony': {\r\n    effects: [\r\n      {\r\n        name: `Born From Agony`,\r\n        desc: `At the end of the battleshock phase, you can roll a dice for this general. On a 6, heal all wounds allocated to this general.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Teachings of the Turscoll': {\r\n    effects: [\r\n      {\r\n        name: `Teachings of the Turscoll`,\r\n        desc: `If this general is on the battlefield at the start of the first battle round, before priority is determined, you can declare that the Tides of Death table will be reversed for your army. If you do so, the Ebb Tide ability applies in the first battle round, the High Tide ability applies in the second battle round, the Flood Tide ability applies in the third battle round, and the Low Tide ability applies in the fourth battle round, From the fifth battle round, the four Tides of Death steps are repeated in this order, starting with Ebb Tide.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Storm and Sea': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Storm and Sea`,\r\n        desc: `Do not take battleshock tests for friendly IDONETH DEEPKIN units wholly within 12\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Ancient Pride': {\r\n    effects: [\r\n      {\r\n        name: `Ancient Pride - Passive`,\r\n        desc: `Effect: If the unmodified hit roll for a combat attack that targets this unit is 1-3, the attack fails and the attack sequence ends.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nightmare Legacy': {\r\n    effects: [\r\n      {\r\n        name: `Nightmare Legacy`,\r\n        desc: `Declare: Pick a visible enemy unit that had any damage points allocated to it this turn by an ability used by this unit to be the target. \r\n        Effect: Subtract D6 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Endless Sea Storm': {\r\n    effects: [\r\n      {\r\n        name: `Endless Sea Storm`,\r\n        desc: `If this general successfully casts a an unmodified casting roll of 7+, this general can attempt to cast 1 extra spell in that phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_SETUP, END_OF_TURN, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n /* Ionrach: {\r\n    effects: [\r\n      {\r\n        name: `Legacy of Glory`,\r\n        desc: `You can carry out this heroic action with a friendly IONRACH AKHELIAN HERO instead of any other heroic action you can carry out with that HERO. If you do so, pick 1 friendly IONRACH AKHELIAN unit wholly within 12\" of that HERO. Until the end of that turn, you can choose for that unit to be affected by either the Flood Tide or Ebb Tide ability from the Tides of Death table in addition to any other abilities from the Tides of Death table they are affected by.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  \r\n  'Namarti Corps': {\r\n    effects: [\r\n      {\r\n        name: `Surge Forward - Passive`,\r\n        desc: `Effect: You can re-roll run rolls and charge rolls for friendly Namarti units while they are wholly within 12\" of a friendly Akhelian unit.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n'Akhelian Beastmasters': {\r\n    effects: [\r\n      {\r\n        name: `Ferocious Predators - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks made with Companion weapons by friendly Akhelian units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Isharann Council': {\r\n    effects: [\r\n      {\r\n        name: `Wisdome of the Deep - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls, Isharann ritual rolls and lurelight rolls for friendly Isharann units while they are within the combat ranges of any other friendly Isharann units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Fuethan: {\r\n    effects: [\r\n      {\r\n        name: `Bloodthirsty Shiver`,\r\n        desc: `You can include Bloodthirsty Shivers in your army (pg 96). If the unmodified hit roll for an attack made by a unit in a Bloodthirsty Shiver is a 6, that attack automatically wounds (do not make a wound roll).`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  \"Soul-Raid Ambushers\": {\r\n    effects: [\r\n      {\r\n        name: `Fade Like Mist - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin Infantry or Cavalry unit wholly within 3\" of a terrain feature. \r\n        Effect: Remove that unit from the battlefield and set it up in reserve travelling the ethersea (see the Raiders from the Deep ability).`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* Nautilar: {\r\n    mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Crushing Assault'])],\r\n    },\r\n    effects: [],\r\n  },\r\n\r\n  Briomdar: {\r\n    effects: [\r\n      {\r\n        name: `Supreme Soulscryers`,\r\n        desc: `During deployment, if you set up a friendly BRIOMDAR SOULSCRYER using the Finder Of Ways ability, up to 3 friendly BRIOMDAR IDONETH DEEPKIN units can join that SOULSCRYER instead of up to 2. In addition, when you set up any units that can join that SOULSCRYER, you can set up those units wholly within 12\" of that SOULSCRYER and more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Akhelian Pursuit': {\r\n    effects: [\r\n      {\r\n        name: `Akhelian Pursuit`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly AKHELIAN units wholly within enemy territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Creeping Gloomtide': {\r\n    effects: [\r\n      {\r\n        name: `The Creeping Gloomtide`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are any Gloomtide Shipwrecks in your army on the battlefield and all of them are more than 3\" from all enemy units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Dominion of the Deep Ones': {\r\n    effects: [\r\n      {\r\n        name: `Dominion of the Deep Ones`,\r\n        desc: `When the battle ends, you complete this grand strategy if the only MONSTERS on the battlefield are friendly LEVIADONS.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Namarti Assault': {\r\n    effects: [\r\n      {\r\n        name: `Namarti Assault`,\r\n        desc: `When the battle ends, you complete this grand strategy if 2 or more friendly NAMARTI units are within 3\" of any enemy units, or if the only Battleline units on the battlefield are friendly NAMARTI units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Crushing Assault': {\r\n    effects: [\r\n      {\r\n        name: `Crushing Assault`,\r\n        desc: `You can carry out this monstrous rampage with a friendly NAUTILAR LEVIADON instead of any other monstrous rampage you can carry out with that LEVIADON. If you do so, change the Rend characteristic of that LEVIADON'S Massive Scythed Fins and Crushing Jaws to -3 until the end of the next combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, SAVES_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst MountTraits = {\r\n/*  'Swift-finned Impaler': {\r\n    effects: [\r\n      {\r\n        name: `Swift-finned Impaler`,\r\n        desc: `If the roll for this unit's Deepmare Horn ability roll is a 6, the target suffers D6 mortal wounds instead of D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Savage Ferocity': {\r\n    effects: [\r\n      {\r\n        name: `Savage Ferocity`,\r\n        desc: `Add 1 to the attacks characteristic of this unit's Fangs and Talons and its Lashing Tails.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Voidchill Darkness': {\r\n    effects: [\r\n      {\r\n        name: `Voidchill Darkness`,\r\n        desc: `Subtract 1 from hit rolls for attacks made by enemy units that are within 3\" of this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ancient: {\r\n    effects: [\r\n      {\r\n        name: `Ancient`,\r\n        desc: `If the Rend characteristic of a weapon used for an attack that targets this unit is -1, change it to '-' for that attack.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Denizen of the Darkest Depths': {\r\n    effects: [\r\n      {\r\n        name: `Denizen of the Darkest Depths`,\r\n        desc: `Subtract 1 from wound rolls for attacks made with melee weapons that target this unit that have a Damage characteristic of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reverberating Carapace': {\r\n    effects: [\r\n      {\r\n        name: `Reverberating Carapace`,\r\n        desc: `Increase the range of this unit's Void Drum ability from 12\" to 15\".`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MountTraits, 'mount_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME, START_OF_SETUP, WARDS_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Scenery = {\r\n /* 'Gloomtide Shipwreck': {\r\n    effects: [\r\n      {\r\n        name: `Set-Up`,\r\n        desc: `After territories are determined, you can set up this faction terrain feature wholly within your territory and more than 3\" from all objectives and other terrain features. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.\r\n\r\n        This faction terrain feature consists of 2 scenery pieces. When you set it up, you can set up the 2 scenery pieces touching, or you can set them up more than 3\" from each other. If you set them up touching, they form 1 large Gloomtide Shipwreck. If you set them up more than 3\" from each other, they form 2 small Gloomtide Shipwrecks that are separate faction terrain features.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Defensible`,\r\n        desc: `If this terrain feature was set up as a small Gloomtide Shipwreck, it is a defensible terrain feature that can be garrisoned by up to 5 Idoneth Deepkin models with a Wounds characteristic of 5 or less that do not have mounts (with the exception of companions).\r\n        \r\n        If this terrain feature was set up as a large Gloomtide Shipwreck, it is a defensible terrain feature that can be garrisoned by up to 10 Idoneth Deepkin models with a Wounds characteristic of 5 or less that do not have mounts (with the exception of companions).`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.BATTLETOME_IDONETH_DEEPKIN, rule_sources.ERRATA_JANUARY_2023],\r\n      },\r\n      {\r\n        name: `Guardians of the Deep`,\r\n        desc: `IDONETH DEEPKIN units that do not have a mount have a ward of 5+ while they are wholly within 6\" of this terrain feature. If a unit that does not have the IDONETH DEEPKIN keyword is within 3\" of this terrain feature, this ability has no effect.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst Spells = {\r\n  'Lore of the Deeps': {\r\n    effects: [\r\n      {\r\n        name: `Steed of Tides: Casting value of 6 (UNLIMITED) `,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin Wizard to cast this spell, pick a visible friendly Idoneth Deepkin unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Corrasion: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from the Rend characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pressure of the Deep: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Counter-current': {\r\n    effects: [\r\n      {\r\n        name: `Counter-current`,\r\n        desc: `Casting value of 6 and range of 18\". If cast, pick 1 enemy unit within range and visible to the caster. Until your next hero phase, halve run rolls and charge rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pressure of the Deep': {\r\n    effects: [\r\n      {\r\n        name: `Pressure of the Deep`,\r\n        desc: `Casting value of 7 and range of 12\". If cast, pick 1 enemy model within range that is visible to the caster and roll a dice. If the dice roll is greater than that model's Wounds characteristic, it is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Arcane Corrasion': {\r\n    effects: [\r\n      {\r\n        name: `Arcane Corrasion`,\r\n        desc: `Casting value of 6 and range of 12\". If cast, pick 1 enemy unit within range and visible to the caster. Worsen the Rend characteristic of that unit's melee weapons by 1 until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit spells\r\n  'Cloying Seas Mists': {\r\n    effects: [\r\n      {\r\n        name: `Cloying Seas Mists`,\r\n        desc: `Casting value of 6 and range of 12\". If cast, pick 1 friendly IDONETH DEEPKIN unit, or 1 enemy unit, within range and visible to the caster. If you picked a friendly IDONETH DEEPKIN unit, heal up to D3 wounds allocated to that unit. If you picked an enemy unit, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tsunami of Terror': {\r\n    effects: [\r\n      {\r\n        name: `Tsunami of Terror`,\r\n        desc: `Casting value of 7 and range of 18\". If cast, pick up to 3 enemy units within range and visible to the caster. Subtract 1 from save rolls for attacks made with melee weapons that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_IDONETH_DEEPKIN,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  Riptide: {\r\n    effects: [\r\n      {\r\n        name: `Riptide`,\r\n        desc: `Casting value of 7 and range of 18\". If cast, pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. In addition, subtract 1 from hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_START_OF_TURN,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst DeepmareHornEffect = {\r\n /* name: `Deepmare Horn`,\r\n  desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true, */\r\n}\r\nconst StormshoalEffect = {\r\n /* name: `Stormshoal`,\r\n  desc: `This unit has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true, */\r\n}\r\nconst GiftsOfTheDepthsEffect = {\r\n /* name: `Gifts of the Depths`,\r\n  desc: `This unit has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true, */\r\n}\r\nconst WarmasterEffect = {\r\n /* name: `Warmaster`,\r\n  desc: `If this unit is included in an IDONETH DEEPKIN army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true, */\r\n}\r\nconst IconBearerChampionEffect = {\r\n /* name: `Champion`,\r\n  desc: `1 model in this unit can be an Icon Bearer. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst AkhelianGuardStandardBearerAndMusicianEffects = [\r\n /* {\r\n    name: `Standard Bearer`,\r\n    desc: `1 in every 3 models in this unit can be a Standard Bearer. Add 1 to the Bravery characteristic of this unit if it includes any Standard Bearers.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  }, \r\n  {\r\n    name: `Musician`,\r\n    desc: `1 in every 3 models in this unit can be a Musician. Add 1 to charge rolls for this unit if it includes any Musicians.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  }, */\r\n]\r\n\r\nconst Units = {\r\n  'Eidolon of Mathlann, Aspect of the Storm': {\r\n    effects: [\r\n      //StormshoalEffect,\r\n      {\r\n        name: `Crashing Upon the Foe - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Drench with Hate - Passive`,\r\n        desc: `Effect: Add 1 to wound rolls for combat attacks made by friendly Idoneth Deepkin units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Pulled Into the Depths - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eidolon of Mathlann, Aspect of the Sea': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Cloying Seas Mists', 'Tsunami of Terror'])],\r\n    }, */\r\n    effects: [\r\n    /*  GenericEffects.WizardTwoSpellsEffect,\r\n      StormshoalEffect, */\r\n      {\r\n        name: `Dormant Energies - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Tranquillity of the Abyss`,\r\n        desc: `Effect: Ignore negative modifiers to the control scores of friendly Idoneth Deepkin units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Dormant Energies: Casting value of 8`,\r\n        desc: `Declare: Pick up to 3 different visible enemy units within 12\" of this unit to be the targets, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from save rolls for combat attacks that target those units until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Vengeful Waves - Once Per Turn`,\r\n        desc: `Declare: If this unit has not charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Volturnos, High King of the Deep': {\r\n    effects: [\r\n     // WarmasterEffect,\r\n      {\r\n        name: `Cealith, the High King's Shield`,\r\n        desc: `Effect: This unit has Ward (3+) against mortal damage inflicted by Spell abilities, Prayer abilities or abilities used by Manifestations.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `First Among Akhelians - Passives`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks made by other friendly Akhelian units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // DeepmareHornEffect,\r\n      {\r\n        name: `Supreme Lord of Tides - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 other friendly Idoneth Deepkin units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Akhelian Thrallmaster': {\r\n    effects: [\r\n      {\r\n        name: `Akhelian Fighting Stance`,\r\n        desc: `Effect: Pick 1 of the following eects to apply to this unit and any friendly Namarti units wholly within 12\" of this unit for the rest of the turn. \r\n        Way of the Riptide: Those units melee weapons have Crit (2 Hits). \r\n        Way of the Vortex: Subtract 1 from wound rolls for attacks that target those units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Thrallmaster - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Namarti Thralls unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Akhelian King': {\r\n    effects: [\r\n     // DeepmareHornEffect,\r\n      {\r\n        name: `Akhelian Paragon - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Akhelian Cavalry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wave Rider`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Add 1 to the Rend characteristic of this units Akhelian Royal Weapons for attacks that target that enemy unit for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Isharann Tidecaster': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Riptide'])],\r\n    }, */\r\n    effects: [\r\n      //GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Master of the Ethersea - Once Per Turn`,\r\n        desc: `Declare: Make an Isharann ritual roll of D6. \r\n        Effect: On a 3+, pick 1 of the following effects to apply until the start of your next turn: \r\n        Creeping Mist: Friendly Idoneth Deepkin units cannot be targeted by shooting attacks unless the attacking model is within 12\" of them. \r\n        Surging Stream: Add 1 to run rolls and charge rolls for friendly Idoneth Deepkin units. \r\n        Spiteful Riptide: Each time an enemy unit uses a Retreat ability, after the effect of that ability has been resolved, inflict D3 mortal damage on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // GiftsOfTheDepthsEffect,\r\n    ],\r\n  },\r\n  'Isharann Soulscryer': {\r\n    effects: [\r\n      {\r\n        name: `Finder of Ways`,\r\n        desc: `Declare: Pick a friendly Idoneth Deepkin unit that is travelling the ethersea to be the target. \r\n        Effect: Set up the target wholly within 12\" of this unit and more than 7\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Cyfar Compass - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero within 18\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to wound rolls for combat attacks made by friendly Idoneth Deepkin units that target that unit for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // GiftsOfTheDepthsEffect,\r\n    ],\r\n  },\r\n  'Isharann Soulrender': {\r\n    effects: [\r\n      {\r\n        name: `Lurelight`,\r\n        desc: `Declare: Pick up to 3 different friendly Namarti units wholly within 12\" of this unit to be the targets. You cannot pick the same unit to be the target of this ability more than once per turn. Make a lurelight roll of D3 for each target unit. \r\n        Effect: On a 2+, return a number of slain models to the target unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hangman's Knot - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll 2D6. If the roll exceeds the targets Health characteristic, it is automatically destroyed.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // GiftsOfTheDepthsEffect,\r\n    ],\r\n  },\r\n  'Akhelian Allopexes': {\r\n    effects: [\r\n      {\r\n        name: `Bloodthirsty Predators - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Allopexs Ferocious Bite while it is within 6\" of any damaged enemy units or while it is within 6\" of any enemy units that had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ensnared`,\r\n        desc: `Declare: Pick an enemy Monster or Cavalry unit that had any damage points allocated to it this turn by this units shooting attacks to be the target. \r\n        Effect: Roll a dice. On a 3+, until the start of your next turn, subtract 1 from the number of dice rolled when making charge rolls for the target, to a minimum of 1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lotann, Warden of the Soul Ledgers': {\r\n    effects: [\r\n      {\r\n        name: `Catalogue of Souls - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of friendly Idoneth Deepkin units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // GiftsOfTheDepthsEffect,\r\n      {\r\n        name: `Fount of Willpower - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Isharann units while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Akhelian Leviadon': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Leviadons Scythed Fins and Crushing Jaws is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Void Drum - Passive`,\r\n        desc: `Effect: Friendly Idoneth Deepkin units have Ward (5+) while they are wholly within 6\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Crushing Charge - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit within 1\" of it to be the target. \r\n        Effect: Roll a dice. Add 1 to the roll if the target unit has more than 10 models. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Akhelian Morrsarr Guard': {\r\n    effects: [\r\n     // ...AkhelianGuardStandardBearerAndMusicianEffects,\r\n      {\r\n        name: `Biovoltaic Blast`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target, then roll a number of dice equal to the number of models in this unit. \r\n        Effect: For each 4-5, inflict 1 mortal damage on the target. For each 6, inflict D3 mortal damage on the target. Add 1 to each roll if there are more models in the target unit than this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Akhelian Ishlaen Guard': {\r\n    effects: [\r\n      {\r\n        name: `Galv-Shields - Passive`,\r\n        desc: `Effect: This unit has Ward (5+) if it charged in the same turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      //...AkhelianGuardStandardBearerAndMusicianEffects,\r\n      {\r\n        name: `Biovoltaic Barrier`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from the Attacks characteristic of the target units weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Namarti Thralls': {\r\n    effects: [\r\n     // IconBearerChampionEffect,\r\n      {\r\n        name: `Sweeping Blows - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Lanmari for attacks that target enemy Monsters.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Namarti Reavers': {\r\n    effects: [\r\n      //IconBearerChampionEffect,\r\n      {\r\n        name: `Strike on the Move - Passive`,\r\n        desc: `Effect: This unit can use Shoot abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Elathain Ill-fated': {\r\n    effects: [\r\n      {\r\n        name: `Soulnet`,\r\n        desc: `Once per battle, at the end of the combat phase, you can pick 1 enemy HERO that has a Wounds characteristic of 7 or less, does not have a mount and is within 3\" of this model and roll 2D6. If the roll is greater than the that enemy model's Wounds characteristic, it is slain.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Envenomed Bite`,\r\n        desc: `If the unmodified hit roll for an attack made with this unit's Envenomed Bite is 6, that attack inflicts 1 mortal wound on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Lurelight`,\r\n        desc: `At the end of the battleshock phase, you can pick 1 friendly NAMARTI unit wholly within 18\" of this unit and return up to D3 slain models to that unit. You can return up to 3 slain models to that unit instead if any enemy models were slain by attacks made with this this unit's Talunsickle and Soulnet in the same turn. The same unit cannot be affected by the Lurelight ability more than once per turn.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n     // GiftsOfTheDepthsEffect,\r\n    ],\r\n  },\r\n  \"Elathain's Soulraid\": {\r\n    effects: [\r\n      {\r\n        name: `Fuirann's Shield`,\r\n        desc: `Fuirann has a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: Fjori`s Flamebearers': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { IDONETH_DEEPKIN } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport MountTraits from './mount_traits'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_traits: [CommandTraits],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    mount_traits: [MountTraits],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [IDONETH_DEEPKIN]: {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [IDONETH_DEEPKIN]),\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { IDONETH_DEEPKIN } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const IdonethDeepkinFaction = new Faction(\r\n  IDONETH_DEEPKIN,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_IDONETH_DEEPKIN\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_KHORNE: {\r\n    name: 'Battletome: Blades of Khorne',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2023/04/PF2QaiUfiT3X0VQR.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n /* Gorecleaver: {\r\n    effects: [\r\n      {\r\n        name: `Gorecleaver`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Improve the Rend characteristic of that weapon by 1. In addition, if the unmodified hit roll for an attack made with that weapon is 6, that attack causes 1 mortal wound to the target in addition to any damage it inflicts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Crimson Plate': {\r\n    effects: [\r\n      {\r\n        name: `The Crimson Plate`,\r\n        desc: `The bearer has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Rune': {\r\n    effects: [\r\n      {\r\n        name: `Blood Rune`,\r\n        desc: `At the end of the combat phase, if any wounds caused by an attack made by the bearer were allocated to a HERO or MONSTER and not negated, you receive 1 Blood Tithe point.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Banner of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Banner of Blood`,\r\n        desc: `BLOODSECRATOR only. You can reroll charge rolls for friendly BLADES OF KHORNE units wholly within 16\" of the bearer.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Ar'gath, the King of Blades\": {\r\n    effects: [\r\n      {\r\n        name: `Ar'gath, the King of Blades`,\r\n        desc: `Ward rolls cannot be made for enemy units while they are within 3\" of the bearer.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */  \r\n  \"Ar'gath, the King of Blades\": {\r\n    effects: [\r\n      {\r\n        name: `Ar'gath, the King of Blades`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Ward rolls cannot be made for the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Collar of Contempt': {\r\n    effects: [\r\n      {\r\n        name: `Collar of Contempt - Passive`,\r\n        desc: `Effect: This unit can use Unbind abilities as if it had Wizard (1). Each time this unit unbinds a spell, inflict D3 mortal damage on the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Halo of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Halo of Blood - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to this units control score and to hit rolls and wound rolls for this units attacks.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { KHORNE } from 'meta/factions'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\n\r\nconst BattleTraits = {\r\n  [KHORNE]: {\r\n    effects: [\r\n      {\r\n        name: `Spelleater Curse - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Declare: You can only use this ability if you have not used any Blood Tithe abilities this turn. Spend 2 blood tithe points. \r\n        Effect: That spell is unbound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Slaughter Triumphant`,\r\n        desc: `Declare: You can only use this ability if you have not used any Blood Tithe abilities this turn. Spend 8 blood tithe points. \r\n        Effect: Pick 1 of the following effects:  \r\n        Add 1 to the Attacks characteristic of melee weapons used by friendly Blades of Khorne units for the rest of the battle.  \r\n        Pick a friendly non-Unique Bloodthirster unit that has been destroyed. Set up an identical replacement unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Murderlust`,\r\n        desc: `Declare: You can only use this ability if you have not used any Blood Tithe abilities this turn. Spend 1 blood tithe point and pick a friendly Blades of Khorne unit that is not in combat to be the target. \r\n        Effect: The target can move 3\". It can move into combat.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_KHORNE, meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Brass Skull Meteor`,\r\n        desc: `Declare: You can only use this ability if you have not used any Blood Tithe abilities this turn. Spend 4 blood tithe points and pick an enemy unit that is visible to a friendly Blades of Khorne Hero to be the target. \r\n        Effect: Roll 8 dice. For each 3+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_KHORNE, meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Heads Must Roll`,\r\n        desc: `Declare: You can only use this ability if you have not used any Blood Tithe abilities this turn. Spend 6 blood tithe points. \r\n        Effect: For the rest of the turn, add 1 to the Rend characteristic of melee weapons used by friendly Blades of Khorne units.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_KHORNE, meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE],\r\n      },\r\n      {\r\n        name: `Skull Altar (Faction Terrain) - Words of Hate - Passive`,\r\n        desc: `Effect: While this terrain feature has an Invoker:  \r\n        Add 1 to chanting rolls for the Invoker.  \r\n        The Invoker cannot use Move abilities.  \r\n        Instead of measuring range or visibility to the Invoker, measure to this terrain feature instead.  \r\n        All attacks that would target the Invoker target this terrain feature instead.  \r\n        If this terrain feature is destroyed, before removing it from the battlefield, inflict D3 mortal damage on the Invoker. Then, set up the Invoker on the battlefield wholly within 3\" of this terrain feature and not in combat. That unit is no longer an Invoker. If it is not possible to set up the Invoker, it is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Skull Altar (Faction Terrain) - Ascend the Altar`,\r\n        desc: `Declare: If this terrain feature does not have an Invoker, pick a friendly Blades of Khorne Infantry Priest within 3\" of it to be the target. \r\n        Effect: Place the target on this terrain feature. The target is now an Invoker (see Words of Hate).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Skull Altar (Faction Terrain) - Descend the Altar`,\r\n        desc: `Effect: If this terrain feature has an Invoker, set up the Invoker on the battlefield wholly within 6\" of this terrain feature and not in combat. That unit is no longer an Invoker.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Skull Altar (Faction Terrain) - Hatred of Sorcery - Reaction: A friendly unit within 18\" of this terrain feature was picked to be the target of an enemy spell`,\r\n        desc: `Effect: Roll a dice. On a 5+:  \r\n        If this terrain feature has an Invoker, gain 1 blood tithe point.  \r\n        Ignore the effect of that spell on that friendly unit. \r\n        This terrain feature can use this ability more than once per phase but you can only roll once for each friendly unit per spell cast.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Blood Tithe': {\r\n    effects: [\r\n      {\r\n        name: `The Blood Tithe - Passive`,\r\n        desc: `Effect: You start the battle with 0 blood tithe points. Earn 1 blood tithe point each time a unit (friendly or enemy) is destroyed.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n  /*'Blood for the Altar': {\r\n    effects: [\r\n      {\r\n        name: `Blood for the Altar`,\r\n        desc: `Pick 1 enemy unit within 8\" of your Skull Altar. You complete this battle tactic if that enemy unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slay the Sorcerer': {\r\n    effects: [\r\n      {\r\n        name: `Slay the Sorcerer`,\r\n        desc: `Pick 1 enemy WIZARD HERO on the battlefield. You complete this battle tactic if that HERO is slain during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Trial of Skulls': {\r\n    effects: [\r\n      {\r\n        name: `The Trial of Skulls`,\r\n        desc: `Pick 1 friendly unit. You complete this battle tactic if 8 or more enemy models are slain by attacks made by that unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'No Cowards Among Us': {\r\n    effects: [\r\n      {\r\n        name: `No Cowards Among Us`,\r\n        desc: `You complete this battle tactic at the end of this turn if all friendly BLADES OF KHORNE units on the battlefield are within 8\" of any enemy units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Leave None Standing': {\r\n    effects: [\r\n      {\r\n        name: `Leave None Standing`,\r\n        desc: `Pick 1 friendly unit within 3\" of any enemy units. You complete this battle tactic if that unit fights in the combat phase of this turn and at the end of that phase there are no enemy units within 3\" of that unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Battlefield Runs Red': {\r\n    effects: [\r\n      {\r\n        name: `The Battlefield Runs Red`,\r\n        desc: `You complete this battle tactic if 4 or more units were destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  /*'Rejoice in Exalted Slaughter': {\r\n    effects: [\r\n      {\r\n        name: `Rejoice in Exalted Slaughter`,\r\n        desc: `You can use this command ability at the start of the combat phase. The command must be issued by this model and received by a friendly KHORNE DAEMON unit. In that combat phase, the unit that receives the command is eligible to fight if it is within 6\" of an enemy unit instead of 3\", and models from that unit can move an extra 3\" when they pile in.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"The Butcher's Due\": {\r\n    effects: [\r\n      {\r\n        name: `The Butcher's Due`,\r\n        desc: `You can use this command ability at the start of the combat phase. The command must be issued by this model and received by a friendly KHORNE unit. Add 1 to wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"'Bring Me Their Skull!'\": {\r\n    effects: [\r\n      {\r\n        name: `'Bring Me Their Skull!'`,\r\n        desc: `You can use this command ability at the start of the combat phase. This unit must issue the command and the unit that receives the command must be a friendly GORECHOSEN unit. The strike-first effect applies to that GORECHOSEN unit until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Relentless Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Relentless Hunger - Passive`,\r\n        desc: `Effect: If this unit is picked to be the target of the Murderlust ability, it can move 6\" instead of 3\".`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Firebrand: {\r\n    effects: [\r\n      {\r\n        name: `Firebrand - Passive`,\r\n        desc: `Effect: If this unit is not a Priest, it has Priest (1). If this unit is already a Priest, add 1 to banishment rolls for it instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Favoured of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `Favoured of Khorne - Passive`,\r\n        desc: `Effect: You begin the battle with 1 blood tithe point.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  /*'Unrelenting Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Unrelenting Hunter`,\r\n        desc: `At the end of the combat phase, if this general fought in that phase and is within 3\" of any enemy units, this general can make a pile-in move. Alternatively, at the end of the combat phase, if this general fought in that phase and is more than 3\" from all enemy units, this general can make a normal move or attempt a charge.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Diabolical Purpose': {\r\n    effects: [\r\n      {\r\n        name: `Diabolical Purpose`,\r\n        desc: `Add 1 to the Damage characteristic of attacks made by this general that target an enemy HERO.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Barbarian Lord': {\r\n    effects: [\r\n      {\r\n        name: `Barbarian Lord`,\r\n        desc: `Add 1 to run rolls and charge rolls for this general and for friendly BLOODREAVERS, CLAWS OF KARANAK and FLESH HOUNDS units while they are wholly within 16\" of this general.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of the Gorechosen': {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Gorechosen`,\r\n        desc: `Add 1 to the Attacks characteristic of melee weapons used by friendly GORECHOSEN units while they are wholly within 16\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'High-priest of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `High-priest of Khorne`,\r\n        desc: `PRIEST only. In each of your hero phases, your general can chant 2 prayers that they know instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, HERO_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\n// Endless prayers.\r\nconst EndlessSpells = {\r\n/*  'Hexgorger Skulls': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 3 and a range of 8\". If answered, set up the parts of the invocation wholly within range and visible to the chanter, within 8\" of each other and more than 1\" from all models, other invocations and endless spells. Only BLADES OF KHORNE PRIESTS can attempt to summon this invocation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Compelled by Hate`,\r\n        desc: `After this invocation is set up and at the start of each of their hero phases, the commanding player can move the parts of this invocation as if they were models with a Move characteristic of 8\" and that can fly. After the parts have been moved, they must be within 8\" of each other.`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hexgorgers`,\r\n        desc: `Subtract 2 from casting rolls for WIZARDS that are within 8\" of any Hexgorger Skulls. In addition, if a WIZARD within 8\" of this invocation attempts to cast a spell and the unmodified casting roll is 8, then that casting attempt is not successful, that WIZARD no longer knows that spell, each WIZARD within 8\" of this invocation suffers D6 mortal wounds, and then this invocation is removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bleeding Icon': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 3 and a range of 8\". If answered, set up this invocation wholly within range and visible to the chanter, and more than 1\" from all models, other invocations and endless spells. Only BLADES OF KHORNE PRIESTS can attempt to summon this invocation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Drifting Menace`,\r\n        desc: `After this invocation is set up and at the start of each of their hero phases, the commanding player can move this invocation as if it were a model with a Move characteristic of 8\" and that can fly.`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sigil of Doom`,\r\n        desc: `Units cannot receive the Inspiring Presence command while they are within 8\" of this invocation. In addition, if a unit fails a battleshock test within 8\" of any Bleeding Icons, roll a dice. On a 1-5, add D3 to the number of models that flee. On a 6, add D6 to the number of models that flee, and then this invocation is removed from play. This ability has no effect on KHORNE units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath-Axe': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This invocation is summoned with a prayer that has an answer value of 4 and a range of 8\". If answered, set up this invocation wholly within range and visible to the chanter, and more than 1\" from all models, other invocations and endless spells. Only BLADES OF KHORNE PRIESTS can attempt to summon this invocation.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flung With Fury`,\r\n        desc: `After this invocation is set up and at the start of each of their hero phases, the commanding player can move this invocation as if it were a model with a Move characteristic of 8\" and that can fly.`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hatred's Edge`,\r\n        desc: `After this invocation has moved, roll a dice for each unit that has any models it passed across. On a 2+, that unit suffers D3 mortal wounds. Then, the commanding player can pick 1 unit within 3\" of this invocation and roll a dice. On a 1, nothing happens. On a 2-5, that unit suffers D3 mortal wounds. On a 6, that unit suffers D6 mortal wounds, and then this invocation is removed from play.`,\r\n        when: [HERO_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Khornate Legion': {\r\n    effects: [\r\n      {\r\n        name: `Butcher's of Nations - Once Per Turn - Reaction: You declared a Fight ability for a friendly Blades of Khorne Daemon unit`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a friendly Bloodbound unit that has not used a Fight ability this turn and is within 12\" of the unit using this ability to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* Bloodlords: {\r\n    effects: [\r\n      {\r\n        name: `The First to Draw Blood`,\r\n        desc: `When you use the Decapitating Blow ability for a BLOODLORDS BLOODLETTER unit, mortal wounds are caused on an unmodified roll of 5+ instead of 6 if that unit made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Goretide: {\r\n    effects: [\r\n      {\r\n        name: `Tireless Conquerors`,\r\n        desc: `Add 1 to wound rolls for attacks made with melee weapons by friendly GORETIDE BLOODBOUND units that target an enemy unit that is contesting an objective you do not control, or that target an enemy unit wholly within enemy territory.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  'Murder Host': {\r\n    effects: [\r\n      {\r\n        name: `Strength through Slaughter - Passive`,\r\n        desc: `Effect: If a friendly non-Monster Blades of Khorne Daemon uses a Fight ability, it has Ward (5+) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Brass Stampede': {\r\n    effects: [\r\n      {\r\n        name: `Obliterating Charge - Passive`,\r\n        desc: `Effect: If the unmodified charge roll for a friendly Blades of Khorne Cavalry unit is 8+, it has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Bloodbound Warhorde': {\r\n    effects: [\r\n      {\r\n        name: `Tireless Conquerors - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks made by friendly Bloodbound units that target an enemy unit that is contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME, TURN_ONE_START_OF_TURN } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'The Blood Legions March': {\r\n    effects: [\r\n      {\r\n        name: `The Blood Legions March`,\r\n        desc: `When the battle ends, you complete this grand strategy if in every battle round after the first you summoned any BLADES OF KHORNE DAEMON units to the battlefield by spending Blood Tithe points.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"'Bring Me A Worthy Skull'\": {\r\n    effects: [\r\n      {\r\n        name: `'Bring Me A Worthy Skull'`,\r\n        desc: `At the start of the first battle round, ask your opponent to pick 1 HERO from their army to be the worthy foe. When the battle ends, you complete this grand strategy if that HERO has been slain and the model picked to be your general has not been slain.`,\r\n        when: [TURN_ONE_START_OF_TURN, END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Reap the Blood Tithe': {\r\n    effects: [\r\n      {\r\n        name: `Reap the Blood Tithe`,\r\n        desc: `When the battle ends, you complete this grand strategy if in every battle round after the first, you spent Blood Tithe points to use a Blood Tithe Reward and you did not use the same Blood Tithe Reward more than once.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Disciples of Carnage': {\r\n    effects: [\r\n      {\r\n        name: `Disciples of Carnage`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed was from the 'For the Skull Throne' list.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Prayers = {\r\n 'Blood Blessings of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `Unholy Flames: Chant value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Blades of Khorne Priest to chant this prayer, pick a visible friendly Blades of Khorne unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Add 1 to the Rend characteristic of the targets melee weapons for the rest of the turn. In addition, if the chanting roll was 10+, add 1 to wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Witchbane Curse: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Blades of Khorne Priest to chant this prayer, pick a visible enemy Wizard within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract 1 from the targets power level, to a minimum of 0, until the end of your next turn. In addition, if the chanting roll was 8+, inflict 3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Boil: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Blades of Khorne Priest to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target. In addition, if the chanting roll was 8+, subtract 1 from wound rolls for the target until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Blood Sacrifice': {\r\n    effects: [\r\n      {\r\n        name: `Blood Sacrifice`,\r\n        desc: `Answer value of 4 and a range of 8\". If answered, pick 1 friendly BLADES OF KHORNE unit wholly within range and visible to the chanter. That unit suffers D3 mortal wounds and you receive 1 Blood Tithe point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Killer Instinct': {\r\n    effects: [\r\n      {\r\n        name: `Killer Instinct`,\r\n        desc: `Answer value of 3 and a range of 16\". If answered, pick 1 friendly BLADES OF KHORNE unit wholly within range, visible to the chanter and more than 3\" from all enemy units. That unit can make a normal move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Witchbane Curse': {\r\n    effects: [\r\n      {\r\n        name: `Witchbane Curse`,\r\n        desc: `Answer value of 4. If answered, pick 1 enemy WIZARD unit visible to the chanter. Until the start of your next hero phase, subtract 1 from casting rolls made for that unit. In addition, until the start of your next hero phase, each time that unit attempts to cast a spell and that spell is not successfully cast, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unholy Flames': {\r\n    effects: [\r\n      {\r\n        name: `Unholy Flames`,\r\n        desc: `Answer value of 4 and a range of 16\". If answered, pick 1 friendly BLADES OF KHORNE unit wholly within range and visible to the chanter. Until the start of your next hero phase, improve the Rend characteristic of that unit's melee weapons by 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Boil': {\r\n    effects: [\r\n      {\r\n        name: `Blood Boil`,\r\n        desc: `Answer value of 4 and a range of 16\". If answered, pick 1 enemy unit within range and visible to the chanter. That enemy unit suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodbind: {\r\n    effects: [\r\n      {\r\n        name: `Bloodbind`,\r\n        desc: `Answer value of 3 and a range of 16\". If answered, pick 1 enemy unit within range, visible to the chanter and more than 3\" from all friendly units. Your opponent must make a move of up to 8\" with that unit. All of the models in that unit must finish that move as close as possible to the chanter and can finish that move within 3\" of units in your army.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wound the Realm': {\r\n    effects: [\r\n      {\r\n        name: `Wound the Realm`,\r\n        desc: `Answer value of 4 and a range of 16\". If answered, pick 1 point on the battlefield within range and visible to the chanter and draw a straight line between that point and the closest part on the chanter's base. Roll a dice for each enemy unit passed across by that line. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodmark: {\r\n    effects: [\r\n      {\r\n        name: `Bloodmark`,\r\n        desc: `Answer value of 3 and a range of 16\". If answered, pick 1 enemy unit within range and visible to the chanter. Until the start of your next hero phase, add 1 to wound rolls for attacks made by friendly BLADES OF KHORNE DAEMON units that target that enemy unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodhex: {\r\n    effects: [\r\n      {\r\n        name: `Bloodhex`,\r\n        desc: `Answer value of 4 and a range of 16\". If answered, pick 1 enemy unit within range and visible to the chanter. Until the start of your next hero phase, subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Call': {\r\n    effects: [\r\n      {\r\n        name: `Blood Call`,\r\n        desc: `Answer value of 3 and a range of 16\". Add 1 to the chanting roll if the chanter is within 3\" of any enemy units. If answered, pick 1 friendly BLOODLETTER HOST or 1 friendly BLOODCRUSHERS unit wholly within range and visible to the chanter. If the unit is a BLOODLETTER HOST, you can return D6 slain models to that unit. If it is a BLOODCRUSHERS unit, you can return 1 slain model to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n /* 'Skull Altar': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Defensible,\r\n      {\r\n        name: `Words of Hate`,\r\n        desc: `You can reroll chanting rolls for friendly BLADES OF KHORNE PRIESTS while they are wholly within 8\" of this terrain feature.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Witchbane`,\r\n        desc: `While any terrain features with this scenery rule are on the battlefield, if a spell is miscast, the caster suffers D6 mortal wounds instead of D3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Invoke Judgement`,\r\n        desc: `While a BLADES OF KHORNE PRIEST garrisons this terrain feature, double the range of any prayers it chants to summon invocations.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  TURN_TWO_END_OF_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Prayers from './prayers'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const BrassCladShieldEffect = {\r\n  name: `Brass-clad Shield`,\r\n  desc: `This unit has a ward of 5+ against mortal wounds caused by spells and mortal wounds caused by the abilities of endless spells.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst ScornOfSorceryEffect = {\r\n  name: `Scorn of Sorcery`,\r\n  desc: `This unit can attempt to unbind 1 spell in the enemy hero phase in the same manner as a WIZARD.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst MurderousChargeEffect = {\r\n  name: `Murderous Charge`,\r\n  desc: `After this unit makes a charge move, pick 1 enemy unit and roll a dice for each model in this unit that is within 3\" of that enemy unit. For each 2-4, that enemy unit suffers 1 mortal wound. For each 5+, that enemy unit suffers 2 mortal wounds.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst WarriorEffects = [\r\n  {\r\n    name: `Gorefists`,\r\n    desc: `If the unmodified save roll for an attack made with a melee weapon that targets a unit armed with Goreaxes and Gorefists is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `No Respite`,\r\n    desc: `If this unit is included in a Blades of Khorne army, each time a model in this unit is slain, you can make 2 murder rolls instead of 1.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst BraveryStandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `Add 1 to the Bravery characteristic of this unit while it includes any Icon Bearers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst ChargeMusicianEffect = {\r\n  name: `Musician`,\r\n  desc: `Add 1 to charge rolls for this unit while it includes any Hornblowers.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst CollarOfKhorneEffects = [\r\n  {\r\n    name: `Collar of Khorne`,\r\n    desc: `This unit can attempt to unbind one spell in the enemy hero phase in the same manner as a WIZARD.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Collar of Khorne`,\r\n    desc: `This unit can attempt to dispel one endless spell at the start of your hero phase in the same manner as a WIZARD.`,\r\n    when: [START_OF_HERO_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst UnflaggingHunterEffect = {\r\n  name: `Unflagging Hunter`,\r\n  desc: `Add 2 to charge rolls for this unit.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst SlaughterousChargeEffect = {\r\n  name: `Slaughterous Charge`,\r\n  desc: `After this unit makes a charge move, pick 1 enemy unit within 3\" of this unit and roll a dice. On a 2+. that enemy unit suffers 3 mortal wounds.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst DrawnInForTheKillEffect = {\r\n  name: `Drawn in for the Kill`,\r\n  desc: `At the start of the enemy movement phase, pick 1 enemy unit within 3\" of this model. That unit cannot retreat in that phase.`,\r\n  when: [START_OF_MOVEMENT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  // Daemons\r\n  Skarbrand: {\r\n    effects: [\r\n      {\r\n        name: `Roar of Total Rage - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll either 3 dice or a number of dice equal to the number of damage points this unit has. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skarbrand's Rage - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, or if it did not use a Fight ability last turn, or if it is the rst turn of the battle, the Attacks characteristic of its Slaughter is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Inescapable Wrath`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodthirster of Unfettered Fury': {\r\n    effects: [\r\n      {\r\n        name: `Beckon the Hunt`,\r\n        desc: `Declare: Pick a friendly non-Unique Blades of Khorne Daemon unit to be the target. \r\n        Effect: For the rest of the turn, add 1 to the number of dice rolled when making charge rolls for the target, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Mighty Axe of Khorne is 4 .`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ensnaring Lash - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: If the target is in combat with this unit when the target is picked to use a Fight ability:  \r\n        It must pick this unit to be the target of the pile-in move (Core Rules, 15.3).  \r\n        Subtract 1 from hit rolls and wound rolls for attacks made as part of that Fight ability against this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodthirster of Insensate Rage': {\r\n    effects: [\r\n      {\r\n        name: `Outrageous Carnage - Passive`,\r\n        desc: `Effect: Each time an attack made by this unit scores a critical hit, inflict D3 mortal damage on each enemy unit within 8\" of it after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Great Axe of Khorne is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shattering Charge - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, inflict an additional 3 mortal damage on it.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath of Khorne Bloodthirster': {\r\n    effects: [\r\n      {\r\n        name: `Commander of Tyrants - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 other visible friendly non-Unique Bloodthirster units to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of each targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Mighty Axe of Khorne and Bloodail is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vengeance of Khorne - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll 8 dice. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Skulltaker: {\r\n    effects: [\r\n      {\r\n        name: `Heroes' Bane`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: For the rest of the turn, while the target is in combat with this unit, this unit has Strike-first but all combat attacks it makes must target that enemy Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skulls for the Skull Throne! - Passive`,\r\n        desc: `Effect: Each time an enemy Hero is slain by this unit, you receive 1 additional blood tithe point.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Karanak: {\r\n    effects: [\r\n      {\r\n        name: `First of the Pack - Passive`,\r\n        desc: `Effect: While this unit is wholly within 12\" of a friendly Flesh Hounds unit, add 2 to charge rolls for this unit. In addition, while any friendly Flesh Hounds units are wholly within 12\" of this unit, they can ignore the effect of the Beast ability.`,\r\n        when: [CHARGE_PHASE, END_OF_TURN],\r\n      },\r\n    //  UnflaggingHunterEffect,\r\n      {\r\n        name: `Stalk the Prey - Enemy Movement Phase`,\r\n        desc: `Effect: If this units quarry moved this phase, this unit can move up to 8\". It cannot move into combat during any part of that move and must end that move closer to its quarry.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Prey of the Blood God`,\r\n        desc: `Effect: Pick an enemy Hero to be this units quarry (see Stalk the Prey). You can pick a Hero in reserve.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Flesh Hounds': {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Unflagging Hunters - Passive`,\r\n        desc: `Effect: Add 2 to charge rolls for this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skullmaster, Herald of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `Slaughterous Charge`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Make a crushing charge roll of D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  SlaughterousChargeEffect,\r\n      {\r\n        name: `Herald of Trampling Death - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Bloodcrushers unit within this units combat range to be the target. \r\n        Effect: For the rest of the turn, weapons used by this unit and the target have Charge (+1 Damage).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodmaster, Herald of Khorne': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Bloodmark'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `The Blood Must Flow - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Bloodletters unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, subtract 1 from ward rolls for damage points inflicted by each of those Fight abilities.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodletters: {\r\n    effects: [\r\n      {\r\n        name: `The Thinning Veil`,\r\n        desc: `Effect: If this unit is in combat, you can return D3 slain models to this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // ChargeMusicianEffect,\r\n    ],\r\n  },\r\n  Bloodcrushers: {\r\n    effects: [\r\n      {\r\n        name: `Slaughterous Charge`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Make a crushing charge roll of D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // MurderousChargeEffect,\r\n    ],\r\n  },\r\n  'Herald of Khorne on Blood Throne': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Blood Call'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Blood Call - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Blades of Khorne Daemon unit that started the battle with 3 or more models and that has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 4+, set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skull Cannon': {\r\n    effects: [\r\n      {\r\n        name: `Grind their Bones, Seize their Skulls - Passive`,\r\n        desc: `Effect: If any enemy models are slain by a Fight ability used by this unit, after that Fight ability has been resolved, this unit can immediately use a Shoot ability as if it were your shooting phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gruesome Bombardment - Passive`,\r\n        desc: `Effect: If any damage points are allocated to an enemy unit by a Shoot ability used by this unit, subtract 3 from that enemy units control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  /*'Exalted Greater Daemon of Khorne': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Rejoice in Exalted Slaughter'])],\r\n    }, \r\n    effects: [\r\n     DrawnInForTheKillEffect,\r\n      {\r\n        name: `The Land Rebels`,\r\n        desc: `At the start of your hero phase, roll a dice for each enemy unit within 8\" of any friendly models with this ability. On a 5+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mazarall the Butcher': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, [\"The Butcher's Due\"])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Bloody Charge`,\r\n        desc: `Roll a dice for each enemy unit that is within 1\" of this model after this model makes a charge move. On a 4+ that unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Harrow Meat's Hunger`,\r\n        desc: `At the end of the combat phase, if any enemy models were slain by wounds inflicted by this model's attacks in that combat phase, add 1 to the Attacks characteristic of Harrow Meat for the rest of the battle.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Ancyte Shield`,\r\n        desc: `This model can attempt to unbind 1 spell in the enemy hero phase in the same manner as a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Korghos Khul': {\r\n    effects: [\r\n      {\r\n        name: `Aqshy's Bane`,\r\n        desc: `This unit is eligible to fight in the combat phase if it is within 8\" of an enemy unit instead of 3\", and it can move an extra 5\" when it piles in.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Collar of Khorne`,\r\n        desc: `This unit can attempt to unbind 1 spell in the enemy hero phase in the same manner as a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Reality-splitting Axe`,\r\n        desc: `Each time this unit fights, wounds caused by its Blood-dark Claws must be allocated before wounds caused by its Axe of Khorne. At the end of any phase, if any wounds caused by this unit's Axe of Khorne in that phase were allocated to an enemy model and that enemy model has not been slain, roll a dice. On a 5+, that enemy model is slain.`,\r\n        when: [END_OF_ANY_PHASE],\r\n      },\r\n      {\r\n        name: `Lord of the Goretide`,\r\n        desc: `If this unit is included in a Goretide army, once per battle, at the start of the combat phase, you can say that Khul will unleash the wrath of the Goretide. If you do so, until the end of that phase, each time a friendly GORETIDE BLOODBOUND model is slain, you can make 1 additional murder roll.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Skarr Bloodwrath': {\r\n    effects: [\r\n      {\r\n        name: `The Slaughterborn`,\r\n        desc: `Declare: This unit can use this ability if it has been destroyed. \r\n        Effect: Roll 2D6. On an 8+, set up a replacement unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Murderous Paragon - Passive`,\r\n        desc: `Effect: If this unit is in combat, add 1 to the Attacks characteristic of melee weapons used by friendly Wrathmongers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Valkia the Bloody': {\r\n    effects: [\r\n      {\r\n        name: `The Red Angel of Slaughter`,\r\n        desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is set up in the skies as a reserve unit. If you do so, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units. Then, you can pick 1 enemy unit within 10\" of this unit and roll a dice. On a 1, nothing happens. On a 2+, that enemy unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Red Angel of Slaughter`,\r\n        desc: `If you set this unit up in reserve, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units. Then, you can pick 1 enemy unit within 10\" of this unit and roll a dice. On a 1, nothing happens. On a 2+, that enemy unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Daemonshield`,\r\n        desc: `This unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `The Gaze of Khorne`,\r\n        desc: `Add 3 to the Bravery characteristic of other friendly BLOODBOUND units while they are wholly within 16\" of this unit. However, friendly BLOODBOUND units cannot retreat while they are wholly within 16\" of this unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Mighty Lord of Khorne': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, [\"'Bring Me Their Skull!'\"])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Lord of the Bloodbound - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Bloodbound Infantry units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Bring Me Their Skull! - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Gorechosen unit wholly within 12\" of this unit to be the target. \r\n        Effect: The target has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodsecrator: {\r\n    effects: [\r\n      {\r\n        name: `Rage of Khorne - Once Per Battle`,\r\n        desc: `Effect: Add 1 to the Attacks characteristics of melee weapons used by friendly Bloodbound units for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Icon of the Blood God`,\r\n        desc: `Effect: If a friendly Bloodbound unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Khorne on Juggernaut': {\r\n    effects: [\r\n     // BrassCladShieldEffect,\r\n      // SlaughterousChargeEffect,\r\n      {\r\n        name: `Slaughterous Charge`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Make a crushing charge roll of D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Lord of the Brass Stampede - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, the following effects apply to friendly Blades of Khorne Cavalry units while they are wholly within 18\" of this unit:  \r\n        Add 1 to charge rolls for those units.  \r\n        You can re-roll crushing charge rolls for those units.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Slaughterpriest: {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Blood Boil'])],\r\n    }, */\r\n    effects: [\r\n      //ScornOfSorceryEffect\r\n      {\r\n        name: `Blood Sacrifice - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly unit within this units combat range to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Gain 1 blood tithe point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scorn of Sorcery - Passive`,\r\n        desc: `Effect: This unit can use Unbind abilities as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Skullgrinder: {\r\n    effects: [\r\n      {\r\n        name: `Bone-Crushing Strikes - Passive`,\r\n        desc: `Effect: If this unit uses a Fight ability, all of the attacks target the same enemy Monster, and any of the attacks score a critical hit, that Monster has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tempered by Fury - Once Per Battle`,\r\n        desc: `Declare: Pick another friendly Bloodbound Hero within 8\" of this unit to be the target. \r\n        Effect: Pick 1 of the targets melee weapons. Add 1 to the Rend characteristic of that weapon for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Aspiring Deathbringer': {\r\n    effects: [\r\n      {\r\n        name: `Furious Warleader - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Blood Warriors unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to wound rolls for attacks made by this unit and the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Exalted Deathbringer': {\r\n    effects: [\r\n      {\r\n        name: `Glorius Ascent - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Deathbringer Weapon for each glorious ascent token it has.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `First of the Gorechosen`,\r\n        desc: `Effect: If any damage points were allocated to an enemy unit by this units combat attacks this turn and that enemy unit has been destroyed, Heal (5) this unit and give this unit a glorious ascent token.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Bloodstoker: {\r\n    effects: [\r\n      {\r\n        name: `Whipped to Fury - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly non-Hero Bloodbound unit within this units combat range to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Warriors': {\r\n    effects: [\r\n    //  ...WarriorEffects,\r\n     // BraveryStandardBearerEffect,\r\n      {\r\n        name: `No Respite - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll 2 dice. For each 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bloodreavers: {\r\n    effects: [\r\n      {\r\n        name: `Blood for the Blood God! - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons for the rest of the turn if this unit charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // BraveryStandardBearerEffect,\r\n     // ChargeMusicianEffect,\r\n    ],\r\n  },\r\n/*  \"Garrek's Reavers\": {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Garrek Gorebeard is the unit champion. Add 1 to the Attacks characteristic of that model's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grisly Trophies`,\r\n        desc: `If this unit is included in a Blades of Khorne army, at the end of the combat phase, if this unit is on the battlefield and any enemy models were slain by attacks made by this unit in that phase, you receive 1 additional Blood Tithe point.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Magore's Fiends\": {\r\n    effects: [\r\n     // ...WarriorEffects,\r\n      {\r\n        name: `Riptooth`,\r\n        desc: `The first time this unit is set up on the battlefield, you must summon 1 FLESH HOUNDS unit consisting of 1 model to the battlefield and add it to your army. That model must not be a Gore Hound and must be on a 50mm base. Set up that FLESH HOUNDS unit wholly within 3\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.BATTLETOME_KHORNE, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n    ],\r\n  },\r\n  /*Riptooth: {\r\n    effects: [...CollarOfKhorneEffects, UnflaggingHunterEffect],\r\n  }, */\r\n  Wrathmongers: {\r\n    effects: [\r\n      {\r\n        name: `Crimson Haze - Passive`,\r\n        desc: `Effect: While this unit is in combat, add 1 to the Attacks characteristic of melee weapons used by friendly Bloodbound units, excluding Wrathmongers units, while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bloodfury - Passive`,\r\n        desc: `Effect: Each time an unmodified hit roll for a combat attack that targets this unit is 1, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mighty Skullcrushers': {\r\n    effects: [\r\n      {\r\n        name: `Slaughterous Charge`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Make a crushing charge roll of D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  BrassCladShieldEffect,\r\n    //  MurderousChargeEffect,\r\n    ],\r\n  },\r\n  Skullreapers: {\r\n    effects: [\r\n      {\r\n        name: `Trial of Skulls - Passive`,\r\n        desc: `Effect: If this unit destroyed an enemy unit this turn, add 8 to this units control score. If this unit did not destroy an enemy unit this turn, it has a control score of 1 that cannot be modified.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Scyla Anfingrimm': {\r\n    effects: [\r\n      {\r\n        name: `Brass Collar of Khorne`,\r\n        desc: `This unit can attempt to unbind 1 spell in the enemy hero phase in the same manner as a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Leap`,\r\n        desc: `This unit is eligible to fight in the combat phase if it is within 8\" of an enemy unit instead of 3\", and it can move an extra 5\" when it piles in.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Khorgoraths: {\r\n    effects: [\r\n      {\r\n        name: `Horrific Predators - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Taker of Heads`,\r\n        desc: `Effect: If this unit is in combat, Heal (3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Vorgaroth the Scarred on Skalok the Skull Host of Khorne': {\r\n    effects: [\r\n      {\r\n        name: `Monstrous Trophies`,\r\n        desc: `Add 1 to wound rolls for attacks made with this model's Skull Cleaver Axe of Khorne that target a MONSTER. In addition, if the unmodified wound roll for an attack made with the Skull Cleaver Axe of Khorne is 6, that attack causes D3 mortal wounds to the target in addition to any damage it inflicts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crushing Bulk`,\r\n        desc: `Roll a dice for each enemy unit that is within 1\" of this model after this model makes a charge move. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Eternal Hunt`,\r\n        desc: `Instead of setting up this model on the battlefield, you can place it to one side and say that it is in reserve. If you do so, at the end of your second movement phase, you must set up this model anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Eternal Hunt`,\r\n        desc: `If you set this unit up in reserve, at the end of your second movement phase, you must set up this model anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [TURN_TWO_END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Fettered Servitude`,\r\n        desc: `Once per battleshock phase, before you take a battleshock test for a friendly KHORNE unit wholly within 12\" of this model, you can say that this model demands unwavering obedience. If you do so, 1 model in that unit is slain, but you do not have to take a battleshock test for that unit in that phase.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Fuelled by Death`,\r\n        desc: `In your hero phase, you can pick 1 friendly model within 3\" of this model and roll a dice. If you do so and the roll is equal to or greater than that model's Wounds characteristic, that model is slain and you can heal a number of wounds allocated to this model equal to the slain model's Wounds characteristic.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wings of Fury`,\r\n        desc: `Subtract 3 from casting and unbinding rolls for enemy WIZARDS that are within 18\" of this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skaarac the Bloodborn': {\r\n    effects: [\r\n      {\r\n        name: `Life-eater`,\r\n        desc: `At the end of the combat phase, if any enemy models were slain by wounds inflicted by this model's attacks in that combat phase, you can heal up to D3 wounds allocated to this model.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Iron`,\r\n        desc: `Subtract 2 from casting rolls for enemy WIZARDS while they are within 12\" of this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Towering Horror`,\r\n        desc: `Subtract 1 from the Bravery characteristic of enemy units while they are within 12\" of this model.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Undying Hate`,\r\n        desc: `If this model is slain, before removing it from play, roll a dice for each enemy model within 3\" of this model. On a 4+, that model's unit suffers 1 mortal wound. This model is then removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Call of the Skull Throne`,\r\n        desc: `Add 1 to charge rolls for friendly KHORNE units that are wholly within 12\" of this model.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Dromm, Wounder of Worlds': {\r\n    mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Wound the Realm'])],\r\n    },\r\n    effects: [ScornOfSorceryEffect],\r\n  },\r\n  'Gorechosen of Dromm': {\r\n    effects: [\r\n      {\r\n        name: `Gorechosen of Dromm`,\r\n        desc: `While this unit is wholly within 3\" of a friendly DROMM, he has a ward of 4+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Throttle`,\r\n        desc: `At the end of the combat phase, if this unit includes the Gorehulk, you can pick 1 enemy model within 3\" of this unit and roll a dice. If the roll is more than double that model's Wounds characteristic, it is slain.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `White-hot Anger`,\r\n        desc: `At the end of the combat phase, roll a dice for each enemy model within 3\" of this unit's Skullgrinder Herax. For each 5+, that enemy model's unit suffers 1 mortal wound.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Realmgore Ritualist': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(Prayers, ['Bloodhex'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Desecrating Blood Runes - Once Per Battle`,\r\n        desc: `Declare: Pick an objective or terrain feature within this units combat range to be the target. \r\n        Effect: For the rest of the battle, add 1 to hit rolls for combat attacks made by friendly Bloodbound units while they are wholly within 12\" of the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Claws of Karanak': {\r\n    effects: [\r\n      {\r\n        name: `The Scent of Blood`,\r\n        desc: `Effect: This unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Pack Hunters - Passive`,\r\n        desc: `Effect: While this unit is wholly within 12\" of a friendly Flesh Hounds unit, this units combat attacks score critical hits on unmodified hit rolls of 5+.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Brand`s Oathbound': {\r\n    effects: [\r\n      {\r\n        name: `Gunnar Brand: Carve a Path to Glory`,\r\n        desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n        Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n      {\r\n        name: `Gunnar Brand: Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Singri Brand: Swift as the Wind - Passive`,\r\n        desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },  \r\n      {\r\n        name: `Singri Brand: Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn Kin: Withering Death: Casting value of 5`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n      {\r\n        name: `Oathsworn Kin: Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of the Gods - Once Per Turn`,\r\n        desc: `Effect: If any enemy Heroes were slain this turn by the Gunnar Brand in this Regiment of Renown:  \r\n        Heal (5) each unit in this Regiment of Renown.  \r\n        Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import BeastsOfChaosUnits from 'factions/beasts_of_chaos/units'\r\nimport SlavesToDarknessUnits from 'factions/slaves_to_darkness/units'\r\nimport { KHORNE } from 'meta/factions'\r\nimport { keyOmitter, keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Prayers from './prayers'\r\nimport Scenery from './scenery'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    prayers: [Prayers],\r\n    scenery: [Scenery],\r\n    units: [\r\n      Units,\r\n     /* keyOmitter(SlavesToDarknessUnits, [\r\n        'Gaunt Summoner on Disc of Tzeentch',\r\n        'Chaos Sorcerer Lord on Manticore',\r\n        'Chaos Sorcerer Lord',\r\n        'Theddra Skull-Scryer',\r\n        'Godsworn Hunt',\r\n        'Darkoath Warqueen',\r\n        'Darkoath Chieftain',\r\n        'Furies',\r\n        'Raptoryx',\r\n        'Splintered Fang',\r\n        'Corvus Cabal',\r\n        'The Unmade',\r\n        'Cypher Lords',\r\n        'Iron Golems',\r\n        'Untamed Beasts',\r\n        'Spire Tyrants',\r\n        'Scions of the Flame',\r\n        \"Be'Lakor\",\r\n        'Mutalith Vortex Beast',\r\n        'Fomoroid Crusher',\r\n        'Mindstealer Sphiranx',\r\n      ]),\r\n      keyPicker(BeastsOfChaosUnits, [\r\n        'Beastlord',\r\n        'Bestigors',\r\n        'Bullgors',\r\n        'Centigors',\r\n        'Cygor',\r\n        'Doombull',\r\n        'Dragon Ogors',\r\n        'Ghorgon',\r\n        'Gors',\r\n        'Tuskgor Chariots',\r\n      ]), */\r\n    ], \r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [KHORNE]: {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [KHORNE, 'The Blood Tithe']),\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { KHORNE } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const KhorneFaction = new Faction(\r\n  KHORNE,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_KHORNE\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, START_OF_HERO_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Black Hammer of Hashut': {\r\n    effects: [\r\n      {\r\n        name: `Black Hammer of Hashut`,\r\n        desc: `Pick 1 of the bearer's melee weapons. You can reroll hit rolls for attacks made with that weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Armour of Bazherak the Cruel': {\r\n    effects: [\r\n      {\r\n        name: `Armour of Bazherak the Cruel`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to the bearer. On a 5+, that wound or mortal wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chalice of Blood and Darkness': {\r\n    effects: [\r\n      {\r\n        name: `Chalice of Blood and Darkness`,\r\n        desc: `Once per battle, at the start of the enemy hero phase, the bearer can use this artifact. If they do so, roll a D6 for each enemy Wizard within 30\" of the bearer. On a 4+, reduce the number of spells that enemy Wizard can attempt to cast in that hero phase by 1.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  LegionOfAzgorh: {\r\n    effects: [\r\n      {\r\n        name: `Blackshard Armor`,\r\n        desc: `The first wound that is allocated to each unit with this battle trait in each shooting phase and each combat phase is negated.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Burning Skies': {\r\n    effects: [\r\n      {\r\n        name: `Burning Skies`,\r\n        desc: `In the movement phase, if an enemy unit can fly and moves more than 6\", roll a D6. On a 4+ the enemy unit suffers 1 mortal wound. On a 6+ it suffers D3 mortal wounds instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of the Black Fortress': {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Black Fortress`,\r\n        desc: `You can use this command ability at the start of the battleshock phase if this model is on the battlefield. If you do so, do not take battleshock tests for friendly Legion of Azgorh units while they are wholly within 24\" of this model.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Lord of the Ba'hal\": {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Ba'hal`,\r\n        desc: `You can use this command ability at the start of your charge phase if this model is on the battlefield. If you do so, you can reroll charge rolls for friendly Ba'hal units while they are wholly within 24\" of this model in that charge phase. In addition, you can reroll hit rolls of 1 for attacks made with Crushing Hooves by friendly Ba'hal units while they are wholly within 24\" of this model in the subsequent combat phase.`,\r\n        when: [START_OF_CHARGE_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Favour of the Burning God': {\r\n    effects: [\r\n      {\r\n        name: `Favour of the Burning God`,\r\n        desc: `You can use this command ability at the start of the combat phase. If you do so, pick 1 friendly model with this command ability. Add 1 to hit rolls for attacks made with melee weapons by friendly Ba'hal units while they are wholly within 12\" of that model until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Martial Contempt': {\r\n    effects: [\r\n      {\r\n        name: `Martial Contempt`,\r\n        desc: `You can use this command ability in your hero phase. If you do so, pick 1 enemy unit within 12\" of a friendly model with this command ability. Until the start of your next hero phase, add 1 to wound rolls for attacks made by friendly Legion of Azgorh units that target that unit. The same enemy unit cannot be picked as the target of this command ability more than once per hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE } from 'types/phases'\r\nconst CommandTraits = {\r\n  Contemptuous: {\r\n    effects: [\r\n      {\r\n        name: `Contemptuous`,\r\n        desc: `You can reroll wound rolls of 1 for attacks made by this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Relentless: {\r\n    effects: [\r\n      {\r\n        name: `Relentless`,\r\n        desc: `After this general has fought in each combat phase for the first time, if it is within 3\" of an enemy HERO or MONSTER, roll a D6. On a 5+, it can make a pile-in move and then attack with all of the melee weapons it is armed with for a second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Grotesque: {\r\n    effects: [\r\n      {\r\n        name: `Grotesque`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  Fireball: {\r\n    effects: [\r\n      {\r\n        name: `Fireball`,\r\n        desc: `Casting value of 5. Pick 1 enemy unit within 18\" and visible to the caster. If the enemy unit consists of one model it suffers 1 mortal wound, if it has 2 to 9 models it suffers D3 mortal wounds, and if it has 10 or more models it suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ash Storm': {\r\n    effects: [\r\n      {\r\n        name: `Ash Storm`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit within 36\" of the caster that is visible to them. Until your next hero phase, subtract 1 from hit rolls for attacks made by that unit, and that unit cannot run.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst InfernalGuardBaseEffects = [\r\n  {\r\n    name: `Fireglaive Deathmask`,\r\n    desc: `The leader of this unit is a Fireglaive Deathmask. A Fireglaive Deathmask is armed with an Ashsteel Hand Weapon and Pyrelock Pistol instead of a Pyrelock Fireglaive and a Pyrelock Fireglaive's Bayonet-cleaver.`,\r\n    when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Icon of Dominion Bearers`,\r\n    desc: `Add 1 to the Bravery characteristic of a unit that includes an Icon of Dominion Bearer.`,\r\n    when: [BATTLESHOCK_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Drummer`,\r\n    desc: `Add 1 to run rolls for a unit that includes a Drummer.`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst TrampleAndGoreEffect = {\r\n  name: `Trample and Gore`,\r\n  desc: `Add 1 to charge rolls for this unit. In addition, this unit's Crushing Hooves have a Damage characteristic of D3 instead of 1 if this unit made a charge move in the same turn.`,\r\n  when: [CHARGE_PHASE, COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst PyrelockPistolEffect = {\r\n  name: `Pyrelock Pistol`,\r\n  desc: `If the unmodified hit roll for an attack made with a Pyrelock Pistol is 6, that attack inflicts 1 mortal wound on the target in addition to any normal damage.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst SpiteshieldEffect = {\r\n  name: `Spiteshield`,\r\n  desc: `If the unmodified save roll for an attack with a melee weapon that targets a unit that includes any models carrying a Spiteshield is 6, the attacking unit suffers 1 mortal wound.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst CarriageHaulerEffect = {\r\n  name: `Carriage Hauler`,\r\n  desc: `At the start of your movement phase, you can pick 1 friendly Deathshrieker Rocket Launcher, Magma Cannon, or Dreadquake Mortar unit within 1\" of this model. If you do so, that unit can use this model's Move characteristic during that movement phase, as long as it is within 1\" of this model at the end of that movement phase.`,\r\n  when: [START_OF_MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst SiegeArtilleryEffects = [\r\n  {\r\n    name: `Siege Artillery`,\r\n    desc: `This unit cannot run or make charge moves.`,\r\n    when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Siege Artillery`,\r\n    desc: `Add 1 to save rolls for attacks made with missile weapons that target this model.`,\r\n    when: [SAVES_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst Units = {\r\n  'Drazhoath the Ashen': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Lord of the Black Fortress'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Blazing Body`,\r\n        desc: `At the start of the combat phase, roll 1 dice for each enemy unit within 3\" of this model. On a 4+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Rage`,\r\n        desc: `You can reroll wound rolls for attacks made with Cinderbreath's Brazen Horns and Teeth if this model made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hellshard Amulet`,\r\n        desc: `Roll a D6 each time you allocate a wound inflicted by an attack made with a melee weapon to this model. On a 5+, that wound is negated and the attacking unit suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Prophet of Ash and Flame`,\r\n        desc: `Add 1 to casting rolls for this model if the battle is being fought in the Aqshy, the Realm of Fire.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Daemonsmith: {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Ash Storm'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Ensorcelled Armour`,\r\n        desc: `Add 1 to unbinding rolls for this model if 1 or more wounds have been allocated to this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magic`,\r\n        desc: `Daemonsmiths are WIZARDS. They can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. It knows the Arcane Bolt, Mystic Shield, and Ash Storm spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Blood of Hashut`,\r\n        desc: `Do not use the attack sequence for an attack made with the Blood of Hashut. Instead roll a D6. On a 2+ the target unit suffers D3 mortal wounds. If the target unit is a War Machine it suffers D6 mortal wounds instead of D3.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Shar'Tor the Executioner\": {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, [\"Lord of the Ba'hal\"])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Darktide Reaping`,\r\n        desc: `If the unmodified hit roll for an attack made with the Darktide Axe is a 6, that attack inflicts 1 mortal wound on the target in addition to any normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Mask of the Executioner`,\r\n        desc: `At the start of your hero phase, you can pick 1 enemy unit within 8\" of this model and roll a D6. On a 1 or 2 nothing happens. On a 3-5 that enemy unit suffers D3 mortal wounds. On a 6, that enemy unit suffers D6 mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      TrampleAndGoreEffect,\r\n    ],\r\n  },\r\n  \"Bull Centaur Taur'Ruk\": {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Favour of the Burning God'])],\r\n    },\r\n    effects: [TrampleAndGoreEffect],\r\n  },\r\n  'Bull Centaur Renders': {\r\n    effects: [SpiteshieldEffect, TrampleAndGoreEffect],\r\n  },\r\n  'Infernal Guard Castellan': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Martial Contempt'])],\r\n    },\r\n    effects: [PyrelockPistolEffect],\r\n  },\r\n  'Infernal Guard Battle Standard Bearer': {\r\n    effects: [\r\n      {\r\n        name: `Icon Bearer`,\r\n        desc: `Add 1 to the Bravery characteristic of friendly Legion of Azgorh units while they are wholly within 18\" of this model. In addition, you can reroll wound rolls of 1 for attacks made with melee weapons by friendly Legion of Azgorh units.`,\r\n        when: [BATTLESHOCK_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Infernal Guard Fireglaives': {\r\n    effects: [...InfernalGuardBaseEffects],\r\n  },\r\n  'Infernal Guard Ironsworn': {\r\n    effects: [...InfernalGuardBaseEffects, PyrelockPistolEffect, SpiteshieldEffect],\r\n  },\r\n  \"K'Daai Fireborn\": {\r\n    effects: [\r\n      {\r\n        name: `Burning Bright`,\r\n        desc: `This unit can run and still charge later in the same turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Bright`,\r\n        desc: `Ignore modifiers (positive or negative) when making save rolls for attacks that target this unit.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Kiss of Fire`,\r\n        desc: `At the end of the combat phase, roll 1 dice for each enemy unit within 3\" of this unit. On a 2+ that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Deathshrieker Rocket Launcher': {\r\n    effects: [\r\n      {\r\n        name: `Death From on High`,\r\n        desc: `This model's Deathshrieker Rockets can target enemy units that are not visible to the attacking model. In addition, add 1 to hit rolls for attacks made with Deathshrieker Rockets if the target unit has 5 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Engineers`,\r\n        desc: `Add 1 to the Attacks characteristic of this model's Deathshrieker Rockets while this model is within 3\" of a friendly Daemonsmith.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      ...SiegeArtilleryEffects,\r\n    ],\r\n  },\r\n  'Iron Daemon War Engine': {\r\n    effects: [\r\n      CarriageHaulerEffect,\r\n      {\r\n        name: `More Power!`,\r\n        desc: `In your shooting phase, you can change the Attacks characteristic of this model's Steam Cannonade from 2D6 to either 3D6 or 4D6. However, if you do so and the roll is 12+, this model suffers D3 mortal wounds after all of its attacks have been resolved.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magma Cannon': {\r\n    effects: [\r\n      {\r\n        name: `Infernal Engineers`,\r\n        desc: `Add 6\" to the Range characteristic of this model's Magma Blast while this model is within 3\" of a friendly Daemonsmith.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Magma Blast`,\r\n        desc: `Do not use the attack sequence for an attack made with a Magma Blast. Instead, roll a D6.Add 1 to the roll if the target unit has 10 or more models. On a 3+, the target unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      ...SiegeArtilleryEffects,\r\n    ],\r\n  },\r\n  'Dreadquake Mortar': {\r\n    effects: [\r\n      {\r\n        name: `Cruel Overlords`,\r\n        desc: `When this model is picked to shoot in your shooting phase, you can say that the Slavemasters are lashing the Slave Ogor. If you do so, roll a D6. On a 1 or 2, this unit suffers D3 mortal wounds (if it is not slain it can shoot normally). On a 3+, add 1 to the Attacks characteristic of this model's Dreadquake Bombs for that phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Engineers`,\r\n        desc: `Add 1 to hit rolls for attacks made with this model's Dreadquake Bomb while this model is within 3\" of a friendly Daemonsmith.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Quake Blast`,\r\n        desc: `This model's Dreadquake Bomb can target enemy units that are not visible to the attacking model. In addition, you can reroll the dice that determines the Damage characteristic of this model's Dreadquake Bomb if the target unit has 10 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      ...SiegeArtilleryEffects,\r\n    ],\r\n  },\r\n  'Skullcracker War Engine': {\r\n    effects: [\r\n      {\r\n        name: `Beaten into Scrap`,\r\n        desc: `You can reroll wound rolls for attacks made with this model's Hammer and Picks that target a War Machine.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      CarriageHaulerEffect,\r\n      {\r\n        name: `More Power!`,\r\n        desc: `In your combat phase, you can change the Attacks characteristic of this model's Hammers and Picks from 2D6 to either 3D6 or 4D6. However, if you do so and the roll is 12+, this model suffers D3 mortal wounds after all of its attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { LEGION_OF_AZGORH } from 'meta/factions'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [LEGION_OF_AZGORH]: {\r\n    effects: pickEffects(BattleTraits, ['LegionOfAzgorh']),\r\n\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Burning Skies'])],\r\n      spells: [keyPicker(Spells, ['Fireball'])],\r\n    },\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [],\r\n      scenery: [],\r\n      spells: [Spells],\r\n      units: [Units],\r\n      flavors: [],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { LEGION_OF_AZGORH } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LegionOfAzgorhFaction = new Faction(LEGION_OF_AZGORH, CHAOS, SubFactions, 'Legions')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_COMBAT_PHASE, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  'Grave-Sand Gem': {\r\n    effects: [\r\n      {\r\n        name: `Grave-sand Gem`,\r\n        desc: `In your hero phase, you can either inflict 1 mortal wound on 1 enemy HERO within 6\" of the bearer, or you can heal 1 wound that has been allocated to the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gothizzari Mortuary Candle': {\r\n    effects: [\r\n      {\r\n        name: `Gothizzari Mortuary Candle`,\r\n        desc: `Subtract 1 from hit rolls for attacks with missile weapons that target the bearer.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Souldrain Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Souldrain Pendant`,\r\n        desc: `At the end of the combat phase, roll a D6 for each enemy unit within 3\" of the bearer. On a 4+ that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { LEGION_OF_GRIEF } from 'meta/factions'\r\nimport {\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [LEGION_OF_GRIEF]: {\r\n    effects: [\r\n      {\r\n        name: `Deathless Minions`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to a friendly DEATH unit within 6\" of your general or another friendly DEATH HERO. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `The Unquiet Dead`,\r\n        desc: `After territories have been determined, but before any units have been set up, you may pick up to 2 points in your territory and up to 2 points anywhere on the battlefield to be gravesites. You may wish to place suitable markers on these points. Instead of setting up a SUMMONABLE unit on the battlefield, you can place it to one side and say that it is set up in the grave. You can do this with as many units as you wish.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Unquiet Dead`,\r\n        desc: `At the end of your movement phase, for each friendly DEATH HERO within 9\" of a gravesite, you may pick a single friendly unit in the grave and set it up wholly within 9\" of the gravesite and more than 9\" from any enemy models. Any model that is unable to be set up in this way is slain. If a unit is still in the grave at the end of the battle, it is considered to be slain.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Invigorating Aura`,\r\n        desc: `At the start of your hero phase, pick a friendly SUMMONABLE unit within 9\" of this gravesite. You can either heal D3 wounds that have been allocated to it or, if no wounds are currently allocated to the unit, you may return a number of slain models to it that have a combined Wounds characteristic equal to or less than the roll of a D3.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of Grief`,\r\n        desc: `Enemy units have -1 bravery while within 6\" of one of your LEGION OF GRIEF units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Legion of Grief`,\r\n        desc: `If Lady Olynder is included in this army she MUST be the general of the army. If you include any Mortachs then you must also include Lady Olynder.`,\r\n        when: [START_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_MOVEMENT_PHASE } from 'types/phases'\r\n\r\n// Store Command Abilities here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandAbilities = {\r\n  'Endless Legions': {\r\n    effects: [\r\n      {\r\n        name: `Endless Legions`,\r\n        desc: `You can use this command ability at the end of your movement phase. If you do so, pick a gravesite that is within 9\" of your general, and then pick a friendly Summonable unit that has been destroyed. Set up that unit wholly within 9\" of that gravesite and more than 9\" from any enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, DURING_GAME, HERO_PHASE } from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Amethyst Glow': {\r\n    effects: [\r\n      {\r\n        name: `Amethyst Glow`,\r\n        desc: `This general is a WIZARD. They can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. They know the arcane bolt and mystic shield spells.\\n\\nIf this general is already a WIZARD, they know one extra spell from the Lore of Sorrows.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vassal of the Craven King': {\r\n    effects: [\r\n      {\r\n        name: `Vassal of the Craven King`,\r\n        desc: `If this general is on the battlefield, each time you spend a command point, roll a D6. On a 5+ you receive 1 extra command point.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Tragic Emanations': {\r\n    effects: [\r\n      {\r\n        name: `Tragic Emanations`,\r\n        desc: `Subtract 2 from the Bravery characteristic of enemy units while they are within 12\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE, SAVES_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Dread Withering': {\r\n    effects: [\r\n      {\r\n        name: `Dread Withering`,\r\n        desc: `Casting value of 5. Pick 1 enemy unit within 18\" of the caster that is visible to them. Subtract 1 from save rolls for attacks that target that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dread Withering`,\r\n        desc: `If active, subtract 1 from save rolls for attacks that target that unit until the start of your next hero phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wail of Doom': {\r\n    effects: [\r\n      {\r\n        name: `Wail of Doom`,\r\n        desc: `Casting value of 8. Roll a D6 for each enemy unit within 6\" of the caster. On a 4+ that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shroud of Terror': {\r\n    effects: [\r\n      {\r\n        name: `Shroud of Terror`,\r\n        desc: `Casting value of 8. Pick 1 enemy unit within 12\" of the caster that is visible to them. Subtract D3 from the Bravery characteristic of that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { LEGION_OF_GRIEF } from 'meta/factions'\r\nimport LegionsOfNagashUnits from '../legions_of_nagash/units'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport NighthauntEndlessSpells from '../nighthaunt/endless_spells'\r\nimport NighthauntUnits from '../nighthaunt/units'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [LEGION_OF_GRIEF]: {\r\n    effects: pickEffects(BattleTraits, [LEGION_OF_GRIEF]),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [NighthauntEndlessSpells],\r\n      spells: [Spells],\r\n      units: [\r\n        NighthauntUnits,\r\n        keyPicker(LegionsOfNagashUnits, [\r\n          //'Arkhan the Black, Mortarch of Sacrament',\r\n          'Black Knights',\r\n          'Corpse Cart w/ Balefire Brazier',\r\n          'Corpse Cart w/ Unholy Lodestone',\r\n          'Dire Wolves',\r\n          'Grave Guard',\r\n          'Mannfred, Mortarch of Night',\r\n          'Morghast Archai',\r\n          'Morghast Harbingers',\r\n          'Mortis Engine',\r\n          'Necromancer',\r\n          'Neferata, Mortarch of Blood',\r\n          'Skeleton Warriors',\r\n          'Wight King with Baleful Tomb Blade',\r\n          'Wight King with Black Axe',\r\n          'Zombies',\r\n        ]),\r\n      ],\r\n    },\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Endless Legions'])],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { LEGION_OF_GRIEF } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LegionOfGriefFaction = new Faction(LEGION_OF_GRIEF, DEATH, SubFactions, 'Flavors')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  // Legion of the First Prince\r\n  'Servants of the Dark Master': {\r\n    effects: [\r\n      {\r\n        name: `First-Damned Prince`,\r\n        desc: `Add 1 to hit rolls and wound rolls for attacks made by Be'lakor while he is within 18\" of at least 1 friendly unit from each of the following warscrolls: Bloodletters, Horrors of Tzeentch, Plaguebearers, Daemonettes.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BOOK_BROKEN_REALMS_BELAKOR,\r\n          meta_rule_sources.ERRATA_BROKEN_REALMS_BELAKOR_JULY_2022,\r\n        ],\r\n      },\r\n      {\r\n        name: `The Cursed Skies`,\r\n        desc: `Roll a D6 for each friendly unit of Bloodletters, Horrors of Tzeentch, Plaguebearers, Daemonettes, or Furies. On a 3+ you can return D3 slain models to the unit (only 1 for Horrors).`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Realmwalkers`,\r\n        desc: `Roll a D6 each time a Legion of the First Prince unit suffers a wound or mortal wound. On a 6+ it is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Unyielding Legions`,\r\n        desc: `Pick 1 friendly Legion of the First Prince Daemon hero that is on the battlefield and roll 3D6. On a 10+ you can summon either 10 Bloodletters, 10 Plaguebearers, 10 Daemonettes, or 5 Horrors of Tzeentch. The unit's god keyword must match a god keyword from the summoning hero. Be'lakor can summon any of the above or 6 Furies. The summoned unit must be setup within 12\" of the hero and more than 9\" from enemy units. If the unmodified summoning roll contained any doubles, the hero suffers 1 mortal wound. If the unmodified summoning roll was a triple, the hero suffers D3 mortal wounds instead.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import KhorneUnits from 'factions/khorne/units'\r\nimport { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport NurgleUnits from 'factions/nurgle/units'\r\nimport SkavenUnits from 'factions/skaven/units'\r\nimport SlaaneshUnits from 'factions/slaanesh/units'\r\nimport SlavesUnits from 'factions/slaves_to_darkness/units'\r\nimport TzeentchUnits from 'factions/tzeentch/units'\r\nimport { LEGION_OF_THE_FIRST_PRINCE } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandTraits from './command_traits'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [LEGION_OF_THE_FIRST_PRINCE]: {\r\n    effects: pickEffects(BattleTraits, ['Servants of the Dark Master']),\r\n\r\n   /* available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [],\r\n      command_traits: [CommandTraits],\r\n      spells: [Spells],\r\n      units: [\r\n        keyPicker(KhorneUnits, [\r\n          'Bloodcrushers',\r\n          'Bloodletters',\r\n          'Bloodmaster, Herald of Khorne',\r\n          'Bloodthirster of Insensate Rage',\r\n          'Bloodthirster of Unfettered Fury',\r\n          'Exalted Greater Daemon of Khorne',\r\n          'Flesh Hounds',\r\n          'Herald of Khorne on Blood Throne',\r\n          'Karanak',\r\n          'Mazarall the Butcher',\r\n          'Skarbrand',\r\n          'Skull Cannon',\r\n          'Skullmaster, Herald of Khorne',\r\n          'Skulltaker',\r\n          'Wrath of Khorne Bloodthirster',\r\n        ]),\r\n        keyPicker(NurgleUnits, [\r\n          'Beasts of Nurgle',\r\n          'Epidemius, Tallyman of Nurgle',\r\n          'Great Unclean One',\r\n          'Horticulous Slimux',\r\n          'Nurglings',\r\n          'Plague Drones',\r\n          'Plaguebearers',\r\n          'Poxbringer, Herald of Nurgle',\r\n          'Pusgoyle Blightlords',\r\n          'Rotigus',\r\n          'Sloppity Bilepiper, Herald of Nurgle',\r\n          'Spoilpox Scrivener, Herald of Nurgle',\r\n        ]),\r\n        keyPicker(SlaaneshUnits, [\r\n          'Bladebringer, Herald on Exalted Chariot',\r\n         // 'Bladebringer, Herald on Hellflayer',\r\n         // 'Bladebringer, Herald on Seeker Chariot',\r\n          'Daemonettes',\r\n         // 'Exalted Chariot',\r\n          'Fiends',\r\n          'Hellflayer',\r\n          'Infernal Enrapturess, Herald of Slaanesh',\r\n          'Keeper of Secrets',\r\n          'Seeker Chariots',\r\n          'Seekers',\r\n          'Shalaxi Helbane',\r\n          \"Syll'Esske, the Vengeful Allegiance\",\r\n          'The Contorted Epitome',\r\n          'The Masque',\r\n         // 'Viceleader, Herald of Slaanesh',\r\n        ]),\r\n        keyPicker(TzeentchUnits, [\r\n          'Burning Chariots of Tzeentch',\r\n          'Changecaster, Herald of Tzeentch',\r\n          'Exalted Flamers of Tzeentch',\r\n          'Exalted Greater Demon of Tzeentch',\r\n          'Fateskimmer, Herald of Tzeentch on Burning Chariot',\r\n          'Flamers of Tzeentch',\r\n          'Fluxmaster, Herald of Tzeentch on Disc',\r\n          'Gaunt Summoner',\r\n          'Gaunt Summoner on Disc of Tzeentch',\r\n          'Horrors of Tzeentch',\r\n          'Kairos Fateweaver',\r\n          'Lord of Change',\r\n          'Screamers of Tzeentch',\r\n          'The Blue Scribes',\r\n          'The Changeling',\r\n        ]),\r\n        keyPicker(SlavesUnits, [\"Be'Lakor\", 'Daemon Prince', 'Furies', 'Soul Grinder']),\r\n        keyPicker(SkavenUnits, ['Lord Skreech Verminking']),\r\n      ],\r\n    }, */\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { LEGION_OF_THE_FIRST_PRINCE } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LegionOfTheFirstPrinceFaction = new Faction(\r\n  LEGION_OF_THE_FIRST_PRINCE,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Legions'\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, START_OF_COMBAT_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Crown of Raven Feathers': {\r\n    effects: [\r\n      {\r\n        name: `Crown of Raven Feathers`,\r\n        desc: `Roll a D6 each time you allocate a wound or mortal wound to the bearer. On a 5+ it is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Silvered Blade': {\r\n    effects: [\r\n      {\r\n        name: `Silvered Blade`,\r\n        desc: `Pick one of the bearers melee weapons. Add 1 to the damage characteristic of that weapon. Add 2 instead if it is targeting a Death unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Flask of Lethisian Darkwater': {\r\n    effects: [\r\n      {\r\n        name: `Flask of Lethisian Darkwater`,\r\n        desc: `Once per battle, you can use this artefact to heal D6 wounds that have been allocated to the bearer.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { LETHISIAN_DEFENDERS } from 'meta/factions'\r\nimport { BATTLESHOCK_PHASE, CHARGE_PHASE, COMBAT_PHASE, MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [LETHISIAN_DEFENDERS]: {\r\n    effects: [\r\n      {\r\n        name: `Warriors of the Grand Necropolis`,\r\n        desc: `You can reroll battleshock tests for friendly Lethisian Defender units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Warriors of the Grand Necropolis`,\r\n        desc: `Add 1 to hit rolls for melee weapons used by Human/Duradin Lethisian Defender units in this army that target enemy units who have made a charge move in this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Akhelian Phalanx`,\r\n        desc: `Add 1 to the move characterstic of Akhelian Lethisian Defender units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Akhelian Phalanx`,\r\n        desc: `Add 1 to the charge rolls of Akhelian Lethisian Defender units.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Onyx Shield Wall': {\r\n    effects: [\r\n      {\r\n        name: `Onyx Shield Wall`,\r\n        desc: `Use this command ability during the enemy's turn. Pick 1 friendly Lethisian Defender Liberator unit wholly within 12\" of a Lethisian Defender Stormcast Eternal hero. Until the end of the phase, add 1 to the save rolls of the Liberator unit.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n\r\n      {\r\n        name: `Onyx Shield Wall`,\r\n        desc: `If active, the buffed Liberator unit cannot pile-in before attacking.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, DURING_GAME, HERO_PHASE } from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Raven Priest': {\r\n    effects: [\r\n      {\r\n        name: `Raven Priest`,\r\n        desc: `This general gains the Priest keyword. If the model is already a priest, it knows two Prayers of Morrda instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Solemn Soul': {\r\n    effects: [\r\n      {\r\n        name: `Solemn Soul`,\r\n        desc: `Do not take battleshock tests for friendly Lethisian Defender units wholly within 12\" of this general.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sinister Aura': {\r\n    effects: [\r\n      {\r\n        name: `Sinister Aura`,\r\n        desc: `Add 1 to the general's wounds characteristic. Subtract 1 from the bravery characteristic of enemy units within 6\" of this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, SAVES_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst Prayers = {\r\n  \"Raven Priest - Morrda's Resurrection\": {\r\n    effects: [\r\n      {\r\n        name: `Morrda's Resurrection`,\r\n        desc: `Prayer is answered on a 3+. If successful, pick a friendly Lethisian Defender unit wholly within 18\" of the priest. You may return up to D3 wounds (rounded down) worth of slain models to the unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Raven Priest - Morrda's Eye\": {\r\n    effects: [\r\n      {\r\n        name: `Morrda's Eye`,\r\n        desc: `Prayer is answered on a 3+. If successful, pick an enemy unit within 18\" of the priest. Subtract 1 from the hit rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morrda's Eye`,\r\n        desc: `If active, subtract 1 from the hit rolls for attacks made by the debuffed unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Raven Priest - Morrda's Embrace\": {\r\n    effects: [\r\n      {\r\n        name: `Morrda's Embrace`,\r\n        desc: `Prayer is answered on a 3+. If successful, reroll save rolls of 1 for friendly units wholly within 12\" of the priest until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morrda's Embrace`,\r\n        desc: `If active, reroll save rolls of 1 for friendly units wholly within 12\" of the priest.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Light of Sigmar': {\r\n    effects: [\r\n      {\r\n        name: `Light of Sigmar`,\r\n        desc: `Prayer is answered on a 3+. If successful, pick one unit within 10\" of the priest. Selected friendly unit heal 1 wound (Order units heal D3 instead). Selected enemy unit suffers 1 mortal wound (Chaos units suffer D3 instead).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, DURING_SETUP, HERO_PHASE } from 'types/phases'\r\nimport prayers from './prayers'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Units = {\r\n  'Excelsior Warpriest': {\r\n    mandatory: {\r\n      prayers: [keyPicker(prayers, ['Light of Sigmar'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Divine Power`,\r\n        desc: `This model can attempt to unbind 1 spell as if it were a wizard.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Loyal Companion`,\r\n        desc: `After setting up the Warpriest, you can set up 1 Gryph-hound within 3\" of this model. The Gryph-hound is bound to that Warpriest.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Loyal Companion`,\r\n        desc: `If the Gryph-hound is within 3\" its bound Warpriest, it makes 4 attacks rather than 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { LETHISIAN_DEFENDERS } from 'meta/factions'\r\nimport FyreslayersUnits from '../fyreslayers/units'\r\nimport IdonethUnits from '../idoneth_deepkin/units'\r\nimport KharadronUnits from '../kharadron_overlords/units'\r\nimport { keyOmitter, keyPicker, pickEffects } from '../metatagger'\r\nimport StormcastUnits from '../stormcast_eternals/units'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Prayers from './prayers'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n [LETHISIAN_DEFENDERS]: {\r\n    effects: pickEffects(BattleTraits, [LETHISIAN_DEFENDERS]),\r\n    available: {\r\n      allied_units: [\r\n        KharadronUnits,\r\n       // keyOmitter(FyreslayersUnits, ['Fjul-Grimnir', 'The Chosen Axes']),\r\n        keyOmitter(StormcastUnits, [\r\n         // 'Astreia Solbright',\r\n        //  'Aventis Firestrike',\r\n         // 'Gavriel Sureheart',\r\n          'Neave Blacktalon',\r\n         // \"Steelheart's Champions\",\r\n         // 'The Farstriders',\r\n          'Vandus Hammerhand',\r\n        ]),\r\n        keyOmitter(IdonethUnits, ['Volturnos, High King of the Deep']),\r\n      ],\r\n      artifacts: [Artifacts],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      prayers: [Prayers],\r\n      units: [Units],\r\n    },\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Onyx Shield Wall'])],\r\n    },\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { LETHISIAN_DEFENDERS } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LethisianDefendersFaction = new Faction(LETHISIAN_DEFENDERS, ORDER, SubFactions)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_LUMINETH: {\r\n    name: 'Battletome: Lumineth Realm-Lords',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_MAY_2021: {\r\n    name: 'Errata (May 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/08/mWMEOpCm7uWKs6FN.pdf',\r\n  },\r\n  ERRATA_JULY_2021: {\r\n    name: 'Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/08/8jwyJBDuvMUu0EsE.pdf',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/08/Nr72FSWnhsPFWgoZ.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_GAME,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  //Vanari\r\n /* 'Syari Pommel': {\r\n    effects: [\r\n      {\r\n        name: `Syari Pommel`,\r\n        desc: `The bearer starts the battle with 1 extra Aetherquartz reserve.`,\r\n        when: [START_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Senlui Amulet': {\r\n    effects: [\r\n      {\r\n        name: `Senlui Amulet`,\r\n        desc: `The bearer can run and still charge in the same turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Waystone: {\r\n    effects: [\r\n      {\r\n        name: `Waystone - Once Per Battle`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  //Scinari\r\n  'Pheonix Stone': {\r\n    effects: [\r\n      {\r\n        name: `Pheonix Stone - Passive`,\r\n        desc: `Effect: If this unit would be destroyed, before removing it from play, roll a dice. On a 3+, this unit is not destroyed and any remaining damage points inflicted on it have no effect. Then, Heal (1) this unit. This unit cannot use this ability again for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Silver Wand': {\r\n    effects: [\r\n      {\r\n        name: `Silver Wand - Passive`,\r\n        desc: `Effect: If this unit is not a Wizard, it has Wizard (1). Otherwise, add 1 to this units power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Rune of Senthoi': {\r\n    effects: [\r\n      {\r\n        name: `Rune of Senthoi`,\r\n        desc: `Add 1 to unbinding and dispelling rolls for the bearer for each friendly Scinari Hero within 6\" of the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Windmage\r\n  'Windblast Fan': {\r\n    effects: [\r\n      {\r\n        name: `Windblast Fan`,\r\n        desc: `Once per battle, at the start of the enemy movement phase, you can pick 1 enemy unit within 3\" of the bearer. That unit must retreat.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wind Stone': {\r\n    effects: [\r\n      {\r\n        name: `Windstone`,\r\n        desc: `Once per battle, in your shooting phase, you can pick 1 enemy unit within 18\" of the bearer and visible to them and roll a dice. On a 1, that unit suffers 1 mortal wound. On a 2-4, that unit suffers 2 mortal wounds. On a 5+, that unit suffers 4 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Buffeting Aspiragillum': {\r\n    effects: [\r\n      {\r\n        name: `Buffeting Aspiragillum`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick 1 enemy unit within 3\" of the bearer. If you do so, subtract 1 from hit rolls and wound rolls for attacks made by that unit until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Stonemage\r\n  'Hearthstone Amulet': {\r\n    effects: [\r\n      {\r\n        name: `Hearthstone Amulet`,\r\n        desc: `The bearer has a ward of 4+ against mortal wounds.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Molten Talisman': {\r\n    effects: [\r\n      {\r\n        name: `Molten Talisman'`,\r\n        desc: `Add 1 to wound rolls for attacks made with melee weapons by friendly Alarith units wholly within 12\" of the bearer if the bearer did not charge in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magmic Hammer': {\r\n    effects: [\r\n      {\r\n        name: `Magmic Hammer`,\r\n        desc: `Add 1 to the number of mortal wounds caused by Arcane Bolt spells that are cast by the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { LUMINETH_REALMLORDS } from 'meta/factions'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [LUMINETH_REALMLORDS]: {\r\n    effects: [\r\n      {\r\n        name: `Lightning Reactions - Passive`,\r\n        desc: `Effect: When players are alternating picking units to use a Fight ability, when it is your turn to pick a unit, you can pick 2 units instead of 1. Resolve the second Fight ability immediately after the first.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shining Company`,\r\n        desc: `Effect: You can only use this ability if you have not used any Facet of War abilities this battle round. \r\n        Subtract 1 from hit rolls for attacks that target friendly Vanari units for the rest of the battle round`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Move Like the Wind`,\r\n        desc: `Declare: You can only use this ability if you have not used any Facet of War abilities this battle round. Pick up to 3 friendly Hurakan units that are not in combat to be the targets. \r\n        Effect: Each target can move a distance up to its Move characteristic. It cannot move into combat during any part of that move, and it cannot use Shoot abilities for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Power of Hysh`,\r\n        desc: `Declare: You can only use this ability if you have not used any Facet of War abilities this battle round. Pick a friendly Vanari unit to be the target. \r\n        Effect: The targets attacks score critical hits on unmodified hit rolls of 5+ for the rest of the battle round.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Deep Thinkers`,\r\n        desc: `Effect: You can only use this ability if you have not used any Facet of War abilities this battle round. \r\n        Add 1 to casting rolls for friendly Scinari units for the rest of the battle round.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Enduring As Rock`,\r\n        desc: `Effect: You can only use this ability if you have not used any Facet of War abilities this battle round. \r\n        Subtract 1 from the Rend characteristic of weapons used for attacks that target friendly Alarith units for the rest of the battle round.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shrine Luminor (Faction Terrain) - Shrine Guardian - Passive`,\r\n        desc: `Effect: While this terrain feature has a Shrine Guardian:  \r\n        This terrain feature has a Move characteristic of 6\" and can use Move abilities as if it were a unit.  \r\n        The Shrine Guardian cannot use Move abilities and remains on this terrain feature each time it moves.  \r\n        Instead of measuring range or visibility to the Shrine Guardian, measure to this terrain feature instead.  \r\n        All attacks that would target the Shrine Guardian target this terrain feature instead.  \r\n        If this terrain feature is destroyed, before removing it from the battlefield, inflict D3 mortal damage on the Shrine Guardian. Then, set up the Shrine Guardian on the battlefield wholly within 3\" of this terrain feature and not in combat. That unit is no longer a Shrine Guardian. If it is not possible to set up the Shrine Guardian, it is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Shrine Luminor (Faction Terrain) - Enter the Shrine`,\r\n        desc: `Declare: If this terrain feature does not have a Shrine Guardian, pick a friendly Lumineth Realm-lords Infantry Hero within 3\" of it to be the target. \r\n        Effect: Place the target on this terrain feature. The target is now a Shrine Guardian (see Shrine Guardian).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shrine Luminor (Faction Terrain) - Exit the Shrine`,\r\n        desc: `Effect: If this terrain feature has a Shrine Guardian, set up the Shrine Guardian on the battlefield wholly within 6\" of this terrain feature and not in combat. That unit is no longer a Shrine Guardian.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shrine Luminor (Faction Terrain) - Cleansing Rituals - Once Per Turn - Reaction: You declared a Spell ability for a unit wholly within 12\" of this terrain feature`,\r\n        desc: `Effect: While this terrain feature has a Shrine Guardian, you can re-roll the casting roll for that spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n /* 'Priority Target': {\r\n    effects: [\r\n      {\r\n        name: `Priority Target`,\r\n        desc: `Pick 1 enemy Monster on the battlefield. You complete this tactic if that Monster is slain in this turn by attacks made by any friendly Starshard Ballistas.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Conserve Aetherquartz': {\r\n    effects: [\r\n      {\r\n        name: `Conserve Aetherquartz`,\r\n        desc: `Pick 1 enemy unit on the battlefield and 1 friendly Lumineth Realm-Lords unit that has at least 1 aetherquartz reserve. You complete this tactic if that enemy unit is destroyed by that Lumineth Realm-Lords unit in this turn and that Lumineth Realm-Lords still has at least 1 aetherquartz reserve at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blind the Enemy': {\r\n    effects: [\r\n      {\r\n        name: `Blind the Enemy`,\r\n        desc: `You complete this tactic if 4 or more spells are successfully cast with different friendly Lumineth Realm-Lords units in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Elemental Supremacy': {\r\n    effects: [\r\n      {\r\n        name: `Elemental Supremacy`,\r\n        desc: `Pick 1 enemy Hero on the battlefield and 1 friendly Aelementiri unit that has at least 1 aetherquartz reserve. You complete this tactc if that Hero is slain by that Aelementiri unit in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hysh Made Manifest': {\r\n    effects: [\r\n      {\r\n        name: `Hysh Made Manifest`,\r\n        desc: `You complete this tactic if there are 2 or more endless spells from your army on the battlefield at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ignore the Odds': {\r\n    effects: [\r\n      {\r\n        name: `Ignore the Odds`,\r\n        desc: `When you reveal this battle tactic, pick 1 friendly Lumineth Realm-Lords unit and 1 enemy unit that are within 1\" of each other. You complete this tactic if that enemy unit is destroyed in this turn and the Lumineth Realm-Lords unit you picked has not been destroyed.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n// Store Command Abilities here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandAbilities = {\r\n /* 'Redoubled Force': {\r\n    effects: [\r\n      {\r\n        name: `Redoubled Force`,\r\n        desc: `Pick 1 YMETRICA ALARITH unit that has forced an enemy unit to move using the Tectonic Force battle trait for the first time in that phase and that is wholly within 18\" of a friendly YMETRICA HERO. You can use Tectonic Force a second time by picking 1 other enemy unit within 1\" of that friendly unit.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Deplete Reserves': {\r\n    effects: [\r\n      {\r\n        name: `Deplete Reserves`,\r\n        desc: `You can use this command ability when a friendly SYAR unit could use an aetherquartz reserve ability, even if any friendly SYAR units have already done so in that phase. Pick 1 friendly SYAR unit that has any aetherquartz reserves and is wholly within 18\" of a friendly SYAR HERO. That unit can use one of its aetherquartz reserves.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_MAY_2021],\r\n      },\r\n    ],\r\n  },\r\n  'Unflinching Valour': {\r\n    effects: [\r\n      {\r\n        name: `Unflinching Valour`,\r\n        desc: `You can use this command ability at the start of the battleshock phase. If you do so, pick 1 friendly model with this command ability. Until the end of that phase, all friendly LUMINETH REALM-LORDS units wholly within 24\" of that model are treated as having a Bravery characteristic of 10.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Faith of the Mountains': {\r\n    effects: [\r\n      {\r\n        name: `Faith of the Mountains`,\r\n        desc: `You can use this command ability at the start of your combat phase. The unit that receives this command must be a friendly Alarith Aelf unit. Add 1 to the attacks characteristic of that unit's melee weapons until the end of that phase. This unit can issue this command up to D3 times in the same phase. If it does so, no command points are spent the second and third times this unit issues this command in that phase. The same unit cannot benefit from this ability and the Unshakeable Faith of the Mountains ability in the same phase.`,\r\n        when: [START_OF_COMBAT_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unshakeable Faith of the Mountains': {\r\n    effects: [\r\n      {\r\n        name: `Unshakeable Faith of the Mountains`,\r\n        desc: `You can use this command ability at the start of your combat phase. the unit that receives the command must be a friendly Alarith Aelf unit. Add 1 to the Attacks characteristic of that unit's melee weapons until the end of that phase. THis unit can issue this command up to 3 times in the same phase. If it does so, no command points are spent the second and third times this unit issues this command in that phase. The same unit cannot benefit from this ability and the Faith of the Mountains ability in the same phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gone Like the Wind': {\r\n    effects: [\r\n      {\r\n        name: `Gone like the Wind`,\r\n        desc: `Pick 1 friendly HELON unit that fought in this phase and is wholly within 12\" of a friendly HELON HERO. That unit can make a normal move or retreat (it cannot run).`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_JULY_2021],\r\n      },\r\n    ],\r\n  },\r\n  'Sieze the Moment': {\r\n    effects: [\r\n      {\r\n        name: `Sieze the Moment`,\r\n        desc: `Pick 1 friendly ALUMNIA unit that ran. It can charge in that charge phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Strike in Unison': {\r\n    effects: [\r\n      {\r\n        name: `Strike in Unison`,\r\n        desc: `You can use this command ability in your shooting phase or in the combat phase. If you do so, pick 1 friendly ILIATHA VANARI unit with 2 or more models. You can reroll hit rolls of 1 for that unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_MAY_2021],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  //Vanari\r\n  'Masterful Tactician': {\r\n    effects: [\r\n      {\r\n        name: `Masterful Tactician - Reaction: You declared the Redeploy command for a friendly Lumineth Realmlords unit wholly within 12\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Perfect Strike': {\r\n    effects: [\r\n      {\r\n        name: `Perfect Strike - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Inflict D3+3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Paragon of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Paragon of Hysh - Once Per Battle - Reaction: You declared the Charge ability or a Spell ability for this unit`,\r\n        desc: `Effect: You can re-roll the charge roll or casting roll for that ability.`,\r\n        when: [HERO_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Scinari\r\n /* Spellmaster: {\r\n    effects: [\r\n      {\r\n        name: `Spellmaster`,\r\n        desc: `Once per battle, this general can use the Magical Boost aetherquartz reserve ability without using an aetherquartz reserve to do so.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Loremaster: {\r\n    effects: [\r\n      {\r\n        name: `Loremaster`,\r\n        desc: `The general knows 1 extra spell from the Lore of Hysh.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fast Learner': {\r\n    effects: [\r\n      {\r\n        name: `Fast Learner`,\r\n        desc: `This general can attempt to unbind 1 extra spell in the enemy hero phase. In addition, the second time that this general attempts to unbind a spell in the same enemy hero phase, you can reroll the unbinding roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Windmage\r\n  'Grand Windrider': {\r\n    effects: [\r\n      {\r\n        name: `Grand Windrider`,\r\n        desc: `Replace this general's Windleap ability with: \"If a friendly Windchargers unit starts a move wholly within 24\" of this general, when it makes that move, that unit has a Move characteristic of 16\" and can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Swift: {\r\n    effects: [\r\n      {\r\n        name: `Swift`,\r\n        desc: `Add 3\" to this general's Move characteristic.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gravity-defying Champion': {\r\n    effects: [\r\n      {\r\n        name: `Gravity-defying Champion`,\r\n        desc: `Once per battle, you can reroll 1 run roll, 1 charge roll, and 1 casting roll for this general.`,\r\n        when: [HERO_PHASE, CHARGE_PHASE, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Stonemage\r\n  'Tectonically Attuned': {\r\n    effects: [\r\n      {\r\n        name: `Tectonically Attuned`,\r\n        desc: `At the start of your shooting phase, you can pick 1 friendly Spirit of the Mountain within 3\" of this general. Add 1 to the Attacks characteristic of that unit's Geomantic Blast until the end of that phase.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Enduring: {\r\n    effects: [\r\n      {\r\n        name: `Enduring`,\r\n        desc: `Add 3 to the general's wound characteristic.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Unyielding Toughness': {\r\n    effects: [\r\n      {\r\n        name: `Unyielding Toughness`,\r\n        desc: `At the start of your hero phase, you can pick 1 friendly Stoneguard unit wholly within 6\" of this general. Add 1 to the Wounds characteristic of that unit until your next hero phase. Designer's Note: This can result in a model that is affected by this ability being slain if the wounds allocated to that model equal or exceed its Wounds characteristic once the effect of this ability ends.`,\r\n        when: [START_OF_HERO_PHASE, DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst EndlessSpells = {\r\n /* 'Hyshian Twinstones': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and range of 6\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, terrain features, other endless spells, invocations and objectives. Only Lumineth Realm-Lords Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Reservoir of Power`,\r\n        desc: `After this endless spell is summoned, place a dice beside it with the '1' facing up. Each time a spell is successfully cast by a Wizard that is within 12\" of this endless spell and not unbound, increase the value of the dice beside this endless spell by 1, to a maximum of 6.\r\n\r\n        Before a Lumineth Realm-Lords Wizard that is within 12\" of this endless spell attempts to cast a spell, that Wizard's commanding player can say that they will draw on the power of the Twinstones. If they do so, they can add the value of the dice beside this endless spell to the casting roll. Then, after the effects of that spell have been resolved, this endless spell is removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sanctum of Amyntok': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This endless spell is summoned with a spell that has a casting value of 7 and range of 3\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 3\" from all other models, terrain features, other endless spells, invocations and objectives. The parts of the endless spell must be set up touching each other so that they form a ring with the caster inside. Only Lumineth Realm-Lords Wizards can attempt to summon this endless spell.\r\n\r\n        A Wizard in a garrison cannot attempt to summon this endless spell, and if this endless spell is summoned, the Wizard that summoned it cannot join a garrison until this endless spell has been removed from play`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Linked,\r\n      {\r\n        name: `Stationery`,\r\n        desc: `While this endless spell is on the battlefield, the model that summoned this endless spell cannot move.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.ERRATA_JULY_2021],\r\n      },\r\n      {\r\n        name: `Barrier`,\r\n        desc: `While this endless spell is on the battlefield, range and visibility to and from the model that summoned this endless spell is measured to and from this endless spell instead.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [rule_sources.ERRATA_JULY_2021],\r\n      },\r\n      {\r\n        name: `Sigil of Yngra`,\r\n        desc: `Subtract 1 from hit rolls and add 1 to save rolls for attacks that target the model that summoned this endless spell while this endless spell is on the battlefield.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE, SAVES_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_JULY_2021],\r\n      },\r\n      {\r\n        name: `Sigil of Yngra`,\r\n        desc: `At the end of the combat phase, if the model that summoned this endless spell was targeted by any attacks in that phase, roll a dice for each enemy unit within 3\" of this endless spell. On a 1-3, nothing happens. On a 4-5, that enemy unit suffers 1 mortal wound. On a 6, that enemy unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rune of Petrification': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 8 and a range of 18\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, terrain features, other endless spells, invocations and objectives. Only Lumineth Realm-Lords Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Turn to Stone`,\r\n        desc: `At the start of the movement phase and at the end of the movement phase, roll a dice for each unit within 6\" of this endless spell. On a 4+, that unit suffers D3 mortal wounds. This ability has no effect on Lumineth Realm-Lords units.`,\r\n        when: [START_OF_MOVEMENT_PHASE, END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Turn to Stone`,\r\n        desc: `Subtract 1 from run rolls and charge rolls for units within 6\" of this endless spell. This ability has no effect on Lumineth Realm-Lords units.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, DURING_GAME, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Vanari Battlehost': {\r\n    effects: [\r\n      {\r\n        name: `Vanari Brilliance - Passive`,\r\n        desc: `Effect: You can use the Power of Hysh ability in addition to the other Facet of War ability used during the battle round.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Scinari Council': {\r\n    effects: [\r\n      {\r\n        name: `Lore of the Scinari - Passive`,\r\n        desc: `Effect: You can use the Deep Thinkers ability in addition to the other Facet of War ability used during the battle round.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Alarith Temple': {\r\n    effects: [\r\n      {\r\n        name: `Alarith Fortitude - Passive`,\r\n        desc: `Effect: You can use the Enduring as Rock ability in addition to the other Facet of War ability used during the battle round.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Hurakan Temple': {\r\n    effects: [\r\n      {\r\n        name: `Grace of the Hurakan - Passive`,\r\n        desc: `Effect: You can use the Move Like the Wind ability in addition to the other Facet of War ability used during the battle round.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n /* Ymetrica: {\r\n    effects: [\r\n      {\r\n        name: `Mountain Realm`,\r\n        desc: `The Enduring as Rock ability of friendly Ymetrica Alarith units worsens the Rend characteristic of attacks that target those units by 2 instead of 1, to a minimum of 0.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  },\r\n  Syar: {\r\n    effects: [\r\n      {\r\n        name: `Gleaming Brightness`,\r\n        desc: `Friendly Syar units start the battle with 2 aetherquartz reserves instead of 1.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Iliatha: {\r\n    effects: [\r\n      {\r\n        name: `Unity of Purpose`,\r\n        desc: `Once per turn, you can say that 2 friendly Iliatha Vanari units will use their aetherquartz reserves to use an aetherquartz reserve ability in the same phase instead of only 1.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Zaitrec: {\r\n    effects: [\r\n      {\r\n        name: `Lambent Mystics`,\r\n        desc: `Add 1 to casting, dispelling or unbinding rolls for friendly Zaitrec Wizards.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* Alumnia: {\r\n    effects: [\r\n      {\r\n        name: `Claim the field`,\r\n        desc: `If the base of each model in a friendly Alumnia Vanari unit is touching the bases of 2 or more other models in the same unit, each model in that unit that is within 6\" of an objective counts as 2 models for the purposes of contesting that objective.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Helon: {\r\n    effects: [\r\n      {\r\n        name: `Gale of Killing Shafts`,\r\n        desc: `In your shooting phase, when you pick a friendly Helon unit to shoot, you can say that it will unleash a gale of killing shafts. If you do so, in that phase, you can add 1 to hit rolls and wound rolls for that unit's missile weapons, but that unit can only target enemy units within 6\" of it.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME, DURING_SETUP, DURING_TURN, HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Scenery = {\r\n/*  'Shrine Luminor': {\r\n    effects: [\r\n      {\r\n        name: `Setup`,\r\n        desc: `After territories are determined, you can set up this faction terrain feature wholly within your territory and more than 3\" from all objectives and other terrain features. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Defensible`,\r\n        desc: `This terrain feature is a defensible terrain feature that can be garrisoned by 1 Lumineth Realm-Lords Hero that is not a Monster and does not have a mount. The garrison is referred to as the terrain feature's 'Shrine Guardian' in the rules on this warscroll.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Cleansing Rituals`,\r\n        desc: `Once per turn, you can reroll 1 casting, dispelling or unbinding roll for 1 friendly Lumineth Realm-Lords Hero that is within 12\" of this terrain feature. If this terrain feature has a Shrine Guardian, the range of this ability is 24\" instead.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_JULY_2021],\r\n      },\r\n      {\r\n        name: `Shrine Guardian`,\r\n        desc: `Once per battle round, this terrain feature's Shrine Guardian can issue a command without a command point being spent.`,\r\n        when: [DURING_TURN],\r\n        rule_sources: [rule_sources.BATTLETOME_LUMINETH, rule_sources.ERRATA_JULY_2021],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Spells = {\r\n  //Lore of Hysh\r\n 'Lore of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Speed of Hysh: Casting value of 5 (UNLIMITED) `,\r\n        desc: `Declare: Pick a friendly Lumineth Realm-lords Wizard to cast this spell, pick a visible friendly Lumineth Realm-lords unit wholly within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Add 4\" to the targets Move characteristic until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Overwhelming Heat: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Lumineth Realm-lords Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Halve the targets Move characteristic until the start of your next turn, then roll a dice. If the roll equals or exceeds the targets Save characteristic, inflict D3 mortal damage on it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Protection of Hysh: Casting value of 8`,\r\n        desc: `Declare: Pick a friendly Lumineth Realm-lords Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, friendly units have Ward (5+) while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /* 'Speed of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Speed of Hysh`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 friendly Lumineth Realm-Lords unit wholly within range and visible to the caster. Double the move characteristic of that unit until your next hero phase.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Solar Flare': {\r\n    effects: [\r\n      {\r\n        name: `Solar Flare`,\r\n        desc: `Casting value of 8 and a range of 10\". Pick a point on the battlefield within range and visible to the caster. If there is an endless spell at that point, it is dispelled, and if there is a unit at that point, roll a number of dice equal to the number of models in that unit. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Protection of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Protection of Hysh`,\r\n        desc: `Casting value of 8 and a range of 9\". Until your next hero phase, friendly units have a ward of 5+ while they are wholly within range of the caster. This spell cannot be cast in the same hero phase as Protection of Teclis.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Protection of Hysh`,\r\n        desc: `If active, until your next hero phase, friendly units wholly within range of the caster have a ward of 5+.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Overwhelming Heat': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelming Heat`,\r\n        desc: `Casting value of 7 and a range of 24\". Pick 1 enemy unit wholly within range and visible to the caster. Halve the Move characteristic of that unit until your next hero phase. Then roll a dice. If the roll is equal to or greater than the unit's Save characteristic, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Etheral Blessings': {\r\n    effects: [\r\n      {\r\n        name: `Etheral Blessings`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly Lumineth Realm-Lords unit wholly within range and visible to the caster. Until your next hero phase, ignore modifiers (positive and negative) when making save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Etheral Blessings`,\r\n        desc: `If active, until your next hero phase, ignore modifiers (positive and negative) when making save rolls for attacks that target that unit.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Total Eclipse': {\r\n    effects: [\r\n      {\r\n        name: `Total Eclipse`,\r\n        desc: `Casting value of 9. If successfully cast, until your next hero phase, your opponent must spend 2 command points to issue a command instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Hurakan\r\n  'Howling Gale': {\r\n    effects: [\r\n      {\r\n        name: `Howling Gale`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. That unit cannot issue or receive commands until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Healing Zephyr': {\r\n    effects: [\r\n      {\r\n        name: `Healing Zephyr`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly Lumineth Realm-Lords unit wholly within range and visible to the caster. You can heal up to D3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Transporting Vortex': {\r\n    effects: [\r\n      {\r\n        name: `Transporting Vortex`,\r\n        desc: `Casting value of 8 and a range of 12\". Pick 1 friendly Lumineth Realm-Lords unit wholly within range and visible to the caster. Remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. That unit cannot move in the next movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Alarith\r\n  'Unbreakable Stoicism': {\r\n    effects: [\r\n      {\r\n        name: `Unbreakable Stoicism`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 friendly Stoneguard unit wholly within range and visible to the caster. Unitl your next hero phase, that unit's Crushing Blow ability causes mortal wounds on an unmodified hit roll of 5+ instead of 6.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crippling Vertigo': {\r\n    effects: [\r\n      {\r\n        name: `Crippling Vertigo`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit wholly within range and visible to the caster. Until your next hero phase, roll 2D6 before that unit makes a normal move, runs, retreats, makes a charge move or makes a pile-in move. If the roll is greater than that unit's bravery, it cannot make that move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Crippling Vertigo`,\r\n        desc: `If active, until your next hero phase, roll 2D6 before that unit makes a normal move, runs, retreats, makes a charge move or makes a pile-in move. If the roll is greater than that unit's bravery, it cannot make that move.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Living Fissure': {\r\n    effects: [\r\n      {\r\n        name: `Living Fissure`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick one point on the battlefield within range of the caster that is visible to them and draw a straight line between that point and the closest part of the caster's base. Roll a dice for each unt that has models passed across by this line. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //Units???\r\n\r\n  Entomb: {\r\n    effects: [\r\n      {\r\n        name: `Entomb`,\r\n        desc: `Casting value of 7. Pick one enemy model within 18\" of the caster and visible to them. Roll a D6, if the roll is greater than the model's Wounds characteristic, that model is slain. If the roll is 6 but not greater than the model's Wounds characteristic, the model suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Assault of Stone': {\r\n    effects: [\r\n      {\r\n        name: `Assault of Stone`,\r\n        desc: `Casting value of 8. Pick one enemy model within 24\" of the caster and visible to them. Roll a number of dice equal to the casting roll. For each roll that is less than the units Save characteristic, that unit suffers 1 mortal wound. Rolls of 1 or 2 always fail. A Save characteristic of '-' counts as a 6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Protection of Teclis': {\r\n    effects: [\r\n      {\r\n        name: `Protection of Teclis`,\r\n        desc: `Casting value of 10 and a range of 18\". Until your next hero phase, friendly units have a ward of 5+ while they are wholly within range of the caster. This spell cannot be cast in the same phase as Protection of Hysh.`,\r\n        when: [HERO_PHASE, WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Storm of Searing White Light': {\r\n    effects: [\r\n      {\r\n        name: `Storm of Searing White Light`,\r\n        desc: `Casting value of 10 and a range of 18\". If successfully cast, roll a dice for each enemy unit within range and visible to the caster.. On a 1, nothing happens. On a 2-4 that unit suffers D3 mortal wounds. On a 5+ that unit suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Darkness of the Soul': {\r\n    effects: [\r\n      {\r\n        name: `Darkness of the Soul`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, roll 2D6 each time that unit makes a normal move, runs, retreats, makes a charge move, shoots or fights. Make the roll before the action is carried out. If the roll is greater than that unit's Bravery characteristic, that unit cannot perform that action in that phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Darkness of the Soul`,\r\n        desc: `If active, until your next hero phase, roll 2D6 each time that unit makes a normal move, runs, retreats, makes a charge move, shoots or fights. Make the roll before the action is carried out. If the roll is greater than that unit's Bravery characteristic, that unit cannot perform that action in that phase.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gravitic Redirection': {\r\n    effects: [\r\n      {\r\n        name: `Gravitic Redirection`,\r\n        desc: `Casting value of 5 and a range of 18\". If successfully cast, until your next hero phase, the caster can fly. In addition, you can pick 1 enemy unit within range and visible to the caster. If you do so, until your next hero phase, that unit's Move characteristic is halved and it cannot fly.`,\r\n        when: [HERO_PHASE, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Power of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Power of Hysh`,\r\n        desc: `Casting value of 6. Until your next hero phase, the Sunmetal Weapons ability for the caster and/or the unit they are part of causes mortal wounds to be inflicted on an unmodified hit roll of 5+ instead of 6. Any number of LUMINETH REALM-LORDS WIZARDS can attempt to cast Power of Hysh in the same hero phase.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Windblast Vortex': {\r\n    effects: [\r\n      {\r\n        name: `Windblast Vortex`,\r\n        desc: `Casting value of 5. Pick 1 enemy unit within 9\" of the caster. Roll a dice, on a 2+ the unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Salvation of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Salvation of Hysh`,\r\n        desc: `Casting value of 6. If successfully cast, the caster has a ward of 5+ until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Salvation of Hysh`,\r\n        desc: `If active, until your next hero phase, the caster has a ward of 5+.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Erasure: {\r\n    effects: [\r\n      {\r\n        name: `Erasure`,\r\n        desc: `Casting value of 7. Pick 1 enemy HERO within 24\" of the caster. You can either inflict D3 mortal wounds on that HERO or mark them for erasure. If the HERO is already marked for erasure, they instead suffer D6 mortal wounds and are no longer marked for erasure.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Greater Power of Hysh': {\r\n    effects: [\r\n      {\r\n        name: `Greater Power of Hysh`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick up to D3 friendly Lumineth Realm-Lords units with the Sunmetal Weapons ability wholly within range and visible to the caster. Until your next hero phase, the Sunmetal Weapons ability of those units causes mortal wounds on an unmodified hit roll of 5+ instead of 6.`,\r\n        when: [HERO_PHASE, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Twinned Tether': {\r\n    effects: [\r\n      {\r\n        name: `Twinned Tether`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, each time a wound or mortal wound is allocated to the caster, your opponent must allocate a wound to that enemy unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dazzling Light': {\r\n    effects: [\r\n      {\r\n        name: `Dazzling Light`,\r\n        desc: `Casting value of 6. Until your next hero phase, subtract 1 from hit rolls targeting the caster and subtract 1 from missile weapon attacks targeting friendly units wholly within 6\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dazzling Light`,\r\n        desc: `If active subtract, 1 from hit rolls targeting friendly units wholly within 6\" of the caster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Dazzling Light`,\r\n        desc: `If active subtract 1 from hit rolls targeting the caster.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_SHOOTING_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport spells from './spells'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst getSunmetalWeaponsEffect = (weapon: string) => ({\r\n /* name: `Sunmetal Weapons`,\r\n  desc: `If the unmodified hit roll for an attack made with a ${weapon} is 6, that attack inflicts 1 mortal wound on the target and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n})\r\n\r\nconst getVanariWizardsEffect = (minimumModelCountToBeWizard: number, modelToBeWizard: string) => ({\r\n /* name: `Magic`,\r\n  desc: `The ${modelToBeWizard} is a WIZARD while this unit has ${minimumModelCountToBeWizard} or more models. That model can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase.`,\r\n  when: [HERO_PHASE],\r\n  shared: true, */\r\n})\r\n\r\nconst StandardBearerEffect = {\r\n /* name: `Standard Bearer`,\r\n  desc: `You can reroll battleshock tests for units that include any Standard Bearers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst AllButImmovableEffect = {\r\n/*  name: `All but Immovable`,\r\n  desc: `If this model doesnt not make a charge move in your charge phase, add 1 to the Attacks characteristic of this model's melee weapons until your next movement phase.`,\r\n  when: [CHARGE_PHASE, COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst StonemageSymbiosisEffect = {\r\n/* name: `Stonemage Symbiosis`,\r\n  desc: `If this unit is within 12\" of a friendly Stonemage, use the top row on this unit's damage table, regardless of how many wounds it has suffered.`,\r\n  when: [DURING_GAME],\r\n  shared: true, */\r\n}\r\n\r\nconst CrushingBlowEffect = {\r\n/*  name: `Crushing Blow`,\r\n  desc: `If the unmodified hit roll for an attack made with a melee weapon by this unit is 6, that attack causes 1 mortal wound to the target in addition to any damage it inflicts.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst DeepThinkersEffect = {\r\n/*  name: `Deep Thinkers`,\r\n  desc: `Once per battle, in your hero phase, when this unit attempts to cast its first spell in that phase, it is automatically cast with a casting roll of 9 (do not roll 2d6), but it can be unbound.`,\r\n  when: [HERO_PHASE],\r\n  rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n  shared: true, */\r\n}\r\nconst PurestAetherquartzHitRollEffect = {\r\n /* name: `Purest Aetherquartz`,\r\n  desc: `Subtract 1 for hit rolls that target this unit. If this unit uses its last Aetherquartz, it can no longer use this ability.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\nconst PurestAetherquartzCastingEffect = {\r\n /* name: `Purest Aetherquartz`,\r\n  desc: `Add 1 to the casting roll when attempting to cast Greater Power of Hysh. If this unit uses its last Aetherquartz, it can no longer use this ability.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst IntoTheGaleOverSaveEffect = {\r\n /* name: `Into the Gale`,\r\n  desc: `This unit has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true, */\r\n}\r\nconst LivingCycloneEffect = {\r\n /* name: `Living Cyclone`,\r\n  desc: `Roll a dice for each enemy unit that is within 3\" of this unit after this unit makes a charge move. On a 3+, that unit suffers 1 mortal wound, and subtract 1 from hit rolls for that unit until the end of the next combat phase. The same unit cannot be affected by this ability more than once per phase.`,\r\n  when: [CHARGE_PHASE, COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst MoveLikeTheWindEffect = {\r\n /* name: `Move like the wind`,\r\n  desc: `When you make a pile-in move with this unit, it does not have to finish the move no further from the nearest enemy unit than it was at the start of the move. In addition, when you make a pile-in move with this unit, if it made a charge move in the same turn, it can move an extra 3\" when it piles in.`,\r\n  when: [CHARGE_PHASE, COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst SpiritOfTheWindEffect = {\r\n /* name: `Spirit of the Wind`,\r\n  desc: `At the end of your shooting phase, this model can make a normal move or a retreat of 12\" (it cannot run). In addition, this unit can retreat and still charge later in the turn.`,\r\n  when: [END_OF_SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst EnduringAsRockEffect = {\r\n /* name: `Enduring as Rock`,\r\n  desc: `When this unit is targeted by an attack, worsen the Rend characteristic of that attack by 1, to a minimum of 0.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n  shared: true, */\r\n}\r\n\r\nconst ShiningCompanyEffect = {\r\n /* name: `Shining Company`,\r\n  desc: `Subtract 1 from hit rolls for attacks that target this unit if this base of each model in this unit is touching the bases of 2 or more other models in the same unit.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  shared: true, */\r\n}\r\n\r\nconst SunmetalWeaponEffect = {\r\n /* name: `Sunmetal Weapons`,\r\n  desc: `If the unmodified hit roll for an attack made by this unit is 6, that attack causes 1 mortal wound to the target and the attack sequence ends (do not make a wound roll or save roll). This ability has no effect made by this unti's mounts.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true, */\r\n}\r\nconst Units = {\r\n  'Archmage Teclis': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Protection of Teclis', 'Storm of Searing White Light'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Archmage - Passive`,\r\n        desc: `Effect: Instead of making a casting roll for this unit, you can use a value of 10 for the roll that cannot be modified. In addition, instead of making an unbinding roll or banishment roll for this unit, you can use a value of 8 for the roll that cannot be modified.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Celennars Moonbright Talons is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of Celennar - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for other friendly Lumineth Realm-lords Wizards while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spirit of the Moon - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_LUMINETH,\r\n          meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n        ],\r\n      },\r\n      {\r\n        name: `Storm of Searing White Light: Casting value of 10`,\r\n        desc: `Declare: Pick any number of different visible enemy units within 18\" of this unit to be the targets, then make a casting roll of 2D6 (see the Archmage ability). \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_LUMINETH,\r\n          meta_rule_sources.BATTLESCROLL_DEPLETED_RESERVES_APRIL_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'The Light of Eltharion': {\r\n    effects: [\r\n      {\r\n        name: `Spirit Armour - Passive`,\r\n        desc: `Effect: Ignore all modifiers to save rolls for this unit (positive and negative).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Supreme Swordmaster - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to hit rolls and wound rolls for this units attacks. In addition, ignore negative modifiers to the characteristics of this units melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lyrior Uthralle, Warden of Ymetrica': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Greater Power of Hysh'])],\r\n    }, */\r\n    effects: [\r\n    //  PurestAetherquartzHitRollEffect,\r\n     // PurestAetherquartzCastingEffect,\r\n      //getSunmetalWeaponsEffect(`Regent's Sword`),\r\n      {\r\n        name: `Solar Flare: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit or Manifestation wholly within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target is a Manifestation, inflict 3D6 mortal damage on it. Otherwise, roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Voice of Tyrion - Reaction: You declared the All-out Attack command for a friendly Vanari unit`,\r\n        desc: `Effect: If this unit is wholly within 12\" of the unit using the All-out Attack command, no command points are spent to use that command.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vanari Lord Regent': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Greater Power of Hysh'])],\r\n    }, */\r\n    effects: [\r\n     // getSunmetalWeaponsEffect(`Regent's Sword`),\r\n     // PurestAetherquartzCastingEffect,\r\n     // PurestAetherquartzHitRollEffect,\r\n     {\r\n      name: `Purest Aetherquartz - Once Per Battle`,\r\n      desc: `Effect: For the rest of the turn, add 1 to casting rolls for this unit and subtract 1 from hit rolls for attacks that target this unit.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Charge of the Lumineth - Once Per Battle`,\r\n      desc: `Declare: Pick this unit and up to 2 friendly Vanari Dawnriders units within this units combat range to be the targets. \r\n      Effect: You can re-roll charge rolls for the targets for the rest of the turn. In addition, if a target charges this phase, add 1 to the Attacks characteristic of that targets weapons for the rest of the turn.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Vanari Bannerblade': {\r\n    effects: [\r\n     // SunmetalWeaponEffect,\r\n      {\r\n        name: `World Banner - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Lumineth Realm-lords units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Vanari Auralan Sentinels': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Power of Hysh'])],\r\n    }, */\r\n    effects: [\r\n    //  getVanariWizardsEffect(5, `High Sentinel`),\r\n      {\r\n        name: `Lofted Shots`,\r\n        desc: `Effect: For the rest of the turn, add 6\" to the Range characteristic of this units Auralan Bows but subtract 1 from hit rolls for this units shooting attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    //  SunmetalWeaponEffect,\r\n    ],\r\n  },\r\n  'Vanari Auralan Wardens': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Power of Hysh'])],\r\n    }, */\r\n    effects: [\r\n     // SunmetalWeaponEffect,\r\n     // getVanariWizardsEffect(5, `High Warden`),\r\n      {\r\n        name: `Wall of Blades`,\r\n        desc: `Effect: If this unit did not charge this turn and is in combat with an enemy unit that charged this turn, roll a dice. Add 1 to the roll if that enemy unit is Cavalry. On a 4+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ShiningCompanyEffect,\r\n    ],\r\n  },\r\n  'Vanari Dawnriders': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Power of Hysh'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Deathly Furrows`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit within 1\" of it to be the target. \r\n        Effect: Roll a dice for each model in this unit. For each 3+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // SunmetalWeaponEffect,\r\n     // getVanariWizardsEffect(3, `Steedmaster`),\r\n     // StandardBearerEffect,\r\n    //  ShiningCompanyEffect,\r\n    ],\r\n  },\r\n  'Vanari Starshard Ballistas': {\r\n    effects: [\r\n      {\r\n        name: `Blinding Bolts - Once Per Battle`,\r\n        desc: `Effect: If all of this units shooting attacks this turn target the same enemy unit, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Scryhawks`,\r\n        desc: `Effect: For the rest of the turn, add 6\" to the Range characteristic of this units Starshard Bolts while it is wholly within 12\" of any friendly Vanari Auralan Sentinels units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vanari Bladelords': {\r\n    effects: [\r\n      {\r\n        name: `Guardians - Passive`,\r\n        desc: `Effect: While any friendly Scinari Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Swordmasters - Passive`,\r\n        desc: `Effect: Each time this unit uses a Fight ability, you must pick either the Perfect Strike or Flurry of Blows weapon characteristics for all the attacks it makes with its Sunmetal Blades. \r\n        In addition, do not use the attack sequence for an attack made with Perfect Strike. Instead, roll a dice. On a 2+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // SunmetalWeaponEffect,\r\n     // ShiningCompanyEffect,\r\n    ],\r\n  },\r\n  'Scinari Cathallar': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Darkness of the Soul'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Absorb Despair - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to the control scores of friendly Lumineth Realm-lords units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Darkness of the Soul`,\r\n        desc: `Declare: Pick an enemy unit within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract D6 from the targets control score for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scinari Enlightener': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Twinned Tether'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     // DeepThinkersEffect,\r\n      {\r\n        name: `Rune of Enthlai - Once Per Turn - Reaction: You declared the Speed of Hysh, Overwhelming Heat or Ethereal Blessings spell for this unit`,\r\n        desc: `Effect: If that spell is successfully cast, roll a dice. On a 3+, after resolving the effect of that spell, this unit can immediately cast that spell a second time using the same casting roll. Do not count the second spell towards the number of Spell abilities this unit can use this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ethereal Blessings: Casting value of 6`,\r\n        desc: `Declare: Pick a visible friendly Lumineth Realm-lords Infantry unit wholly within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore all modifiers to save rolls for the target (positive and negative) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scinari Calligrave': {\r\n  /* mandatory: {\r\n      spells: [keyPicker(spells, ['Erasure'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    //  DeepThinkersEffect,\r\n      {\r\n        name: `Realmscribe - Once Per Turn - Reaction: You declared a Summon Spell ability for this unit`,\r\n        desc: `Effect: Change the casting roll for that spell to a value of 8 that cannot be modified.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scinari Loreseeker': {\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Lone Agent - Passive`,\r\n        desc: `Effect: Add 5 to this units control score while it is more than 9\" from all other friendly units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Independent Operative`,\r\n        desc: `Effect: If this unit has not been deployed, set it up anywhere on the battlefield not in combat with any enemy units. This unit has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Alarith Spirit of the Mountain': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Faith of the Mountains'])],\r\n    }, */\r\n    effects: [\r\n    //  StonemageSymbiosisEffect,\r\n     // AllButImmovableEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stoneheart Worldhammer is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stonemage Symbiosis - Passive`,\r\n        desc: `Effect: The Battle Damaged ability has no effect on this unit while it is wholly within 12\" of a friendly Alarith Stonemage.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Stoneheart Shockwave - Once Per Turn`,\r\n        desc: `Declare: If this unit did not charge this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Alarith Stoneguard': {\r\n    effects: [\r\n    //  StandardBearerEffect,\r\n     // CrushingBlowEffect,\r\n     // EnduringAsRockEffect,\r\n      {\r\n        name: `Fortitude of the Earth - Passive`,\r\n        desc: `Effect: This unit has Ward (5+) while all of its models are contesting an objective you control.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Alarith Stonemage': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Gravitic Redirection'])],\r\n    }, */\r\n     effects: [\r\n     // EnduringAsRockEffect,\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Stonemage stance`,\r\n        desc: `Declare: Pick a friendly Alarith Aelf unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to the Rend characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Living Fissure: Casting value of 7`,\r\n        desc: `Declare: Pick a point on the battlefield within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Draw a straight line between the target and the closest part of this units base. Roll a D3 for each unit (friendly and enemy) that the line passes across. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Avalenor, the Stoneheart King': {\r\n  /*  mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Unshakeable Faith of the Mountains'])],\r\n    }, */\r\n    effects: [\r\n    //  StonemageSymbiosisEffect,\r\n    //  AllButImmovableEffect,\r\n     // EnduringAsRockEffect,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Firestealer Hammers is 4.`,\r\n      when: [COMBAT_PHASE],\r\n     }, \r\n     {\r\n      name: `Stonemage Symbiosis - Passive`,\r\n      desc: `Effect: The Battle Damaged ability has no effect on this unit while it is wholly within 12\" of a friendly Alarith Stonemage.`,\r\n      when: [DURING_GAME],\r\n    },\r\n     {\r\n        name: `Command Ability - Unshakeable Faith of the Mountains`,\r\n        desc: `Declare: Pick up to 3 dierent friendly Alarith Aelf units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unbreakable Bulwark - Once Per Turn`,\r\n        desc: `Declare: If this unit did not charge this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from the Rend characteristic of the targets melee weapons for the rest of the turn and add 1 to the Attacks characteristic of this units melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ellania and Ellathor, Eclipsian Warsages': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Salvation of Hysh'])],\r\n    }, */\r\n    effects: [\r\n      // GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Equal Prodigies`,\r\n        desc: `Declare: Pick whether Ellania will take the lead or Ellathor will take the lead. \r\n        Effect: If Ellania takes the lead, until the start of your next turn, add 1 to this units power level and it has Ward (4+). If Ellathor takes the lead, until the start of your next turn, add the current battle round number to the Damage characteristic of Altairi.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Total Eclipse: Casting value of 8`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, the first time an enemy unit uses a command within 18\" of this unit, your opponent must spend an additional command point to use that command.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sudden Translocation`,\r\n        desc: `Effect: This unit can use this ability if any enemy models were slain by it this turn. Heal (D6) this unit. Then, remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. When using the Equal Prodigies ability in your next turn, you must pick Ellania to take the lead.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Hurakan Windmage': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Windblast Vortex'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n     // MoveLikeTheWindEffect,\r\n      {\r\n        name: `Transporting Vortex: Casting value of 7`,\r\n        desc: `Declare: Pick a visible friendly Lumineth Realm-lords unit wholly within 12\" of this unit and not in combat to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield more than 9\" from all enemy units`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Windleap`,\r\n        desc: `Declare: Pick a friendly Hurakan Windchargers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 3\" to the targets Move characteristic for the rest of the turn and the target has Fly for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hurakan Windchargers': {\r\n    effects: [\r\n    //  StandardBearerEffect,\r\n    //  MoveLikeTheWindEffect,\r\n      {\r\n        name: `Windcharger Arrows - Passive`,\r\n        desc: `Effect: Ward rolls cannot be made for damage points inflicted by this units shooting attacks`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sevireth, Lord of the Seventh Wind': {\r\n    effects: [\r\n     // IntoTheGaleOverSaveEffect,\r\n    //  LivingCycloneEffect,\r\n     // MoveLikeTheWindEffect,\r\n     // SpiritOfTheWindEffect,\r\n     {\r\n      name: `The Living Gale - Passive`,\r\n      desc: `Effect: This unit cannot be targeted by shooting attacks made by enemy units that are more than 9\" from this unit.`,\r\n      when: [SHOOTING_PHASE],\r\n    },\r\n      {\r\n        name: `Spirit of the Wind - Passive`,\r\n        desc: `Effect: While friendly Hurakan units are wholly within 12\" of this unit, they can use Shoot and/or Charge abilities even if they used a Run or Retreat ability in the same turn and no mortal damage is inflicted on them by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Searing Desert Winds`,\r\n        desc: `Declare: Pick up to 3 dierent enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll and subtract 1 from wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hurakan Spirit of the Wind': {\r\n    effects: [\r\n      // IntoTheGaleOverSaveEffect, SpiritOfTheWindEffect, LivingCycloneEffect\r\n      {\r\n        name: `Spirit of the Wind - Passive`,\r\n        desc: `Effect: While friendly Hurakan units are wholly within 12\" of this unit, they can use Shoot and/or Charge abilities even if they used a Run or Retreat ability in the same turn and no mortal damage is inflicted on them by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Hunters of the Majestic Beasts - Passive`,\r\n        desc: `Effect: The Damage characteristic of this units Bow of the Winds Vengeance is 3 for attacks that target Monsters.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Living Cyclone - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll, then this unit can move 6\", but it must end that move in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      ],\r\n  },\r\n  'Ydrilan Riverblades': {\r\n    effects: [\r\n      // IntoTheGaleOverSaveEffect, SpiritOfTheWindEffect, LivingCycloneEffect\r\n      {\r\n        name: `Relentless as the Driving Current`,\r\n        desc: `Effect: This unit can move 2D6\". It can pass through models in enemy units but must end that move in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Travel the Waterways`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield wholly within 6\" of a battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      ],\r\n  },\r\n  /*'Myari Lightcaller': {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Dazzling Light'])],\r\n    }, \r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    //  DeepThinkersEffect,\r\n      {\r\n        name: `Scryowl Familiar`,\r\n        desc: `Add 1 to casting, unbinding, and dispelling rolls for this model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scryowl Familiar`,\r\n        desc: `You can pick 1 enemy unit within 24\" and not visible. The target becomes visible.`,\r\n        when: [START_OF_HERO_PHASE, START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Myari's Purifiers\": {\r\n    effects: [\r\n      {\r\n        name: `Guardians`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly Myari Lightcaller within 3\" of this unit, or instead of making a ward roll for a wound or mortal wound that would be allocated to Myari Lightcaller within 3\" of this unit, roll a dice. On a 2+, that wound or mortal wound must be allocated to this unit instead of Myari Lightcaller and cannot be negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Purifying Strikes`,\r\n        desc: `If the unmodified hit roll for an attack made by this unit is 6, that attack causes 1 mortal wound to the target and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: Fjori`s Flamebearers': {\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { LUMINETH_REALMLORDS } from 'meta/factions'\r\nimport { pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport grand_strategies from './grand_strategies'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [grand_strategies],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [LUMINETH_REALMLORDS]: {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [LUMINETH_REALMLORDS]),\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Vanari Assault': {\r\n    effects: [\r\n      {\r\n        name: `Vanari Assault`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 4 or more friendly Vanari units on the battlefield and the model picked to be your opponent's genearl has been slain.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Scinari Illumination': {\r\n    effects: [\r\n      {\r\n        name: `Scinari Illumination`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is a friendly Scinari unit in each quarter of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Alarith Aftershock': {\r\n    effects: [\r\n      {\r\n        name: `Alarith Aftershock`,\r\n        desc: `When the battle ends, you complete this grand strategy if 2 or more friendly Alarith units are contesting 2 or more objectives on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Hurakan Cyclone': {\r\n    effects: [\r\n      {\r\n        name: `Hurakan Cyclone`,\r\n        desc: `When the battle ends, you complete this grand strategy if 3 or more friendly Hurakan units are within 6\" of the same enemy unit on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { LUMINETH_REALMLORDS } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const LuminethRealmlordsFaction = new Faction(\r\n  LUMINETH_REALMLORDS,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_LUMINETH\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\n/*const AlmightyStompEffect = {\r\n  name: `Almighty Stomp`,\r\n  desc: `Add 1 to hit rolls for attacks made with this unit's Almighty Stomp that target an enemy unit with a Wounds characteristic of 3 or less.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CrushingChargeEffect = {\r\n  name: `Crushing Charge`,\r\n  desc: `After this model makes a charge move, roll a dice for each enemy unit within 1\" of this model. On a 2+, that unit suffers D3 mortal wounds if it is a MONSTER, or D6 mortal wounds if it is not a MONSTER.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst DeathGripEffect = {\r\n  name: `Death Grip`,\r\n  desc: `When determinig the damage inflicted by an attack made with this unit's Death Grip that targets an enemy Monster, you can roll 2 dice instead of 1 and pick either result.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst LongshanksEffect = {\r\n  name: `Longshanks`,\r\n  desc: `When this unit makes a normal move, run or retreats, it can pass across other models that are not Monsters and parts of terrain features that are less than 4\" tall in the same manner as a unit that can fly.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst SonOfBehematEffect = {\r\n  name: `Son of Behemat`,\r\n  desc: `If a spell or ability would slay this model without any wounds or mortal wounds being caused by the spell or ability, this model suffers D6 mortal wounds instead of being slain.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true,\r\n}\r\nconst TerrorEffect = {\r\n  name: `Terror`,\r\n  desc: `Enemy units cannot receive the Inspiring PResence command while they are within 3\" of any friendly units with this ability.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst TimberrrrrEffect = {\r\n  name: `Timberrrrr!`,\r\n  desc: `If this model is slain, before removing the model from the battlefield, the players must roll off. The winner must pick a point on the battlefield 5\" from this model. Each unit within 3\" of that point that is not a Mega-Gargant suffers D3 mortal wounds. This slain model is then removed from the battlefield.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  shared: true,\r\n}\r\nconst BaseMegaGargantEffects = [\r\n  AlmightyStompEffect,\r\n  CrushingChargeEffect,\r\n  DeathGripEffect,\r\n  TerrorEffect,\r\n  LongshanksEffect,\r\n  SonOfBehematEffect,\r\n  TimberrrrrEffect,\r\n]\r\n\r\nconst BaseGargantEffects = [\r\n  {\r\n    name: `Keep Up!`,\r\n    desc: `If this unit is wholly within 15\" of a friendly MEGA-GARGANT at the start of the charge phase, it can attempt to charge in that charge phase even if it ran in the same turn.`,\r\n    when: [START_OF_CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Stomping Charge`,\r\n    desc: `After a model from this unit makes a charge move, pick 1 enemy unit within 1\" of it and roll a dice. If the roll is equal to or greater than the Stomping Charge value for the charging model shown on the damage table above, that unit suffers D3 mortal wounds. If this unit has more than 1 model, do not allocate the mortal wounds until all of the models in this unit have made their charge moves.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Stuff 'Em In Me Bag`,\r\n    desc: `After a model from this unit piles in, you can pick 1 enemy model within 3\" of it and roll a D6. If the roll is at least double that model's Wounds characteristic, it is slain.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Timber!`,\r\n    desc: `If a model from this unit is slain, before removing it from the battlefield, the players must roll off. The winner must pick a point on the battlefield 3\" from that model. Each unit within 2\" of that point that is not a Gargant or Mega-Gargant suffers D3 mortal wounds. The slain model is then removed from the battlefield.`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n] */\r\n\r\nconst Units = {\r\n  'Kragnos': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of The Dread Mace is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 3+, ignore the effect of that spell on this unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this phase, pick 1 of the following effects:  \r\n        Roll a dice for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.  \r\n        Pick an enemy Monster in combat with this unit and roll 2D6. On a 7, this ability has no effect. Otherwise, inflict an amount of mortal damage on that unit equal to the results on the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal damage (2x6).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The End of Empires - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for friendly Destruction units while they are wholly within 12\" of this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'King Brodd': {\r\n    effects: [\r\n     // ...BaseMegaGargantEffects,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Obelisk of Tor Crania is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Creepers - Passive`,\r\n        desc: `Effect: This unit cannot be picked to be the target of enemy Rampage abilities.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Power of Behemat: Chant value of 5`,\r\n        desc: `Declare: Make a chanting roll of D6. \r\n        Effect: Pick 1 of the following effects. If the chanting roll was 10+, pick 2 instead: \r\n        Shatter the Mountains: Add 2\" to the Move characteristic of friendly Sons of Behemat units for the rest of the turn. \r\n        Might of the Earth: Heal (D3) each friendly Sons of Behemat unit. \r\n        Pummel All to Dust: For the rest of the turn, add 1 to the Rend characteristic of the Obelisk of Tor Crania, Menhir Club, Fortcrusha Flail, Shipwrecka Warclub, Titanic Boulderclub and Massive Club used by friendly Sons of Behemat units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Beast-Smasher': {\r\n    effects: [\r\n     // ...BaseMegaGargantEffects,\r\n      {\r\n        name: `Beast-Breaking Strike`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 5D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      //  shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Behemoth Brawler - Passive`,\r\n        desc: `Effect: Subtract 1 from the Attacks characteristic of enemy Monsters while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Menhir Club is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gatebreaker: {\r\n    effects: [\r\n     // ...BaseMegaGargantEffects,\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kraken-Eater': {\r\n    effects: [\r\n    //  ...BaseMegaGargantEffects,\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Warstomper: {\r\n    effects: [\r\n    //  ...BaseMegaGargantEffects,\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      //  shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n       // shared: true, // it's not normally correct to set this directly on units, but this unit gets extended for the merc version\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mancrusher Gargant': {\r\n    effects: [\r\n      {\r\n        name: `Keep Up! - Passive`,\r\n        desc: `Effect: While this unit is wholly within 12\" of a friendly Mega-Gargant, this unit can use Charge abilities even if it used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em in Me Bag - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ...BaseGargantEffects\r\n    ],\r\n  },\r\n  'Mancrusher Mob': {\r\n    effects: [\r\n     // ...BaseGargantEffects,\r\n     {\r\n      name: `Keep Up! - Passive`,\r\n      desc: `Effect: While this unit is wholly within 12\" of a friendly Mega-Gargant, this unit can use Charge abilities even if it used a Run ability in the same turn.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n    {\r\n      name: `Stuff 'Em in Me Bag - Once Per Turn`,\r\n      desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n      Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n      {\r\n        name: `Oo's Under the Heel Now! - Passive`,\r\n        desc: `Effect: Each time this unit uses the Gargant Charge ability, add 1 to the amount of mortal damage inflicted, if any, for each model in this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Bonegrinder Mega-Gargant': {\r\n    effects: [\r\n     // SonOfBehematEffect,\r\n    //  GenericEffects.Terror,\r\n    //  LongshanksEffect,\r\n    //  TimberrrrrEffect,\r\n      {\r\n        name: `Thunderous Stomp`,\r\n        desc: `You can reroll hit rolls of 1 for Thunderous Stomp attacks unless the target is a MONSTER.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Bite Your Head Off!`,\r\n        desc: `After this model piles in, you can pick 1 enemy model that is within 3\" of this model, and roll a dice. If the roll is greater than that enemy model's Wounds characteristic, that enemy model is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mega-Club of Gork`,\r\n        desc: `Add 1 to the Bravery characteristic of friendly Orruk units while they are wholly within 12\" of this model.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    //  LongshanksEffect,\r\n    ],\r\n  }, */\r\n  'ROR: Braggit`s Bottle-Snatchaz': {\r\n    effects: [\r\n      {\r\n        name: `Super-Secret Tunnels`,\r\n        desc: `Declare: Pick a unit in this Regiment of Renown that has not been deployed. \r\n        Effect: Set up that unit in reserve in a super-secret tunnel. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Sudden Emergence - Once Per Turn`,\r\n        desc: `Declare: If the Rabble-Rowza in this Regiment of Renown is in a super-secret tunnel, pick it to be the target. \r\n        Effect: Set up the target anywhere on the battlefield more than 9\" from all enemy units. Then, set up all other friendly units that are in a super-secret tunnel within 3\" of the target and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Rabble-Rowza: Neh Neh Na-Neh Neh! Can't Catch me! - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Monster or Beast unit to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn, but each time it uses a Move ability, it must end the move closer to this unit. \r\n        In addition, for the rest of the turn, the first time the target ends a move within this units combat range, inflict D6 mortal damage on this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Hallucinogenic Fungus Brews - Passive`,\r\n        desc: `Effect: In the first battle round, this unit has Ward (4+). In the second battle round, this unit has Ward (5+). In the third and subsequent battle rounds, this unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Gobbapalooza Know-Wotz`,\r\n        desc: `Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Glareface Dance: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to run rolls and charge rolls for that unit until the start of your next turn. \r\n        Nasty Poisons: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to the Rend characteristic of that units weapons until the start of your next turn. \r\n        Mesmerise: Pick a visible enemy unit within 12\" of this unit. Until the start of your next turn, that unit cannot use commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Squig Herd: Squigs Gone Wild - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Herding Squigs`,\r\n        desc: `Effect: Roll a dice for each Squig Herder in this unit. For each 2+, you can return D3 slain Cave Squigs to this unit. For each 1, 1 Squig Herder in this unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Hoppers: Boing! Boing! Boing!`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sneaky Distraction: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Gobbapalooza in this Regiment of Renown to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for attacks made by enemy units while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Grikk`s Kruleshots': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Skewer Killbow: Skewering Bolts - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, the Damage characteristic of this units Beast-Skewer Bolts is 6 if the target is a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Skewer Killbow: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Man-Skewer Crossbows - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, pick either the Hasty Shot or Aimed Shot weapon characteristics for all the attacks it makes with its Man-skewer Crossbows.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Skewer It Again! - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster that had any damage points allocated to it this phase by a shooting attack made by the Beast-skewer Killbow in this Regiment of Renown. Then, pick any number of Man-skewer Boltboyz units in this Regiment of Renown to focus fire. \r\n        Effect: For the rest of the turn, add 1 to the Attacks characteristic of the ranged weapons used by the units you picked to focus fire but all of their attacks must target the enemy Monster you picked.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { pickEffects, tagAs } from 'factions/metatagger'\r\nimport SonsOfBehematUnits from 'factions/sons_of_behemat/units'\r\nimport { COMBAT_PHASE, END_OF_COMBAT_PHASE, SHOOTING_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst Units = {\r\n  'Odo Godswallow - Beast-Smasher': {\r\n    effects: [\r\n      ...pickEffects(SonsOfBehematUnits, ['Beast-Smasher']),\r\n      {\r\n        name: `Mighty Wallopwer`,\r\n        desc: `Add 1 to hit rolls for attacks made by this unit that target an enemy Monster.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bundo Whalebiter - Kraken-Eater': {\r\n    effects: [\r\n      ...pickEffects(SonsOfBehematUnits, ['Kraken-Eater']),\r\n      {\r\n        name: `Dead Cunning, for a Gargant`,\r\n        desc: `At the start of the combat phase. you can say that this model will be uncannily cunning. If you do so, the strike-last effect applies to this unit until the end of that phase. but you can add 1 to hit and wound rolls for attacks made by this model in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'One-Eyed Grunnock - Warstomper': {\r\n    effects: [\r\n      ...pickEffects(SonsOfBehematUnits, ['Warstomper']),\r\n      {\r\n        name: `Shake The Earth`,\r\n        desc: `Subtract 1 from hit rolls for attacks made by enemy units within 6\" of this model if this unit made any Jump Up and Down attacks earlier in the same phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Big Drogg Fort-Kicka - Gatebreaker': {\r\n    effects: [\r\n      ...pickEffects(SonsOfBehematUnits, ['Gatebreaker']),\r\n      {\r\n        name: `Grievous Halitosis`,\r\n        desc: `At the end of the combat phase, you can pick 1 enemy unit within 3\" of this unit and roll a number of dice equal to the number of models from that unit that are within 3\" of this model. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { GenericEffects } from 'generic_rules'\r\nimport { MEGA_GARGANT_MERCENARIES } from 'meta/factions'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [MEGA_GARGANT_MERCENARIES]: {\r\n    effects: [GenericEffects.DisruptivePresence],\r\n    available: {\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { MEGA_GARGANT_MERCENARIES } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const MegaGargantMercenariesFaction = new Faction(\r\n  MEGA_GARGANT_MERCENARIES,\r\n  DESTRUCTION,\r\n  SubFactions,\r\n  'Flavors',\r\n  undefined,\r\n  undefined,\r\n  true\r\n)\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_FOUR_START_OF_ROUND,\r\n  TURN_ONE_START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport prayers from './prayers'\r\nimport spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const ThundertuskEffects = [\r\n  {\r\n    name: `Blasts of Frost-wreathed Ice`,\r\n    desc: `Do not use the attack sequence for an attack made with Frost-wreathed Ice. Instead, pick 1 enemy unit within 18\" of this model that is visible to it and roll the number of dice shown on the damage table on the warscroll.\r\n      Add 1 to each roll if the target unit has 10 or more models.\r\n      Add 2 to each roll instead if the target unit has 20 or more models.\r\n      For each 6+, that enemy unit suffers 1 mortal wound.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Numbing Chill`,\r\n    desc: `Subtract 1 from hit rolls for attacks made with melee weapons that target this unit.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst StonehornEffects = [\r\n  {\r\n    name: `Earth-shattering Charge`,\r\n    desc: `Add 1 to the damage inflicted by attacks made with this model's Rock-hard Horns and Crushing Hooves if this model made a charge move in the same turn.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Stone Skeleton`,\r\n    desc: `This unit has a ward of 5+.`,\r\n    when: [WOUND_ALLOCATION_PHASE, WARDS_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst ReelEmInEffects = [\r\n  {\r\n    name: `Reel Em In`,\r\n    desc: `If an attack made with a Chaintrap scores a hit on an enemy MONSTER and that MONSTER unit is not\r\n  destroyed and not already snagged, after that attack has been resolved, you can roll a dice. On a 4+ that MONSTER unit is snagged until the start of your next shooting phase. \r\n  \r\n  While a MONSTER unit is snagged, each time it makes a move, it must finish that move at least as close to the unit that snagged it as it was at the start of the move.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Reel Em In`,\r\n    desc: `While an enemy MONSTER unit is snagged, each time it makes a move, it must finish that move at least as close to the unit that snagged it as it was at the start of the move.`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst BloodVultureEffect = {\r\n  name: `Blood Vulture`,\r\n  desc: `If this model is armed with a Blood Vulture, at the start of your shooting phase, pick 1 enemy unit that is visible to it and roll a D6. On a 2+, that unit suffers 1 mortal wound.`,\r\n  when: [START_OF_SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst MastersOfAmbushEffects = (otherUnit: 'Frost Sabres' | \"Hrothgorn's Mantrappers\") => [\r\n  {\r\n    name: `Masters of Ambush`,\r\n    desc: `Instead of setting up this model on the battlefield, you can place it to one side and say that it is set up in ambush as a reserve unit. If you do so, when you would set up a friendly ${otherUnit} unit, instead of setting up that unit on the battlefield, you can say that it is joining this model in ambush as a reserve unit. 1 unit can join this model in this way.`,\r\n    when: [DURING_SETUP],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Masters of Ambush`,\r\n    desc: `If you set this model up in reserve, at the end of your movement phase, you can set up this model anywhere on the battlefield that is more than 9\" from any enemy units. You can then set up any unit that joined this model in ambush wholly within 12\" of this model and more than 9\" from any enemy units.`,\r\n    when: [END_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Masters of Ambush`,\r\n    desc: `Any reserve units in ambush that are not set up on the battlefield before the start of the fourth battle round are destroyed.`,\r\n    when: [TURN_FOUR_START_OF_ROUND],\r\n    shared: true,\r\n  },\r\n]\r\nconst RhinoxChargeEffect = {\r\n  name: `Rhinox Charge`,\r\n  desc: `Add 1 to the damage inflicted by attacks made with this unit's Rhinox's Sharp Horns if this model made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst IronfistEffect = {\r\n  name: `Ironfist`,\r\n  desc: `If the unmodified save roll for an attack made with a melee weapon that targets a unit armed with Ironfists is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst BellowerEffect = {\r\n  name: `Bellower`,\r\n  desc: `Add 1 to charge rolls for this unit if it includes any bellowers.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst BloodgruelEffect = {\r\n  name: `Bloodgruel`,\r\n  desc: `Roll a D6 each time this model successfully casts or unbinds a spell, after the effects of the spell have been resolved. On a 2+, you can heal 1 wound allocated to this model. On a 1, this model suffers 1 mortal wound.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst FrostlordEffects = [\r\n  {\r\n    name: `Frost Spear`,\r\n    desc: `If the unmodified wound roll for an attack made with a frost spear that targets an enemy HERO or MONSTER is a 6, subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1) until the end of that phase. The same unit can only be affected by this ability once per phase.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Bellowing Voice`,\r\n    desc: `Add 1 to charge rolls for friendly BEASTCLAW RAIDERS units wholly within 12\" of this unit.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst ChampionEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be a champion. Add 1 to the Attacks characteristic for that model.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  'Kragnos': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of The Dread Mace is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Shield Inviolate - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit was picked to be the target of that spell, roll a dice. On a 3+, ignore the effect of that spell on this unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Avatar of Destruction - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rampaging Destruction - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this phase, pick 1 of the following effects:  \r\n        Roll a dice for each enemy unit within 1\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.  \r\n        Pick an enemy Monster in combat with this unit and roll 2D6. On a 7, this ability has no effect. Otherwise, inflict an amount of mortal damage on that unit equal to the results on the dice used for the 2D6 roll multiplied together. For example, a 2D6 roll of 2 and 6 would inflict 12 mortal damage (2x6).`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The End of Empires - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for friendly Destruction units while they are wholly within 12\" of this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Butcher: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Voracious Maw'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Savage Hunter - Passive`,\r\n        desc: `Effect: While they are wholly within 12\" of this unit, friendly Gutbusters units can use Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // BloodgruelEffect, GenericEffects.WizardOneSpellEffect\r\n    ],\r\n  },\r\n  Firebelly: {\r\n    /*mandatory: { spells: [keyPicker(spells, ['Cascading Fire-cloak'])] }, */\r\n    effects: [\r\n      //GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Torrent of Flame - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Fire Breath for attacks that target Infantry.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Frost Sabres': {\r\n    effects: [\r\n      {\r\n        name: `Hunters of the Frozen Wilds - Passive`,\r\n        desc: `Effect: This unit is not visible to enemy units while it is within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Frostlord on Stonehorn': {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Chill of the Everwinter', 'Unstoppable Charge'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stonehorns Rock-hard Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Earth-Shattering Charge - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Inflict D3 mortal damage on the target. Then, roll 2D6. This unit can move a distance up to the value of the roll. During that move, it can pass through models in the target unit but must end that move in combat.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Frost Spear - Passive`,\r\n        desc: `Effect: If any damage points are allocated to an enemy Hero or Monster by attacks made with this units Frost Spear, subtract 1 from the Attacks characteristic of that enemy units melee weapons until the start of your next turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stone Skeleton - Passive`,\r\n        desc: `Effect: Ignore the first damage point that would be allocated to this unit in each phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    //  ...StonehornEffects, ...FrostlordEffects\r\n    ],\r\n  },\r\n  'Frostlord on Thundertusk': {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Chill of the Everwinter'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Thundertusks Colossal Tusks is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sweeping Tusks - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Bellowing Voice - Once Per Battle`,\r\n        desc: `Declare: Pick any number of friendly Beastclaw Raiders units wholly within 12\" of this unit to be the targets. \r\n        Effect: Each target can add 1 to the D3 roll made if that unit uses the Trampling Charge ability this turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  ...ThundertuskEffects, ...FrostlordEffects\r\n    ],\r\n  },\r\n  'Huskard on Stonehorn': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, [\"Winter's Endurance\", \"Winter's Strength\"])],\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Unstoppable Charge'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stonehorns Rock-hard Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Everwinter's Goad - Once Per Turn`,\r\n        desc: `Declare: Pick each friendly and enemy Monster within this units combat range to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+:  \r\n        If the target is a friendly Ogor Mawtribes unit, its Companion weapons have Crit (2 Hits) for the rest of the turn.  \r\n        If the target is an enemy unit, subtract 1 from hit rolls for attacks made with its Companion weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stone Skeleton - Passive`,\r\n        desc: `Effect: Ignore the first damage point that would be allocated to this unit in each phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    //  ...StonehornEffects, BloodVultureEffect, ...ReelEmInEffects\r\n    ],\r\n  },\r\n  'Huskard on Thundertusk': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, [\"Winter's Endurance\", \"Winter's Strength\"])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Thundertusks Colossal Tusks is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Freezing Aura - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. Add 1 to the roll if the target had Strike-last as a result of this ability in the previous turn. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  ...ThundertuskEffects, BloodVultureEffect, ...ReelEmInEffects\r\n    ],\r\n  },\r\n  'Stonehorn Beastriders': {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Unstoppable Charge'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stonehorns Rock-hard Horns is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stonehorn Avalanche - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, when this unit makes a pile-in move this phase, add D6\" to the distance it can move.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Stone Skeleton - Passive`,\r\n        desc: `Effect: Ignore the first damage point that would be allocated to this unit in each phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    //  ...StonehornEffects, BloodVultureEffect, ...ReelEmInEffects\r\n    ],\r\n  },\r\n  'Thundertusk Beastriders': {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Chill of the Everwinter'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Thundertusks Colossal Tusks is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Everwinter's Assault - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Eect: Roll a dice. On a 3+, for the rest of the turn:  \r\n        If the target is a Monster, subtract 3 from its control score.  \r\n        If the target is a non-Monster unit, subtract 5 from its control score.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    //  ...ThundertuskEffects, BloodVultureEffect, ...ReelEmInEffects\r\n    ],\r\n  },\r\n  'Gnoblar Scraplauncher': {\r\n    effects: [\r\n      //RhinoxChargeEffect,\r\n      {\r\n        name: `Rain of Scrap`,\r\n        desc: `Declare: Pick an enemy unit that had any models slain this turn by this units shooting attacks to be the target. \r\n        Effect: Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Load it Up!`,\r\n        desc: `Effect: If this unit is within the combat range of a friendly Gnoblars unit, this units shooting attacks score critical hits on unmodified hit rolls of 5+ until the start of your next turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gnoblars: {\r\n    effects: [\r\n     // ChampionEffect,\r\n      {\r\n        name: `Nasty Traps and Tricks`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit and that used a Move ability this turn to be the target. You cannot pick the same unit to be the target of this ability more than once per turn. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gorger Mawpack': {\r\n    effects: [\r\n      {\r\n        name: `Frenzied Hunters`,\r\n        desc: `Declare: Pick this unit if it is lurking on the fringes. \r\n        Effect: Set up this unit on the battlefield wholly within 9\" of a battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Troglodytic Lurkers`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve lurking on the fringes. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  Maneaters: {\r\n   /* mandatory: { command_abilities: [keyPicker(command_abilities, ['A Barrel of Meat and the Jobs Done'])] }, */\r\n    effects: [\r\n     // GenericEffects.Elite,\r\n      {\r\n        name: `Been There, Done That - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n        desc: `Effect: Roll a dice. On a 4+, that ability has no effect on this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Icebrow Hunter': {\r\n    /*mandatory: { command_abilities: [keyPicker(command_abilities, ['Lead the Skal'])] }, */\r\n    effects: [\r\n      //...MastersOfAmbushEffects('Frost Sabres'),\r\n      {\r\n        name: `Masters of Ambush`,\r\n        desc: `Declare: Pick this unit and up to 2 friendly Frost Sabres units if those units have not been deployed. \r\n        Effect: Set up those units in reserve outflanking the prey. They have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Hunt is On`,\r\n        desc: `Declare: Pick this unit if it is outflanking the prey. \r\n        Effect: Set up this unit wholly within 9\" of a battlefield edge and more than 9\" from all enemy units. Then, set up each Frost Sabres unit that was set up outflanking the prey with this unit wholly within 12\" of it and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Icefall Yhetees': {\r\n    effects: [\r\n      {\r\n        name: `Bounding Leaps - Enemy Combat Phase`,\r\n        desc: `Effect: This unit can move up to 3\". It can move into combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mournfang Pack': {\r\n    effects: [\r\n      {\r\n        name: `Lumpen Wall of Flesh - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for shooting attacks that target friendly Beastclaw Raiders units while they are within this units combat range.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Alpha Cavalry - Passive`,\r\n        desc: `Effect: The Charge (+1 Damage) weapon ability has no effect on attacks that target this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // IronfistEffect,\r\n    ],\r\n  },\r\n  Ironblaster: {\r\n    effects: [\r\n      {\r\n        name: `Lethal Payload - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, pick either the Big Shot or Hail Shot weapon characteristics for all the attacks it makes with its Ironblaster Cannon.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n   //   RhinoxChargeEffect,\r\n    ],\r\n  },\r\n  Leadbelchers: {\r\n    effects: [\r\n      {\r\n        name: `Firing from the Belly`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Powder Gnoblars - Passive`,\r\n        desc: `Effect: This unit has up to 2 Powder Gnoblar tokens. Each time this unit uses a Shoot ability, for each of this units Powder Gnoblars that are on the battlefield, you can re-roll 1 random characteristic roll for this units Attacks characteristic. If a random characteristic roll re-rolled in this manner is 1, remove 1 of this units Powder Gnoblars from the battlefield.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ironguts: {\r\n    effects: [\r\n      {\r\n        name: `Protect the Tyrant - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any friendly Tyrants, both this unit and those Tyrants have Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Down to the Ironguts - Once Per Battle`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ogor Gluttons': {\r\n    effects: [\r\n      {\r\n        name: `Insatiable Gluttony - Passive`,\r\n        desc: `Effect: If you have used the Feast on Flesh ability this battle, add 1 to the control score of this unit for each model in this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // IronfistEffect,\r\n    ],\r\n  },\r\n  Slaughtermaster: {\r\n    /*mandatory: { spells: [keyPicker(spells, ['Rockchomper'])] }, */\r\n    effects: [\r\n     // BloodgruelEffect,\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Great Cauldron`,\r\n        desc: `Effect: You can spend 1 or more of this units grisly remains points. For each point spent, pick a friendly Gutbusters unit wholly within 12\" of this unit to be the target, then pick 1 of the following effects: \r\n        Bloodgruel: The target has Ward (5+) for the rest of the turn. \r\n        Spinemarrow: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Fill the Pot - Passive`,\r\n        desc: `Effect: Each time an enemy unit is destroyed by a combat attack made by a friendly Ogor Mawtribes unit wholly within 18\" of this unit, give this unit a grisly remains point, to a maximum of 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Tyrant: {\r\n    effects: [\r\n      {\r\n        name: `Brawlerguts - Passive`,\r\n        desc: `Effect: Add 1 to the D3 roll made when this unit uses the Trampling Charge ability.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Bully of the First Degree`,\r\n        desc: `Declare: Pick another friendly Ogor Mawtribes unit wholly within 12\" of this unit to be the target. \r\n        Effect: Add 3 to the targets control score until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  \"Hrothgorn's Mantrappers\": {\r\n    effects: [\r\n      {\r\n        name: `Hidden Trap`,\r\n        desc: `At the start of the first hero phase, if this unit is in your army, you can pick 1 terrain feature or objective that is not wholly within enemy territory and say that it is trapped. If you do so, place 1 Bushwakka's Trap marker next to that terrain feature or objective.\r\n          The first time a unit finishes a move within 1\" of the trapped terrain feature or objective remove the Bushwakka's Trap minature and roll a D6. On a 2+, that unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [TURN_ONE_START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Here You Go Boss!`,\r\n        desc: `While a friendly HROTHGORN is within 3\" of this unit while it includes Quiv, add 1 to the Attacks characteristic of his Trap Launcher.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Hrothgorn: {\r\n    effects: [\r\n    //  ...MastersOfAmbushEffects(\"Hrothgorn's Mantrappers\"),\r\n      {\r\n        name: `Thrafnir`,\r\n        desc: `The first time this model is set up on the battlefield, you can set up a Frost Sabres unit consisting of a single model on the battlefield and add it to your army. Set up the Frost Sabre wholly within 3\" of this model and more than 9\" from any enemy units.`,\r\n        when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Blackpowder's Buccaneers\": {\r\n    effects: [\r\n      {\r\n        name: `Companions`,\r\n        desc: `Gorlok Blackpowder is accompanied by four Minions: Peggz, Kagey, Mange and Shreek. The minions must remain within 1\" of Gorlok Blackpowder. For rules purposes, Gorlok Blackpowder and their minions are treated as a single model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Legendary Looter`,\r\n        desc: `At the start of the combat phase, you can pick 1 enemy HERO with an artefact of power enhancement that is within 3\" of this unit, and roll 2d6. Add 2 to the roll if Kagey has not been removed, and add 1 to the roll for each other minion that has not been removed. If the roll is 12+, that enemy HERO cannot use that artefact of power for the rest of the battle. If the artefact of power modified any of the bearer's characteristics or weapon characteristics, they return to their original values.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gorlok's Minions`,\r\n        desc: `Each time a wound or mortal wound is allocated to this model and not negated, you can choose to remove 1 minion. If you do so the wound or mortal wound is negated. In additiona, each minion confers an ability to this unit as shown below. If the minion is removed, that ability can no longer be used.\r\n        \r\n        Peggz: Add 1 to hit rolls for this unit. In addition, if you choose to remove this unit when this unit suffers a wound or mortal wound, roll a dice. On a 5+ this minion is not removed, but the wound or mortal wound is still negated.\r\n        \r\n        Kagey: See the Legendary Looter Ability\r\n        \r\n        Mange: After this unit fights, you can pick 1 enemy unit within 3\" of this model and roll a dice. On a 5+ that enemy unit suffers 1 mortal wound.\r\n        \r\n        Shreek: In your shooting phase, you can pick 1 enemy unit within 18\" of this model and roll a dice. On a 5+ that enemy unit suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Gorlok's Minions - Peggz`,\r\n        desc: `Add 1 to hit rolls for this unit. In addition, if you choose to remove this unit when this unit suffers a wound or mortal wound, roll a dice. On a 5+ this minion is not removed, but the wound or mortal wound is still negated.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Gorlok's Minions - Kagey`,\r\n        desc: `See the Legendary Looter Ability.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gorlok's Minions - Mange`,\r\n        desc: `After this unit fights, you can pick 1 enemy unit within 3\" of this model and roll a dice. On a 5+ that enemy unit suffers 1 mortal wound.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gorlok's Minions - Shreek`,\r\n        desc: `In your shooting phase, you can pick 1 enemy unit within 18\" of this model and roll a dice. On a 5+ that enemy unit suffers 1 mortal wound.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Bloodpelt Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Unrelenting Hunter - Once Per Turn - Enemy Movement Phase`,\r\n        desc: `Effect: If this unit is more than 9\" from all enemy units, it can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Breaker - Passive`,\r\n        desc: `Effect: If the target is a Monster, the Damage characteristic of this units Skullshatter Crossbow is 3 and the Damage characteristic of its Impaling Spear is 6.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Gorger Mawpack': {\r\n    effects: [\r\n      {\r\n        name: `Clawback`,\r\n        desc: `1 in every 5 models in this unit must be a Clawback. Add 1 to the Attacks characteristic of that model's Bone-shattering Strikes. That model can issue commands to their own unit.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Cave Howler`,\r\n        desc: `1 in every 5 models in this unit must be a Cave Howler.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Ambushing Hunters`,\r\n        desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is set up in ambush as a reserve unit. If you do so, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Ambushing Hunters`,\r\n        desc: `If this unit is set up in ambush as a reserve unit, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Agonising Roar`,\r\n        desc: `Roll a dice each time an enemy unit receives a command within 12\" of a friendly Cave Howler. On a 5+, that command is not received (the command ability still counts as having been used) and the command point that was spent to issue that command is lost.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      }, \r\n    ], \r\n  }, */\r\n  'ROR: Braggit`s Bottle-Snatchaz': {\r\n    effects: [\r\n      {\r\n        name: `Super-Secret Tunnels`,\r\n        desc: `Declare: Pick a unit in this Regiment of Renown that has not been deployed. \r\n        Effect: Set up that unit in reserve in a super-secret tunnel. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Sudden Emergence - Once Per Turn`,\r\n        desc: `Declare: If the Rabble-Rowza in this Regiment of Renown is in a super-secret tunnel, pick it to be the target. \r\n        Effect: Set up the target anywhere on the battlefield more than 9\" from all enemy units. Then, set up all other friendly units that are in a super-secret tunnel within 3\" of the target and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Rabble-Rowza: Neh Neh Na-Neh Neh! Can't Catch me! - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Monster or Beast unit to be the target. \r\n        Effect: For the rest of the turn, the target can use Charge abilities even if it used a Run ability in the same turn, but each time it uses a Move ability, it must end the move closer to this unit. \r\n        In addition, for the rest of the turn, the first time the target ends a move within this units combat range, inflict D6 mortal damage on this unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Hallucinogenic Fungus Brews - Passive`,\r\n        desc: `Effect: In the first battle round, this unit has Ward (4+). In the second battle round, this unit has Ward (5+). In the third and subsequent battle rounds, this unit has Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gobbapalooza: Gobbapalooza Know-Wotz`,\r\n        desc: `Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Glareface Dance: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to run rolls and charge rolls for that unit until the start of your next turn. \r\n        Nasty Poisons: Pick a friendly Gloomspite Gitz unit within this units combat range. Add 1 to the Rend characteristic of that units weapons until the start of your next turn. \r\n        Mesmerise: Pick a visible enemy unit within 12\" of this unit. Until the start of your next turn, that unit cannot use commands.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Squig Herd: Squigs Gone Wild - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Herd: Herding Squigs`,\r\n        desc: `Effect: Roll a dice for each Squig Herder in this unit. For each 2+, you can return D3 slain Cave Squigs to this unit. For each 1, 1 Squig Herder in this unit is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Squig Hoppers: Boing! Boing! Boing!`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sneaky Distraction: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Gobbapalooza in this Regiment of Renown to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for attacks made by enemy units while they are wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Grikk`s Kruleshots': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Skewer Killbow: Skewering Bolts - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, the Damage characteristic of this units Beast-Skewer Bolts is 6 if the target is a Monster.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast-Skewer Killbow: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Man-Skewer Crossbows - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, pick either the Hasty Shot or Aimed Shot weapon characteristics for all the attacks it makes with its Man-skewer Crossbows.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Man-Skewer Boltboyz: Pick 'Em Off`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Skewer It Again! - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster that had any damage points allocated to it this phase by a shooting attack made by the Beast-skewer Killbow in this Regiment of Renown. Then, pick any number of Man-skewer Boltboyz units in this Regiment of Renown to focus fire. \r\n        Effect: For the rest of the turn, add 1 to the Attacks characteristic of the ranged weapons used by the units you picked to focus fire but all of their attacks must target the enemy Monster you picked.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Odo Godswallow': {\r\n    effects: [\r\n      {\r\n        name: `Beast-Breaking Strike`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 5D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Behemoth Brawler - Passive`,\r\n        desc: `Effect: Subtract 1 from the Attacks characteristic of enemy Monsters while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Menhir Club is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mighty Walloper - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import BeastsOfChaosUnits from 'factions/beasts_of_chaos/units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport GloomspiteGitzUnits from 'factions/gloomspite_gitz/units'\r\nimport LegionsOfNagashUnits from 'factions/legions_of_nagash/units'\r\nimport { keyPicker, tagAs } from 'factions/metatagger'\r\nimport OgorMawtribeUnits from 'factions/ogor_mawtribes/units'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Units = {\r\n  'Greyfyrd Mercenary Company': {\r\n    effects: [\r\n      {\r\n        name: `Fulfill One's Oaths`,\r\n        desc: `Add 1 to hit rolls for attacks made with melee weapons by FYRESLAYERS MERCENARY units that target enemy units that made a charge move in the same turn. However, from the start of the third battle round, subtract 1 from the Bravery characteristic of friendly FYRESLAYERS MERCENARY units while they are not wholly within 18\" of your general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tenebrous Court Mercenary Company': {\r\n    mandatory: { units: [keyPicker(LegionsOfNagashUnits, ['Necromancer'])] },\r\n    effects: [\r\n      {\r\n        name: `Frightful Allies`,\r\n        desc: `Add 1 to hit rolls for attacks made by FLESH-EATER COURTS MERCENARY units that made a charge move in the same turn. However, FLESH-EATER COURTS MERCENARY units cannot make retreat moves.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Sons Of The Lichemaster Mercenary Company': {\r\n    effects: [\r\n      {\r\n        name: `Power Of The Lichemaster`,\r\n        desc: `Add 1 to the Attacks characteristic of weapons used by Zombies or Skeleton Warriors units from this mercenary company while they are wholly within 18\" of the Necromancer from the same company.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Order Of The Blood-Drenched Rose Mercenary Company': {\r\n    mandatory: { units: [keyPicker(LegionsOfNagashUnits, ['Blood Knights'])] },\r\n    effects: [\r\n      {\r\n        name: `Unreasoning Bloodlust`,\r\n        desc: `Do not take battleshock tests for units from this mercenary company.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grugg Brothers Mercenary Company': {\r\n   /* mandatory: { units: [keyPicker(GloomspiteGitzUnits, ['Aleguzzler Gargant'])] }, */\r\n    effects: [\r\n      {\r\n        name: `Sibling Rivalry`,\r\n        desc: `You can reroll hit rolls of 1 for attacks made by a unit from this mercenary company that is within 6\" of 1 other unit from the same mercenary company. You can instead reroll all hit rolls for attacks made by a unit from this mercenary company that is within 6\" of 2 other units from the same mercenary company.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // \"Nimyard's Rough-Riders Mercenary Company\": {\r\n  //   mandatory: { units: [keyPicker(CitiesOfSigmarUnits, ['Freeguild Pistoliers'])] },\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Eyes And Ears`,\r\n  //       desc: `Instead of setting up a unit from this mercenary company on the battlefield, you can place it to one side and say that it is scouting as a reserve unit. If you do so, at the end of your first movement phase, you must set up that unit wholly within 6\" of the edge of the battlefield and more than 9\" from any enemy units. Any number of units from this mercenary company can be set up this way.`,\r\n  //       when: [DURING_SETUP, TURN_ONE_MOVEMENT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  'The Blacksmoke Battery Mercenary Company': {\r\n    effects: [\r\n      {\r\n        name: `The Spotter`,\r\n        desc: `Add 1 to hit rolls for attacks made by Cannons and Organ Guns from this mercenary company if a Gyrocopter or Gyrobomber from the same mercenary company is within 12\" of the target.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rampagers Mercenary Company': {\r\n    effects: [\r\n      {\r\n        name: `On The Rampage`,\r\n        desc: `After you set up a unit from this mercenary company, you can move it D6.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  \"Skroug's Menagerie Mercenary Company\": {\r\n    mandatory: { units: [keyPicker(BeastsOfChaosUnits, ['Chaos Gargant'])] },\r\n    effects: [\r\n      {\r\n        name: `Lord And Master`,\r\n        desc: `The Chaos Gargant from this mercenary company can use the At the Double, Forward to Victory and Inspiring Presence command abilities from the core rules as if they were a general. However, any command abilities that they use only affect units from the same mercenary company as them.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE, BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Gutstuffers Mercenary Company': {\r\n    mandatory: { units: [keyPicker(OgorMawtribeUnits, ['Firebelly', 'Maneaters'])] },\r\n    effects: [\r\n      {\r\n        name: `Hungry Beyond Reason`,\r\n        desc: `You can reroll charge rolls for units from this mercenary company. However, if a unit from this mercenary company is within 12\" of the enemy at the start of its charge phase, it must attempt to charge, and must make a charge move if it is possible for it to do so.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { GenericEffects } from 'generic_rules'\r\nimport { MERCENARY_COMPANIES } from 'meta/factions'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [MERCENARY_COMPANIES]: {\r\n    effects: [GenericEffects.DisruptivePresence],\r\n    available: {\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { MERCENARY_COMPANIES } from 'meta/factions'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const MercenaryCompaniesFaction = new Faction(\r\n  MERCENARY_COMPANIES,\r\n  ORDER,\r\n  SubFactions,\r\n  'Flavors',\r\n  undefined,\r\n  undefined,\r\n  true\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_NIGHTHAUNT: {\r\n    name: 'Battletome: Nighthaunt',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/K4iAr34vBjsg1BaI.pdf',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/p2QjqiUdVWzSKpbn.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, END_OF_COMBAT_PHASE, END_OF_TURN, HERO_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\n// Add individual artifacts here, and access them in other files!\r\nconst Artifacts = {\r\n  /*\"Shadow's Edge\": {\r\n    effects: [\r\n      {\r\n        name: `Shadow's Edge`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If the unmodified wound roll for an attack made with that weapon is 6, that attack inflicts D3 mortal wounds on the target and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reaper of Sorrows': {\r\n    effects: [\r\n      {\r\n        name: `Reaper of Sorrows`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Before the bearer attacks with that weapon, pick 1 enemy unit within 1\" of the bearer and roll 2D6. If the result is higher than the target's Bravery characteristic, that weapon's Rend characteristic is -3 for attacks made against that unit until the end of that phase. That weapon's Rend characteristic is -4 instead of -3 if the target is terrified.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Slitter: {\r\n    effects: [\r\n      {\r\n        name: `Slitter`,\r\n        desc: `When you pick the bearer to fight for the first time in a turn, before the bearer makes a pile-in move, you can pick 1 enemy model within 1\" of the bearer and roll a dice. If the roll is greater than that model's Wounds characteristic, that model is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soulfire Ring': {\r\n    effects: [\r\n      {\r\n        name: `Soulfire Ring`,\r\n        desc: `At the end of the combat phase, you can heal up to D6 wounds allocated to the bearer if any attacks made by the bearer in that phase slay an enemy model.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cloak of the Waxing Moon': {\r\n    effects: [\r\n      {\r\n        name: `Cloak of the Waxing Moon`,\r\n        desc: `Subtract 1 from the Attacks characteristic of melee weapons that target the bearer (to a minimum of 1).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pendant of the Fell Wind': {\r\n    effects: [\r\n      {\r\n        name: `Pendant of the Fell Wind`,\r\n        desc: `Subtract 1 from wound rolls for attacks made with melee weapons by enemy units while they are within 3\" of the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Midnight Tome': {\r\n    effects: [\r\n      {\r\n        name: `Midnight Tome`,\r\n        desc: `WIZARD only. Once per battle, if the bearer attempts to cast a spell that would summon an endless spell, that spell is automatically cast with a casting roll of 12 that cannot be modified (do not roll 2D6), and it cannot be unbound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Covetous Familiar': {\r\n    effects: [\r\n      {\r\n        name: `Covetous Familiar`,\r\n        desc: `Enemy units that finish a pile-in move within 3\" of the bearer suffer 1 mortal wound after the pile-in move is made.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lightshard of the Harvest Moon': {\r\n    effects: [\r\n      {\r\n        name: `Lightshard of the Harvest Moon - Once Per Battle`,\r\n        desc: `Effect: If this unit is in combat, add 1 to the Attacks characteristic of melee weapons used by friendly Nighthaunt units wholly within 12\" of this unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Covetous Familiar': {\r\n    effects: [\r\n      {\r\n        name: `Covetous Familiar - Reaction: Opponent declared a Fight ability for a unit in combat with this unit`,\r\n        desc: `Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soulfire Ring': {\r\n    effects: [\r\n      {\r\n        name: `Soulfire Ring`,\r\n        desc: `Effect: If any enemy models were slain by this units combat attacks this turn, Heal (D6) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { NIGHTHAUNT } from 'meta/factions'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_ROUND,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [NIGHTHAUNT]: {\r\n    effects: [\r\n      {\r\n        name: `Ethereal - Passive`,\r\n        desc: `Effect: Ignore all modiers to save rolls (positive and negative) for friendly Nighthaunt units, excluding Nagash.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Command Ability: Discorporate - Reaction: Opponent declared an Attack ability`,\r\n        desc: `Used By: A friendly Nighthaunt unit targeted by that Attack ability. \r\n        Effect: That unit has Ward (5+) for the rest of the phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shriek - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Nighthaunt unit that has not used an Aura of Dread ability this turn and that charged this turn to use this ability, then pick an enemy unit within 1\" of it to be the target. The number of models in the friendly Nighthaunt unit must be greater than the number of models in the target unit. \r\n        Effect: Subtract 1 from hit rolls for the targets attacks for the rest of the turn`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Stun - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Nighthaunt War Machine or Cavalry unit that has not used an Aura of Dread ability this turn and that charged this turn to use this ability, then pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Subtract 1 from save rolls for the target for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Petrify - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Nighthaunt Hero that has not used an Aura of Dread ability this turn and that charged this turn to use this ability, then pick an enemy unit within 1\" of it to be the target. \r\n        Effect: The target has Strike-last for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Wave of Terror - Once Per Turn`,\r\n        desc: `Effect: Friendly Nighthaunt units that are in combat can use Charge abilities this phase. However, if a unit that is in combat uses a Charge ability and the charge roll is 3 or less, that unit does not count as having charged that turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // The Emerald Host\r\n/*  'The Emerald Host': {\r\n    effects: [\r\n      {\r\n        name: `The Emerald Curse`,\r\n        desc: `After armies have been set up but before the first battle round begins, you can pick up to D3+1 different enemy units on the battlefield. At the end of each battle round, roll a dice for each unit you picked that is on the battlefield. On a 2+, that unit suffers D3 mortal wounds. If that unit is a MONSTER, it suffers D3+1 mortal wounds instead of D3.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `The Emerald Curse`,\r\n        desc: `At the end of each battle round, roll a dice for each unit you picked that is on the battlefield. On a 2+, that unit suffers D3 mortal wounds. If that unit is a MONSTER, it suffers D3+1 mortal wounds instead of D3.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n   The Scarlet Doom\r\n  'The Scarlet Doom': {\r\n    effects: [\r\n      {\r\n        name: `Vortex of Frenzied Violence`,\r\n        desc: `After a friendly SCARLET DOOM BLADEGHEIST REVENANTS unit makes a charge move, you can pick 1 enemy unit within 1\" of that unit. If you do so, roll a number of dice equal to the number of models from the charging unit. For each 5+, the target suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  The Quicksilver Dead\r\n  'The Quicksilver Dead': {\r\n    effects: [\r\n      {\r\n        name: `Artisans of Harrowing Death`,\r\n        desc: `Ward rolls cannot be made for wounds caused by attacks made with melee weapons by friendly QUICKSILVER DEAD DREADSCYTHE HARRIDANS units.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n   The Grieving Legion\r\n  'The Grieving Legion': {\r\n    effects: [\r\n      {\r\n        name: `Dragged into Grave`,\r\n        desc: `Enemy units cannot retreat while they are within 3\" of any friendly GRIEVING LEGION units with 10 or more models.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst BattleTactics = {\r\n  /*'Overwhelmed with Dread': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelmed with Dread`,\r\n        desc: `When you reveal this battle tactic, pick 1 enemy unit on the battlefield. You complete this tactic if that unit is affected by the Shriek, Stun and Petrify effects of the Wave of Terror battle trait (pg 58) during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tides of Terror': {\r\n    effects: [\r\n      {\r\n        name: `Tides of Terror`,\r\n        desc: `You complete this tactic if at least 2 friendly NIGHTHAUNT units are within 1/2\" of the same enemy unit at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mass Panic': {\r\n    effects: [\r\n      {\r\n        name: `Mass Panic`,\r\n        desc: `You complete this tactic at the end of this turn if 3 or more enemy units on the battlefield are terrified.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Death by a Thousand Cuts': {\r\n    effects: [\r\n      {\r\n        name: `Death by a Thousand Cuts`,\r\n        desc: `You complete this tactic if an enemy HERO or MONSTER is destroyed by attacks made by a friendly CHAINRASPS or SPIRIT HOST unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'One Stop, No Return': {\r\n    effects: [\r\n      {\r\n        name: `One Stop, No Return`,\r\n        desc: `When you reveal this battle tactic, pick 1 objective marker on the battlefield that your opponent controls. You complete this battle tactic if you control that objective marker at the end of this turn and there is a friendly BLACK COACH within 3\" of that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ceaseless Nightmares': {\r\n    effects: [\r\n      {\r\n        name: `Ceaseless Nightmares`,\r\n        desc: `You complete this tactic if 2 or more terrified enemy units fail a battleshock test during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, SHOOTING_PHASE, START_OF_COMBAT_PHASE, START_OF_MOVEMENT_PHASE } from 'types/phases'\r\n\r\n// Store Command Abilities here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandAbilities = {\r\n  // Nighthaunt faction CA\r\n /* Discorporate: {\r\n    effects: [\r\n      {\r\n        name: `Discorporate`,\r\n        desc: `You can use this command ability when a friendly NIGHTHAUNT unit is picked as the target of an attack in the shooting or combat phase. That unit must receive the command. That unit has a ward of 5+ instead of 6+ until the end of that phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit CA's\r\n  'Passage Through the Underworlds': {\r\n    effects: [\r\n      {\r\n        name: `Passage Through the Underworlds`,\r\n        desc: `You can use this command ability at the start of your movement phase. If you do so, pick 1 friendly Nighthaunt unit on the battlefield that is visible to this unit. That unit must receive the command. First, remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. Then, remove that friendly Nighthaunt unit from the battlefield and set it up again wholly within 12\" of this unit and more than 9\" from all enemy units. This counts as their move for that movement phase.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Death Magic Incarnate': {\r\n    effects: [\r\n      {\r\n        name: `Death Magic Incarnate`,\r\n        desc: `You can use this command ability if this unit is on the battlefield at the start of the combat phase. The unit that receives this command must be a different friendly DEATH unit. Add 1 to ward rolls for that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\n// Store Command Traits here. You can add them to units, abilities, flavors, and subfactions later.\r\nconst CommandTraits = {\r\n  'Ruler of the Spectral Hosts': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability: Ruler of the Spectral Hosts - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Nighthaunt unit that started the battle with 3 or more models and that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cloaked in Shadow': {\r\n    effects: [\r\n      {\r\n        name: `Cloaked in Shadow - Passive`,\r\n        desc: `Effect: If the unmodified hit roll for an attack that targets this unit is 1-3, the attack fails and the attack sequence ends.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terrifying Entity': {\r\n    effects: [\r\n      {\r\n        name: `Terrifying Entity - Passive`,\r\n        desc: `Effect: This unit can use an Aura of Dread ability even if it has already used one this turn, but it cannot use more than two per turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Cloaked in Shadow': {\r\n    effects: [\r\n      {\r\n        name: `Cloaked in Shadow`,\r\n        desc: `This general cannot be picked as the target of a shooting or combat attack by more than 1 unit per phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ruler of the Spirit Hosts': {\r\n    effects: [\r\n      {\r\n        name: `Ruler of the Spirit Hosts`,\r\n        desc: `Once per battle, at the end of your movement phase, you can pick 1 friendly NIGHTHAUNT SUMMONABLE unit that has been destroyed. After you pick a unit that has been destroyed, roll a dice. On a 4+, a new replacement unit with half of the models from the unit that was destroyed (rounding up) is added to your army. Set up that unit wholly within 12\" of this general and more than 3\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Always export using tagAs\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport BattleTraits from './battle_traits'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { DURING_GAME, END_OF_TURN, MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Vanishing Phantasms': {\r\n    effects: [\r\n      {\r\n        name: `Ethereal Translocation - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Nighthaunt unit that is not in combat to use this ability. \r\n        Effect: Remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hunters of the Accursed': {\r\n    effects: [\r\n      {\r\n        name: `Vengeful Malison - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy Heroes each within 12\" of a different friendly Nighthaunt Hero to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Death Stalkers': {\r\n    effects: [\r\n      {\r\n        name: `There is No Escape - Passive`,\r\n        desc: `Effect: Friendly Nighthaunt units can use Charge abilities even if they used a Run or Retreat ability in the same turn. In addition, no mortal damage is inflicted on friendly Nighthaunt units by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Procession of Death': {\r\n    effects: [\r\n      {\r\n        name: `Cavalcade of Death - Passive`,\r\n        desc: `Effect: Friendly Nighthaunt Infantry units have Ward (5+) while they are wholly within 6\" of a friendly Black Coach.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Emerald Host': {\r\n    effects: pickEffects(BattleTraits, ['The Emerald Host']),\r\n  },\r\n\r\n  'The Scarlet Doom': {\r\n    effects: pickEffects(BattleTraits, ['The Scarlet Doom']),\r\n  },\r\n\r\n  'The Quicksilver Dead': {\r\n    effects: pickEffects(BattleTraits, ['The Quicksilver Dead']),\r\n  },\r\n\r\n  'The Grieving Legion': {\r\n    effects: pickEffects(BattleTraits, ['The Grieving Legion']),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME, END_OF_SETUP } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'A Soul to Claim': {\r\n    effects: [\r\n      {\r\n        name: `A Soul to Claim`,\r\n        desc: `After deployment but before the first battle round begins, the enemy unit with the highest Wounds characteristic is marked as 'the target'. If more than 1 unit has the highest Wounds characteristic, you can choose which of those units will be 'the target'. When the battle ends, you complete this grand strategy if the target was destroyed by attacks made by a friendly SUMMONABLE unit.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `A Soul to Claim`,\r\n        desc: `When the battle ends, you complete this grand strategy if the target was destroyed by attacks made by a friendly SUMMONABLE unit.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Fright or Flight': {\r\n    effects: [\r\n      {\r\n        name: `Fright or Flight`,\r\n        desc: `When the battle ends, you complete this grand strategy if 1 or more objectives are being contesting by friendly Nighthaunt units and there are no enemy units within 6\" of any friendly Nighthaunt units that are contesting an objective.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  },\r\n  'Feed on Terror': {\r\n    effects: [\r\n      {\r\n        name: `Feed on Terror`,\r\n        desc: `When the battle ends, you complete this grand strategy if 1 or more enemy units on the battlefield are terrified.\r\n\r\n        Designer's Note: You cannot complete this grand strategy if all of the units in your opponent's army have been destroyed.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Dismantle the Brave': {\r\n    effects: [\r\n      {\r\n        name: `Dismantle the Brave`,\r\n        desc: `After deployment but before the first battle round begins, the enemy unit with the highest Bravery characteristic is marked as 'the target'. If more than 1 unit has the highest Bravery characteristic, you can choose which of those units will be 'the target'. When the battle ends, you complete this grand strategy if the target has slain and the model chosen to be your general not been slain.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Dismantle the Brave`,\r\n        desc: `When the battle ends, you complete this grand strategy if the target has slain and the model chosen to be your general not been slain.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of the Underworlds': {\r\n    effects: [\r\n      {\r\n        name: `Shademist: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Nighthaunt Wizard to cast this spell, pick a visible friendly Nighthaunt unit that has 3 or more models and is wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from wound rolls for attacks that target that unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spirit Drain: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Nighthaunt Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spectral Lure: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Nighthaunt Wizard to cast this spell, pick a friendly Nighthaunt unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Return a number of slain models to the target unit with a combined Health characteristic of up to D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Spirit Drain': {\r\n    effects: [\r\n      {\r\n        name: `Spirit Drain`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Roll a number of dice equal to the number of models in the target unit. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Lifestealer: {\r\n    effects: [\r\n      {\r\n        name: `Lifestealer`,\r\n        desc: `Casting value of 7 and arange of 12\". Pick 1 enemy unit within range and visible to the caster. The target suffers D3 mortal wounds. You can heal 1 wound allocated to the caster for each mortal wound that was allocated (and not negated) by this spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Seal of Shyish': {\r\n    effects: [\r\n      {\r\n        name: `Seal of Shyish`,\r\n        desc: `Casting value of 5 and a range of 12\". Pick 1 friendly NIGHTHAUNT unit wholly within range and visible to the caster. That unit has a ward of 5+ until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Shademist: {\r\n    effects: [\r\n      {\r\n        name: `Shademist`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 friendly NIGHTHAUNT unit wholly within range and visible to the caster. Subtract 1 from wound rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spectral Tether': {\r\n    effects: [\r\n      {\r\n        name: `Spectral Tether`,\r\n        desc: `Casting value of 4. If successfully cast, remove the caster from the battlefield and set it up again on the battlefield more than from all enemy units. The caster cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grief-Stricken': {\r\n    effects: [\r\n      {\r\n        name: `Grief-Stricken`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from hit rolls for attacks made by that unit and add 1 to hit rolls for attacks made with melee weapons by friendly Nighthaunt units that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Wraithstorm: {\r\n    effects: [\r\n      {\r\n        name: `Wraithstorm`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. If any models in that unit are slain as a result of this spell, that unit immediately suffers an additional D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spectral Lure': {\r\n    effects: [\r\n      {\r\n        name: `Spectral Lure`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick 1 friendly Nighthaunt Summonable unit wholly within range and visible to the caster. You can heal up to D6 wounds allocated to that unit or, if no wounds are allocated to it, you can return a number of slain models to that unit that have a combined Wounds characteristic of D6 or less.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Hand of Dust': {\r\n    effects: [\r\n      {\r\n        name: `Hand of Dust`,\r\n        desc: `Casting value of 8 and a range of 3\". Pick 1 enemy model within range and visible to the caster. Then, take a dice and hide it in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one holding the dice, the spell has no effect. If they pick the empty hand or container, the enemy model is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul Stealer': {\r\n    effects: [\r\n      {\r\n        name: `Soul Stealer`,\r\n        desc: `Casting value of 7 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. If the unmodified casting roll for this spell is 9+ and this spell is not unbound, that unit suffers D6 mortal wounds instead of D3. You can heal up to 1 wound that has been allocated to the caster for each mortal wound caused by this spell that is not negated.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Howling Vortex': {\r\n    effects: [\r\n      {\r\n        name: `Howling Vortex`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick a point on the battlefield within range and visible to the caster. Then, roll 2D6 for each enemy unit within 6\" of that point. If the roll is greater than that unit's unmodified Move characteristic, or the roll is a double, that unit suffers 1 mortal wound and its Move characteristic is halved until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { NIGHTHAUNT } from 'meta/factions'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n /* mandatory: {\r\n    command_abilities: [keyPicker(CommandAbilities, ['Discorporate'])],\r\n  }, */\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [NIGHTHAUNT]: {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [NIGHTHAUNT]),\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { NIGHTHAUNT } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const NighthauntFaction = new Faction(\r\n  NIGHTHAUNT,\r\n  DEATH,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_NIGHTHAUNT\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_NURGLE: {\r\n    name: 'Battletome: Maggotkin of Nurgle',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JANUARY_2022: {\r\n    name: 'Errata (January 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/07/GjHi2Ip94TenkORr.pdf',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/07/oeeKXfBv3sqy06LO.pdf',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/07/OAwscbnmGZsyoHxE.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Artifacts = {\r\n /* 'The Splithorn Helm': {\r\n    effects: [\r\n      {\r\n        name: `The Splithorn Helm`,\r\n        desc: `The bearer has a Disgustingly Resilient ward of 4+.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Muttergrub: {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Gift of Disease'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Muttergrub`,\r\n        desc: `The bearer can attempt to cast the Gift of Disease spell (pg 66) in your hero phase in the same manner as a WIZARD. If the bearer is a WIZARD, they know the Gift of Disease spell in addition to the spell you can normally pick for them from the Lore of Malignance, and you can add 1 to the casting roll when they attempt to cast Gift of Disease.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Rustfang: {\r\n    effects: [\r\n      {\r\n        name: `Rustfang`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick 1 enemy HERO within 3\" of the bearer. Subtract 1 from save rolls for attacks that target that HERO for the rest of the battle.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Flesh Peeler': {\r\n    effects: [\r\n      {\r\n        name: `Flesh Peeler`,\r\n        desc: `In your hero phase, roll a dice for each enemy unit that is within 7\" of the bearer. On a 4+, give that unit 1 disease point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Fecund Flask': {\r\n    effects: [\r\n      {\r\n        name: `The Fecund Flask`,\r\n        desc: `Once per battle, at the start of your hero phase, you can say the bearer will drink from the Fecund Flask. If you do so, roll a dice. On a 2+, heal all wounds allocated to the bearer. On a 1, the bearer is slain. If the bearer is slain by this artefact, before they are removed from play, you can add 1 BEASTS OF NURGLE unit that has 1 model to your army and set it up within 1\" of the bearer. The BEASTS OF NURGLE unit can only be set up within 3\" of an enemy unit if the bearer was within 3\" of that enemy unit when they were slain.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_NURGLE, rule_sources.ERRATA_JANUARY_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Noxious Nexus': {\r\n    effects: [\r\n      {\r\n        name: `Noxious Nexus`,\r\n        desc: `If an enemy unit is within 3\" of the bearer at the end of the movement phase or combat phase, give 2 disease points to that unit instead of 1 for being within 3\" of any friendly MAGGOTKIN OF NURGLE units.`,\r\n        when: [END_OF_MOVEMENT_PHASE, END_OF_COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_NURGLE, rule_sources.ERRATA_JANUARY_2022],\r\n      },\r\n    ],\r\n  },\r\n  \"Nurgle's Nail\": {\r\n    effects: [\r\n      {\r\n        name: `Nurgle's Nail`,\r\n        desc: `Pick one of the bearer's melee weapons. Attacks made with that weapon inflict 1 disease point on the target unit on an unmodified hit roll of 5 or 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Bountiful Swarm': {\r\n    effects: [\r\n      {\r\n        name: `The Bountiful Swarm`,\r\n        desc: `Once per battle, at the start of your hero phase, pick 1 enemy model within 3\" of the bearer and then roll a dice. If the roll is greater than that model's Wounds characteristic, it is slain. If that model is slain and had a Wounds characteristic of 4 or more, before it is removed from play, you can add 1 BEASTS OF NURGLE unit that has 1 model to your army and set it up within 1\" of the slain model. The BEASTS OF NURGLE unit can only be set up within 3\" of an enemy unit if the model was within 3\" of that enemy unit when it was slain.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Witherstave': {\r\n    effects: [\r\n      {\r\n        name: `The Witherstave`,\r\n        desc: `Add 1 to disease rolls for enemy units that are within 7\" of the bearer.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tome of a Thousand Poxes': {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Gift of Disease'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Tome of a Thousand Poxes`,\r\n        desc: `The bearer can attempt to cast the Gift of Disease spell (pg 66) in your hero phase in the same manner as a WIZARD. If the bearer is a WIZARD, they know the Gift of Disease spell in addition to the spell you can normally pick for them from the Lore of Virulence, and you can add 1 to the casting roll when they attempt to cast Gift of Disease.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Endless Gift': {\r\n    effects: [\r\n      {\r\n        name: `The Endless Gift`,\r\n        desc: `The bearer is always treated as being within 14\" of a Locus of Fecundity.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  'The Witherstave': {\r\n    effects: [\r\n      {\r\n        name: `The Witherstave`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rustfang': {\r\n    effects: [\r\n      {\r\n        name: `Rustfang - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Subtract 1 from save rolls for the target for the rest of the battle.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Carrion Dirge': {\r\n    effects: [\r\n      {\r\n        name: `The Carrion Dirge - Once Per Battle`,\r\n        desc: `You can reroll save rolls for attacks that target the bearer if the save roll is equal to or less than the number of wounds allocated to the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { MagnificentBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst NurgleBattalions = {\r\n /* 'Thricefold Befoulment': {\r\n    effects: [MagnificentBattalionEffect],\r\n  },\r\n  'Rotbringer Cyst': {\r\n    effects: [OneDropDeploymentEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(NurgleBattalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Feed the Maggots': {\r\n    effects: [\r\n      {\r\n        name: `Feed the Maggots`,\r\n        desc: `You complete this tactic if at least 7 enemy models are slain by disease rolls during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nurture the Gnarlmaw': {\r\n    effects: [\r\n      {\r\n        name: `Nurture the Gnarlmaw`,\r\n        desc: `Pick 1 Feculent Gnarlmaw in your army that is within 12\" of any enemy units. You complete this tactic if that Feculent Gnarlmaw is more than 12\" from all enemy units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gifts of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Gifts of Nurgle`,\r\n        desc: `You complete this tactic if 3 or more friendly MAGGOTKIN OF NURGLE units are within 3\" of the same enemy unit at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_NURGLE, rule_sources.ERRATA_JANUARY_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Glory to the Grandfather!': {\r\n    effects: [\r\n      {\r\n        name: `Glory to the Grandfather!`,\r\n        desc: `You complete this tactic at the end of this turn if more enemy units than friendly units are destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Droning': {\r\n    effects: [\r\n      {\r\n        name: `The Droning`,\r\n        desc: `You complete this tactic if there is a different friendly unit with a Rot Fly mount in each quarter of the battlefield at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sudden Domination': {\r\n    effects: [\r\n      {\r\n        name: `Sudden Domination`,\r\n        desc: `You complete this tactic if you summon a GREAT UNCLEAN ONE to the battlefield during this turn and it is within 3\" of an objective that you control in your opponent's territory at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Don't Squabble, Children\": {\r\n    effects: [\r\n      {\r\n        name: `Don't Squabble, Children`,\r\n        desc: `Pick an objective wholly outside your territory. You complete this battle tactic at the end of the turn if you control that objective and any friendly Rotbringers units and any friendly Nurgle Daemon units contest that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { NURGLE } from 'meta/factions'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [NURGLE]: {\r\n    effects: [\r\n      {\r\n        name: `Blessed by the Plaguefather - Once Per Turn`,\r\n        desc: `Effect: Pick 1 of the following effects: \r\n        Infect: Pick an enemy unit that is in combat with a friendly Maggotkin of Nurgle unit to be the target. The target has the Diseased keyword. \r\n        Spread: Pick a Diseased enemy unit to be the target. Each other enemy unit within the targets combat range has the Diseased keyword. \r\n        Mutate: If all enemy units on the battlefield have the Diseased keyword, inflict 1 mortal damage on each of them.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Desperate Remedies - Passive`,\r\n        desc: `Effect: If a Diseased enemy unit uses an ability that would heal or return slain models to it, instead of healing or returning slain models to it, that unit no longer has the Diseased keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Wracked with Disease - Once Per Turn`,\r\n        desc: `Effect: Roll a D3 for each Diseased enemy unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Feculent Gnarlmaw (Faction Terrain) -  Riddled with Disease - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this terrain feature to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has the Diseased keyword.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ]\r\n  }\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* Blightkrieg: {\r\n    effects: [\r\n      {\r\n        name: `Blightkrieg`,\r\n        desc: `You can use this command ability at the end of the enemy movement phase if this unit is within 12\" of an enemy unit. The command must be issued by this unit and must be received by another friendly Maggotkin of Nurgle unit that is within 12\" of an enemy unit. This unit and then the unit that received the command can attempt a charge.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  START_OF_SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n /* \"Grandfather's Blessing\": {\r\n    effects: [\r\n      {\r\n        name: `Grandfather's Blessing`,\r\n        desc: `Once per battle, at the start of the battle round after the Cycle of Corruption has advanced, if this general has not been slain, you can move the Cycle of Corruption 1 stage forwards. If more than 1 player could move the current stage of the Cycle of Corruption using this command trait, then none of them can.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Living Plague': {\r\n    effects: [\r\n      {\r\n        name: `Living Plague`,\r\n        desc: `At the start of your hero phase, roll a dice for each enemy unit within 7\" of this general. On a 2+, give that unit 1 disease point and you receive 1 contagion point.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloated with Corruption': {\r\n    effects: [\r\n      {\r\n        name: `Bloated with Corruption`,\r\n        desc: `If an unmodified Disgustingly Resilient ward roll for this general is 6, you can pick 1 enemy unit within 3\" of this general and give it 1 disease point.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Infernal Conduit': {\r\n    effects: [\r\n      {\r\n        name: `Infernal Conduit`,\r\n        desc: `If this general is on the battlefield at the start of your hero phase, roll a dice. On a l, nothing happens. On a 2-5, you receive 1 contagion point. On a 6, you receive D3 contagion points.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Avalanche of Rotten Flesh': {\r\n    effects: [\r\n      {\r\n        name: `Avalanche of Rotten Flesh`,\r\n        desc: `After this general makes a charge move, you can pick 1 enemy unit within 1\" of them and roll a number of dice equal to the charge roll for that charge move. For each 6, that enemy unit suffers 1 mortal wound and give that enemy unit1 disease point.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Overpowering Stench': {\r\n    effects: [\r\n      {\r\n        name: `Overpowering Stench - Reaction: Opponent declared a Command for a unit in combat with this unit`,\r\n        desc: `Effect: Roll a dice. On a 5+, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Gift of Febrile Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Gift of Febrile Frenzy - Passive`,\r\n        desc: `Effect: Add 1\" to the Move characteristic of friendly Maggotkin of Nurgle units that do not have Fly if they are wholly within 12\" of this unit at the start of the move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grandfathers Blessing': {\r\n    effects: [\r\n      {\r\n        name: `Grandfathers Blessing`,\r\n        desc: `Effect: If this unit is in combat with a Diseased enemy unit, Heal (D6) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n/*  'Pestilent Breath': {\r\n    effects: [\r\n      {\r\n        name: `Pestilent Breath`,\r\n        desc: `At the start of your shooting phase, pick 1 enemy unit within 7\" of your general. Roll 1 dice for each model in that unit that is within 7\" of this general. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport BattleTraits from './battle_traits'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { BATTLESHOCK_PHASE, COMBAT_PHASE, DURING_GAME, DURING_SETUP, END_OF_TURN, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\n\r\nconst Flavors = {\r\n/*  'Munificent Wanderers': {\r\n    effects: pickEffects(BattleTraits, ['Infested With Wonders']),\r\n  },\r\n\r\n  'Befouling Host': {\r\n    effects: pickEffects(BattleTraits, ['Festerbark Pox']),\r\n  },\r\n\r\n  'Droning Guard': {\r\n    effects: pickEffects(BattleTraits, ['Cloying Stench']),\r\n  },\r\n\r\n  'Blessed Sons': {\r\n    effects: pickEffects(BattleTraits, [\"Nurgle's Embrace\"]),\r\n  },\r\n\r\n  'Drowned Men': {\r\n    effects: pickEffects(BattleTraits, ['Lords of Sea and Sky']),\r\n  },\r\n\r\n  Filthbringers: {\r\n    effects: pickEffects(BattleTraits, ['Rot Covens']),\r\n  }, */\r\n  'Tallyband of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Disease and Pestilence Personified - Passive`,\r\n        desc: `Effect: From the second battle round onwards, add 1 to the amount of mortal damage inflicted, if any, by the Wracked with Disease ability.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Nurgles Menagerie': {\r\n    effects: [\r\n      {\r\n        name: `Tenders of the Garden Grotesque - Passive`,\r\n        desc: `Effect: During army composition, you can include 2 Feculent Gnarlmaws in your army instead of 1.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Plague Cyst': {\r\n    effects: [\r\n      {\r\n        name: `Vectors of Contagion - Passive`,\r\n        desc: `Effct: Each time a model in a friendly Rotbringers unit is slain by a combat attack and that model was in combat with the attacking unit, roll a number of dice equal to the slain models Health characteristic, to a maximum of 4. For each 5+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Affliction Cyst': {\r\n    effects: [\r\n      {\r\n        name: `From Noxious Skies - Once Per Battle`,\r\n        desc: `Declare: Pick up to 2 friendly Maggotkin of Nurgle units that have Fly. \r\n        Effect: Remove the targets from the battlefield and set them up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Mountain of Loathsome Flesh': {\r\n    effects: [\r\n      {\r\n        name: `Mountain of Loathsome Flesh`,\r\n        desc: `You can carry out this monstrous rampage with this unit instead of any other monstrous rampage you can carry out with this unit. If you do so, pick 1 enemy unit within 3\" of this unit and roll a dice. On a 2+, that enemy unit suffers a number of mortal wounds equal to the Mountain of Loathsome Flesh value on this unit's damage table.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Corrupt Arcane Nexus': {\r\n    effects: [\r\n      {\r\n        name: `Corrupt Arcane Nexus`,\r\n        desc: `You complete this grand strategy if a MAGGOTKIN OF NURGLE WIZARD is within 3\" of the centre of the battlefield and no enemy units are within 6\" of the centre of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Tend the Garden': {\r\n    effects: [\r\n      {\r\n        name: `Tend the Garden`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no enemy units within 3\" of any Feculent Gnarlmaws in your army and there is a Feculent Gnarlmaw in your army wholly within your opponent's territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Spread Rampant Disease': {\r\n    effects: [\r\n      {\r\n        name: `Spread Rampant Disease`,\r\n        desc: `When the battle ends, you complete this grand strategy if every enemy unit on the battlefield has at least 1 disease point.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Blessed Desecration': {\r\n    effects: [\r\n      {\r\n        name: `Blessed Desecration`,\r\n        desc: `You can pick this grand strategy only if the model picked to be your general has the MORTAL keyword. If you do so, after deployment, pick 1 terrain feature that is wholly within enemy territory. If no terrain features are wholly within enemy territory, you can pick any terrain feature. When the battle ends, you complete this grand strategy if you control that terrain feature.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { DURING_GAME, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n  /*'Feculent Gnarlmaw': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Spreading Disease`,\r\n        desc: `This faction terrain feature can never be set up within 7\" of another Feculent Gnarlmaw or within 3\" of an objective or other terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Uproot`,\r\n        desc: `If this terrain feature is affected by a rule that says you cannot use the scenery rules on its warscroll for the rest of the battle, remove this terrain feature from play instead.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Encroaching Corruption`,\r\n        desc: `This terrain feature is treated as a friendly unit with the Maggotkin of Nurgle keyword for the purposes of the Diseased battle trait.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Encroaching Corruption`,\r\n        desc: `At the start of your hero phase, you receive 1 extra contagion point for each Feculent Gnarlmaw in your army that is on the battlefield and has no enemy models within 3\" of it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n /* 'Stream of Corruption': {\r\n    effects: [\r\n      {\r\n        name: `Stream of Corruption`,\r\n        desc: `Stream of Corruption is a spell with a casting value of 6 and range of 7\". If successfully cast, pick 1 enemy unit within range and visible to the caster. Roll 1 dice for each model in that unit that is within range of the caster. For each 5+, that unit suffers 1 mortal wound.\r\n        \r\n        Before attempting to cast this spell, you can say that the caster will project the stream across a greater distance. If you do so, the spell has a range of 14\" but only inflicts 1 mortal wound for each roll of 6 instead of each roll of 5+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Deluge of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Deluge of Nurgle`,\r\n        desc: `Casting value of 7. If successfully cast, roll 7 dice. For each 5+, you can pick 1 different enemy unit that is visible to the caster. Each of those units suffers 3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Plague Wind': {\r\n    effects: [\r\n      {\r\n        name: `Plague Wind`,\r\n        desc: `Casting value of 7 and range of 14\". Pick 1 point on the battlefield within range and visible to the caster and draw a straight line between that point and the closest part on the caster's base. Roll a dice for each enemy unit passed across by that line. On a 4+, that unit suffers 1 disease point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eruptive Infestation': {\r\n    effects: [\r\n      {\r\n        name: `Eruptive Infestation`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit that is within 3\" of a friendly Plaguebearer Host that is visible to the caster. That enemy unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fleshy Abundance': {\r\n    effects: [\r\n      {\r\n        name: `Fleshy Abundance`,\r\n        desc: `Fleshy Abundance is a spell that has a casting value of 7 and range of 14\". If successfully cast, pick 1 friendly MAGGOTKIN OF NURGLE DAEMON unit within range and visible to the caster. Add 1 to the Wounds characteristic of that unit until your next hero phase.\r\n\r\n        Designer's Note: This can result in a model that is affected by this spell being slain if the wounds allocated to that model equal or exceed its Wounds characteristic once the effect of the spell ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Miasma of Pestilence': {\r\n    effects: [\r\n      {\r\n        name: `Miasma of Pestilence`,\r\n        desc: `Casting value of 6 and range of 14\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, roll a dice at the end of each phase in which any wounds or mortal wounds were allocated to that unit. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blades of Putrefaction': {\r\n    effects: [\r\n      {\r\n        name: `Blades of Putrefaction`,\r\n        desc: `Casting value of 7 and range of 14\". Pick 1 friendly MAGGOTKIN OF NURGLE unit within range and visible to the caster. Until your next hero phase, each attack made with a missile weapon or melee weapon by that unit inflicts 1 disease point on the target unit on an unmodified hit roll of 5 or 6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gift of Disease': {\r\n    effects: [\r\n      {\r\n        name: `Gift of Disease`,\r\n        desc: `Casting value of 6 and range of 21\". Pick 1 enemy unit within range and visible to the caster. Give that unit and each other enemy unit within 7\" of that unit 1 disease point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rancid Visitations': {\r\n    effects: [\r\n      {\r\n        name: `Rancid Visitations`,\r\n        desc: `Casting value of 6 and range of 7\". Pick 1 enemy unit within range and visible to the caster and roll 1 dice for each model in that unit that is within range. For each 2+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Favoured Poxes': {\r\n    effects: [\r\n      {\r\n        name: `Favoured Poxes`,\r\n        desc: `Casting value of 7 and range of 14\". Pick 1 enemy unit within range and visible to the caster. Until the caster moves, attacks, makes a casting, unbinding or dispelling attempt, or is slain, subtract 1 from hit and wound rolls for attacks made by that unit and subtract 1 from save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magnificent Buboes': {\r\n    effects: [\r\n      {\r\n        name: `Magnificent Buboes`,\r\n        desc: `Casting value of 7 and range of 21\". Pick 1 enemy hero within range and visible to the caster. Until your next hero phase, subtract 1 from hitrolls for attacks made by that HERO and subtract 1 from chanting, casting, dispelling and unbinding rolls for that HERO.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Plague Squall': {\r\n    effects: [\r\n      {\r\n        name: `Plague Squall`,\r\n        desc: `Casting value of 6. If successfully cast, roll 7 dice. For each 6, you can pick 1 different encnoy unit that is visible to the caster and give that unit 1 disease point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lore of Malignance': {\r\n    effects: [\r\n      {\r\n        name: `Cloying Quagmire: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Maggotkin of Nurgle Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Halve the targets Move characteristic until the start of your next turn. If the targets Save characteristic is 3+ or better, subtract 1 from run rolls and charge rolls for that unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Fleshy Abundance: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Maggotkin of Nurgle Wizard to cast this spell, pick a visible friendly Maggotkin of Nurgle unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target unit is damaged, Heal (D3) the target. If the target is not damaged, subtract 1 from wound rolls for attacks that target that unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magnificent Buboes: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Maggotkin of Nurgle Wizard to cast this spell, pick a visible enemy Hero within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for the targets attacks and subtract 1 from casting rolls, chanting rolls, banishment rolls and unbinding rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/* 'Fleshy Abundance': {\r\n    effects: [\r\n      {\r\n        name: `Fleshy Abundance`,\r\n        desc: `Fleshy Abundance is a spell that has a casting value of 7 and range of 14\". If successfully cast, pick 1 friendly MAGGOTKIN OF NURGLE DAEMON unit within range and visible to the caster. Add 1 to the Wounds characteristic of that unit until your next hero phase.\r\n\r\n        Designer's Note: This can result in a model that is affected by this spell being slain if the wounds allocated to that model equal or exceed its Wounds characteristic once the effect of the spell ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Magnificent Buboes': {\r\n    effects: [\r\n      {\r\n        name: `Magnificent Buboes`,\r\n        desc: `Casting value of 7 and range of 21\". Pick 1 enemy hero within range and visible to the caster. Until your next hero phase, subtract 1 from hitrolls for attacks made by that HERO and subtract 1 from chanting, casting, dispelling and unbinding rolls for that HERO.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport Spells from './spells'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\n/*const TaintedEndlessSpellEffect = {\r\n  name: `Tainted Endless Spell`,\r\n  desc: `If this unit summons an endless spell, then for the purposes of the Diseased battle trait, that endless spell is treated as a unit with the Maggotkin of Nurgle keyword that is in the same army as this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in a Maggotkin of Nurgle army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst BloatedWithCorruptionEffect = {\r\n  name: `Bloated with Corruption`,\r\n  desc: `If an unmodified ward roll for this unit is 6, you can pick 1 enemy unit within 3\" of this unit. That enemy unit suffers 1 disease point.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst RelentlessAttackersEffect = {\r\n  name: `Relentless Attackers`,\r\n  desc: `At the end of the combat phase, pick 1 enemy unit with a Wounds characteristic of 3 or less that is within 3\" of this unit. Roll 1 dice for each model in this unit that is within 3\" of that enemy unit. For each roll that exceeds that enemy unit's Wounds characteristic, that enemy unit suffers 1 mortal wound.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst LordOfTheBlightkingsEffect = {\r\n  name: `Lord of the Blightkings`,\r\n  desc: `In the combat phase, when you pick this unit to fight for the first time in that phase, you can pick 1 friendly Putrid Blightkings unit wholly within 12\" of this unit and that has not yet fought in that phase. This unit and that Putrid Blightkings unit can fight one after the other in the order of your choice.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  Rotigus: {\r\n    /*mandatory: {\r\n      spells: [keyPicker(Spells, ['Deluge of Nurgle'])],\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Mountain of Loathsome Flesh'])],\r\n    }, */\r\n    effects: [\r\n   //   WarmasterEffect,\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    //  BloatedWithCorruptionEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Gnarlrod is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Deluge of Nurgle: Casting value of 8`,\r\n        desc: `Declare: Pick each Diseased enemy unit on the battlefield and each friendly Maggotkin of Nurgle unit in combat with any Diseased enemy units to be the targets. Then, make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+:  \r\n        Inflict an amount of mortal damage on each enemy target equal to the roll.  \r\n        Heal (X) each friendly target, where X is an amount equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mountain of Loathsome Flesh - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, roll a dice. On a 3+, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Bringer of Plenty - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Great Unclean One': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Plague Wind'])],\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Mountain of Loathsome Flesh'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    //  BloatedWithCorruptionEffect,\r\n      {\r\n        name: `Locus of Nurgle - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Maggotkin of Nurgle Daemon unit that started the battle with 3 or more models and that has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 4+, set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Bloated with Corruption - Once Per Turn`,\r\n        desc: `Declare: If this unit is damaged, pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Colossal Blight Weapons is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Plague Wind: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has the Diseased keyword.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Poxbringer, Herald of Nurgle': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Eruptive Infestation'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Captain of the Plague Legions - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Plaguebearers unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Epidemius, Tallyman of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Tallyman of Nurgle`,\r\n        desc: `At the start of your hero phase, if this unit is on the battlefield, roll the following number of dice for each of the following units and terrain features that are visible to this unit:\r\n\r\n        - 3 dice for each friendly Great Unclean One.\r\n\r\n        - 2 dice for each friendly Plaguebearer Host that has 10 or more models and each Feculent Gnarlmaw in your army.\r\n\r\n        1 dice for each other friendly Maggotkin of Nurgle unit.\r\n\r\n        For each roll of 5+, add 1 to the tally of new diseases kept by Epidemius, to a maximum tally of 7. Each new disease that is recorded allows you to reroll 1 ward roll, casting roll, dispelling roll or unbinding roll that you make for a friendly Maggotkin of Nurgle unit.\r\n\r\n        Designer's Note: You can keep track of the tally of diseases and the number of rerolls you have used on a piece of paper or with a separate pool of dice. Note that each new disease only allows you to make a single reroll during the battle.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Spoilpox Scrivener, Herald of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Keep Counting, I'm Watching You - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Plaguebearers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a D6. On a 2+, pick 1 of the following effects to apply until the start of your next turn: \r\n        Tally of Blows: Add 1 to the Attacks characteristic of the targets melee weapons. \r\n        Recorded Stamina: Add 1 to save rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sloppity Bilepiper, Herald of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Jolly Gutpipes - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Maggotkin of Nurgle Daemon unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply for the rest of the turn: \r\n        A-Stabbing We Will Go!: Add 1 to wound rolls for the targets attacks. \r\n        Early One Evening My Pustule Was Seeping: Ward rolls cannot be made for damage points inicted by the targets combat attacks. \r\n        My Love Is Like a Ripe, Ripe Fart: Subtract 1 from hit rolls for attacks made by enemy units that target the target unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Horticulous Slimux': {\r\n    effects: [\r\n      {\r\n        name: `Beast Handler - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Beasts of Nurgle unit that has been destroyed. \r\n        Effect: Roll a dice. On a 3+, set up a replacement unit wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Cultivating the Garden of Nurgle`,\r\n        desc: `Effect: If there are fewer than 3 friendly Feculent Gnarlmaws on the battlefield, you can set up a Feculent Gnarlmaw wholly within 12\" of this unit, more than 3\" from all enemy units, objectives and other terrain features.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_NURGLE, rule_sources.ERRATA_JANUARY_2022],\r\n      },\r\n   \r\n    ],\r\n  },\r\n  Plaguebearers: {\r\n    effects: [\r\n      {\r\n        name: `Cloud of Flies - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Plague Drones': {\r\n    effects: [\r\n      {\r\n        name: `Ripe Pastures - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Beasts of Nurgle': {\r\n    effects: [\r\n      {\r\n        name: `Attention Seekers`,\r\n        desc: `Declare: If this unit is not in combat, pick the closest enemy unit to it to be the target. If 2 or more enemy units are tied to be the closest, you can pick which is the target. Then, make a charge roll of 2D6. \r\n        Effect: This unit can move a distance up to the value of the charge roll. During that move, this unit can move into combat and can pass through models in the target unit, but it must end that move within 1\" of the target. Then, inflict D3 mortal damage on the target.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Nurglings: {\r\n    effects: [\r\n      {\r\n        name: `Endless Swarm - Passive`,\r\n        desc: `Effect: Heal (3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'The Glottkin': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Blightkrieg'])],\r\n      spells: [keyPicker(Spells, ['Abundance of Flesh'])],\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Mountain of Loathsome Flesh'])],\r\n    }, */\r\n    effects: [\r\n     // WarmasterEffect,\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Horrific Opponent - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points,the Attacks characteristic of Ghurks Tentacle is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blighted Stampede - Once Per Turn - Reaction: You declared a Counter-Charge command for this unit`,\r\n        desc: `Effect: Pick up to 2 friendly Maggotkin of Nurgle units wholly within 12\" of this unit to be the targets. After the Counter-charge command for this unit has been resolved, if this unit charged, each of the targets can immediately use the Counter-charge command in an order of your choosing without any command points being spent.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Overgrowth of Flesh: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 5+, inflict 1 mortal damage on the target, to a maximum of 7 mortal damage.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Orghotts Daemonspew': {\r\n    effects: [\r\n     // WarmasterEffect,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Whippermaws Claws and Maws is 3.`,\r\n      when: [COMBAT_PHASE],\r\n    }, \r\n     {\r\n        name: `Acid Ichor - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grasping Tongue - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to wound rolls for combat attacks made by friendly Maggotkin of Nurgle units that target that enemy unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloab Rotspawned': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Miasma of Pestilence'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Bilespurters Claws and Maw is 3.`,\r\n      when: [COMBAT_PHASE],\r\n    }, \r\n     {\r\n        name: `Daemon Flies - Once Per Turn`,\r\n        desc: `Declare: Pick each enemy unit within 7\" of this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 4+:  \r\n        Inflict 1 mortal damage on the target.  \r\n        Subtract 1 from hit rolls for the targets combat attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Miasma of Pestilence: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, each time you allocate any damage points that were inicted by another friendly ability to the target, roll a dice. On a 4+, allocate 1 additional damage point to the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morbidex Twiceborn': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Tripletongues Claws and Maw is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gigantic Nurgling-kin`,\r\n        desc: `Effect: Heal (X) this unit, where X is half the number of damage points this unit has (rounding up).`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Lord of Nurglings - Passive`,\r\n        desc: `Effect: While any friendly Nurglings units are wholly within 12\" of this unit:  \r\n        Ignore the first damage point that would be allocated to each of those units each phase.  \r\n        Add 3 to those units control scores.`,\r\n        when: [DURING_GAME, END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Tide of Nurglings - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Nurglings unit within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, the targets melee weapons have Crit (Mortal) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Afflictions': {\r\n    effects: [\r\n      {\r\n        name: `Vectors of Foulest Contagion`,\r\n        desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of Rot Flies`,\r\n        desc: `Declare: If this unit charged this turn, pick this unit and up to 2 friendly Pusgoyle Blightlords units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Rend characteristic of the targets Companion melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Festus the Leechlord': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, [\"The Leechlord's Curse\"])],\r\n    },\r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Delightful Brews, Splendid Restoratives`,\r\n        desc: `At the start of your hero phase, you can pick 1 unit within 1\" of this unit. If you pick a friendly unit, roll a dice. On a 2+, you can heal up to D3 wounds allocated to that unit. If you pick an enemy unit, roll a dice. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Harbinger of Decay': {\r\n    effects: [\r\n      {\r\n        name: `Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rotbringer Sorcerer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Stream of Corruption'])],\r\n    }, */\r\n    effects: [\r\n      //GenericEffects.WizardOneSpellEffect, TaintedEndlessSpellEffect\r\n      {\r\n        name: `Tainted Sorceries`,\r\n        desc: `Declare: Pick an enemy unit that was picked to be the target of a spell that was successfully cast by this unit this phase to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from ward rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'Lord of Blights': {\r\n    effects: [\r\n      {\r\n        name: `Thrice-Ripened Death's Heads`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll D3. On 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Festering Bulwark - Passive`,\r\n        desc: `Effect: The Blighted Weapons used by friendly Putrid Blightkings units have Anti-charge (+1 Rend) while those units are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  LordOfTheBlightkingsEffect,\r\n    ],\r\n  },\r\n  'Gutrot Spume': {\r\n    effects: [\r\n      {\r\n        name: `Flailing Tentacles`,\r\n        desc: `Declare: Pick an enemy Infantry Hero in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Slime Fleet`,\r\n        desc: `Declare: Pick a regiment led by this unit to be the target if it has not been deployed. \r\n        Effect: Each unit in the target regiment is set up in reserve aboard the Slime Fleet. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Pestilential Beachhead`,\r\n        desc: `Declare: Pick this unit if it is aboard the Slime Fleet. \r\n        Effect: Set up this unit on the battlefield, wholly within 7\" of a battlefield edge and more than 9\" from all enemy units. Then set up every other friendly unit that is aboard the Slime Fleet on the battlefield wholly within 7\" of a battlefield edge, wholly within 7\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Plagues': {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Blightkings - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Putrid Blightkings units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Sevenfold Slaughter`,\r\n        desc: `Declare: Pick a friendly Putrid Blightkings unit that charged this turn and is wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, add 1 to the Attacks characteristic of the targets Blighted Weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    // LordOfTheBlightkingsEffect,\r\n    ],\r\n  },\r\n  'Putrid Blightkings': {\r\n    effects: [\r\n      {\r\n        name: `Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // RelentlessAttackersEffect,\r\n    ],\r\n  },\r\n  'Pusgoyle Blightlords': {\r\n    effects: [\r\n      {\r\n        name: `Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // RelentlessAttackersEffect,\r\n    ],\r\n  },\r\n /* 'Fecula Flyblown': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Stream of Corruption'])],\r\n    }, \r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Retchling`,\r\n        desc: `Once per battle, in your hero phase, you can choose for this unit to channel the power of its familiar. If you do so, this unit can attempt to cast 1 additional spell that phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  TaintedEndlessSpellEffect,\r\n    ],\r\n  },\r\n  'The Wurmspat': {\r\n    effects: [\r\n      {\r\n        name: `Festering Bodyguards`,\r\n        desc: `If a friendly Fecula Flyblown is within 3\" of this unit, before you allocate a wound or mortal wound to her, or instead of making a ward roll for her, you can roll a dice. On a 4+, that wound is allocated to this unit instead and cannot be negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE, SAVES_PHASE],\r\n      },\r\n      //RelentlessAttackersEffect,\r\n    ],\r\n  },\r\n /* 'Rot Coven': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Stream of Corruption'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Wizard`,\r\n        desc: `Each model in this unit can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      TaintedEndlessSpellEffect,\r\n    ],\r\n  }, */\r\n  'Rotmire Creed': {\r\n    effects: [\r\n      {\r\n        name: `Virulent Concoctions - Passive`,\r\n        desc: `Effect: When using the Blessed by the Plaguefather ability, if you choose to infect an enemy unit, you can pick an enemy unit that had any damage points allocated to it by this units shooting attacks this turn to be the target even if that unit is not in combat with a friendly Maggotkin of Nurgle unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Brand`s Oathbound': {\r\n    effects: [\r\n      {\r\n        name: `Gunnar Brand: Carve a Path to Glory`,\r\n        desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n        Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n      {\r\n        name: `Gunnar Brand: Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Singri Brand: Swift as the Wind - Passive`,\r\n        desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },  \r\n      {\r\n        name: `Singri Brand: Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn Kin: Withering Death: Casting value of 5`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n      {\r\n        name: `Oathsworn Kin: Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of the Gods - Once Per Turn`,\r\n        desc: `Effect: If any enemy Heroes were slain this turn by the Gunnar Brand in this Regiment of Renown:  \r\n        Heal (5) each unit in this Regiment of Renown.  \r\n        Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: The Coven of Thryx': {\r\n    effects: [\r\n      {\r\n        name: `Magister: Magic-Touched`,\r\n        desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n        Add 1 to this units power level.  \r\n        If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pink Horrors: Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tome of Eyes: Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      }, \r\n      {\r\n        name: `Burning SIgil of Tzeentch: Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sparks of Profane Potential - Once Per Battle`,\r\n        desc: `Effect: If the Magister in the Regiment of Renown has been deployed, set up one of the following Manifestations within 1\" of them:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Skilled Summoner: Casting value of 6`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick 1 of the Manifestations from the list below that is not on the battlefield, then make a casting roll of 2D6:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum \r\n        Effect: If there is already a friendly Manifestation from the list above on the battlefield, it is immediately banished. Then, set up the Manifestation you picked within 1\" of the caster and visible to them. If that Manifestation is a Daemonic Simulacrum, it must also be set up more than 9\" away from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flickering Wyrdflame - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points inflicted on it this turn by Wyrdflame Spell abilities or attacks made with weapons that have the Wyrdflame weapon ability to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { NURGLE } from 'meta/factions'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport SkavenUnits from '../skaven/units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [\r\n      Units,\r\n     /* keyPicker(SkavenUnits, [\r\n        'Plague Priest on Plague Furnace',\r\n        'Verminlord Corruptor',\r\n        'Plague Priest',\r\n        'Plague Censer Bearers',\r\n        'Plague Monks',\r\n        'Plagueclaw',\r\n        'Skabbik Plagueseeker',\r\n        \"Skabbik's Plaguepack\", \r\n      ] \r\n    ), */\r\n    ],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  Nurgle: {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [NURGLE]),\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { NURGLE } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const NurgleFaction = new Faction(\r\n  NURGLE,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_NURGLE\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_OGOR_MAWTRIBES: {\r\n    name: 'Battletome: Ogor Mawtribes',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/07/AmayJMooi82E8FI5.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  //GUTBUSTERS HERO only.\r\n  'Gruesome Trophies': {\r\n    effects: [\r\n      {\r\n        name: `Gruesome Trophies - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks that target Heroes or Monsters made by friendly Ogor Mawtribes units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Elixir of the Frostwyrm': {\r\n    effects: [\r\n      {\r\n        name: `Elixir of the Frostwyrm - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. Inflict an amount of mortal damage on the target equal to the roll. Then, Heal (X) this unit, where X is an amount equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Fang of Ghur': {\r\n    effects: [\r\n      {\r\n        name: `The Fang of Ghur - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Ward rolls cannot be made for the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Flask of Stonehorn Blood': {\r\n    effects: [\r\n      {\r\n        name: `Flask of Stonehorn Blood`,\r\n        desc: `Once per battle, at the start of a phase, you can say that the bearer will drink this potion. The bearer has a ward of 3+ until the end of that phase.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //BEASTCLAW RAIDERS HERO only,\r\n  'Elixir of Frostwyrm': {\r\n    effects: [\r\n      {\r\n        name: `Elixir of Frostwyrm`,\r\n        desc: `Once per battle, in your shooting phase, you can pick 1 enemy unit within 6\" of the bearer and roll a dice. On a 2+, that unit suffers D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Frost-talon Shardbolts': {\r\n    effects: [\r\n      {\r\n        name: `Frost-talon Shardbolts`,\r\n        desc: `If the unmodified hit roll for an attack made with the bearer's Hunter's Crossbow is 6, that attack causes D3 mortal wounds to the target in addition to any damage it inflicts.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Carvalox Flank': {\r\n    effects: [\r\n      {\r\n        name: `Carvalox Flank`,\r\n        desc: `Friendly ICEFALL YHETEE units wholly within 12\" of the bearer at the start of the movement phase can move an extra 2\" when they make a normal move during that phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Seat of Alvagr': {\r\n    effects: [\r\n      {\r\n        name: `The Seat of Alvagr`,\r\n        desc: `Once per battle, in the charge phase, you can carry out a second monstrous rampage with the bearer. The second monstrous rampage cannot be monstrous rampage you have already carried out in that phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // The Roving Maw\r\n  'Flask of Congealed Maw-juices': {\r\n    effects: [\r\n      {\r\n        name: `Flask of Congealed Maw-juices`,\r\n        desc: `Once per battle, at the start of the hero phase, you can pick 1 Mawpit in your army that is within 9\" of the bearer and that has been affected by a rule that says you cannot use the scenery rules on its warscroll (such as Smash To Rubble) and roll a dice. On a 2+, that Mawpit is no longer affected by that rule and you can use the scenery rules on its warscroll once more.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  MagnificentBattalionEffect,\r\n  SlayersBattalionEffect,\r\n  SwiftBattalionEffect,\r\n} from 'generic_rules/core_battalions'\r\n\r\nconst OgorBattalions = {\r\n /* Jorlbad: {\r\n    effects: [SwiftBattalionEffect],\r\n  },\r\n  Eurlbad: {\r\n    effects: [SlayersBattalionEffect],\r\n  },\r\n  Junkmob: {\r\n    effects: [SlayersBattalionEffect],\r\n  },\r\n  Torrbad: {\r\n    effects: [MagnificentBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(OgorBattalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Eat Your Fill': {\r\n    effects: [\r\n      {\r\n        name: `Eat Your Fill`,\r\n        desc: `You complete this tactic at the start of the combat phase if every friendly OGOR unit is eating.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Savour the Taste': {\r\n    effects: [\r\n      {\r\n        name: `Savour the Taste`,\r\n        desc: `You cannot pick this battle tactic in the first battle round. You complete this tactic at the end of your turn if every friendly OGOR unit on the battlefield is hungry.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n    ],\r\n  },\r\n  'Avalanche of Flesh': {\r\n    effects: [\r\n      {\r\n        name: `Avalanche of Flesh`,\r\n        desc: `You complete this tactic at the end of the turn if 10+ mortal wounds were caused by the trampling charge battle trait this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Winter Take Thee': {\r\n    effects: [\r\n      {\r\n        name: `Winter Take Thee`,\r\n        desc: `Pick 1 enemy HERO or enemy MONSTER. You complete this tactic if that enemy unit is destroyed by wounds caused by the Grasp of the Everwinter battle trait (pg 64) this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Let them Loose': {\r\n    effects: [\r\n      {\r\n        name: `Let them Loose`,\r\n        desc: `You complete this tactic at the end of your turn if you carried out 4 or more monstrous rampages this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Boil their Bones': {\r\n    effects: [\r\n      {\r\n        name: `Boil their Bones`,\r\n        desc: `Pick 1 enemy HERO or enemy MONSTER. You complete this tactic if that enemy unit is destroyed within 6\" of an empty Great Mawpot in your army.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'That Was Just a Morsel': {\r\n    effects: [\r\n      {\r\n        name: `That Was Just a Morsel`,\r\n        desc: `You complete this tactic if any enemy models were slain by the Mawpit's Head Butcher ability in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Slavering Ambush': {\r\n    effects: [\r\n      {\r\n        name: `Slavering Ambush`,\r\n        desc: `You complete this tactic if a friendly GORGERS unit was set up on the battlefield using the Ambushing Hunters ability this turn and made a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  \"We Eated 'Em All\": {\r\n    effects: [\r\n      {\r\n        name: `We Eated 'Em All`,\r\n        desc: `Pick 1 objective controlled by your opponent. You complete this tactic if you control that objective at the end of this turn and there are no enemy models contesting it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { OGOR_MAWTRIBES } from 'meta/factions'\r\n\r\nconst BattleTraits = {\r\n  [OGOR_MAWTRIBES]: {\r\n    effects: [\r\n      {\r\n        name: `Trampling Charge`,\r\n        desc: `Declare: Pick a friendly Ogor or Rhinox unit that charged this turn to use this ability, then pick a visible enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Ravenous Brutes - Passive`,\r\n        desc: `Effect: Add 2 to run rolls for friendly Ogor units while you have not used the Feast on Flesh ability this battle.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Feast on Flesh - Once Per Battle`,\r\n        desc: `Declare: Pick each friendly Ogor unit that is in combat or that used a Fight ability this turn to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+:  \r\n        Heal (X) the target, where X is an amount equal to the roll.  \r\n        Pick an enemy unit in combat with the target. You cannot pick the same enemy unit more than once. Inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Great Mawpot (Faction Terrain) - Great Mawpot - Passive`,\r\n        desc: `Effect: The Great Mawpot is either full or empty. It starts the battle full.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Great Mawpot (Faction Terrain) - Throw 'Em In - Passive`,\r\n        desc: `Effect: If an enemy model is slain within 6\" of the Great Mawpot when it is empty, it becomes full.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Great Mawpot (Faction Terrain) - Vessel of the Gulping God`,\r\n        desc: `Declare: If the Great Mawpot is full, pick a friendly Ogor Wizard within 3\" of it to be the target. \r\n        Effect: Add 1 to the power level of the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Great Mawpot (Faction Terrain) - Battlebroth`,\r\n        desc: `Effect: If the Great Mawpot is full, Heal (D3) each friendly unit wholly within 18\" of it. After you have done so, the Great Mawpot is empty.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mawpit (Faction Terrain) - Altar of the Gulping God - Passive`,\r\n        desc: `Effect: While this terrain feature has a Head Butcher:  \r\n        The Head Butcher cannot use Move abilities.  \r\n        Instead of measuring range or visibility to the Head Butcher, measure to this terrain feature instead.  \r\n        All attacks that would target the Head Butcher target this terrain feature instead.  \r\n        If this terrain feature is destroyed, before removing it from the battlefield, inflict D3 mortal damage on the Head Butcher. Then, set up the Head Butcher on the battlefield wholly within 3\" of this terrain feature and not in combat. That unit is no longer a Head Butcher. If it is not possible to set up the Head Butcher, it is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Mawpit (Faction Terrain) - Feed the Maw`,\r\n        desc: `Declare: If this terrain feature does not have a Head Butcher, pick a friendly Butcher or Slaughtermaster within 3\" of it to be the target. \r\n        Effect: Place the target on this terrain feature. The target is now a Head Butcher (see Altar of the Gulping God).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mawpit (Faction Terrain) - Step Away from the Maw`,\r\n        desc: `Effect: If this terrain feature has a Head Butcher, set up the Head Butcher on the battlefield wholly within 3\" of this terrain feature and not in combat. That unit is no longer a Head Butcher.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mawpit (Faction Terrain) - Throat of Ghur`,\r\n        desc: `Declare: Pick up to 3 enemy units within 12\" of this terrain feature, or within 18\" if it has a Head Butcher, to be the targets. \r\n        Effect: Roll a D3 for each target. Add 1 to the roll if the target is more than 3\" from all other enemy units. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Ravenous Brutes': {\r\n    effects: [\r\n      {\r\n        name: `Ravenous Brutes`,\r\n        desc: `If an OGOR unit is more than 3\" from any enemy units, it is hungry. If an OGOR unit is within 3\" of any enemy units, it is eating. Add 2\" to the Move characteristic of a unit that is hungry. Add 2 to the Bravery characteristic of a unit that is eating.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Ravenous Brutes`,\r\n        desc: `If an OGOR unit is more than 3\" from any enemy units, it is hungry. Add 2\" to the Move characteristic of a unit that is hungry.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ravenous Brutes`,\r\n        desc: `If an OGOR unit is within 3\" of any enemy units, it is eating. Add 2 to the Bravery characteristic of a unit that is eating.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Gulping Bites': {\r\n    effects: [\r\n      {\r\n        name: `Gulping Bites`,\r\n        desc: `Roll a dice for each enemy unit within 3\" of any friendly GUTBUSTERS OGOR units. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'The Roving Maw': {\r\n    effects: [\r\n      {\r\n        name: `Mawpits of Ghur`,\r\n        desc: `At the start of each battle round, after determining which player will take the first turn, you must determine the hunger status of the Mawpits on the battlefield by rolling 2D6. If you included a Mawpit in your army, add the number of models slain by its Head Butcher ability during the battle to the roll. If the Mawpit is garrisoned by a Head Butcher, add 1 to the roll. Then, pick 1 result from the Mawpit Table that has a score equal to or less than your modified dice roll to apply for that battle round.\r\n\r\n        A unit is vulnerable to Mawpits if it is on the battlefield unless it is wholly within 1\" of a terrain feature that is not a Mawpit or it can fly. This ability has no effect on ROVING MAW units.\r\n                \r\n        2-3: Subdued: No effect.\r\n        4-5: Peckish: Subtract 1 from the Bravery characteristic of units that are vulnerable to Mawpits.\r\n        6-8: Rumbling: Roll a dice for each unit that is vulnerable to Mawpits. On a 5+, that unit suffers 1 mortal wound.\r\n        9-11: Famished: Units that are vulnerable to Mawpits and that do not have the HERO keyword cannot issue commands.\r\n        12+: Ravenous: Roll a dice for each unit that is vulnerable to Mawpits. On a 4+, that unit suffers D3 mortal wounds. `,\r\n        when: [START_OF_ROUND],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Driven by Starvation`,\r\n        desc: `Friendly GORGERS units that are not wholly within 1\" of a terrain feature at the start of your charge phase can attempt a charge even if they ran in the same turn.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `The Butcher's Kitchen`,\r\n        desc: `For each BUTCHER included in your army, you can include 1 GORGERS unit as a Battleline unit.`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Gobbling Bites`,\r\n        desc: `At the end of the combat phase, roll a dice for each enemy unit within 3\" of any friendly GUTBUSTERS units. On a 2+, that enemy unit suffers D3+1 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ], */\r\n\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { START_OF_CHARGE_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* 'A Barrel of Meat and the Jobs Done': {\r\n    effects: [\r\n      {\r\n        name: `A Barrel of Meat and the Jobs Done`,\r\n        desc: `You can use this command ability at the start of the hero phase. The command can only be issued by your general and must be received by this unit. Until the end of the turn, each model in this unit counts as 3 models for the purposes of contesting objectives.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lead the Skal': {\r\n    effects: [\r\n      {\r\n        name: `Lead the Skal`,\r\n        desc: `You can use this command ability at the start of your charge phase. Pick 1 friendly Frost Sabres. Until the end of that phase, when you attempt a charge with that unit, you can change 1 of the dice in the charge roll to a 4.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  //Gutbuster Heros\r\n  'Great Gutlord': {\r\n    effects: [\r\n      {\r\n        name: `Great Gutlord - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to this units control score and to hit rolls and wound rolls for this units attacks.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n/*  Gastromancer: {\r\n    effects: [\r\n      {\r\n        name: `Gastromancer`,\r\n        desc: 'This general knows all of the spells from the Lore of Gutmagic (pg 68) in addition to the other spells it knows. Butcher Only.',\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  DeadlyAim: {\r\n    effects: [\r\n      {\r\n        name: `Deadly Aim`,\r\n        desc: ' The To Hit characteristic of this units missile weapons is 2+. BLOODPELT HUNTER only.',\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Booming Roar': {\r\n    effects: [\r\n      {\r\n        name: `Booming Roar - Passive`,\r\n        desc: `Effect: Subtract 5 from the control scores of enemy Infantry units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Touched by the Everwinter': {\r\n    effects: [\r\n      {\r\n        name: `Touched by the Everwinter - Passive`,\r\n        desc: `Effect: If this unit is not a Priest, it has Priest (1). If this unit is already a Priest, you can re-roll chanting rolls of 1 for it instead. If this unit is a Wizard, it cannot use Spell abilities and Prayer abilities in the same phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //BEASTCLAW RAIDERS HERO only.\r\n  /*'Voice of the Avalanche': {\r\n    effects: [\r\n      {\r\n        name: `Voice of the Avalanche`,\r\n        desc: `This general can issue commands to any friendly units on the battlefield instead of only those wholly within 18* of them. In addition, once per battle, this general can issue a command without a command point being spent.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Beastmaster: {\r\n    effects: [\r\n      {\r\n        name: `Beastmaster`,\r\n        desc: `Once per battle, when this general is picked to fight, you can say that they will dig in their heels. If you do so, until the end of that phase, use the top row on this general's damage table, regardless of how many wounds they have suffered. STONEHORN HERO OF THUNDERTUSK HERO only.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Touched by the Everwinter': {\r\n    effects: [\r\n      {\r\n        name: `Touched by the Everwinter`,\r\n        desc: `This general has the PRIEST keyword. If this general is already a PRIEST, they know all of the prayers from the Everwinter Prayers prayer scripture in addition to the other prayers they know.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skal Packmaster': {\r\n    effects: [\r\n      {\r\n        name: `Skal Packmaster`,\r\n        desc: `When you use this general's Masters of Ambush ability, up to 3 FROST SABRES units can join this general in ambush instead of 1. ICEBROW HUNTER only.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  // The Roving Maw\r\n  'Prime Gutserver': {\r\n    effects: [\r\n      {\r\n        name: `Prime Gutserver`,\r\n        desc: `This general knows all of the spells from the Lore of the Great Maw in addition to any other spells they know.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { CHARGE_PHASE, DURING_GAME, HERO_PHASE, SHOOTING_PHASE } from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Prophets of the Gulping God': {\r\n    effects: [\r\n      {\r\n        name: `Master Butchers - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Ogor Mawtribes Wizards.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Beast Handlers': {\r\n    effects: [\r\n      {\r\n        name: `Brutal Stock - Passive`,\r\n        desc: `Effect: Each time a friendly Beastclaw Raiders Monster uses the Trampling Charge ability, add 1 to the amount of mortal damage inflicted, if any.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Heralds of the Everwinter': {\r\n    effects: [\r\n      {\r\n        name: `Eyes of the Storm - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target friendly Ogor Mawtribes Infantry units while they are wholly within 12\" of any friendly Beastclaw Raiders Heroes.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blackpowder Fanatics': {\r\n    effects: [\r\n      {\r\n        name: `Feed Yer Cannons! - Passive`,\r\n        desc: `Effect: Ranged weapons used by friendly Leadbelchers and Ironblaster units have Shoot in Combat while they are within the combat range of a friendly Ogor Mawtribes Hero.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Thunderbellies (Mawtribe)': {\r\n    effects: [\r\n      {\r\n        name: `Swift Outflank`,\r\n        desc: `Friendly THUNDERBELLIES MOURNFANG PACK units can run and still charge later in the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Winterbite (Mawtribe)': {\r\n    effects: [\r\n      {\r\n        name: `Ghosts in the Blizzard`,\r\n        desc: `Subtract 1 from hit rolls for attacks made with missile weapons that target friendly WiNTERBITE units wholly within your territory.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Ghosts in the Blizzard`,\r\n        desc: `Friendly WINTERBITE FROST SABRES, ICEBROW HUNTER and ICEFALL YHETEES units are not visible to enemy models more than 12 away.`,\r\n        when: [SHOOTING_PHASE, HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Ready for Plunder': {\r\n    effects: [\r\n      {\r\n        name: `Ready for Plunder`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are more friendly units wholly within enemy territory than enemy units.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Saga of the Monster Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Saga of the Monster Hunter`,\r\n        desc: `When the battle ends, you complete this grand strategy If an enemy MONSTER was destroyed by wounds caused by an attack made by the model picked to be your general and the model picked to be your general has not been slain.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Enough Grub For All': {\r\n    effects: [\r\n      {\r\n        name: `Enough Grub For All`,\r\n        desc: `When the battle ends, you complete this grand strategy if a Great Mawpot in your army is full and you spent all of that Great Mawpot's magic at least once during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'On the Mawpath': {\r\n    effects: [\r\n      {\r\n        name: `On the Mawpath`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed 4 or more battle tactics and each of those battle tactics was from the Glory to the Gulping God (Ogor Tactics).`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  // The Roving Maw\r\n  'Still Not Satiated': {\r\n    effects: [\r\n      {\r\n        name: `Still Not Satiated`,\r\n        desc: `When the battle ends, you complete this grand strategy if 6 or more enemy models were slain by the Mawpit'sHead Butcher ability.`,\r\n        when: [END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Chill of the Everwinter': {\r\n    effects: [\r\n      {\r\n        name: `Chill of the Everwinter`,\r\n        desc: `Only a THUNDERTUSK unit that has made a charge move in the same phase can carry out this monstrous rampage. Roll a dice for each enemy unit within 1\" of this unit. On a 3+, the strike-last effect applies to that unit until the end of the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unstoppable Charge': {\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Charge`,\r\n        desc: `Only a STONEHORN unit that has made a charge move in the same phase can carry out this monstrous rampage. This unit makes a 3D6\" move and can pass across enemy units in the same manner as a unit that can fly. It must finish the move within 3\" of any enemy units. At the end of the move, roll a dice for each unit it passed across. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst MountTraits = {\r\n/*  Fleshgreed: {\r\n    effects: [\r\n      {\r\n        name: `Fleshgreed`,\r\n        desc: `At the start of each hero phase, if this model is eating, you can heal D3 wound allocated to it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rimefrost Hide': {\r\n    effects: [\r\n      {\r\n        name: `Rimefrost Hide`,\r\n        desc: `This unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Matriarch: {\r\n    effects: [\r\n      {\r\n        name: `Matriarch`,\r\n        desc: `Add 1 to charge rolls for friendly THUNDERTUSKS wholly within 12\" of this model.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Metalcruncher: {\r\n    effects: [\r\n      {\r\n        name: `Metalcruncher`,\r\n        desc: `At the start of the combat phase, pick 1 enemy WAR MACHINE, or 1 enemy unit with a Save characteristic of 3+ or 2+, that is within 3\" of this model. That enemy unit immediately suffers D6 mortal wounds.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Belligerent Charger': {\r\n    effects: [\r\n      {\r\n        name: `Belligerent Charger`,\r\n        desc: `Charge rolls for this unit of less than 7 are treated as 7 for the purposes of the Trampling Charge battle trait.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rockmane Elder': {\r\n    effects: [\r\n      {\r\n        name: `Rockmane Elder`,\r\n        desc: `Subtract 1 from wound rolls for attacks tha target this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MountTraits, 'mount_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Prayers = {\r\n  'Everwinter Prayers': {\r\n    effects: [\r\n      {\r\n        name: `Call of the Blizzard: Chant value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Priest to chant this prayer, pick a terrain feature within 18\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Place a blizzard token next to the target. Terrain features that have a blizzard token gain the Obscuring terrain ability. In addition, if the chanting roll was 10+, until the start of your next turn, friendly Beastclaw Raiders units have Ward (5+) while they are within 3\" of any terrain features that have blizzard tokens.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pulverising Hailstorm: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Priest to chant this prayer, pick a point on the battlefield within 12\" of them, then pick each visible enemy unit within 3\" of that point to be the targets. Then, make a chanting roll of D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the chanting roll was 10+, double the amount of mortal damage inflicted.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Keening Gale: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Priest to chant this prayer, pick a visible friendly Ogor Mawtribes Monster or Mournfang Pack unit wholly within 12\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: For the rest of the turn, the target can use a Run ability and still use Charge abilities later in the turn. In addition, if the chanting roll was 8+, you can re-roll run rolls and charge rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Keening Gale': {\r\n    effects: [\r\n      {\r\n        name: `Keening Gale`,\r\n        desc: `Answer value of 3 and range of 18\". If answered, pick 1 friendly MONSTER or MOURNFANG PACK wholly within range and visible to the chanter. Add 3\" to that unit's Move characteristic until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n    ],\r\n  },\r\n  'Call of the Blizzard': {\r\n    effects: [\r\n      {\r\n        name: `Call of the Blizzard`,\r\n        desc: `Answer value of 3 and range of 18\". If answered, pick 1 friendly ICEFALL YHETEES or FROST SABERS unit wholly within range and visible to the chanter. You can return 1 slain model to that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit Prayers\r\n  \"Winter's Endurance\": {\r\n    effects: [\r\n      {\r\n        name: `Winter's Endurance`,\r\n        desc: `This prayer has an answer value of 3 and range of 18\". If answered, pick 1 friendly BEASTCLAW RAIDERS unit wholly within range and visible to the chanter. You can heal D3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n    ],\r\n  },\r\n  \"Winter's Strength\": {\r\n    effects: [\r\n      {\r\n        name: `Winter's Strength`,\r\n        desc: `This prayer has an answer value of 3 and range of 18\". If answered, pick 1 friendly BEASTCLAW RAIDERS unit wholly within range and visible to the chanter. Add 1 to wound rolls for attacks made with melee weapons by that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { END_OF_CHARGE_PHASE, HERO_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Scenery = {\r\n /* 'Great Mawpot': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Vessel of the Gulping God`,\r\n        desc: `Add 1 to casting, unbinding and dispelling rolls for friendly OGOR WIZARDS that are within 1\" of this terrain feature.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n      {\r\n        name: `Battlebroth`,\r\n        desc: `A Great Mawpot is either full or empty. At the start of the battle, it is full. In your hero phase, 1 friendly OGOR HERO within 6\" of a full Great Mawpot in your army can spend all of that Great Mawpot's magic. If they do so, you can heal D3 wounds allocated to each friendly OGOR unit wholly within 36\" of that Great Mawpot (roll separately for each unit). Once all of the Great Mawpot's magic has been spent, it is empty.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n      {\r\n        name: `Throw 'Em In`,\r\n        desc: `If an enemy model is slain within 6\" of an empty Great Mawpot in your army, it becomes full.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_OGOR_MAWTRIBES],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Mawpit: {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Defensible,\r\n      {\r\n        name: `The Throat of Ghur`,\r\n        desc: `At the end of the charge phase, the player whose turn is taking place must roll a dice for each unit in their army that is within 12\" of this terrain feature and within 12\" of any units in their opponent's army and more than 3\" from all units in their opponent's army. On a 3+, that unit suffers D3 mortal wounds.\r\n\r\n        If this terrain feature has a Head Butcher, this ability affects units within 18\" of this terrain feature instead of 12\". This ability has no effect on GUTBUSTERS units.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Head Butcher`,\r\n        desc: `If this terrain feature has a Head Butcher, in your hero phase, you can say that an offering will be made to the Mawpit. If you do so, pick 1 enemy unit within 18\" of this terrain feature and roll D6. If the roll is more than twice that enemy unit's Wounds characteristic, 1 model in that unit is slain. If the roll is more than three times that enemy unit's Wounds characteristic, 3 models in that unit are slain.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `It Fights Back`,\r\n        desc: `If this terrain feature is picked as the target of the Smash To Rubble monstrous rampage, and that monstrous rampage is unsuccessful, the MONSTER that carried out that monstrous rampage suffers 3D6 mortal wounds.\r\n\r\n        Designer's Note: A Smash To Rubble monstrous rampage is unsuccessful if the roll was not a 3+.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { COMBAT_PHASE, HERO_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  //BUTCHER SPELLS\r\n  'Lore of Maw-Magic': {\r\n    effects: [\r\n      {\r\n        name: `Troggoth Guts: Casting value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Wizard to cast this spell, pick a visible friendly Ogor Mawtribes unit within 12\" of them that has not been picked to be the target of this ability this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Heal (D3) the target and add 3 to the targets control score for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Greasy Deluge: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from hit rolls for the targets attacks until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Blood Feast: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Ogor Mawtribes Wizard to cast this spell, pick a visible friendly Ogor Infantry unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Blubbergrub Stench': {\r\n    effects: [\r\n      {\r\n        name: `Blubbergrub Stench`,\r\n        desc: `Casting value of 5 and a range of 18\". Until the start of your next hero phase, while they are wholly within range of the caster, friendly RHINOX units are treated as MONSTERS for the purposes of the Trampling Charge battle trait; contesting objectives; and carrying out monstrous rampages.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Molten Entrails': {\r\n    effects: [\r\n      {\r\n        name: `Molten Entrails`,\r\n        desc: `Casting value of 5. Pick 1 friendly OGOR MAWTRIBES MONSTER wholly within 18\" of the caster that is visible to them. Until the start of your next hero phase, add 1 to the Damage characteristic of the melee weapons used by that MONSTER'S mount.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Molten Entrails`,\r\n        desc: `If active, add 1 to the Damage characteristic of the melee weapons used by that MONSTER'S mount.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Greasy Deluge': {\r\n    effects: [\r\n      {\r\n        name: `Greasy Deluge`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit within 18\" of the caster that is visible to them. Subtract 1 from hit rolls for attacks made by that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //FIREBELLY SPELLS\r\n  'Fiery Whirlwind': {\r\n    effects: [\r\n      {\r\n        name: `Fiery Whirlwind`,\r\n        desc: `Casting value of 6. Pick one enemy unit and roll 1 dice for each model in that unit that is within 12\" of the caster and visible to them. For each 4+, that unit suffers 1 mortal wound. If that unit only has 1 model, roll 3 dice instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Billowing Ash': {\r\n    effects: [\r\n      {\r\n        name: `Billowing Ash`,\r\n        desc: `Casting value of 6. Until the start of your next hero phase, subtract 1 from hit rolls for attacks that target friendly units wholly within 12\" of the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tongues of Flame': {\r\n    effects: [\r\n      {\r\n        name: `Tongues of Flame`,\r\n        desc: `Casting value of 6. Pick 1 enemy unit that has 5 or more models that are within 18\" of the caster and visible to them. Until the start of your next hero phase, each time that unit finishes a move, it suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  //UNIT SPELLS\r\n  'Voracious Maw': {\r\n    effects: [\r\n      {\r\n        name: `Voracious Maw`,\r\n        desc: `Casting value of 7. Pick 1 enemy unit within 18\" of the caster that is visible to them. That unit suffers D3 mortal wounds. After resolving any damage, roll a D6. On a 1, 2 or 3, the maw is said to be satisfied and the spell ends. On a 4+, the target unit suffers D3 additional mortal wounds. Keep repeating this process until the maw is satisfied or the target unit is destroyed.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Cascading Fire-cloak': {\r\n    effects: [\r\n      {\r\n        name: `Cascading Fire-cloak`,\r\n        desc: `Casting value of 5. Roll 1 dice for each enemy unit within 3\" of the caster. On a 4+, that enemy unit suffers D3 mortal wounds. In addition, if this spell is successfully cast, this unit has a ward of 5+ until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cascading Fire-cloak`,\r\n        desc: `If active, this unit has a ward of 5+ until the start of your next hero phase.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Rockchomper: {\r\n    effects: [\r\n      {\r\n        name: `Rockchomper`,\r\n        desc: `Casting value of 5. Pick 1 friendly unit of Ogor Gluttons wholly within 18\" of the caster that is visible to them. Until the start of your next hero phase, rolls made for the Gulping Bite batlle trait cause D6 mortal wounds on a 4+ instead of D3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // The Roving Maw\r\n  Mawmeat: {\r\n    effects: [\r\n      {\r\n        name: `Mawmeat`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 terrain feature within range and visible to the caster. For the rest of the battle, units on or within 1\" of that terrain feature are vulnerable to Mawpits.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  Retcher: {\r\n    effects: [\r\n      {\r\n        name: `Retcher`,\r\n        desc: `Casting value of 7. If successfully cast, until your next hero phase, improve the Rend characteristic of melee weapons used by the caster by 2.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Offal Bringer': {\r\n    effects: [\r\n      {\r\n        name: `Offal Bringer`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Your opponent must make a move of up to 6\" with that unit. All of the models in that unit must finish that move as close as possible to the caster and can finish that move within 3\" of the caster. If it is impossible for that unit to make the move, it suffers D3 mortal wounds instead. After that unit has moved, if that unit is within 3\" of the caster and the caster is within 6\" of a Mawpit in your army, you can immediately use the Mawpit's Head Butcher ability, but you must pick that enemy unit to be the target.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { OGOR_MAWTRIBES } from 'meta/factions'\r\nimport { pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport MountTraits from './mount_traits'\r\nimport Prayers from './prayers'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    flavors: [Flavors],\r\n    mount_traits: [MountTraits],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    prayers: [Prayers],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n    grand_strategies: [GrandStrategies],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  'Ogor Mawtribes': {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [OGOR_MAWTRIBES\r\n    //  'Grasp of the Everwinter',\r\n    //  'Might Makes Right',\r\n    //  'Ravenous Brutes',\r\n     // 'Trampling Charge',\r\n     // 'Gulping Bites',\r\n    ]),\r\n  },\r\n /* 'The Roving Maw': {\r\n    ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, ['The Roving Maw', 'Ravenous Brutes', 'Might Makes Right']),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { OGOR_MAWTRIBES } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const OgorMawtribesFaction = new Faction(\r\n  OGOR_MAWTRIBES,\r\n  DESTRUCTION,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_OGOR_MAWTRIBES\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { OSSIARCH_BONEREAPERS } from 'meta/factions'\r\nimport { BATTLESHOCK_PHASE, CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, HERO_PHASE, MOVEMENT_PHASE, START_OF_ROUND, WARDS_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [OSSIARCH_BONEREAPERS]: {\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Advance`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. All friendly Ossiarch Bonereapers units wholly within 12\" of that Hero are the targets. \r\n        Effect: Add 2\" to the Move characteristic of each target for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Re-Form Ranks`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. \r\n        Effect: For the rest of the turn, while they are wholly within 12\" of that Hero, friendly Ossiarch Bonereapers units can use Charge abilities even if they used a Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Coodrinated Charge`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. \r\n        Effect: For the rest of the turn, add 1 to charge rolls for friendly Ossiarch Bonereapers units while they are wholly within 12\" of that Hero.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Counter-Strike`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. \r\n        Effect: For the rest of the turn, friendly units melee weapons have Anti-charge (+1 Rend) while they are wholly within 12\" of that Hero.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Bludgeon`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. \r\n        Effect: For the rest of the turn, add 1 to wound rolls for combat attacks made by friendly Ossiarch Bonereapers units while they are wholly within 12\" of that Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Impenetrable Ranks`,\r\n        desc: `Declare: If no friendly units have used a Relentless Discipline ability this phase, pick a friendly Ossiarch Bonereapers Hero to use this ability. \r\n        Effect: For the rest of the turn, friendly Ossiarch Bonereapers have Ward (5+) while they are wholly within 12\" of that Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bone-Tithe Nexus (Faction Terrain) - Deadly Gaze`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this terrain feature to be the target. \r\n        Effect: Roll a dice. On a 4+, pick 1 of the following effects to apply: \r\n        Punishment of Agony: Subtract 1 from hit rolls for the target until the start of your next turn. \r\n        Punishment of Ignorance: Subtract 1 from casting rolls and/or chanting rolls for the target until the start of your next turn. \r\n        Punishment of Lethargy: Halve the targets Move characteristic until the start of your next turn. \r\n        Punishment of Death: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_OSSIARCH_BONEREAPERS: {\r\n    name: 'Battletome: Ossiarch Bonereapers',\r\n    type: 'battletome',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst Battalions = {\r\n  /*'Ossiarch Cohort': {\r\n    effects: [OneDropDeploymentEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n  /*'Trample the Defiant': {\r\n    effects: [\r\n      {\r\n        name: `Trample the Defiant`,\r\n        desc: `Pick 1 friendly KAVALOS DEATHRIDERS unit that is more than 3\" from all enemy units. You complete this tactic if that unit made a charge move in this turn and is within 3\" of any enemy units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unfeeling Recursion': {\r\n    effects: [\r\n      {\r\n        name: `Unfeeling Recursion`,\r\n        desc: `You complete this tactic if there are 3 or more friendly OSSIARCH BONEREAPERS units on the battlefield that had models returned to them in this turn using the Reknit Construct command ability and did not have any models slain in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Tithe Demands': {\r\n    effects: [\r\n      {\r\n        name: `The Tithe Demands`,\r\n        desc: `Pick 1 enemy HERO or MONSTER on the battlefield. You complete this tactic if that unit is destroyed during this turn by an attack made by a friendly GOTHIZZAR HARVESTER.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"The Sculptor's Entourage\": {\r\n    effects: [\r\n      {\r\n        name: `The Sculptor's Entourage`,\r\n        desc: `You complete this tactic at the end of this turn if a friendly IMMORTIS GUARD unit and a friendly MORTISAN are contesting the same objective wholly outside of your territory.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Remorseless Bombardment': {\r\n    effects: [\r\n      {\r\n        name: `Remorseless Bombardment`,\r\n        desc: `Pick 1 enemy unit on the battlefield. You complete this tactic if that enemy unit is destroyed during this turn by attacks made by friendly MORTEK CRAWLER units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Edge of Obliteration': {\r\n    effects: [\r\n      {\r\n        name: `The Edge of Obliteration`,\r\n        desc: `You complete this tactic if 2 or more friendly NECROPOLIS STALKERS units are wholly within enemy territory and more than 9\" from all enemy units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n /* Mindblade: {\r\n    effects: [\r\n      {\r\n        name: `Mindblade`,\r\n        desc: `Pick 1 of the bearer's melee weapons. At the end of the combat phase, if any wounds or mortal wounds caused by attacks made with that weapon were allocated to an enemy HERO in that phase and that HERO was not slain, that HERO cannot carry out heroic actions for the rest of the battle.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bones of the Abyss': {\r\n    effects: [\r\n      {\r\n        name: `Bones of the Abyss`,\r\n        desc: `SOULMASON only. Each time the bearer successfully casts a spell that is not unbound, add 1 to the Attacks characteristic of the bearer' Ossified Claws until the end of that turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Marrowpact: {\r\n    effects: [\r\n      {\r\n        name: `Marrowpact`,\r\n        desc: `Each time the bearer fights, after all of their attacks have been resolved, you can heal up to a number of wounds allocated to the bearer equal to the number of wounds and mortal wounds caused by those attacks that were allocated to enemy units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Helm of Tyranny': {\r\n    effects: [\r\n      {\r\n        name: `Helm of Tyranny - Passive`,\r\n        desc: `Effect: Subtract 2 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  \"Marrowpact\": {\r\n    effects: [\r\n      {\r\n        name: `Marrowpact - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, if the unmodified hit roll for a combat attack that targets this unit is 1-2, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lode of Saturation': {\r\n    effects: [\r\n      {\r\n        name: `Lode of Saturation - Passive`,\r\n        desc: `Effect: This unit has Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n /* 'Gothizzar Cartouche': {\r\n    effects: [\r\n      {\r\n        name: `Gothizzar Cartouche`,\r\n        desc: `OSSIFECTOR only. Add 1 to wound rolls for attacks made with melee weapons by friendly OSSIARCH BONEREAPERS units wholly within 9\" of the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Luminscythe: {\r\n    effects: [\r\n      {\r\n        name: `Luminscythe`,\r\n        desc: `SOULREAPER only. Subtract 1 from hit rolls and wound rolls for attacks that target the bearer while they are within 3\" of any enemy units.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* 'Re-form Ranks': {\r\n    effects: [\r\n      {\r\n        name: `Re-form Ranks`,\r\n        desc: `You can use this command ability in your movement phase. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit. That unit can retreat in that phase and still charge later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Impenetrable Ranks': {\r\n    effects: [\r\n      {\r\n        name: `Impenetrable Ranks`,\r\n        desc: `You can use this command ability when a friendly OSSIARCH BONEREAPERS unit is picked as the target of an attack. That unit must receive the command. Until the end of the phase, add 1 to ward rolls for that unit for the purposes of the Deathless Warriors battle trait.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unstoppable Advance': {\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Advance`,\r\n        desc: `You can use this command ability in your movement phase when you pick a friendly OSSIARCH BONEREAPERS unit to make a normal move. Add 3\" to that unit's Move characteristic until the end of that phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Endless Duty': {\r\n    effects: [\r\n      {\r\n        name: `Endless Duty`,\r\n        desc: `You can use this command ability in your hero phase. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit. Until your next hero phase, add 1 to the Attacks characteristic of that unit's melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reknit Construct': {\r\n    effects: [\r\n      {\r\n        name: `Reknit Construct`,\r\n        desc: `You can use this command ability at the end of your movement phase. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit that is more than 3\" from all enemy units. You can heal up to D3 wounds allocated to that unit or, if no wounds are allocated to it, you can return a number of slain models to that unit that have a combined Wounds characteristic of D3 or less.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unflinching Coordination': {\r\n    effects: [\r\n      {\r\n        name: `Unflinching Coordination`,\r\n        desc: `You can use this command ability in the combat phase, after a friendly OSSIARCH BONEREAPERS HERO has fought for the first time in that phase. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit that has not yet fought in that combat phase, that is within 3\" of an enemy unit and that is wholly within 12\" of that friendly OSSIARCH BONEREAPERS HERO. That unit fights immediately.\r\n        \r\n        Designer's Note: If the unit you pick to fight immediately is an OSSIARCH BONEREAPERS HERO, after that unit has fought, you cannot then use this command ability to pick another friendly OSSIARCH BONEREAPERS unit to fight immediately.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Still Their Breath!': {\r\n    effects: [\r\n      {\r\n        name: `Still Their Breath!`,\r\n        desc: `You can use this command ability in the combat phase. This unit must receive the command. Until your next hero phase, add 1 to wound rolls for attacks made with melee weapons by friendly MORTIS PRAETORIANS units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Shieldwall: {\r\n    effects: [\r\n      {\r\n        name: `Shieldwall`,\r\n        desc: `You can use this command ability at the start of the combat phase. The command can only be issued by this unit's Mortek Hekatos, and this unit must receive the command. Ignore modifiers (positive and negative) to save rolls for attacks that target this unit in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Deathrider Wedge': {\r\n    effects: [\r\n      {\r\n        name: `Deathrider Wedge`,\r\n        desc: `You can use this command ability in the charge phase. The command can only be issued by this unit's Mortek Hekatos, and this unit must receive the command. Until the end of that phase, models in this unit can pass across other models with a Wounds characteristic of 3 or less in the same manner as a model that can fly.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hunt and Kill': {\r\n    effects: [\r\n      {\r\n        name: `Hunt and Kill`,\r\n        desc: `You can use this command ability in your hero phase. The command can only be issued by a model in this unit, and this unit must receive the command. Until your next hero phase, this unit can run and still charge later in the turn. In addition, until your next hero phase, models in this unit can pass across terrain features in the same manner as models that can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Supreme Lord of the Bonereaper Legions': {\r\n    effects: [\r\n      {\r\n        name: `Supreme Lord of the Bonereaper Legions`,\r\n        desc: `You can use this command ability in your hero phase if this unit is more than 3\" from all enemy units. This unit must receive the command. Until your next hero phase, add 1 to hit rolls for attacks made by friendly OSSIARCH BONEREAPERS units wholly within 24\" of this unit and add 1 to save rolls for attacks that target friendly OSSIARCH BONEREAPERS units wholly within 24\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Counter-strike': {\r\n    effects: [\r\n      {\r\n        name: `Counter-strike`,\r\n        desc: `You can use this command ability in the enemy charge phase, after an enemy unit has finished a charge move. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit that is within 3\" of an enemy unit that made a charge move in the same turn and more than 3\" from all other enemy units. Add 1 to wound rolls for attacks made with melee weapons by that unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Bludgeon: {\r\n    effects: [\r\n      {\r\n        name: `Bludgeon`,\r\n        desc: `You can use this command ability at the start of the combat phase. The unit that receives the command must be a friendly OSSIARCH BONEREAPERS unit. Improve the Rend characteristic of that unit's melee weapons by 1 until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crushing Assault': {\r\n    effects: [\r\n      {\r\n        name: `Crushing Assault`,\r\n        desc: `You can use this command ability once per battle, after this unit has fought for the first time in the combat phase. The command can only be issued by a model in this unit, and this unit must receive the command. This unit can fight for a second time in that phase. The strike-last effect applies to this unit when it fights for that second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, HERO_PHASE, SAVES_PHASE, SHOOTING_PHASE, START_OF_ROUND } from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n /* 'Show of Superiority': {\r\n    effects: [\r\n      {\r\n        name: `Show of Superiority`,\r\n        desc: `While this general is on the battlefield, roll a dice before your opponent spends any command points to use a command ability. On a 5+, your opponent must spend 2 command points to issue the command instead of 1.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Crafted from Beast-bone': {\r\n    effects: [\r\n      {\r\n        name: `Crafted from Beast-bone`,\r\n        desc: `After this general has fought for the first time, at the start of each battle round, add 1 to the Attacks characteristic of this general's weapons for the rest of the battle. This effect is cumulative.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Aura of Sterility': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Sterility`,\r\n        desc: `Subtract 1 from hit rolls and wound rolls for attacks made with missile weapons that target friendly OSSIARCH BONEREAPERS units wholly within 12\" of this general.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Diversionary Tactics': {\r\n    effects: [\r\n      {\r\n        name: `Diversionary Tactics - Passive`,\r\n        desc: `Effect: Subtract 2 from charge rolls for enemy units while they are within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Aura of Sterility': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Sterility - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for shooting attacks that target friendly Ossiarch Bonereapers units while they are wholly within 12\" of this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mighty Archaeossian': {\r\n    effects: [\r\n      {\r\n        name: `Mighty Archaeossian - Passive`,\r\n        desc: `Effect: If the unmodified hit roll for an attack that targets this unit is 1-3, the attack fails and the attack sequence ends.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  DURING_GAME,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst EndlessSpells = {\r\n /* 'Bone-tithe Shrieker': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 12\". If successfully cast, set up this endless spell within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only OSSIARCH BONEREAPERS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      ...GenericEffects.Bonded,\r\n      {\r\n        name: `Portent of Doom`,\r\n        desc: `Units cannot receive the Inspiring Presence or Rally commands while they are within 12\" of this endless spell. This ability has no effect on OSSIARCH BONEREAPERS units.`,\r\n        when: [START_OF_BATTLESHOCK_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `No Escape`,\r\n        desc: `Subtract 1 from ward rolls for units within 12\" of this endless spell. This ability has no effect on OSSIARCH BONEREAPERS units.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nightmare Predator': {\r\n    effects: [\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      ...GenericEffects.Bonded,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 12\". If successfully cast, set up this endless spell within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only OSSIARCH BONEREAPERS WIZARDS can attempt to summon this endless spell. A WIZARD in a garrison cannot attempt to summon this endless spell, and if this endless spell is summoned, the WIZARD that summoned it cannot join a garrison until this endless spell has been removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Death Incarnate`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across. On a 2+, that unit suffers D3 mortal wounds. Then, the commanding player can pick 1 unit within 1\" of this endless spell and roll a dice. On a 1, nothing happens. On a 2-5, that unit suffers D3 mortal wounds. On a 6, that unit suffers D6 mortal wounds. This ability has no effect on OSSIARCH BONEREAPERS units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soulstealer Carrion': {\r\n    effects: [\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      ...GenericEffects.Bonded,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6. If successfully cast, set up this endless spell anywhere on the battlefield that is visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only OSSIARCH BONEREAPERS WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Aviarch Sentry`,\r\n        desc: `Models with a Wounds characteristic of 1 or 2 that are within 6\" of this endless spell cannot contest objectives. This ability has no effect on OSSIARCH BONEREAPERS units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_SETUP, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst Flavors = {\r\n  'Mortis Council': {\r\n    effects: [\r\n      {\r\n        name: `Necrotic Symphony - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Ossiarch Bonereapers Infantry Wizards.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortek Ballistari': {\r\n    effects: [\r\n      {\r\n        name: `Crawling Barrage`,\r\n        desc: `Declare: Pick up to 3 friendly Mortek Crawler units that are wholly within friendly territory and that have not used a Move ability this turn to be the targets. \r\n        Effect: Add 1 to hit rolls for each targets shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kavalos Lance': {\r\n    effects: [\r\n      {\r\n        name: `Swift as Death - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Ossiarch Bonereapers Cavalry units to be the targets. \r\n        Effect: Each target can move 6\" but cannot end that move in combat.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Mortek Phalanx': {\r\n    effects: [\r\n      {\r\n        name: `Send in the Reserve - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Mortek Guard unit that has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 5+, set up a replacement unit with half the number of models from the target unit (rounding up) on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Null Myriad': {\r\n    effects: [\r\n      {\r\n        name: `Eldritch Nulls`,\r\n        desc: `You can roll a dice each time a friendly Null Myriad unit is affected by a spell cast by an enemy unit or the abilities of an endless spell summoned by an enemy unit. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on that unit.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_OSSIARCH_BONEREAPERS,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  Crematorians: {\r\n    effects: [\r\n      {\r\n        name: `Immolation`,\r\n        desc: `Each time a friendly CREMATORIANS model is slain, before removing that model from play, you can pick 1 enemy unit within 3\" of it and roll a number of dice equal to the Wounds characteristic of that model. For each 5+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\n// Note: We do NOT use tagAs for Flavors\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n /* 'Bone-tithe Nexus': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup_Removable,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Deadly Gaze`,\r\n        desc: `In your hero phase, you can choose for this terrain feature to deliver 1 of the following punishments:\r\n\r\n        Punishment of Agony: Pick 1 enemy unit within 18\" of this terrain feature and visible to it, and roll a dice. Add 1 to the roll if any enemy models were slain within 12\" of this terrain feature in the previous turn. On a 4+, subtract 1 from hit rolls for attacks made by that unit until your next hero phase.\r\n        \r\n        Punishment of Death: Pick 1 enemy unit within 18\" of this terrain feature and visible to it, and roll a dice. Add 1 to the roll if any enemy models were slain within 12\" of this terrain feature in the previous turn. On a 4+, that unit suffers D3 mortal wounds.\r\n        \r\n        Punishment of Ignorance: Pick 1 enemy WIZARD or PRIEST within 18\" of this terrain feature and visible to it, and roll a dice. Add 1 to the roll if any enemy models were slain within 12\" of this terrain feature in the previous turn. On a 4+, subtract 1 from casting rolls or chanting rolls for that unit until your next hero phase.\r\n        \r\n        Punishment of Lethargy: Pick 1 enemy unit within 18\" of this terrain feature and visible to it, and roll a dice. Add 1 to the roll if any enemy models were slain within 12\" of this terrain feature in the previous turn. On a 4+, that unit cannot run until your next hero phase. In addition, subtract 3 from charge rolls for that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of Ossian Sorcery': {\r\n    effects: [\r\n      {\r\n        name: `Empower Nadirite Weapons: Casting value of 5 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Ossiarch Bonereapers Wizard to cast this spell, pick a visible friendly Ossiarch Bonereapers unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The targets combat attacks score critical hits on unmodified hit rolls of 5+ until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Drain Vitality: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Ossiarch Bonereapers Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from hit rolls for the targets attacks and subtract 1 from save rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shard Storm: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Ossiarch Bonereapers Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Protection of Nagash': {\r\n    effects: [\r\n      {\r\n        name: `Protection of Nagash`,\r\n        desc: `Casting value of 6. If successfully cast, at the end of any phase, if any wounds or mortal wounds were allocated to the caster in that phase from an attack made with a melee weapon and the caster was not slain, remove them from the battlefield and set them up again on the battlefield more than 9\" from all enemy units. After setting up the caster, this spell is unbound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reinforce Constructs': {\r\n    effects: [\r\n      {\r\n        name: `Reinforce Constructs`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 friendly OSSIARCH BONEREAPERS unit wholly within range and visible to the caster. Until your next hero phase, that unit has a ward of 4+ against mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Drain Vitality': {\r\n    effects: [\r\n      {\r\n        name: `Drain Vitality`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, subtract 1 from hit rolls for attacks made by that unit and subtract 1 from save rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortal Contract': {\r\n    effects: [\r\n      {\r\n        name: `Mortal Contract`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. For the rest of the battle, roll a dice at the end of each phase in which any attacks made by that unit inflicted any damage on a friendly OSSIARCH BONEREAPERS unit. On a 3+, that enemy unit suffers D3 mortal wounds. You cannot pick the same enemy unit to be affected by this spell more than once per battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul Release': {\r\n    effects: [\r\n      {\r\n        name: `Soul Release`,\r\n        desc: `Casting value of 5 and a range of 12\". Until your next hero phase, enemy reserve units and enemy summoned units (core rules, 3.1) cannot be set up within range of the caster. The range of this spell cannot be modified and must be measured from the caster, even if an ability would allow youto measure it from elsewhere.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortal Touch': {\r\n    effects: [\r\n      {\r\n        name: `Mortal Touch`,\r\n        desc: `Casting value of 7 and a range of 1\". Pick 1 enemy model within range and visible to the caster and roll a dice. On a 4+, that model is slain. The range of this spell cannot be modified and must be measured from the caster, even if an ability would allow you to measure it from elsewhere.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul-guide': {\r\n    effects: [\r\n      {\r\n        name: `Soul-guide`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick 1 friendly MORTEK GUARD or KAVALOS DEATHRIDERS unit wholly within range and visible to the caster. Add 1 to wound rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Soul-blast': {\r\n    effects: [\r\n      {\r\n        name: `Soul-blast`,\r\n        desc: `Casting value of 6 and a range of 12\". If successfully cast, at the start of any 1 phase before your next hero phase, you can pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. If that unit is within 3\" of the caster, it suffers 3 mortal wounds instead of D3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shard-storm': {\r\n    effects: [\r\n      {\r\n        name: `Shard-storm`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 enemy unit within range and visible to the caster and roll a number of dice equal to the number of models in that unit. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Empower Ossification': {\r\n    effects: [\r\n      {\r\n        name: `Empower Ossification`,\r\n        desc: `Casting value of 5 and a range of 24\". If successfully cast, the caster can pick up to 3 different friendly GOTHIZZAR HARVESTERS, MORTEK CRAWLERS or MORGHAST units in any combination that are wholly within range to benefit from the Refined Creations ability instead of 1 unit that is wholly within 12\".`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dire Ultimatum': {\r\n    effects: [\r\n      {\r\n        name: `Dire Ultimatum`,\r\n        desc: `Casting value of 4 and a range of 3\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, if this unit is within 3\" of that enemy unit when that enemy unit is picked to fight, all attacks made with melee weapons by that enemy unit must target this unit. The range of this spell must be measured from the caster, even if an ability would allow you to measure it from elsewhere.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const TheWillOfTheLegionsEffect = {\r\n  name: `The Will of the Legions`,\r\n  desc: `Once per turn, this unit can issue a command to a friendly OSSIARCH BONEREAPERS unit without a command point being spent.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst GrimOpponentsEffect = {\r\n  name: `Grim Opponents`,\r\n  desc: `If you make an unmodified charge roll of 8+ for this unit, the strike-first effect applies to this unit until the end of that turn.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst NecrophorosEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `Add 1 to run rolls and charge rolls for this unit if it includes any Necrophoroi.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst HeraldsOfTheAccursedOneEffect = {\r\n  name: `Heralds of the Accursed One`,\r\n  desc: `Enemy units cannot receive commands while they are within 3\" of any friendly units with this ability.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst MortekHekatosEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be a Mortek Hekatos. Add 1 to the Attacks characteristic of that model's melee weapon.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst UnstoppableChargeEffects = [\r\n  {\r\n    name: `Unstoppable Charge`,\r\n    desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a number of dice equal to the unmodified charge roll for that charge move. For each 5+, that enemy unit suffers 1 mortal wound.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Unstoppable Charge`,\r\n    desc: `This unit can move an extra 3\" when it piles in if it made a charge move in the same turn.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n] */\r\n\r\nconst Units = {\r\n  'Arkhan the Black, Mortarch of Sacrament': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Curse of Years'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Razaraks Ebon Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Doom of Traitors - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is a Hero, double the amount of mortal damage inflicted.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  FeasterOfSoulsEffect,\r\n      {\r\n        name: `Staff of Spirits - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit. Each time this unit successfully casts a spell, Heal (1) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Curse of Years: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 10 dice. For each 6:  \r\n        Inflict 1 mortal damage on the target.  \r\n        Roll an extra dice. \r\n        For each 5+ on those extra dice, repeat the above bullet points. Then, do the same for each 4+, then each 3+, then each 2+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Sacrament - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Ossiarch Bonereapers unit wholly within 18\" of this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on that unit. This unit can use this ability more than once per phase but only once per Spell ability`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Teratic Cohort': {\r\n     effects: [\r\n       {\r\n         name: `Predator's Cunning`,\r\n         desc: `Declare: Pick this unit if it has not been deployed. \r\n         Effect: Set up this unit in reserve outflanking the enemy. It has now been deployed.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n       {\r\n         name: `Hunters Unleashed`,\r\n         desc: `Declare: Pick this unit if it is outflanking the enemy. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n     ],\r\n   },\r\n  'Nagash, Supreme Lord of the Undead': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, subtract 3 from its power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Staff of Power - Passive`,\r\n        desc: `Effect: Add 2 to casting rolls for this unit while it has not miscast any spells this turn. If this unit miscasts a spell, ignore the restriction that would stop this unit from casting any more spells this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Hand of Dust - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy Hero or Monster in combat with this unit to be the target. \r\n        Effect: Hide a dice in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one hiding the dice, this ability has no effect. If they pick the empty one, the target is automatically destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Supreme Lord of the Undead - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero non-Unique Death unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit identical to the target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Invocation of Nagash: Casting value of 7`,\r\n        desc: `Declare: This unit can cast this spell more than once per phase. Pick a visible unit wholly within 18\" of this unit that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target is an enemy unit, inflict D3 mortal damage on it. If the target is a friendly Death unit, pick 1 of the following effects:  \r\n        Return a number of slain models to the target unit with a combined Health characteristic of up to 3.  The target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gothizzar Harvester': {\r\n    effects: [\r\n      {\r\n        name: `Bone Harvest - Passive`,\r\n        desc: `Effect: Each time an enemy model in combat with this unit is slain, give this unit 1 bone-tithe point. This unit can have a maximum of 6 bone-tithe points at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gruesome Surgery - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. For each model slain by this ability, you can return 1 slain model to a friendly Mortek Guard unit wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Repair Construct`,\r\n        desc: `Declare: Pick a friendly Ossiarch Bonereapers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Return a number of slain models to the target with a combined Health characteristic equal to the number of bone-tithe points this unit has. Then, reset this units bone-tithe points to 0.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Immortis Guard': {\r\n  /*  mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Crushing Assault'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n      {\r\n        name: `Soulbound Protectors - Passive`,\r\n        desc: `Effect: Add 1 to ward rolls for friendly Ossiarch Bonereapers Heroes within this units combat range. However, each time you make a ward roll of 1 for a friendly Ossiarch Bonereapers Hero within this units combat range, allocate 1 damage point to this unit after the damage sequence for that Hero has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Mortek Guard': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Shieldwall'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Shieldwall - Passive`,\r\n        desc: `Effect: Ignore all modiifers to save rolls for this unit (positive and negative) for the rest of the turn if this unit did not use a Move ability in the same turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    //  NecrophorosEffect,\r\n    ],\r\n  },\r\n  'Kavalos Deathriders': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Deathrider Wedge'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Deathrider Wedge - Passive`,\r\n        desc: `Effect: When this unit uses a Charge ability, models in this unit can pass through models in enemy Infantry units as if this unit had Fly.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Unstoppable Charge - Passive`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit that it passed across to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    //  NecrophorosEffect, MortekHekatosEffect, ...UnstoppableChargeEffects\r\n    ],\r\n  },\r\n  'Necropolis Stalkers': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Hunt and Kill'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n      {\r\n        name: `Quadrarch Aspects`,\r\n        desc: `Effect: Pick 1 of the following effects to apply for the rest of the turn: \r\n        Domination Aspect: Subtract 3 from the control scores of enemy units while they are in combat with this unit. \r\n        Blade-Parry Aspect: Subtract 1 from hit rolls for combat attacks that target this unit. \r\n        Destroyer Aspect: Ward rolls cannot be made for damage points inflicted by this units combat attacks. \r\n        Precision Aspect: This units melee weapons have Anti-Hero (+1 Rend) while this unit is in combat with an enemy Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortek Crawler': {\r\n    effects: [\r\n      {\r\n        name: `Deathly Barrage`,\r\n        desc: `Declare: Pick an enemy unit that was targeted by all of this units shooting attacks this phase to be the target. \r\n        Effect: Roll a dice. Add 1 to the roll if this unit is wholly within 12\" of a friendly Mortisan Ossifector, and add 1 to the roll if any other friendly Mortek Crawler units picked that enemy unit to be the target of this ability this turn. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morghast Archai': {\r\n    effects: [\r\n     // GenericEffects.Elite,\r\n     // HeraldsOfTheAccursedOneEffect,\r\n     // GrimOpponentsEffect,\r\n      {\r\n        name: `Ebon-Wrought Armour - Passive`,\r\n        desc: `Effect: This unit has Ward (3+) against damage points inflicted by Spell abilities, Prayer abilities and abilities used by Manifestations. If you make a successful ward roll for this unit, or if this unit destroys an enemy Manifestation, give this unit an arcane charge token. This unit cannot have more than 1 arcane charge token at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Discharge Armour`,\r\n        desc: `Declare: If this unit has an arcane charge token, pick a friendly Ossiarch Bonereapers Wizard wholly within 12\" of this unit to be the target. \r\n        Effect: Remove this units arcane charge token, then add 1 to casting rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Morghast Harbingers': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n    //  HeraldsOfTheAccursedOneEffect,\r\n    //  GrimOpponentsEffect,\r\n      {\r\n        name: `Heralds of Nagash - Once Per Turn - Reaction: You declared a Relentless Discipline ability`,\r\n        desc: `Effect: This unit is affected by that Relentless Discipline ability as if it were wholly within range of the friendly Hero picked to use it.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Harbingers of Death - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Arch-Kavalos Zandtos': {\r\n  /*  mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Still Their Breath!'])],\r\n    }, */\r\n    effects: [\r\n    //  ...UnstoppableChargeEffects,\r\n    {\r\n      name: `Unstoppable Charge - Passive`,\r\n      desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit that it passed across to be the target. \r\n      Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n      {\r\n        name: `Spear of the Kavaloi - Passive`,\r\n        desc: `Effect: When this unit uses a Charge ability, it can pass through models in enemy Infantry units as if it had Fly.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // TheWillOfTheLegionsEffect,\r\n      {\r\n        name: `Still Their Breath - Once Per Battle`,\r\n        desc: `Effect: If this unit is in combat, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly non-Hero Ossiarch Bonereapers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Vokmortian: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Mortal Touch'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Voice of Nagash - Once Per Battle`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target. \r\n        Effect: For the rest of the turn, non-Fight Core abilities cost 1 command point for the target to use.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mortal Contract: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be bound, pick a visible friendly Ossiarch Bonereapers unit wholly within 18\" of this unit to be bound, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, each time the bound friendly unit is picked to be the target of an ability used by the bound enemy unit, roll a D3. On a 2+, inflict an amount of mortal damage on the bound enemy unit equal to the roll as a reaction. If the bound enemy unit is destroyed by this ability, do not resolve the effect of the enemy ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Liege-Kavalos': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Endless Duty'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Charge - Passive`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit that it passed across to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Spear of the Kavaloi - Passive`,\r\n        desc: `Effect: When this unit uses a Charge ability, it can pass through models in enemy Infantry units as if it had Fly.`,\r\n        when: [CHARGE_PHASE],\r\n     },\r\n     {\r\n      name: `Master of Cavalry - Reaction: You declared a Fight ability for this unit`,\r\n      desc: `Effect: Pick a friendly Kavalos Deathriders unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n      when: [COMBAT_PHASE],\r\n     },\r\n    //  TheWillOfTheLegionsEffect, ...UnstoppableChargeEffects\r\n    ],\r\n  },\r\n  'Mortisan Boneshaper': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Shard-storm'])],\r\n    }, */\r\n    effects: [\r\n   //   GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Boneshaper - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Ossiarch Bonereapers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+:  \r\n        If the target is damaged, Heal (3) the target.  \r\n        If the target is not damaged, return a number of slain models to the target unit with a combined Health characteristic of up to 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortisan Soulmason': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Soul-guide'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Soul-Guide: Casting value of 7`,\r\n        desc: `Declare: Pick a visible friendly Ossiarch Bonereapers unit wholly within 12\" of the caster to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has Strike-first for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortisan Soulreaper': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Soul-blast'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Soulreaper - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for combat attacks made by enemy units while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Necrotic Impetus - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Ossiarch Bonereapers Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mortisan Ossifector': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Empower Ossification'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Refined Creations - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Gothizzar Harvester, Morghast Archai or Morghast Harbingers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, add 1 to the Rend characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Katakros: {\r\n   /* mandatory: {\r\n      command_abilities: [\r\n        keyPicker(CommandAbilities, ['Supreme Lord of the Bonereaper Legions', 'Endless Duty']),\r\n      ], \r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Inda-Khaat is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of the Necropolis - Passive`,\r\n        desc: `Effect: If this unit uses a Relentless Discipline ability, that ability affects friendly Ossiarch Bonereapers units wholly within 18\" of this unit instead of wholly within 12\".`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Prime Necrophoros - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Ossiarch Bonereapers units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Aviarch Spymaster - Once Per Turn - Reaction: Opponent declared a command for a unit within 18\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 5+, that command has no effect, it still counts as having been used and the command points spent to use it are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Command Ability - Supreme Lord of the Bonereaper Legions`,\r\n        desc: `Declare: Pick up to 3 friendly Ossiarch Bonereapers units wholly within 18\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, add 1 to save rolls for the targets while they are wholly within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Mir Kainan': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Dire Ultimatum'])],\r\n    },\r\n    effects: [\r\n      GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Bone-tithe`,\r\n        desc: `This unit has a tithe score that starts at 0 at the start of the battle. Each time an enemy model is slain by this unit's attacks, increase this unit's tithe score by 1. If that slain model had a Wounds characteristic of 4 or more, increase this unit's tithe score by 2 instead of 1.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Bone-tithe`,\r\n        desc: `At the start of your hero phase, if this unit has a tithe score of 1 or more, you can reduce its tithe score by 1. If you do so, pick 1 of the following abilities:\r\n\r\n        Built for War: Pick 1 friendly KAINAN'S REAPERS unit wholly within 6\" of this unit. You can return up to 3 slain models to that unit.\r\n        \r\n        Invigorated: Until your next hero phase, add 1 to the Attacks characteristic of melee weapons used by this unit and by friendly KAINAN'S REAPERS units wholly within 6\" of this unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Kainan's Reapers\": {\r\n    effects: [\r\n      {\r\n        name: `Dark Efficiency`,\r\n        desc: `If a friendly MIR KAINAN is within 3\" of this unit, before you allocate a wound or mortal wound to that HERO, or instead of making a ward roll for a wound or mortal wound that would be allocated to that HERO, roll a dice. On a 2+, that wound or mortal wound is allocated to this unit instead of MIR KAINAN and cannot be negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Tithe Reapers`,\r\n        desc: `Each model in this unit counts as 3 models for the purposes of controlling objectives.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ], \r\n  }, */\r\n  'ROR: The Summerking`s Entourage': {\r\n    effects: [\r\n      {\r\n        name: `Ushoran: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Monstrous Talons is 6.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Epicentre of Delusion`,\r\n          desc: `Effect: Pick 1 of the following effects to apply until the start of your next turn: \r\n          The Royal Hunt: Add 1 to wound rolls for attacks made by friendly Flesh-eater Courts units that target a Monster. \r\n          Crusading Army: Add 1 to run rolls and charge rolls for friendly Flesh-eater Courts units. \r\n          Defenders of the Realm: Add 1 to save rolls for friendly Flesh-eater Courts units while they are contesting an objective you control. \r\n          The Grand Tournament: Add 1 to hit rolls for attacks made by other friendly Flesh-eater Courts Heroes if they charged in the same turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Shroudcage Fragment - Once Per Turn`,\r\n          desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n          Effect: Roll a dice for each target. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Glimpse of Delusion: Casting value of 7`,\r\n          desc: `Declare: Pick a visible enemy model within 18\" of this unit to be the target, pick another enemy unit within the targets combat range to be the victim, then make a casting roll of 2D6. \r\n          Effect: Pick 1 of the targets melee weapons. Immediately resolve combat attacks made with that weapon against the victim.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Armoury of Madness - Reaction: You declared a Fight ability for this unit`,\r\n          desc: `Effect: If any damage points inflicted by attacks made as part of that Fight ability are allocated to any enemy units, those enemy units cannot use commands until the start of your next turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Royal Bodyguard - Passive`,\r\n          desc: `Effect: While any friendly Flesh-eater Courts Heroes are wholly within this units combat range, both this unit and those Heroes have Ward (5+).`,\r\n          when: [DURING_GAME],\r\n        },\r\n        {\r\n          name: `Morbheg Kinghts: Shrieking Charge`,\r\n          desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of this unit to be the target. \r\n          Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n          when: [CHARGE_PHASE],\r\n        },\r\n        {\r\n          name: `Morbheg Knights: Predator's Pounce - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Deranged Transformation: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to cast this spell, pick another visible unit in this Regiment of Renown wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn:  \r\n          Add 2\" to the targets Move characteristic.  \r\n          Add 1 to wound rolls for the targets combat attacks.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Maddening Radiance - Passive`,\r\n          desc: `Effect: Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown while they are wholly within 12\" of the Ushoran in this Regiment of Renown.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Summon Deluded Throngs - Once Per Battle`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to use this ability, then pick another unit in this Regiment of Renown that has been destroyed to be the target. \r\n          Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 6\" of a battlefield edge and more than 9\" from all enemy units. The replacement unit is part of this Regiment of Renown.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Jerrion`s Delegation': {\r\n    effects: [\r\n      {\r\n        name: `Marrowscroll Herald: The King's Entreaty - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Attack the Apostate!: Friendly Flesh-eater Courts units in combat with the target have Strike-first for the rest of the turn. \r\n        Welcome the Disciple!: The target has the Infected keyword for the rest of the battle. Each time your opponent declares a command, Spell ability or Prayer ability for an Infected unit, roll a dice. On a 5+:  \r\n        If they declared a command, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.  \r\n        If they declared a Spell or Prayer ability, that spell or prayer fails.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Marrowscroll Herald: Don't Shoot the Messenger - Passive`,\r\n        desc: `Effect: While this unit is not in combat and is wholly within the combat ranges of 3 or more other friendly Flesh-eater Courts Infantry models, it is not visible to enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Crypt Ghouls: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Horrors: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Flayers: Escort Courtier - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a friendly Flesh-eater Courts Infantry Hero that does not have Fly and is within this units combat range to be the target. \r\n        Effect: Remove the target from the battlefield. Then, this unit can move a distance up to its Move characteristic. It cannot end that move in combat. Then, set up the target within this units combat range and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Urgent Missive - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown can use Charge abilities even if they used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on units in this Regiment of Renown by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Sorrowmourn Choir': {\r\n    effects: [\r\n      {\r\n        name: `Lady Olynder: Grief-Stricken: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore positive modifiers to hit rolls, wound rolls and save rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lady Olynder: Mortarch of Grief - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Lady Olynder: No Rest For the Wicked - Once Per Battle`,\r\n        desc: `Declare: Pick any number of friendly Nighthaunt units on the battlefield to be the targets. \r\n        Effect: For each target, you can return a number of slain models to that unit with a combined Health characteristic of up to D3+3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Myrmourn Banshees: Spell-Eaters - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Nighthaunt unit wholly within 12\" of this unit was picked to be the target of that spell, this unit can use the Unbind ability as if it had Wizard (1). Add 1 to the unbinding roll for that ability. If the spell is unbound, inflict D3 mortal damage on the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Harrowing Shriek - Passive`,\r\n        desc: `Effect: If this unit charged in the same turn, subtract 1 from wound rolls for attacks made by enemy units while they are in combat with this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Murderous Bloodlust - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units combat attacks while it is in combat with any damaged enemy units or while it is in combat with any enemy units that had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ghostly Paths: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Lady Olynder in this Regiment of Renown to cast this spell, pick a visible friendly unit in this Regiment of Renown that is wholly within 12\" of them, that is not in combat and that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Insubstantial - Passive`,\r\n        desc: `Effect: Ignore modifiers to save rolls (positive and negative) for units in the Regiment of Renown.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Harvesters of Sorrow - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Neferata`s Royal Echelon': {\r\n    effects: [\r\n      {\r\n        name: `Neferata: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Nagadrons Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n        {\r\n          name: `Neferata: Twilight's Allure - Passive`,\r\n          desc: `Effect: Subtract 1 from hit rolls for combat attacks that target friendly Soulblight Gravelords units while they are wholly within 6\" of this unit.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Neferata: Mortarch of Blood`,\r\n          desc: `Declare: Pick up to 3 friendly Deathrattle Infantry or Deadwalkers Infantry units to be the targets. \r\n          Effect: Each target can use the Normal Move ability as if it were your movement phase.`,\r\n          when: [DURING_SETUP],\r\n        },\r\n        {\r\n          name: `Neferata: The Adevore - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy Hero that was allocated any damage points inflicted by this units Akmet-har this turn to be the target. \r\n          Effect: Roll a dice. On a 5+, the target is automatically destroyed.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Neferata: Dark Mist: Casting value of 7`,\r\n          desc: `Declare: Pick a visible friendly non-Monster Soulblight Gravelords unit wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n          Effect: Ignore modifiers to save rolls for the target (positive and negative) until the start of your next turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Black Knights: The Deathly Charge - Passive`,\r\n          desc: `Effect: If this unit charged this turn, its Barrow Lances have Crit (Mortal) for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Deathrattle Skeletons: Skeleton Legion`,\r\n          desc: `Effect: You can return D3 slain models to this unit.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n        {\r\n          name: `Soulpike: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Neferata in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn, each time the target uses a Charge ability, immediately after that ability has been resolved, roll a number of dice equal to the unmodified charge roll for that ability. For each 4+, inflict 1 mortal damage on the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Premeditated Demise - Once Per Turn`,\r\n          desc: `Declare: Pick an enemy unit within 12\" of the Neferata in this Regiment of Renown to be the target. \r\n          Effect: Until the start of your next turn, ward rolls cannot be made for damage points inflicted on the target by attacks made by units in this Regiment of Renown.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `The Blood Queen's Will - Once Per Battle`,\r\n          desc: `Declare: Pick an enemy unit contesting an objective that the Neferata in this Regiment of Renown is contesting to be the target. \r\n          Effect: Roll a dice. On a 2-5, subtract 10 from the control score of the target for the rest of the turn. On a 6, the target has a maximum control score of 1 for the rest of the turn.`,\r\n          when: [END_OF_TURN],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: The Sternieste Garrison': {\r\n    effects: [\r\n      {\r\n        name: `Mannfred Von Carstein: Wind of Death: Casting value of 7`,\r\n        desc: `Declare: Pick a point on the battlefield within 18\" of the caster, pick up to 3 visible enemy units within 6\" of that point to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Sword of Unholy Power - Passive`,\r\n        desc: `Effect: If this unit has slain any enemy models this turn, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Deathrattle and Deadwalkers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Mortarch of Night - Reaction: You declared the Redeploy command for a Soulblight Gravelords unit wholly within 12\" of this unit`,\r\n        desc: `Effect: The unit using the Redeploy command can move into combat when using that ability.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Ashigaroths Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mannfred Von Carstein: Ashigaroth's Hunger - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fell Bats: Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n        {\r\n          name: `Fell Bats: Fleet and Fell - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Stalking Blades: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Mannfred von Carstein in this Regiment of Renown to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Inflict 1 mortal damage on the target for each other enemy unit within 3\" of the target.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Engulfing Shadows - Passive`,\r\n          desc: `Effect: Each time a unit in this Regiment of Renown is set up, add 1 to the Attacks characteristic of that units melee weapons for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Cover of Night - Once Per Turn`,\r\n          desc: `Declare: Pick 1 friendly unit in this Regiment of Renown that is not in combat to be the target. \r\n          Effect: Remove that unit from the battlefield and set it up again more than 6\" from all enemy units.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Veremord`s Shamblers': {\r\n    effects: [\r\n      {\r\n        name: `Corpse Cart: Locus of Undeath - Passive`,\r\n        desc: `Effect: Melee weapons used by other friendly Deadwalkers units have Crit (Auto-wound) while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Deadwalker Zombies: Mindless Ferocity - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 6+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vitiating Vapours - Passive`,\r\n        desc: `Effect: Subtract 1 from ward rolls for enemy units while they are within 12\" of the Corpse Cart in this Regiment of Renown.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Legend Among Graverobbers`,\r\n        desc: `Declare: Pick the Corpse Cart in this Regiment of Renown to use this ability if it is within 3\" of the Deadwalker Zombies unit in this Regiment of Renown. Then, pick each enemy Infantry, Cavalry and Beast unit within 12\" of the Corpse Cart to be the targets. \r\n        Effect: For each target that had any models slain this turn, you can return D3 slain models to the Deadwalker Zombies unit in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'The Scales Balanced': {\r\n    effects: [\r\n      {\r\n        name: `The Scales Balanced`,\r\n        desc: `When the battle ends, you complete this grand strategy if any friendly MORTEK GUARD or KAVALOS DEATHRIDERS units from your starting army have the same number of models as they had at the start of the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'A Textbook Conquest': {\r\n    effects: [\r\n      {\r\n        name: `A Textbook Conquest`,\r\n        desc: `When the battle ends, you complete this grand strategy if you control all of the objectives on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Creation and Termination': {\r\n    effects: [\r\n      {\r\n        name: `Creation and Termination`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are more friendly MORTISANS than enemy HEROES on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Pride of Ossia': {\r\n    effects: [\r\n      {\r\n        name: `The Pride of Ossia`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed this battle was from the 'Flawless Executions' list below.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport { OSSIARCH_BONEREAPERS } from 'meta/factions'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport LegionsOfNagashUnits from '../legions_of_nagash/units'\r\nimport NighthauntUnits from '../nighthaunt/units'\r\nimport Artifacts from './artifacts'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport grand_strategies from './grand_strategies'\r\n\r\nconst subFactions = {\r\n  [OSSIARCH_BONEREAPERS]: {\r\n    effects: [],\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Unstoppable Advance'])],\r\n    }, */\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [grand_strategies],\r\n      scenery: [Scenery],\r\n      spells: [Spells],\r\n      units: [\r\n        Units,\r\n       /* keyPicker(LegionsOfNagashUnits, ['Arkhan the Black, Mortarch of Sacrament']),\r\n        keyPicker(NighthauntUnits, ['Nagash, Supreme Lord of the Undead']), */\r\n      ], \r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { OSSIARCH_BONEREAPERS } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const OssiarchBonereapersFaction = new Faction(\r\n  OSSIARCH_BONEREAPERS,\r\n  DEATH,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_OSSIARCH_BONEREAPERS,\r\n  pickEffects(battle_traits, [OSSIARCH_BONEREAPERS])\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SERAPHON: {\r\n    name: 'Battletome: Seraphon',\r\n    type: 'battletome',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Coatl Familiar': {\r\n    effects: [\r\n      {\r\n        name: `Coatl Familiar - Once Per Battle - Reaction: You declared a Spell ability for a friendly Seraphon Wizard within this units combat range`,\r\n        desc: `Effect: Add D6 to the casting roll for that spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Incandescent Rectrices': {\r\n    effects: [\r\n      {\r\n        name: `Incandescent Rectrices`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodrage Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Bloodrage Pendant - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons. Add 2 instead if the number of damage points allocated to this unit is equal to or greater than half of this units Health characteristic (rounding up).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Blade of Realities': {\r\n    effects: [\r\n      {\r\n        name: `Blade of Realities`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Improve the Rend characteristic of that weapon by 1. In addition, add 1 to the damage inflicted by each successful attack made with that weapon that targets a HERO.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Prism of Amyntok': {\r\n    effects: [\r\n      {\r\n        name: `Prism of Amyntok`,\r\n        desc: `Once per battle, at the start of a phase, pick 1 enemy unit within 12\" of the bearer and roll a dice. On a 1, nothing happens. On a 2+, that enemy unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Spacefolder's Stave\": {\r\n    effects: [\r\n      {\r\n        name: `Spacefolder's Stave`,\r\n        desc: `Once per turn, at the end of your movement phase, if the bearer is on the battlefield, you can say that they will guide the arrival of their celestial reinforcements. If you do so, the next friendly STARBORNE unit to be set up on the battlefield can be set up more than 7\" from all enemy units instead of more than 9\".`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Itxi Grubs': {\r\n    effects: [\r\n      {\r\n        name: `Itxi Grubs`,\r\n        desc: `At the start of each hero phase, you can heal 1 wound allocated to the bearer.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Itxi Grubs`,\r\n        desc: `In your hero phase, you can reroll 1 casting roll or 1 dispelling roll for the bearer, and in the enemy hero phase, you can reroll 1 unbinding roll for the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bloodrage Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Bloodrage Pendant`,\r\n        desc: `Add 1 to the Attacks characteristic of the bearer's melee weapons. If the number of wounds allocated to the bearer is equal to or greater than half of the bearer's Wounds characteristic (rounding up), add 2 instead.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cloak of Feathers': {\r\n    effects: [\r\n      {\r\n        name: `Cloak of Feathers`,\r\n        desc: `Subtract 1 from hit rolls for attacks that target the bearer.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Cloak of Feathers`,\r\n        desc: `Add 4\" to the bearer's Move characteristic, and the bearer can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sacred Stegadon Helm': {\r\n    effects: [\r\n      {\r\n        name: `Sacred Stegadon Helm`,\r\n        desc: `Add 1 to save rolls for attacks that target the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Sacred Stegadon Helm`,\r\n        desc: `Add 1 to the Damage characteristic of melee weapons used by the bearer if they made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Serpent God Dagger': {\r\n    effects: [\r\n      {\r\n        name: `Serpent God Dagger`,\r\n        desc: `Pick 1 of the bearer's melee weapons. At the end of any phase, if any wounds inflicted by that weapon in that phase were allocated to an enemy model and not negated, and that enemy model has not been slain, roll a D6. On a 5+, that enemy model is slain.`,\r\n        when: [END_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eviscerating Blade': {\r\n    effects: [\r\n      {\r\n        name: `Eviscerating Blade`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If the unmodified hit roll for an attack made with that weapon is 6, that attack inflicts 2 mortal wounds on the target in addition to any normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fusil of Conflagration': {\r\n    effects: [\r\n      {\r\n        name: `Fusil of Conflagration`,\r\n        desc: `In your shooting phase, you can pick 1 enemy unit within 12\" of the bearer and visible to them and roll a D6. On a 1, this artefact cannot be used again for the rest of the battle. On a 2-3, nothing happens. On a 4-5 that enemy unit suffers D3 mortal wounds. On a 6, that enemy unit suffers D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crystalline Skull': {\r\n    effects: [\r\n      {\r\n        name: `Crystalline Skull`,\r\n        desc: `The bearer starts with a power reserve of 0. Each time the bearer successfully casts a spell that is not unbound, increase the bearer's power reserve by 1. Once per battle, in your hero phase, you can say that the bearer will shatter the crystalline skull. If you do so, pick 1 enemy unit within 12\" of the bearer and roll a number of dice equal to the power reserve. For each 3+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Coati Familiar': {\r\n    effects: [\r\n      {\r\n        name: `Coati Familiar`,\r\n        desc: `Once per battle, at the start of your hero phase, you can say that the bearer will be blessed by Tepok. If you do so, the bearer can attempt to cast 1 additional spell in that hero phase, and that spell can be any spell from the Lore of Ancient Domains.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Sotek's Gaze\": {\r\n    effects: [\r\n      {\r\n        name: `Sotek's Gaze`,\r\n        desc: `Enemy models with a Wounds characteristic of 1 or 2 cannot contest objectives while they are within 6\" of the bearer.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SlayersBattalionEffect, SwiftBattalionEffect } from 'generic_rules/core_battalions'\r\n\r\nconst Battalions = {\r\n /* Thunderquake: {\r\n    effects: [SlayersBattalionEffect, SwiftBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n/*  'Celestial Obliteration': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Obliteration`,\r\n        desc: `Pick 1 enemy unit on the battlefield. You complete this tactic if that unit is destroyed this turn by mortal wounds caused by a spell or the abilities of an endless spell.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Overwhelming Numbers': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelming Numbers`,\r\n        desc: `Pick 1 objective controlled by the enemy. You complete this tactic at the end of this turn if you control that objective and all friendly units contesting it have the SKINK keyword.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Apex Predator': {\r\n    effects: [\r\n      {\r\n        name: `Apex Predator`,\r\n        desc: `Pick 1 enemy MONSTER. You complete this tactic at the end of this turn if that enemy unit was destroyed by an attack made by a friendly SERAPHON MONSTER.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cold-blooded Resilience': {\r\n    effects: [\r\n      {\r\n        name: `Cold-blooded Resilience`,\r\n        desc: `Pick 1 friendly SAURUS or KROXIGOR unit within 3\" of an enemy unit. You complete this tactic at the end of this turn if that unit was not destroyed, did not retreat and was not removed from the battlefield.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pack Hunters': {\r\n    effects: [\r\n      {\r\n        name: `Pack Hunters`,\r\n        desc: `Pick 1 enemy unit within 3\" of only 1 friendly AGGRADON unit. You complete this tactic if, at the end of this turn, that unit is within 3\" of 2 or more friendly AGGRADON units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stampede of Scales': {\r\n    effects: [\r\n      {\r\n        name: `Stampede of Scales`,\r\n        desc: `Pick 3 different friendly SERAPHON MONSTERS. You complete this tactic if each of those units runs in the following movement phase and finishes that run within 6\" of at least 1 of the other units you picked and wholly within enemy territory.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SERAPHON } from 'meta/factions'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [SERAPHON]: {\r\n    effects: [\r\n      {\r\n        name: `The Great Plan - Once Per Battle`,\r\n        desc: `Declare: Pick an Asterism ability. \r\n        Effect: That Asterism ability can be used for the rest of the battle, but the others cannot, unless allowed by the Further the Great Plan ability.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Further The Great Plan - Once Per Battle, Start of the Third Battle Round`,\r\n        desc: `Declare: You can use this ability if you meet the condition below that corresponds to the Asterism you picked in the deployment phase. \r\n        Itzl the Tamer: 3 or more enemy units have been destroyed. \r\n        Quetzl the Preserver: There are no enemy units wholly within friendly territory. \r\n        Sotek the Deliverer: The enemy general is in combat or has been destroyed. \r\n        Tepok the Seer: There are any friendly Slann units on the battlefield and no friendly Slann units are in combat or have been destroyed. \r\n        Effect: Pick a different Asterism ability. It can be used in addition to the one you picked in the deployment phase.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Itzl the Tamer - Passive`,\r\n        desc: `Effect: Companion weapons used by friendly Seraphon units have Crit (2 Hits).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Quetzl the Preserver - Passive`,\r\n        desc: `Effect: Subtract 1 from the Rend characteristic of melee weapons for attacks that target friendly Seraphon units that are wholly within friendly territory.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sotek the Deliverer - Passive`,\r\n        desc: `Effect: Add 2 to the Move characteristic of friendly Seraphon units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Tepok the Seer - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Seraphon units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Realmshaper Engine (Faction Terrain) - Fierce Guardians - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for combat attacks made by friendly Saurus or Kroxigor units that target an enemy unit while that enemy unit is within 9\" of this terrain feature.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Realmshaper Engine (Faction Terrain) - Power Unleashed`,\r\n        desc: `Declare: If there are any friendly Seraphon Wizards within 3\" of this terrain feature, pick another terrain feature within 24\" of this terrain feature, then pick up to 3 enemy units within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If that terrain feature has a Health characteristic, inflict D3 mortal damage on it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n \r\n /* STARBORNE: {\r\n    effects: [\r\n      {\r\n        name: `Contemplations of the Ancient Ones (Heroic Action)`,\r\n        desc: `At the start of your hero phase, you can carry out this heroic action with a friendly STARBORNE SLANN instead of any other heroic action you can carry out with that HERO. Pick 1 friendly STARBORNE SLANN. Replace 1 spell that they know from the Lore of Celestial Domination with another spell from that table.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spatial Translocation (Heroic Action)`,\r\n        desc: `At the start of your hero phase, you can carry out this heroic action with a friendly STARBORNE SLANN instead of any other heroic action you can carry out with that HERO. Pick 1 friendly STARBORNE SLANN, and then pick 1 other friendly STARBORNE unit wholly within 12\" of them. Remove that other STARBORNE unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. That unit cannot move in the following movement phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cosmic Power`,\r\n        desc: `If you have a Starborne army, the following are considered to be cosmic nodes:\r\n\r\n        Friendly STARBORNE WIZARD units\r\n        Friendly STARBORNE ASTROLITH BEARER units\r\n        Friendly Starborne Realmshaper Engine faction terrain features.\r\n        \r\n        During the battle, you will be able to receive cosmic power points (CPP) to spend on abilities and summoning units to the battlefield.\r\n        \r\n        You begin the battle with 0 cosmic power points.\r\n        \r\n        At the start of your hero phase, you receive 1 cosmic power point for each friendly STARBORNE WIZARD or friendly STARBORNE ASTROLITH BEARER on the battlefield.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cosmic Power`,\r\n        desc: `You receive 1 cosmic power point each time a friendly STARBORNE WIZARD successfully casts a spell that is not unbound, successfully unbinds a spell or successfully dispels an endless spell.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Spending Cosmic Power Points`,\r\n        desc: `In your hero phase, you can spend your cosmic power points on any of the listed abilities. You can only use the ability if you have enough cosmic power points to do so, and the same ability cannot be used more than once each phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Azure Light (Cosmic Power)`,\r\n        desc: `You must spend 5 cosmic power points to use this ability. You can return D3 slain models to each friendly STARBORNE unit with a Wounds characteristic of 1 or 2 that is wholly within 12\" of any friendly cosmic nodes. Roll separately for each unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Protection of the Old Ones (Cosmic Power)`,\r\n        desc: `You must spend 10 cosmic power points to use this ability. Until the start of your next hero phase, friendly units affected by the Revivifying Energies ability have a ward of 5+ instead of 6+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Cleanse the Realms (Cosmic Power)`,\r\n        desc: `You must spend 15 cosmic power points to use this ability. Roll a dice for each enemy unit within 12\" of any friendly cosmic nodes. On a 2+, that unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summoning Seraphon`,\r\n        desc: `At the end of your movement phase, you can spend your cosmic power points to summon 1 unit from the following list and add it to your army. Each unit you summon costs the number of cosmic power points shown on the list, and you can only summon the unit if you have enough cosmic power points to do so. Units must be set up more than 9\" from all enemy units and wholly within 12\" of a friendly cosmic node.\r\n\r\n        1 Dread Saurian\t      50 CPP\r\n        1 Engine of the Gods\t30 CPP\r\n        1 Stegadon\t          28 CPP\r\n        1 Bastiladon\t        24 CPP\r\n        3 Aggradon Lancers\t  22 CPP\r\n        10 Saurus Guard\t      22 CPP\r\n        10 Saurus Warriors\t  20 CPP\r\n        3 Kroxigor Warspawned\t18 CPP\r\n        3 Kroxigor\t          18 CPP\r\n        5 Raptadon Hunters\t  16 CPP\r\n        5 Raptadon Chargers\t  16 CPP\r\n        1 Spawn of Chotec\t    16 CPP\r\n        5 Hunters of Huanchi with Dartpipes\t12 CPP\r\n        3 Terradon Riders\t    12 CPP\r\n        3 Ripperdactyl Riders\t10 CPP\r\n        5 Hunters of Huanchi with Starstone Bolas\t10 CPP\r\n        3 Terrawings\t        8 CPP\r\n        10 Skinks\t            8 CPP`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  COALESCED: {\r\n    effects: [\r\n      {\r\n        name: `Predatory Fighters`,\r\n        desc: `Add 1 to bite rolls made for COALESCED SAURUS and COALESCED KROXIGOR units with the Mighty Saurus Jaws, Saurus Jaws or Vice-like Jaws ability.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Scaly Skin`,\r\n        desc: `Subtract 1 from the damage inflicted (to a minimum of 1) by each successful attack that targets a friendly COALESCED unit that has the SAURUS, KROXIGOR or MONSTER keyword.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n /* 'Gift from the Heavens': {\r\n    effects: [\r\n      {\r\n        name: `Gift from the Heavens`,\r\n        desc: `You can use this command ability in your hero phase. The command can only be issued by this unit, and the unit that receives the command must be a friendly SERAPHON unit. Until your next hero phase, that unit can fly. In addition, add 1 to save rolls for attacks made with missile weapons that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst CommandTraits = {\r\n  'Being of the Stars': {\r\n    effects: [\r\n      {\r\n        name: `Being of the Stars - Passive`,\r\n        desc: `Effect: Ignore modiifiers to save rolls for this unit (positive and negative).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Reptilian Cunning': {\r\n    effects: [\r\n      {\r\n        name: `Reptilian Cunning - Passive`,\r\n        desc: `Effect: If this unit charged this turn, if a friendly unit wholly within 12\" of this unit uses the All-out Attack command in the combat phase, no command points are spent.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Beastmaster': {\r\n    effects: [\r\n      {\r\n        name: `Beastmaster - Passive`,\r\n        desc: `Effect: Add 2\" to the Move characteristic of friendly Seraphon Cavalry and Seraphon Monster units for the rest of the phase if they are wholly within 12\" of this unit at the start of the move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Vast Intellect': {\r\n    effects: [\r\n      {\r\n        name: `Vast Intellect`,\r\n        desc: `This general knows 2 extra spells from the Lore of Celestial Domination.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Thickly Scaled Hide': {\r\n    effects: [\r\n      {\r\n        name: `Thickly Scaled Hide`,\r\n        desc: `Add 1 to save rolls for attacks that target this general.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Master of Star-rituals': {\r\n    effects: [\r\n      {\r\n        name: `Master of Star Rituals`,\r\n        desc: `WIZARD only. This general knows all the spells from the Lore of Celestial Manipulation in addition to any other spells they know.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Nimble Warleader': {\r\n    effects: [\r\n      {\r\n        name: `Nimble Warleader`,\r\n        desc: `Roll 2D6 instead of D6 when making run rolls for friendly SKINK units while they are wholly within 18\" of this general.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Shrewd Strategist': {\r\n    effects: [\r\n      {\r\n        name: `Shrewd Strategist`,\r\n        desc: `Once per battle, at the start of your opponent's combat phase, you can pick 1 friendly SERAPHON unit wholly within 18\" of this general. If that unit is within 12\" of any enemy units but more than 3\" from all enemy units, it can immediately attempt a charge.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Prime Warbeast': {\r\n    effects: [\r\n      {\r\n        name: `Prime Warbeast`,\r\n        desc: `Unit with mount only. Add 1 to the Attacks characteristic of the weapons used by this general's mount.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrath of Aeons': {\r\n    effects: [\r\n      {\r\n        name: `Wrath of Aeons`,\r\n        desc: `Once per battle, at the start of your combat phase, you can say that this general will rouse the wrath of the Seraphon. If you do so, until the end of that phase, add 1 to the Attacks characteristic of melee weapons used by friendly SAURUS and KROXIGOR units while they are wholly within 12\" of this unit.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Custodian of Divine Technology': {\r\n    effects: [\r\n      {\r\n        name: `Custodian of Divine Technology`,\r\n        desc: `Pick 2 artefacts of power from the Treasures of the Temple-cities table and note them on your roster. This general has both of those artefacts of power, but they cannot be given any others. These 2 artefacts of power are in addition to the first artefact of power enhancement you can take for your army.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Master of the Material Plane': {\r\n    effects: [\r\n      {\r\n        name: `Master of the Material Plane`,\r\n        desc: `This general knows 2 extra spells from the Lore of Ancient Domains.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dominating Mind': {\r\n    effects: [\r\n      {\r\n        name: `Dominating Mind`,\r\n        desc: `Once per turn, at the start of your hero phase, you can pick 1 friendly COALESCED MONSTER unit on the battlefield and say that it will have its mind dominated by this general. If you do so, roll a dice. On a 2+, add 1 to wound rolls for attacks made with melee weapons by that unit until the start of your next hero phase. If the unit picked to have its mind dominated has a mount, this command trait only affects attacks made by that unit's mount.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vengeful Defender': {\r\n    effects: [\r\n      {\r\n        name: `Vengeful Defender`,\r\n        desc: `At the start of your hero phase, if this general is wholly within your territory, you can pick this general and up to 2 other friendly SAURUS or KROXIGOR units wholly within 12\" of this general to each make a normal move.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  \"Eternal Starhost\": {\r\n    effects: [\r\n      {\r\n        name: `Celestial Translocation - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Seraphon unit wholly within 12\" of a friendly Seraphon Wizard to use this ability. \r\n        Effect: Roll a dice. On a 3+, remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Shadowstrike Starhost': {\r\n    effects: [\r\n      {\r\n        name: `NImble and Quick - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Skink Infantry or Skink Cavalry units that are not in combat to be the targets. \r\n        Effect: Each target can move D6\". Each target cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Sunclaw Starhost\": {\r\n    effects: [\r\n      {\r\n        name: `Vengeance of Azyr - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Saurus or Kroxigor units that are in combat to be the targets. \r\n        Effect: For each target:  \r\n        Make a pile-in move.  \r\n        Then, pick an enemy unit in combat with the target and roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Thunderquake Starhost': {\r\n    effects: [\r\n      {\r\n        name: `Scaley Monstrosties - Passive`,\r\n        desc: `Effect: Add 2 to the Health characteristic of friendly Seraphon Monster units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Continuous Expansion': {\r\n    effects: [\r\n      {\r\n        name: `Continuous Expansion`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is at least 1 friendly SERAPHON unit wholly within each large quarter of the battlefield (core rules, 28.2.8).`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Realmshaper Guardians': {\r\n    effects: [\r\n      {\r\n        name: `Realmshaper Guardians`,\r\n        desc: `When the battle ends, you complete this grand strategy if you have a Coalesced Realmshaper Engine or Starborne Realmshaper Engine on the battlefield, there are no enemy models within 12\" of it and it was not affected by a successful Smash To Rubble monstrous rampage.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Repel Corruption': {\r\n    effects: [\r\n      {\r\n        name: `Repel Corruption`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no enemy units wholly within your territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Further the Great Plan': {\r\n    effects: [\r\n      {\r\n        name: `Further the Great Plan`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed 4 or more battle tactics and each of those battle tactics was from the March of the Seraphon Host table below.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n/*  'Gargantuan Jaws': {\r\n    effects: [\r\n      {\r\n        name: `Gargantuan Jaws`,\r\n        desc: `Only a CARNOSAUR can carry out this monstrous rampage. Pick 1 enemy model within 3\" of this unit and roll a dice. If the roll is greater than that model's Wounds characteristic, it is slain.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Earthshaking Charge': {\r\n    effects: [\r\n      {\r\n        name: `Earthshaking Charge`,\r\n        desc: `Only a STEGADON that has made a charge move in the same phase can carry out this monstrous rampage. Pick 1 enemy unit within 1\" of this unit and roll a dice. On a 4+, the strike-last effect applies to that unit until the end of the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Odious Roar': {\r\n    effects: [\r\n      {\r\n        name: `Odious Roar`,\r\n        desc: `Only a TROGLODON can carry out this monstrous rampage. Roll a dice. On a 2+, until the end of the following combat phase, the range of this unit's Stench of Death ability is 12\" instead of 9\".`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bludgeoning Sweep': {\r\n    effects: [\r\n      {\r\n        name: `Bludgeoning Sweep`,\r\n        desc: `Only a BASTILADON can carry out this monstrous rampage. Pick 1 enemy unit within 3\" of this unit that is not a MONSTER and roll a dice. If the roll is less than the number of models in that enemy unit, that enemy unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { COMBAT_PHASE, HERO_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n /* 'Coalesced Realmshaper Engine': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup_Removable,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Fierce Guardians`,\r\n        desc: `Add 1 to bite rolls made for COALESCED SAURUS and COALESCED KROXIGOR units using the Mighty Saurus Jaws, Saurus Jaws or Vice-like Jaws ability if they are wholly within 12\" of this terrain feature. In addition, use the top row on the damage tables of friendly COALESCED MONSTERS if they are wholly within 12\" of this terrain feature, regardless of how many wounds the unit has suffered.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Starborne Realmshaper Engine': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup_Removable,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Power Unleashed`,\r\n        desc: `In your hero phase, if there are any friendly SERAPHON WIZARDS within 3\" of this terrain feature, you can pick 1 other terrain feature on the battlefield and roll a dice for each enemy unit within 3\" of that terrain feature. Add 2 to the roll if that terrain feature is within 18\" of this terrain feature, and subtract 2 from the roll if that terrain feature is more than 36\" from this terrain feature. On a 4+, that enemy unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of Celestial Manipulation': {\r\n    effects: [\r\n      {\r\n        name: `Mystical Unforgiving: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Subtract 1 from the Rend characteristic of the targets weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Comet's Call: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Speed of Haunchi: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a visible friendly Seraphon unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, the target can use a Run ability and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lore of Primal Jungles': {\r\n    effects: [\r\n      {\r\n        name: `Light of Chotec: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a visible friendly Seraphon unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of damage points the target has. For each 4+, Heal (1) the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Earth Trembles: Casting value of 8`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a point on the battlefield within 18\" of them to be the target point, then make a casting roll of 2D6. \r\n        Effect: Draw a straight line between the target point and the closest part on the casters base. Roll a D3 for each unit (friendly and enemy) that has models passed across by this line. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Empowered Celestite: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Seraphon Wizard to cast this spell, pick a visible friendly Saurus unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Add 1 to the Rend characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Stellar Tempest': {\r\n    effects: [\r\n      {\r\n        name: `Stellar Tempest`,\r\n        desc: `Casting value of 8 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. Roll a number of dice equal to the number of models in that unit. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cosmic Crush': {\r\n    effects: [\r\n      {\r\n        name: `Cosmic Crush`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Roll a number of dice equal to the number of models in that unit. For each roll that equals or exceeds that unit's Save characteristic, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Celestial Harmony': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Harmony`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 friendly SERAPHON unit wholly within range and visible to the caster. If the casting roll was 10+, pick all friendly SERAPHON units wholly within range and visible to the caster instead of 1. Until your next hero phase, the units picked have a Bravery characteristic of 10.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Speed of Huanchi': {\r\n    effects: [\r\n      {\r\n        name: `Speed of Huanchi`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly KROXIGOR or SKINK unit that is not a MONSTER and that is wholly within range and visible to the caster. That unit can make a normal move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Equilibrium': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Equilibrium`,\r\n        desc: `Casting value of 6. If successfully cast, until the end of the phase, add 1 to casting rolls for friendly WIZARDS other than the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Drain Magic': {\r\n    effects: [\r\n      {\r\n        name: `Drain Magic`,\r\n        desc: `Casting value of 6. Until the end of the phase, each time a friendly Seraphon Wizard is picked to cast a spell, instead of attempting to cast that spell, they can attempt to dispel an endless spell. If they do so, add 1 to the dispelling roll. In addition, until the end of the phase, subtract\r\n        1 from unbinding rolls made for enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Comet's Call\": {\r\n    effects: [\r\n      {\r\n        name: `Comet's Call`,\r\n        desc: `Casting value of 7. Pick up to D3 different enemy units on the battlefield. If the casting roll was 10+, pick up to D6 different enemy units instead of up to D3. Each of those units suffers D3 mortal wounds (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Tepok's Beneficence\": {\r\n    effects: [\r\n      {\r\n        name: `Tepok's Beneficence`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 friendly SKINK unit wholly within range and visible to the caster. Until the start of your next hero phase, subtract 1 from wound rolls for attacks that target that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Deliverance': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Deliverance`,\r\n        desc: `Casting value of 7 and a range of 12\". This unit can attempt to cast this spell multiple times in your hero phase. Each time this spell is successfully cast, pick up to 3 different enemy units within range and visible to the caster. Each of those units suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Blazing Starlight': {\r\n    effects: [\r\n      {\r\n        name: `Blazing Starlight`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, subtract 1 from hit rolls for attacks made by that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Earth Trembles': {\r\n    effects: [\r\n      {\r\n        name: `The Earth Trembles`,\r\n        desc: `Casting value of 8. Pick 1 of the corners of the battlefield and draw a straight line between that corner and the closest part of the caster's base. Roll a dice for each enemy unit passed across by that line. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Empowered Celestite': {\r\n    effects: [\r\n      {\r\n        name: `Empowered Celestite`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 friendly SAURUS unit wholly within range and visible to the caster. Until the start of the next hero phase, improve the Rend characteristic of that unit's Celestite weapons by 1. A Celestite weapon is any weapon that has 'Celestite' in the name.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Itzl's Invigoration\": {\r\n    effects: [\r\n      {\r\n        name: `Itzl's Invigoration`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 friendly MONSTER wholly within range and visible to the caster. Until the start of your next hero phase, use the top row of that unit's damage table, regardless of how many wounds it has suffered.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Telepathic Summons': {\r\n    effects: [\r\n      {\r\n        name: `Telepathic Summons`,\r\n        desc: `Casting value of 6 and a range of 9\". Pick 1 friendly Seraphon unit that is not a Monster and that is visible to the caster. Remove that unit from the battlefield and set it up again wholly within range of the caster and more than 9\" from all enemy units. That unit cannot move in the next movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Light of Chotec': {\r\n    effects: [\r\n      {\r\n        name: `Light of Chotec`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 friendly SERAPHON model wholly within range and visible to the caster. Roll a number of dice equal to the number of wounds allocated to it. For each 5+, heal 1 wound allocated to that model.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Heavenly Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Heavenly Frenzy`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 friendly SERAPHON unit wholly within range and visible to the caster. Until the end of the turn, that unit can run and still charge later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Primordial Mire': {\r\n    effects: [\r\n      {\r\n        name: `Primordial Mire`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 objective or terrain feature within range and visible to the caster. Until your next hero phase, units within 3\" of that objective or terrain feature cannot run or retreat and must halve the result of any charge rolls. This spell has no effect on SKINK units and units that can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Celestial Doom': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Doom`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until the end of your turn, ward rolls cannot be made for models in that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shield of the Old Ones': {\r\n    effects: [\r\n      {\r\n        name: `Shield of the Old Ones`,\r\n        desc: `Casting value of 7. If successfully cast, the caster has a ward of 4+ against mortal wounds until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/* const TerradonBaseEffects = [\r\n  {\r\n    name: `Deadly Cargo`,\r\n    desc: `Once per battle, after this unit finishes a normal move or run, you can pick 1 enemy unit and roll a dice if this unit passed across any models in that enemy unit. On a 4+, that enemy unit suffers D3 mortal wounds. In addition, if any mortal wounds caused by this ability are allocated to that enemy unit, halve the Move characteristic of that enemy unit until your next hero phase.`,\r\n    when: [MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Attack from On High`,\r\n    desc: `Subtract 1 from hit rolls for attacks made with missile weapons that target this unit.`,\r\n    when: [SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst RipperdactylBaseEffects = [\r\n  {\r\n    name: `Blot Toad`,\r\n    desc: `You receive 1 Blot Toad marker for each RIPPERDACTYL CHIEF in your army. After the players have received their starting command points but before the start of the first turn, you can pick 1 enemy unit to have a Blot Toad for each Blot Toad marker you have. Place a Blot Toad marker next to that enemy unit.\r\n\r\n  Designer's Note: Blot Toads are not units; they are markers that are used to keep track of which enemy units have Blot Toads.`,\r\n    when: [END_OF_SETUP],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Toad Rage`,\r\n    desc: `In the combat phase, add 1 to hit rolls and wound rolls for attacks made with this unit's Tearing Jaws that target an enemy unit that has a Blot Toad.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Swooping Dive`,\r\n    desc: `Subtract 1 from hit rolls from attacks made with missile weapons that target this unit. In addition, if this unit is targeted by attacks made by an enemy unit that received the Unleash Hell command in that phase, those attacks only score a hit on an unmodified hit roll of 6.`,\r\n    when: [SHOOTING_PHASE, CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst KroxigorBaseEffects = [\r\n  {\r\n    name: `Skink Guidance`,\r\n    desc: `Unit champions of SKINK units can issue commands to this unit if this unit is wholly within 12\" of the SKINK unit.`,\r\n    when: [DURING_GAME],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Vice-like Jaws`,\r\n    desc: `Each time this unit fights, after all of its attacks have been resolved, pick 1 enemy unit within 1\" of this unit and roll 3 dice for each model in this unit within 1\" of that unit. These dice rolls are referred to as bite rolls. For each bite roll of 6+, that enemy unit suffers 1 mortal wound.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst MightySaurusJawsEffect = {\r\n  name: `Mighty Saurus Jaws`,\r\n  desc: `Each time this unit fights, after all of its attacks have been resolved, pick 1 enemy unit within 1\" of this unit and roll 3 dice. These dice rolls are referred to as bite rolls. For each bite roll of 6+, that enemy unit suffers 1 mortal wound.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst SelflessProtectorsEffect = {\r\n  name: `Selfless Protectors`,\r\n  desc: `Before you allocate a wound or mortal wound to a friendly SERAPHON HERO that is not a MONSTER, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly SERAPHON HERO that is not a MONSTER, if this unit is within 3\" of that friendly SERAPHON HERO, you can roll a dice. On a 1-2, that wound or mortal wound is allocated to that SERAPHON HERO as normal. On a 3+, that wound or mortal wound is allocated to this unit instead.`,\r\n  when: [WOUND_ALLOCATION_PHASE, WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst UnstoppableStampedeEffect = {\r\n  name: `Unstoppable Stampede`,\r\n  desc: `After this unit finishes a charge move, roll a dice for each enemy unit within 1\" of this unit. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst SteadfastMajestyEffect = {\r\n  name: `Steadfast Majesty`,\r\n  desc: `Add 3 to the Bravery characteristic of friendly SKINK units that do not have the STEGADON keyword while they are wholly within 12\" of any friendly units with this ability.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst ArmouredCrestEffect = {\r\n  name: `Armoured Crest`,\r\n  desc: `At the start of the combat phase, you can pick 1 enemy unit within 3\" of this unit that has up to 5 models. If you do so, until the end of that phase, add 1 to save rolls for attacks made by that unit that target this unit.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CarnosaurBaseEffects = [\r\n  {\r\n    name: `Blood Frenzy`,\r\n    desc: `If any enemy models are slain by wounds caused by this unit's attacks, for the rest of the battle, this unit is blood-frenzied. Add 1 to wound rolls for attacks made by this unit's mount while it is blood-frenzied.`,\r\n    when: [WOUND_ALLOCATION_PHASE, COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  GenericEffects.Terror,\r\n]\r\nconst ArcaneVassalEffect = {\r\n  name: `Arcane Vassal`,\r\n  desc: `Once per phase, when this unit attempts to cast a spell, before making the casting roll, you can pick either 1 friendly Skink Wizard within 12\" of this unit or 1 friendly Oracle anywhere on the battlefield. If you do so and the spell is successfully cast and not unbound, you must measure the range and visibility for that spell from that SKINK WIZARD or ORACLE.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst SunfireThrowersEffect = {\r\n  name: `Sunfire Throwers`,\r\n  desc: `Do not use the attack sequence for an attack made with Sunfire Throwers. Instead, roll a number of dice equal to the number of models in the target unit that are within range of the attack. For each 5+, the target unit suffers 1 mortal wound.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst StegadonBaseEffects = [ArmouredCrestEffect, SteadfastMajestyEffect, UnstoppableStampedeEffect]\r\n\r\nconst IconBearersEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `Add 1 to the Bravery characteristic of this unit if it includes any Icon Bearers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst WardrummersEffect = {\r\n  name: `Musician`,\r\n  desc: `Add 1 to run rolls and charge rolls for this unit if it includes any War-drummers.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst StarbucklersEffect = {\r\n  name: `Shield`,\r\n  desc: `If this unit is armed with Star-bucklers, it has a Save characteristic of 5+ instead of 6+.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst ChameleonAmbushEffects = [\r\n  {\r\n    name: `Chameleon Ambush`,\r\n    desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is hiding as a reserve unit. If you do so, at the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n    when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Chameleon Ambush`,\r\n    desc: `If this unit is on the battlefield at the end of your movement phase, you can remove it from the battlefield and say that it is hiding as a reserve unit. If you do so, at the end of any of your subsequent movement phases, you can set up this unit on the battlefield more than 9\" from all enemy units.`,\r\n    when: [END_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst HornblowersEffect = {\r\n  name: `Musician`,\r\n  desc: `Add 1 to run rolls and charge rolls for this unit if it includes any Hornblowers.`,\r\n  when: [CHARGE_PHASE, MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst HuntersOfHuanchiBaseEffects = [\r\n  HornblowersEffect,\r\n  ...ChameleonAmbushEffects,\r\n  {\r\n    name: `Perfect Mimicry`,\r\n    desc: `This unit is not visible to enemy units that are more than 12\" away or while it is in cover.`,\r\n    when: [DURING_GAME],\r\n    shared: true,\r\n  },\r\n]\r\nconst StarVenomEffect = {\r\n  name: `Star-venom`,\r\n  desc: `If the unmodified hit roll for an attack made with a Dartpipe is 6, the target suffers 1 mortal wound and the attack sequence ends (do not make a wound roll or save roll).`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  'Lord Kroak': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Celestial Deliverance'])],\r\n    }, */\r\n    effects: [\r\n      //ArcaneVassalEffect,\r\n      {\r\n        name: `Supreme Master of Order - Passive`,\r\n        desc: `Effect: Add 2 to casting rolls for this unit. In addition, this unit can use an Unbind ability if an enemy Wizard anywhere on the battlefield uses a Spell ability instead of an enemy Wizard within 30\" of this unit, and when using the Banish Manifestation ability, this unit can pick a manifestation anywhere on the battlefield instead of within 30\" of it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dead for Innumerable Ages`,\r\n        desc: `Effect: This unit must use this ability each turn while it is damaged. Roll 3D6 and add the number of damage points this unit has to the roll. On a 20+, this unit is destroyed. Otherwise, Heal (18) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Arcane Vassal - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Skink Wizard wholly within 18\" of this unit to be the target. \r\n        Effect: Measure the range and visibility of the next Spell ability used by this unit from the target instead of from this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Celestial Deliverance: Casting value of 7 (MULTIPLE)`,\r\n        desc: `Declare: This unit can cast this spell more than once per phase. Pick up to 3 dierent visible enemy units within 12\" of this unit to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slann Starmaster': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Celestial Equilibrium', 'Shield of the Old Ones'])],\r\n      command_abilities: [keyPicker(CommandAbilities, ['Gift from the Heavens'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Masters of Order - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit. In addition, this unit can use an Unbind ability if an enemy Wizard anywhere on the battlefield uses a Spell ability instead of an enemy Wizard within 30\" of this unit, and when using the Banish Manifestation ability, this unit can pick a manifestation anywhere on the battlefield instead of within 30\" of it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // ArcaneVassalEffect,\r\n      {\r\n        name: `Celestial Equilibrium: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: For the rest of the turn, add 1 to casting rolls made for other friendly Seraphon Wizards while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Vassal - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Skink Wizard wholly within 18\" of this unit to be the target. \r\n        Effect: Measure the range and visibility of the next Spell ability used by this unit from the target instead of from this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Celestial Reinforcements - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Seraphon unit that started the battle with 3 or more models and that has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 4+, set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Saurus Oldblood on Carnosaur': {\r\n    effects: [\r\n    //  ...CarnosaurBaseEffects,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Carnosaurs Massive Jaws is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Spearhead of the Charge - Passive`,\r\n        desc: `Effect: If this unit charged this turn, add 1 to charge rolls for friendly Saurus units while they are wholly within 18\" of this unit for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Terror - Passive`,\r\n        desc: `Effect: Subtract 2 from the control scores of enemy units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Blood Frenzy - Once Per Turn`,\r\n        desc: `Effect: If this unit is in combat with any damaged enemy Monsters, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Saurus Oldblood': {\r\n    effects: [\r\n      {\r\n        name: `Predatory Exemplar - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Saurus Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wrath of the Seraphon - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, add 1 to wound rolls for combat attacks made by friendly Saurus Infantry units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // MightySaurusJawsEffect,\r\n    ],\r\n  },\r\n  'Saurus Scar-Veteran on Aggradon': {\r\n    effects: [\r\n      {\r\n        name: `Primal Rage`,\r\n        desc: `Effect: This unit must use this ability each turn. \r\n        If this unit used any Fight abilities this turn, place a rage token next to it, to a maximum of 3. If this unit did not use any Fight abilities this turn, remove all rage tokens it has. \r\n        Add 1 to the Attacks characteristic of this units Companion weapons for each rage token it has until the end of the next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Alpha Roar - Once Per Battle`,\r\n        desc: `Effect: Place a rage token next to this unit and each friendly Aggradon Lancers unit wholly within 12\" of this unit, to a maximum of 3 per unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // 'Saurus Eternity Warden': {\r\n  //   mandatory: {\r\n  //     command_abilities: [keyPicker(CommandAbilities, ['Prime Guardian'])],\r\n  //   },\r\n  //   effects: [ColdFerocityEffect, SelflessProtectorsEffect],\r\n  // },\r\n  // 'Saurus Sunblood': {\r\n  //   mandatory: {\r\n  //     command_abilities: [keyPicker(CommandAbilities, ['Scent of Weakness'])],\r\n  //   },\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Primal Rage`,\r\n  //       desc: `If the unmodified hit roll for an attack made by this model is 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit. In addition, if the unmodified wound roll for an attack made by this model is 6, that attack inflicts 1 mortal wound on the target in addition to any normal damage.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  'Saurus Scar-Veteran on Carnosaur': {\r\n    effects: [\r\n     // ...CarnosaurBaseEffects,\r\n     {\r\n      name: `Terror - Passive`,\r\n      desc: `Effect: Subtract 2 from the control scores of enemy units while they are in combat with this unit.`,\r\n      when: [END_OF_TURN],\r\n    },\r\n      {\r\n        name: `Maim and Tear - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the number of damage points the target has. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Carnosaurs Massive Jaws is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Saurus Astrolith Bearer': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Conduit - Reaction: You declared a Spell ability for a friendly Seraphon Wizard wholly within 12\" of this unit`,\r\n        desc: `Effect: If that spell is successfully cast, add 3 to the control scores of friendly Seraphon units wholly within 12\" of this unit for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Revivifying Energies - Passive`,\r\n        desc: `Effect: Friendly Seraphon Infantry units have Ward (6+) while they are wholly within 12\" of this unit. If a unit already has Ward (6+), it has Ward (5+) instead.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // MightySaurusJawsEffect,\r\n    ],\r\n  },\r\n  // 'Skink Priest': {\r\n  //   mandatory: {\r\n  //     command_abilities: [keyPicker(CommandAbilities, ['Herald of the Old Ones'])],\r\n  //   },\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Star-stone Staff`,\r\n  //       desc: `In your hero phase, you can pick 1 friendly SKINK unit wholly within 12\" of this model and roll a D6. On a 3+, until your next hero phase, that unit can run and still shoot and/or charge in the same turn, and you can add 1 to save rolls for attacks that target that unit. A unit cannot benefit from this ability more than once per phase.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Star-stone Staff`,\r\n  //       desc: `If active, until your next hero phase, that unit can run and still shoot and/or charge in the same turn.`,\r\n  //       when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Star-stone Staff`,\r\n  //       desc: `If active, until your next hero phase, you can add 1 to save rolls for attacks that target that unit.`,\r\n  //       when: [SAVES_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  'Skink Starseer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Celestial Doom'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Scry the Stars - Once Per Battle`,\r\n        desc: `Effect: Roll a number of dice equal to the current battle round number. For each 3+, pick a friendly Seraphon unit wholly within 18\" of this unit. That unit has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Celestial Doom: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" to be the target, then make a casting roll of 2D6. \r\n        Effect: Ward rolls cannot be made for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skink Starpriest': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Blazing Starlight'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Serpent Staff`,\r\n        desc: `Declare: Pick a visible friendly Seraphon unit wholly within 18\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, the targets melee weapons have Crit (Auto-wound) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Engine of the Gods': {\r\n    effects: [\r\n    //  ...StegadonBaseEffects,\r\n      {\r\n        name: `Cosmic Engine`,\r\n        desc: `Declare: Pick if this unit will harness or reserve the power of its cosmic engine. \r\n        Effect: If it will reserve the power, place a cosmic power token next to this unit. \r\n        If it will harness the power, roll a dice and add the number of cosmic power tokens this unit has to the roll. Then, remove all cosmic power tokens this unit has and pick 1 of the following effects (if possible). \r\n        Healing Light: On a 3+, you can Heal (D3) all friendly Seraphon units wholly within 12\" of this unit. \r\n        Starlight Summons: On a 5+, you can pick up to 3 friendly Seraphon units wholly within 12\" of this unit. Return 1 slain model to each unit. \r\n        Time Slows: On a 6+, you can pick up to 3 friendly Seraphon units wholly within 12\" of this unit. Those units have Strike-first for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stegadon's Horns and Jaws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crest of Horns - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+: Inflict an amount of mortal damage on the target equal to the roll.  Add 1 to save rolls for attacks made by that enemy unit that target this unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Saurus Warriors': {\r\n    effects: [\r\n      {\r\n        name: `Ordered Cohort - Passive`,\r\n        desc: `Effect: Add 1 to save rolls for this unit while each model in this unit is contesting an objective you control.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    //  IconBearersEffect,\r\n     // WardrummersEffect,\r\n    ],\r\n  },\r\n  'Saurus Guard': {\r\n    effects: [\r\n      {\r\n        name: `Selfless Protectors - Passive`,\r\n        desc: `Effect: While any friendly Slann units are within this units combat range, both this unit and those Slann units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // IconBearersEffect,\r\n     // WardrummersEffect,\r\n     // SelflessProtectorsEffect,\r\n    ],\r\n  },\r\n  // 'Saurus Knights': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Saurus Knight Alpha`,\r\n  //       desc: `1 model in this unit can be a Saurus Knight Alpha. Add 1 to the Attacks characteristic of that model's Celestite Blade or Celestite Warspear.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //     CelestiteWarspearEffect,\r\n  //     IconBearersEffect,\r\n  //     WardrummersEffect,\r\n  //   ],\r\n  // },\r\n  Skinks: {\r\n    effects: [\r\n      {\r\n        name: `Swift and Nimble - Passive`,\r\n        desc: `Effect: When this unit uses the Redeploy command, when determining the distance this unit can move, you can roll 2 dice instead of 1 and pick either result.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     // StarbucklersEffect,\r\n    ],\r\n  },\r\n  // 'Chameleon Skinks': {\r\n  //   effects: [\r\n  //     ...ChameleonAmbushEffects,\r\n  //     {\r\n  //       name: `Perfect Mimicry`,\r\n  //       desc: `Models in this unit that are within 1\" of a terrain feature have a ward of 4+`,\r\n  //       when: [WARDS_PHASE],\r\n  //     },\r\n  //     StarVenomEffect,\r\n  //   ],\r\n  // },\r\n  'Terradon Chief': {\r\n    effects: [\r\n     // ...TerradonBaseEffects,\r\n      {\r\n        name: `Chief's Deadly Cargo`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice and add 2 to the roll if this unit is within the combat ranges of any friendly Terradon Riders units. On a 5+:  \r\n        Inflict D3 mortal damage on the target.  \r\n        If any damage points are allocated by this ability and the target does not have Fly, the target cannot use Run abilities until the start of your next turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Attack From on High - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terradon Riders': {\r\n    effects: [\r\n      {\r\n        name: `Attack From on High - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Deadly Cargo`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice and add 2 to the roll if this unit is within the combat ranges of any friendly Terradon Chief units. On a 5+:  \r\n        Inflict 1 mortal damage on the target.  \r\n        If any damage points are allocated by this ability and the target does not have Fly, the target cannot use Run abilities until the start of your next turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    //  ...TerradonBaseEffects,\r\n    ],\r\n  },\r\n  'Ripperdactyl Chief': {\r\n    effects: [\r\n    //  ...RipperdactylBaseEffects,\r\n      {\r\n        name: `Ripperdactyl Assault - Once Per Battle`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of Moonstone Warspears used by friendly Ripperdactyl Riders units wholly within 12\" of this unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blot Toad - Once Per Battle`,\r\n        desc: `Declare: You receive 1 Blot Toad token for each Ripperdactyl Chief or Ripperdactyl Riders unit in your army, to a maximum of 3 tokens. Pick a number of enemy units equal to the number of Blot Toads you have to be the targets. \r\n        Effect: Place a Blot Toad next to each target.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Toad Rage - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Ripperdactyls Tearing Jaws while it is in combat with any units that have a Blot Toad.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ripperdactyl Riders': {\r\n    effects: [\r\n      {\r\n        name: `Blot Toad - Once Per Battle`,\r\n        desc: `Declare: You receive 1 Blot Toad token for each Ripperdactyl Chief or Ripperdactyl Riders unit in your army, to a maximum of 3 tokens. Pick a number of enemy units equal to the number of Blot Toads you have to be the targets. \r\n        Effect: Place a Blot Toad next to each target.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Toad Rage - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Ripperdactyls Tearing Jaws while it is in combat with any units that have a Blot Toad.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ...RipperdactylBaseEffects,\r\n    ],\r\n  },\r\n  // 'Salamander Hunting Pack': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `It Burns!`,\r\n  //       desc: `If the unmodified hit roll for an attack made with a Stream of Fire or Burning Jaws is 6, that attack inflicts mortal wounds on the target unit and the attack sequence ends (do not make a wound or save roll).`,\r\n  //       when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // 'Razordon Hunting Pack': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Instinctive Defence`,\r\n  //       desc: `If there are any enemy units within 3\" of this unit at the end of the charge phase, and no enemy units were within 3\" of this unit at the start of that phase, each Razordon in this unit can make a shooting attack with its Volley of Spikes but the Attacks characteristic for that attack is D6 instead of 2D6.`,\r\n  //       when: [END_OF_CHARGE_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Piercing Barbs`,\r\n  //       desc: `Improve the Rend characteristic by 1 for an attack made with a Volley of Spikes if the distance to the target is 6\" or less.`,\r\n  //       when: [SHOOTING_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  Kroxigor: {\r\n    effects: [\r\n     // ...KroxigorBaseEffects,\r\n      {\r\n        name: `Brutal Blows`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons for attacks that target an enemy unit that has 10 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kroxigor Warspawned': {\r\n    effects: [\r\n     // ...KroxigorBaseEffects,\r\n      {\r\n        name: `Heavy-scaled Skin - Passive`,\r\n        desc: `Effect: Subtract 1 from the Rend characteristic of ranged weapons used for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Spawn of Sotek - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons while this unit is wholly within 12\" of any friendly Skink Infantry or Skink Cavalry units in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stegadon Chief': {\r\n    effects: [\r\n      //...StegadonBaseEffects,\r\n     // SunfireThrowersEffect,\r\n      {\r\n        name: `Crushing Stomps - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. Add 2 to the amount of mortal damage inflicted, if any, if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stegadons Horns and Jaws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      }, \r\n      {\r\n        name: `Skink Coordination - Passive`,\r\n        desc: `Effect: If a friendly non-Monster Skink unit uses the Redeploy command while it is wholly within 18\" of this unit, no command points are spent.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Stegadon: {\r\n    effects: [\r\n     // ...StegadonBaseEffects,\r\n    //  SunfireThrowersEffect,\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stegadons Horns and Jaws is 4.`,\r\n      when: [COMBAT_PHASE],\r\n    }, \r\n    {\r\n      name: `Unstoppable Stampede - Once Per Turn`,\r\n      desc: `Declare: If this unit charged this phase, pick an enemy Infantry unit in combat with it to be the target. \r\n      Effect: Inflict D3 mortal damage on the target. Then, this unit can move 2D6\". This unit can pass through models in the target unit but must end that move in combat.`,\r\n      when: [CHARGE_PHASE],\r\n    }, \r\n    ],\r\n  },\r\n  'Bastiladon Ark of Sotek': {\r\n    effects: [\r\n      //...StegadonBaseEffects,\r\n     // SunfireThrowersEffect,\r\n      {\r\n        name: `Ark of Sotek - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 dierent enemy units within 9\" of this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bastiladon Solar Engine': {\r\n    effects: [\r\n      //...StegadonBaseEffects,\r\n     // SunfireThrowersEffect,\r\n      {\r\n        name: `Tail Swipe - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit, to a maximum of 8. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Bastiladon: {\r\n    effects: [\r\n      {\r\n        name: `Tide of Snakes`,\r\n        desc: `If the unmodified hit roll for an attack made with an Ark of Sotek is 6, the target suffers 1 mortal wound and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Skink Oracle on Troglodon': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Primordial Mire'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Troglodons Jaws is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Noxious Roar - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Terror - Passive`,\r\n        desc: `Effect: Subtract 2 from the control scores of enemy units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Troglodon Regeneration`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    //  GenericEffects.Terror,\r\n    ],\r\n  },\r\n /* 'Dread Saurian': {\r\n    effects: [\r\n      {\r\n        name: `Arcane Glyphs`,\r\n        desc: `Each time this model is affected by a spell or the ability of an endless spell, you can roll a dice. If you do so, on a 6+, ignore the effects of that spell or the ability of that endless spell on this model. Add 2 to the roll if this model is within 12\" of a friendly SLANN.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Obliterating Charge`,\r\n        desc: `After this model makes a charge move, roll a dice for each enemy unit within 1\" of this model. On a 2+, that unit suffers D3 mortal wounds if it is a MONSTER or D6 mortal wounds if it is not a MONSTER.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Death Throes`,\r\n        desc: `If this model is slain, before removing it from play, roll a dice for each enemy unit within 3\" of it that is not a MONSTER. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      }, \r\n    //  GenericEffects.Terror,\r\n    ],\r\n  }, */\r\n  // 'Celestial Swarm': {\r\n  //   effects: [\r\n  //     {\r\n  //       name: `Swarming Tide`,\r\n  //       desc: `You may heal D3 wounds allocated to this unit.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     DeadlyVenomEffect,\r\n  //   ],\r\n  // },\r\n  // 'Chameleon Skink Stalker': {\r\n  //   effects: [\r\n  //     ...ChameleonAmbushEffects,\r\n  //     {\r\n  //       name: `Disappear from Sight`,\r\n  //       desc: `Remove the model from the battlefield and follow the Chameleon Ambush rules for this or future turns.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Flawless Mimicry`,\r\n  //       desc: `If this model is within or on terrain, its Save characteristic is 3+ instead of 6+. This counts as the cover bonus.`,\r\n  //       when: [SAVES_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Master Hunter`,\r\n  //       desc: `Add 2 to wound rolls for the Stalker Blowpipes if this model did not move and was not set up this turn.`,\r\n  //       when: [SHOOTING_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // 'Skink Prophet': {\r\n  //   effects: [\r\n  //     DeadlyVenomEffect,\r\n  //     {\r\n  //       name: `Priestly Rites`,\r\n  //       desc: `Roll a D6. On a 4+, you can reroll run, charge, and save rolls for this model until your next hero phase.`,\r\n  //       when: [HERO_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Priestly Rites`,\r\n  //       desc: `If active you can reroll run rolls.`,\r\n  //       when: [MOVEMENT_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Priestly Rites`,\r\n  //       desc: `If active you can reroll charge rolls.`,\r\n  //       when: [CHARGE_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Priestly Rites`,\r\n  //       desc: `If active you can reroll save rolls.`,\r\n  //       when: [SAVES_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  'Hunters of Huanchi with Dartpipes': {\r\n    effects: [\r\n     // ...HuntersOfHuanchiBaseEffects,\r\n      {\r\n        name: `Hidden Hunters`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve in ambush. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Star-Vendom`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by attacks made with this units Dartpipe to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from wound rolls for the targets combat attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Chameleon Ambush`,\r\n        desc: `Declare: Pick this unit if it is in ambush. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     // StarVenomEffect,\r\n    ],\r\n  },\r\n  'Hunters of Huanchi with Starstone Bolas': {\r\n    effects: [\r\n     // ...HuntersOfHuanchiBaseEffects,\r\n     {\r\n      name: `Hidden Hunters`,\r\n      desc: `Declare: Pick this unit if it has not been deployed. \r\n      Effect: Set up this unit in reserve in ambush. It has now been deployed.`,\r\n      when: [DURING_SETUP],\r\n    }, \r\n    {\r\n      name: `Chameleon Ambush`,\r\n      desc: `Declare: Pick this unit if it is in ambush. \r\n      Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n      {\r\n        name: `Starstone Bolas`,\r\n        desc: `Declare: Pick an enemy unit that was targeted by this units Starstone Bolas this turn to be the target. \r\n        Effect: Roll a dice. On a 3+, until the start of your next turn, subtract 1 from the number of dice rolled when making charge rolls for the target, to a minimum of 1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Terrawings: {\r\n    effects: [\r\n      {\r\n        name: `Nerve-shredding Screeches`,\r\n        desc: `Declare: Pick an enemy unit within 10\" of this unit to be the target. \r\n        Effect: Roll a D3. If the roll exceeds the targets Control characteristic, the target cannot use commands for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Beast`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Starblood Stalkers': {\r\n    effects: [\r\n      {\r\n        name: `Sacred Duty`,\r\n        desc: `Before you allocate a wound or mortal wound to a friendly KIXI-TAKA, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly KIXI-TAKA, if this unit is within 3\" of that friendly KIXI-TAKA, you can roll a dice. On a 1-2, that wound or mortal wound is allocated to that KIXI-TAKA as normal. On a 3+, that wound or mortal wound is allocated to this unit instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE, WARDS_PHASE],\r\n      }, \r\n   //   StarVenomEffect,\r\n    ],\r\n  }, */\r\n /* 'Kixi-Taka, the Diviner': {\r\n    effects: [\r\n      {\r\n        name: `Servant of the Starmasters`,\r\n        desc: `Once per battle, in your hero phase, you can pick 1 enemy unit within 6\" of this unit and roll a dice. On a 2+, models in that unit cannot contest objectives until the start of the next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Aggradon Lancers': {\r\n    effects: [\r\n    //  IconBearersEffect,\r\n     // WardrummersEffect,\r\n      {\r\n        name: `Primal Rage`,\r\n        desc: `Effect: This unit must use this ability each turn. \r\n        If this unit used any Fight abilities this turn, place a rage token next to it, to a maximum of 3. If this unit did not use any Fight abilities this turn, remove all rage tokens it has. \r\n        Add 1 to the Attacks characteristic of this units Companion weapons for each rage token it has until the end of the next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n/*  'Klaq-Trok': {\r\n    effects: [\r\n      {\r\n        name: `Savage Protector`,\r\n        desc: `You can reroll hit rolls and wound rolls for attacks made by this unit while it is within 3\" of a friendly KIXI-TAKA.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bolstering Presence`,\r\n        desc: `Add 3 to the Bravery characteristic of friendly THE STARBLOOD STALKERS units while they are wholly within 9\" of this unit.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    //  MightySaurusJawsEffect,\r\n    ],\r\n  }, */\r\n  'Raptadon Chargers': {\r\n    effects: [\r\n      {\r\n        name: `Cold-Blooded Unity - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this units combat attacks if they target an enemy unit that was targeted by shooting attacks made by a friendly Raptadon Hunters unit in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // IconBearersEffect,\r\n    //  HornblowersEffect,\r\n    ],\r\n  },\r\n  'Raptadon Hunters': {\r\n    effects: [\r\n\r\n     // IconBearersEffect,\r\n     // HornblowersEffect,\r\n     {\r\n      name: `Deadly Cohesion`,\r\n      desc: `Declare: If this unit is not in combat, pick a friendly Raptadon Chargers unit that charged this turn and is within 12\" of this unit to be the target. \r\n      Effect: This unit can use a Shoot ability as if it were your shooting phase. It must target a visible enemy unit in combat with the target.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Spawn of Chotec': {\r\n    effects: [\r\n      {\r\n        name: `Sun Acolytes - Passive`,\r\n        desc: `Effect: This unit has a crew of 3 Sun Acolytes that are tokens. \r\n        Add 1 to this units control score for each Sun Acolyte it has. If this unit has no Sun Acolytes, it has a maximum control score of 1 for the rest of the battle. \r\n        Each time you make an unmodified save roll of 1 for this unit, remove 1 of its Sun Acolytes from the battlefield after the Attack ability has been resolved (the damage point is still inflicted).`,\r\n        when: [DURING_GAME, END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Acid-Fuelled Flame - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, you must pick either its Glob of Flame Acid or its Stream of Fire ranged weapon. \r\n        In addition, after resolving shooting attacks made with this units Glob of Flame Acid, if any damage points were allocated to an enemy unit by those attacks, subtract 1 from save rolls for that enemy unit for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Fjori`s Flamebearers': {\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker, pickEffects } from '../metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { SERAPHON } from 'meta/factions'\r\n\r\nconst baseSubFaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [SERAPHON]: {\r\n    //  ...baseSubfaction,\r\n      effects: pickEffects(BattleTraits, [SERAPHON]),\r\n  \r\n      available: {\r\n        artifacts: [Artifacts],\r\n        battalions: [Battalions],\r\n        battle_tactics: [BattleTactics],\r\n        command_abilities: [CommandAbilities],\r\n        command_traits: [CommandTraits],\r\n        //endless_spells: [EndlessSpells],\r\n        flavors: [Flavors],\r\n        grand_strategies: [GrandStrategies],\r\n        //prayers: [Prayers],\r\n        spells: [Spells],\r\n        units: [Units],\r\n      },\r\n    }, \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n /* Coalesced: {\r\n    effects: pickEffects(BattleTraits, ['COALESCED']),\r\n\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      flavors: [keyPicker(Flavors, [\"Koatl's Claw\", 'Thunder Lizard'])],\r\n    },\r\n  },\r\n\r\n  Starborne: {\r\n    effects: pickEffects(BattleTraits, ['STARBORNE']),\r\n\r\n    available: {\r\n      ...baseSubFaction.available,\r\n      flavors: [keyPicker(Flavors, [\"Dracothion's Tail\", 'Fangs of Sotek'])],\r\n    },\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { SERAPHON } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SeraphonFaction = new Faction(\r\n  SERAPHON,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_SERAPHON\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SKAVEN: {\r\n    name: 'Battletome: Skaven',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/MqngzVQxuC9OhX5q.pdf',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/07/I6erkna5aSTFhKRg.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Foulhide': {\r\n    effects: [\r\n      {\r\n        name: `Foulhide`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  /*Skavenbrew: {\r\n    effects: [\r\n      {\r\n        name: `Skavenbrew`,\r\n        desc: `MASTERCLAN HERO only. Once per turn, in your hero phase, you can pick 1 other friendly SKAVEN unit within 3\" of the bearer. That unit suffers D3 mortal wounds. but you can add 1 to the Attacks characteristic of melee weapons used by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Warpstone Charm': {\r\n    effects: [\r\n      {\r\n        name: `Warpstone Charm`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from save rolls for the target for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skavenbrew': {\r\n    effects: [\r\n      {\r\n        name: `Skavenbrew - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero Skaven Infantry unit wholly within 13\" of this unit to be the target. \r\n        Effect: Inflict D3 mortal damage on the target. Then, add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Esoteric Warp Resonator': {\r\n    effects: [\r\n      {\r\n        name: `Esoteric Warp Resonator`,\r\n        desc: `CLANS SKRYRE HERO only. At the start of each battle round, you receive 1 extra warpstone spark if the bearer is on the battlefield. That warpstone spark can only be used to carry out a warpstone spark ability with the bearer in that battle round. If it is not used before the end of the battle round in which it was received, it is lost.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Vial of the Fulminator': {\r\n    effects: [\r\n      {\r\n        name: `Vial of the Fulminator`,\r\n        desc: `CLANS SKRYRE HERO only. At the start of your movement phase, you can pick 1 friendly CLANS SKRYRE WAR MACHINE within 6\" of the bearer. Double that unit's Move characteristic until the end of that phase. At the end of that phase, roll a dice. On a 1, that unit suffers D3 mortal wounds.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blade of Corruption': {\r\n    effects: [\r\n      {\r\n        name: `Blade of Corruption`,\r\n        desc: `CLANS PESTILENS HERO only. Pick 1 of the bearer's melee weapons. If the unmodified wound roll for an attack made with that weapon is 6, that weapon has a Rend characteristic of -3 and a Damage characteristic of 6 for that attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Fumigatous': {\r\n    effects: [\r\n      {\r\n        name: `The Fumigatous`,\r\n        desc: `CLANS PESTILENS HERO only. At the start of the combat phase, you can pick 1 enemy unit within of the bearer and roll a dice. On a 1-2. nothing happens. On a 3-4 that unit suffers D3 mortal wounds. On a 5-6. that unit suffers D6 mortal wounds.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blistrevous, the Living Cyst': {\r\n    effects: [\r\n      {\r\n        name: `Blistrevous, the Living Cyst`,\r\n        desc: `CLANS PESTILENS HERO only. The strike-first effect applies to the bearer if it made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Blistrevous, the Living Cyst`,\r\n        desc: `CLANS PESTILENS HERO only. Starting from the second battle round, at the start of your hero phase, you must transfer this artefact to another friendly CLANS PESTILENS HERO on the battlefield if it is possible to do so, even if that HERO already has an artefact of power.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shield of Distraction': {\r\n    effects: [\r\n      {\r\n        name: `Shield of Distraction`,\r\n        desc: `CLANS VERMINUS HERO only. The bearer cannot be picked as the target of a combat attack by more than 1 unit per phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Rustcursed Armour': {\r\n    effects: [\r\n      {\r\n        name: `Rustcursed Armour`,\r\n        desc: `CLANS VERMINUS HERO only. Add 1 to save rolls for attacks that target the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Rustcursed Armour`,\r\n        desc: `CLANS VERMINUS HERO only. At the start of your combat phase, you can pick 1 enemy HERO that has an artefact of power within 3\" of the bearer and roll 2D6. If the roll is greater than that HERO's Bravery characteristic, that HERO no longer bears that artefact of power (if a weapon was picked when the artefact of power was given to that HERO, that weapon reverts to normal).`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warpstone Charm': {\r\n    effects: [\r\n      {\r\n        name: `Warpstone Charm`,\r\n        desc: `CLANS VERMINUS HERO only. Subtract 1 from save rolls for enemy units within 3\" of the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Warpstone Charm`,\r\n        desc: `CLANS VERMINUS HERO only. At the start of your hero phase, roll a dice. On a 1, the bearer suffers D3 mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lash of Fangs': {\r\n    effects: [\r\n      {\r\n        name: `Lash of Fangs`,\r\n        desc: `CLANS MOULDER HERO only. Pick 1 of the bearer's melee weapons. If the unmodified hit roll for an made with that weapon is 6, that attack causes D3 mortal wounds to the target in addition to any damage it inflicts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Foulhide: {\r\n    effects: [\r\n      {\r\n        name: `Foulhide`,\r\n        desc: `CLANS MOULDER HERO only. The bearer has a Wounds characteristic of 10.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Foulhide`,\r\n        desc: `CLANS MOULDER HERO only. At the start of your hero phase, you can heal 1 wound allocated to the bearer.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rabid Crown': {\r\n    effects: [\r\n      {\r\n        name: `Rabid Crown`,\r\n        desc: `CLANS MOULDER HERO only. Add 1 to hit rolls for attacks made by friendly CLANS MOULDER FIGHTING BEAST and CLANS MOULDER PACK units wholly within 13\" of the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fleshgift Vial (Moulder)': {\r\n    effects: [\r\n      {\r\n        name: `Fleshgift Vial (Moulder)`,\r\n        desc: `Once per battle, in your shooting phase, you can pick 1 enemy unit within 6\" of the bearer and roll a D6. On a 1, the bearer suffers 1 mortal wound. On a 2-5, that enemy unit suffers D3 mortal wounds. On a 6 that enemy unit suffers D6 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shadow Magnet Trinket': {\r\n    effects: [\r\n      {\r\n        name: `Shadow Magnet Trinket`,\r\n        desc: `CLANS ESHIN HERO only. Once per battle, at the start of the combat phase, you can say that the bearer will use this artefact. If you do so, the strike-first effect applies to the bearer until your next hero phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Farskitter Cloak': {\r\n    effects: [\r\n      {\r\n        name: `Farskitter Cloak`,\r\n        desc: `CLANS ESHIN HERO only. Once per battle, at the end of your movement phase, you can remove the bearer from the battlefield and set them up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gnawbomb: {\r\n    effects: [\r\n      {\r\n        name: `Gnawbomb`,\r\n        desc: `CLANS ESHIN HERO only. Once per battle, in hero phase, you can pick 1 terrain feature within 6\" of the bearer. Until your next hero phase, that terrain feature has the scenery rules from the Gnawhole warscroll (pg 118) in addition to any other scenery rules that it may have.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SKAVEN } from 'meta/factions'\r\nimport { COMBAT_PHASE, DURING_GAME, DURING_SETUP, END_OF_TURN, HERO_PHASE, MOVEMENT_PHASE, START_OF_ROUND } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [SKAVEN]: {\r\n    effects: [\r\n      {\r\n        name: `The Lurking Vermintide`,\r\n        desc: `Declare: Pick a friendly Skaven unit that has not been deployed. \r\n        Effect: Set up that unit in reserve in the tunnels below. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Splinters of the Vermindoom - Once Per Battle Round`,\r\n        desc: `Declare: You can use this ability if there are fewer than 3 friendly Gnawholes on the battlefield. \r\n        Effect: Set up a Gnawhole on the battlefield more than 9\" from all enemy units, more than 1\" from all friendly units and more than 3\" from all objectives and other terrain features.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Too Quick to Hit-Hit - Passive`,\r\n        desc: `Effect: No mortal damage is inflicted on friendly Skaven Infantry and Cavalry units by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gnawhole Ambush`,\r\n        desc: `Declare: Pick a friendly Skaven unit that is in the tunnels below to use this ability. \r\n        Effect: Set up that unit wholly within 6\" of a friendly Gnawhole and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Always Three Clawsteps Ahead - Once Per Turn - Enemy Hero Phase`,\r\n        desc: `Declare: Pick a friendly non-Monster Skaven unit that is not in combat and was not set up this turn to use this ability. \r\n        Effect: That unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Gnawhole (Faction Terrain) - Volatile Ground - Passive`,\r\n        desc: `Effect: Models can pass through this terrain feature but cannot be set up on or end moves on any part of this terrain feature. Each time an enemy unit ends a move that passed through or across this terrain feature, roll a D3. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Command Ability - Gnawhole (Faction Terrain) - The Endless Vermintide`,\r\n        desc: `Declare: Pick a friendly non-Hero Skaven Infantry unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 6\" of a friendly Gnawhole and more than 3\" from all enemy units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Gnawhole (Faction Terrain) - Tunnels Through Reality`,\r\n        desc: `Declare: Pick a friendly Skaven unit that is not in combat and is wholly within 6\" of this terrain feature to be the target. \r\n        Effect: Remove the target from the battlefield and set it up again wholly within 6\" of another friendly Gnawhole and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst BattleTactics = {\r\n /* 'Restore the Beast': {\r\n    effects: [\r\n      {\r\n        name: `Restore the Beast`,\r\n        desc: `Pick 1 friendly RAT OGOR unit on the battlefield that has 3 or more wounds allocated to it. You complete this tactic if that RAT OGOR unit has 0 wounds allocated to it at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Deathmark: {\r\n    effects: [\r\n      {\r\n        name: `Deathmark`,\r\n        desc: `Pick 1 enemy HERO on the battlefield that has a Wounds characteristic of 10 or more and that has 0 wounds allocated to it. You complete this tactic if that HERO is slain in this turn by attacks made by friendly CLANS ESHIN units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fire-fire! More-more!': {\r\n    effects: [\r\n      {\r\n        name: `Fire-fire! More-more!`,\r\n        desc: `Pick 1 enemy MONSTER on the battlefield. You complete this tactic if that unit is destroyed in this turn by attacks made with missile weapons by friendly CLANS SKRVRE units.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crescendo of the Diseased Choir': {\r\n    effects: [\r\n      {\r\n        name: `Crescendo of the Diseased Choir`,\r\n        desc: `You complete this tactic if 3 or more prayers chanted by different friendly CLANS PESTILENS PRIESTS are answered in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Flee-flee!': {\r\n    effects: [\r\n      {\r\n        name: `Flee-flee!`,\r\n        desc: `You complete this battle tactic at the end of the turn if 2 or more friendly Skaven units retreated this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  /*'Gnash-gnaw on their Bones!': {\r\n    effects: [\r\n      {\r\n        name: `Gnash-gnaw on their Bones!`,\r\n        desc: `You can use this command ability when you pick a friendly Clans Verminus unit to fight in the combat phase. That unit must receive the command. Add 1 to the Attacks characteristic of that unit's melee weapons in that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Rat King': {\r\n    effects: [\r\n      {\r\n        name: `The Rat King`,\r\n        desc: `You can use this command ability when you pick a friendly Skaven unit to fight in the combat phase. That unit must receive the command. Add 1 to hit rolls and wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tyrant of Battle': {\r\n    effects: [\r\n      {\r\n        name: `Tyrant of Battle`,\r\n        desc: `You can use this command ability when you pick a friendly Clans Verminus unit to fight in the combat phase. That unit must receive the command. Add 1 to hit rolls and wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Pestilence': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Pestilence`,\r\n        desc: `You can use this command ability when you pick a friendly Clans Pestilens unit to fight in the combat phase. That unit must receive the command. Add 1 to hit rolls and wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Assassins': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Assassins`,\r\n        desc: `You can use this command ability when you pick a friendly Clans Eshin unit to fight in the combat phase. That unit must receive the command. Add 1 to hit rolls and wound rolls for attacks made by that unit until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unleash More-more Beasts!': {\r\n    effects: [\r\n      {\r\n        name: `Unleash More-more Beasts!`,\r\n        desc: `You can use this command ability if this unit is on the battlefield when a friendly Clans Moulder Pack unit is destroyed. If you do so, roll a dice. On a 3+, a new replacement unit identical to the one that was destroyed is added to your army. Set up that unit wholly within 12\" of this unit and more than 9\" from all enemy units. Each destroyed unit can only be replaced once - replacement units cannot themselves be replaced.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_TURN,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Scurry Away': {\r\n    effects: [\r\n      {\r\n        name: `Scurry Away`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 3+, this unit can immediately use the Retreat ability as if it were your movement phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Short-Tempered': {\r\n    effects: [\r\n      {\r\n        name: `Short-Tempered - Passive`,\r\n        desc: `Effect: Add 1 to run rolls and charge rolls for friendly Skaven units while they are wholly within 13\" of this unit.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skilled Manipulator': {\r\n    effects: [\r\n      {\r\n        name: `Skilled Manipulator - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly non-Hero Skaven Infantry unit:  \r\n        This unit has Ward (4+).  \r\n        Each time you make a successful ward roll for this unit, allocate 1 damage point to a friendly non-Hero Skaven Infantry unit within this units combat range after the damage sequence for this unit has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_TURN],\r\n      },\r\n    ],\r\n  },\r\n /* 'Master of Magic': {\r\n    effects: [\r\n      {\r\n        name: `Master of Magic`,\r\n        desc: `MASTERCLAN HERO only. You can reroll casting, dispelling and unbinding rolls for this general.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Diabolical Schemer': {\r\n    effects: [\r\n      {\r\n        name: `Diabolical Schemer`,\r\n        desc: `MASTERCLAN HERO only. Roll a dice each time an enemy model issues a command within 13\" of this general. On a 5+, that command is not received, the command point spent is lost and you receive 1 command point.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Cunning Mutator': {\r\n    effects: [\r\n      {\r\n        name: `Cunning Mutator`,\r\n        desc: `CLANS MOULDER HERO only. If this general is within 3\" of another friendly CLANS MOULDER unit, before you allocate a wound or mortal wound to this general, or instead of making a ward roll for a wound or mortal wound that would be allocated to this general, you can roll a dice. On a 3+, that wound or mortal wound is allocated to that friendly unit instead of this general.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Masterful Scavenger': {\r\n    effects: [\r\n      {\r\n        name: `Masterful Scavenger`,\r\n        desc: `CLANS SKRYRE HERO only. Add 2 to the number of warpstone sparks you can use during a battle if your army includes this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Deranged Inventor': {\r\n    effects: [\r\n      {\r\n        name: `Deranged Inventor`,\r\n        desc: `CLANS SKRYRE HERO only At the start of your shooting phase, you can pick 1 friendly CLANS SKRYRE unit wholly within 13\" of this general. Add 1 to hit rolls for attacks made with missile weapons by that unit until the end of that phase.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Overseer of Destruction': {\r\n    effects: [\r\n      {\r\n        name: `Overseer of Destruction`,\r\n        desc: `CLANS SKRYRE HERO only. If a friendly unit within 13\" of this general that is hiding a WEAPON TEAM is destroyed, the hidden WEAPON TEAM is not destroyed. Instead, before removing the last slain model in the destroyed unit from play, you can set up the hidden WEAPON TEAM wholly within 3\" of that model and more than 3\" from all enemy units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Master of Rot and Ruin': {\r\n    effects: [\r\n      {\r\n        name: `Master of Rot and Ruin`,\r\n        desc: `CLANS PESTILENS HERO only. Add 1 to chanting rolls for this general.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Architect of Death': {\r\n    effects: [\r\n      {\r\n        name: `Architect of Death`,\r\n        desc: `CLANS PESTILENS HERO only. Add 1 to the Damage characteristic of missile weapons used by friendly PLAGUECLAW units wholly within 18\" of this general.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ridden with Poxes': {\r\n    effects: [\r\n      {\r\n        name: `Ridden with Poxes`,\r\n        desc: `CLANS PESTILENS HERO only. At the end of the combat phase, roll a dice if this general is within 3\" of any enemy units. On a 4+, each enemy unit within 3\" of this general suffers D3 mortal wounds.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Powerful Alpha': {\r\n    effects: [\r\n      {\r\n        name: `Powerful Alpha`,\r\n        desc: `CLANS VERMINUS HERO only. The first 2 wounds or mortal wounds caused to this general in each phase are negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Devious Adversary': {\r\n    effects: [\r\n      {\r\n        name: `Devious Adversary`,\r\n        desc: `In the combat phase, if this general fights within 3\" of an enemy unit that has not yet fought in that phase, add 2 to the Attacks characteristic of this general's melee weapon until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Moulder Supreme': {\r\n    effects: [\r\n      {\r\n        name: `Moulder Supreme`,\r\n        desc: `CLANS MOULDER HERO only. Add 1 to hit rolls and wound rolls for attacks made by friendly FIGHTING BEAST units wholly within 13\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Hordemaster: {\r\n    effects: [\r\n      {\r\n        name: `Hordemaster`,\r\n        desc: `CLANS MOULDER HERO only. Once per battle, if this general is on the battlefield when a friendly PACK unit is destroyed, you can say that they will call more of their creatures to the fore. If you do so, roll a dice. On a 3+, a new replacement unit identical to the unit that was destroyed is added to your army. Set that unit wholly within 13\" of this general and than 9\" from all enemy units, A destroyed unit can only be replaced once - replacement units cannot themselves be replaced.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unrivalled Killer': {\r\n    effects: [\r\n      {\r\n        name: `Unrivalled Killer`,\r\n        desc: `CLANS ESHIN HERO only. This general counts as 2 CLANS ESHIN HEROES for the purposes of the Masters of Murder battle trait.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Shadowmaster: {\r\n    effects: [\r\n      {\r\n        name: `Shadowmaster`,\r\n        desc: `CLANS ESHIN HERO only. This general cannot be picked as the target of attacks made with missile weapons while they are within 1\" of a terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Incredible Agility': {\r\n    effects: [\r\n      {\r\n        name: `Incredible Agility`,\r\n        desc: `CLANS ESHIN HERO only. This general can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Incredible Agility`,\r\n        desc: `CLANS ESHIN HERO only. You can carry out the Their Finest Hour heroic action (core rules, 7.1) with this general twice in the same battle instead of once.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst EndlessSpells = {\r\n /* 'Warp Lightning Vortex': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 8 and a range of 13\". If successfully cast, set up 1 part of the endless spell wholly within range of the caster, then set up the second and third parts exactly 7\" from the first part and exactly 7\" from each other (the parts will form a triangle with each part exactly 7\" from the other two parts). All of the parts must be set up more than 1\" from all models, other endless spells and invocations. Only Skaven Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warp Lightning Bolts`,\r\n        desc: `After this endless spell is set up and at the end of each movement phase, roll a dice for each unit within 6\" of this endless spell. Add 1 to the roll if that unit is within 6\" of 2 parts of this endless spell. Add 2 to the roll instead if that unit is within 6\" of all 3 parts of this endless spell. On a 4+, that unit suffers D3 mortal wounds. On an unmodified roll of 6, that unit suffers D6 mortal wounds instead of D3.`,\r\n        when: [HERO_PHASE, END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Warp Vortex`,\r\n        desc: `Units within 3\" of this endless spell cannot run.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Vermintide: {\r\n    effects: [\r\n      {\r\n        name: `Predatory`,\r\n        desc: `This endless spell is a predatory endless spell. It can be moved up to 7\".`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 18\". If successfully cast, set up the endless spell wholly within range and visible to the caster, more than 1\" from all models, other endless spells and invocations. Only Skaven Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ravening Horde`,\r\n        desc: `After this endless spell has moved, the commanding player can pick 1 unit within 3\" of it and roll 13 dice. For each 6, that unit suffers 1 mortal wound. In addition, roll 13 dice for each unit that finishes a normal move, run, retreat or charge move within 3\" of this endless spell. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Ravening Horde`,\r\n        desc: `Roll 13 dice for each unit that finishes a normal move, run, retreat or charge move within 3\" of this endless spell. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bell of Doom': {\r\n    effects: [\r\n      GenericEffects.Predatory.Two_D6,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and a range of 13\". If successfully cast, set up the endless spell wholly within range and visible to the caster, more than 1\" from all models, other endless spells and invocations. Only Skaven Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Apocalyptic Doom`,\r\n        desc: `After this endless spell has moved, roll 3D6. On a 13, each unit within 13\" of this endless spell suffers D3 mortal wounds, and then this endless spell is removed from play.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Boldness or Despair`,\r\n        desc: `Do not take battleshock tests for Skaven units wholly within 13\" of this endless spell. Subtract 1 from the Bravery characteristic of other units within 13\" of this endless spell.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Warpcog Convocation': {\r\n    effects: [\r\n      {\r\n        name: `Skryre Prototypes - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Skryre units to be the targets. \r\n        Effect: Roll a dice for each target and apply the corresponding effect: \r\n        1 Kaboom!: Inflict D3 mortal damage on the target. \r\n        2-5 More Power!: Add 1 to wound rolls for the targets shooting attacks for the rest of the turn. \r\n        6 More-more Power!: In addition to the effect of More Power!, add 1 to the Rend characteristic of the targets ranged weapons for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fleshmeld Menagerie': {\r\n    effects: [\r\n      {\r\n        name: `Prized Creations - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly non-Hero Moulder units to be the targets. \r\n        Effect: Roll a dice for each target and apply the corresponding effect: \r\n        1-2 Self-destructive Fury: Inflict D3 mortal damage on the target. \r\n        3-4 Rabid Infusion: Add 1 to the Attacks characteristic of the targets melee weapons until the start of your next turn. \r\n        5-6 Blinded by Frenzy: In addition to the effect of Rabid Infusion, the target has Ward (5+) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Virulent Procession': {\r\n    effects: [\r\n      {\r\n        name: `Corrupted Earth - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Pestilens units to be the targets. \r\n        Effect: For each target:  \r\n        Make a pile-in move.  \r\n        Then, pick an enemy unit in combat with the target and roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Claw-Horde': {\r\n    effects: [\r\n      {\r\n        name: `Claw-Picked - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Verminus units that charged this turn to be the targets. \r\n        Effect: Add 1 to the Rend characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Masterclan: {\r\n    effects: [\r\n      {\r\n        name: `Skilled Manipulators`,\r\n        desc: `Roll a dice before you allocate a wound or mortal wound to a friendly MASTERCLAN HERO that is not a MONSTER, or instead of making a ward roll for a wound or mortal wound that would be allocated to a friendly MASTERCLAN HERO that is not a MONSTER, if that HERO is within 3\" of any friendly SKAVEN units that have 3 or more models. On a 3+, that wound or mortal wound is allocated to 1 of those units instead of that HERO.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Always Three Clawsteps Ahead`,\r\n        desc: `You can only use this ability if you include 3 or more MASTERCLAN HEROES in your starting army. After you pick a friendly Skaven unit to be your first unit to run in a phase and make a run roll for that unit, you can use that unmodified run roll in place of any other run rolls you make for friendly Skaven units until the end of that phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SKAVEN, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n      {\r\n        name: `Always Three Clawsteps Ahead`,\r\n        desc: `You can only use this ability if you include 3 or more MASTERCLAN HEROES in your starting army. After you pick a friendly SKAVEN unit to be your first unit to attempt a charge in a phase and make a charge roll for that unit, you can use that charge roll in place of any other charge rolls you make for friendly SKAVEN units until the end of that phase.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SKAVEN, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n      {\r\n        name: `Always Three Clawsteps Ahead`,\r\n        desc: `You can only use this ability if you include 3 or more MASTERCLAN HEROES in your starting army. After you pick a friendly SKAVEN unit to be your first unit to fight in a phase and make any pile-in moves for that unit, you can make pile-in moves for each other friendly SKAVEN unit on the battlefield that is within 3\" of any enemy units.\r\n\r\n        Designer's Note: This ability does not prevent a unit from making another pile-in move when it is picked to fight.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SKAVEN, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n    ],\r\n  },\r\n  Moulder: {\r\n    effects: [\r\n      {\r\n        name: `Prized Creations`,\r\n        desc: `At the start of the first battle round, after determining who has the first turn but before the first turn begins, you can pick 1 HELL PIT ABOMINATION in your army to have a mutation from the table. If you include 3 or more MASTER MOULDERS in your starting army, you can pick each HELL PIT ABOMINATION in your army to have a mutation instead of only 1.\r\n\r\n        The same HELL PIT ABOMINATION cannot have more than 1 mutation, and an army cannot include duplicates of the same mutation.\r\n        \r\n        Toughened Sinews: This unit has a Wounds characteristic of 16 and a Save characteristic of 4+.\r\n\r\n        Lumbering Behemoth: This unit has a Move characteristic of 7\". In addition, charge rolls for this unit are automatically a 7 (do not roll the dice).\r\n\r\n        Quivering Bulk: Add 1 to each roll you make for this unit's Avalanche of Flesh ability.\r\n\r\n        Accelerated Regeneration: You can use this unit's Regenerating Monstrosity ability in the enemy hero phase as well as in your hero phase.\r\n\r\n        Best-best Warpstone Spikes: You can reroll the dice when you use this unit's Warpstone Spikes ability.\r\n        \r\n        Never-never Die-die: You can reroll the dice when you use this unit's Too Horrible To Die ability.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  Eshin: {\r\n    effects: [\r\n      {\r\n        name: `Masters of Murder`,\r\n        desc: `At the start of the first battle round, after determining who has the first turn but before the first turn begins, you can pick 1 enemy on the battlefield. Add 1 to hit rolls and wound rolls for attacks made by friendly CLANS ESHIN units that target that HERO.\r\n\r\n        If you include 3 or more CLANS HEROES in your starting army, add 1 to hit rolls and wound rolls for attacks made with melee weapons by friendly CLANS ESHIN units that target enemy HEROES.`,\r\n        when: [TURN_ONE_START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Masters of Murder`,\r\n        desc: `Add 1 to hit rolls and wound rolls for attacks made by friendly CLANS ESHIN units that target that HERO. If you include 3 or more CLANS HEROES in your starting army, add 1 to hit rolls and wound rolls for attacks made with melee weapons by friendly CLANS ESHIN units that target enemy HEROES.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Verminus: {\r\n    effects: [\r\n      {\r\n        name: `Mighty Warlords`,\r\n        desc: `This is a heroic action that you can carry out with 1 friendly CLAWLORD instead of picking 1 from the table in the core rules. If you do so, pick 1 eligible command trait from pages 70-71 that this CLAWLORD does not already have and apply its effect to this unit until the end of this turn.\r\n\r\n        If you include 3 or more CLAWLORDS in your starting army, you can carry out this heroic action with each friendly CLAWLORD instead just 1. The same command trait cannot be picked with this ability more than once in the same turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Skryre: {\r\n    effects: [\r\n      {\r\n        name: `Warpstone Sparks`,\r\n        desc: `If you include any CLANS SKRYRE HEROES in your starting army, at the start of the battle, before either player starts deploying units, you can roll a D3 and add 3 to the roll, If you include 3 or more CLANS SKRYRE HEROES in your starting army, you can roll a D6 and add 3 to the roll instead. The result is the number of warpstone sparks you receive that you can use during the battle, You cannot use more than 1 warpstone spark in the same phase. Each warpstone spark can be used once per battle to carry out 1 of the warpstone spark abilities: `,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Warpstone Sparks`,\r\n        desc: `In the hero phase, pick 1 friendly CLANS SKRYRE WIZARD. You can reroll casting, dispelling and unbinding rolls for that WIZARD until the end of that phase. At the end of that phase, roll a dice. On a 1, that WIZARD suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warpstone Sparks`,\r\n        desc: `At the start of your shooting phase, pick 1 friendly CLANS SKRYRE HERO. Then pick up to 3 different friendly CLANS SKRYRE units wholly within 13\" of that HERO. You can add 1 to the Damage characteristic of missile weapons used by those units until the end of that phase. At the end of that phase, roll a dice. On a 1, that HERO suffers D3 mortal wounds.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Warpstone Sparks`,\r\n        desc: `In the combat phase, when you pick a friendly CLANS SKRYRE HERO to fight, you can say that they will use this warpstone spark ability. If you do so, add 1 to hit rolls and wound attacks made by that HERO until the end phase. At the end of that phase, roll a dice. On a 1, that HERO suffers D3 mortal wounds.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Pestilens: {\r\n    effects: [\r\n      {\r\n        name: `Echoes of the Great Plagues`,\r\n        desc: `When you make a chanting roll for a friendly CLANS PESTILENS PRIEST, you can add 1 to that chanting roll for each other friendly CLANS PESTILENS PRIEST wholly within 13\" of the chanter. In addition, if the chanting roll for a prayer chanted by a friendly CLANS PESTILENS PRIEST is 6+, you can pick 1 of the following Great Plagues to manifest (in addition to the effect of the prayer). Each Great Plague can only manifest once per battle, and no more than one Great Plague can manifest in the same turn.\r\n\r\n        Bubonic Blightplague: If this Great Plague manifests, pick the nearest enemy unit within 13\" of the chanter. That unit is infected with the Bubonic Blightplague. If several enemy units are tied to be the closest, you can pick which is infected. The infected unit suffers 2D6 mortal wounds. If the infected unit is destroyed by those mortal wounds, you can pick another enemy unit within 6\" of the last model to be slain in the infected unit. That unit is now infected and suffers D6 mortal wounds. If that infected unit is likewise destroyed, you can pick another enemy unit within 6\" of the last model to be slain. Ihat unit is now infected and suffers D3 mortal wounds, Continue in this manner until either a unit is not destroyed or there are no other enemy units within 6\" of a destroyed unit.\r\n\r\n        Crimsonweal Curse: If this Great Plague manifests, pick the nearest enemy unit within 13\" of the chanter, That unit is infected with the Crimsonweal Curse for the rest of the battle. If several enemy units are tied to be the closest, you can pick which is infected. The infected unit suffers 1 mortal wound. In addition, at the start of each turn, the infected unit and each other enemy unit within 1\" of the infected unit suffer 1 mortal wound.\r\n\r\n        Redmaw Plague: If this Great Plague manifests, pick the nearest enemy HERO within 13\" of the chanter, That HERO is infected with the Redmaw Plague for the rest of the battle. If several enemy HEROES are tied to be the closest, you can pick which is infected. At the start of the combat phase, if the infected HERO is within 3\" of any other units in your opponent's army and is not within 3\" of any units in your army, then you can treat that HERO as a friendly unit until the end of that combat phase.\r\n\r\n        The Neverplague: If this Great Plague manifests, you can reroll chanting rolls for friendly CLANS PESTILENS PRIESTS for the rest of the battle.\r\n\r\n        Undulant Scourge: If this Great Plague manifests, pick the nearest enemy unit within 13\" of the chanter and roll a dice for each model in that unit. If several enemy units are tied to be the closest, you can pick which unit to roll dice for. For each 4+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Shapers of Beast-flesh': {\r\n    effects: [\r\n      {\r\n        name: `Shapers of Beast-flesh`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly MASTERCLAN or ClANS MOULDER HEROES from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Masters of Execution': {\r\n    effects: [\r\n      {\r\n        name: `Masters of Execution`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly MASTERCLAN or ClANS ESHIN HEROES from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Clawmasters: {\r\n    effects: [\r\n      {\r\n        name: `Clawmasters`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly MASTERCLAN or ClANS VERMINUS HEROES from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Warpstone Weaponmasters': {\r\n    effects: [\r\n      {\r\n        name: `Warpstone Weaponmasters`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly MASTERCLAN or ClANS SKRYRE HEROES from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Arch-corruptors of the Mortal Realms': {\r\n    effects: [\r\n      {\r\n        name: `Arch-corruptors of the Mortal Realms`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are 3 or more friendly MASTERCLAN or ClANS PESTILENS HEROES from your starting army on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Prayers = {\r\n  'Noxious Prayers': {\r\n    effects: [\r\n      {\r\n        name: `Filth-Crust: Chant value of 4 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Skaven Priest to chant this prayer, pick a visible friendly Skaven Infantry unit wholly within 13\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Add 1 to wound rolls for the targets combat attacks until the start of your next turn. In addition, if the chanting roll was 8+, the targets melee weapons have Crit (Mortal) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Bile-Torrent: Chant value of 4`,\r\n        desc: `Declare: Pick a friendly Skaven Priest to chant this prayer, pick a visible enemy unit within 13\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target. If the chanting roll was 8+, inflict 1 mortal damage on the target for each 4+ instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rabid-Tough: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Skaven Priest to chant this prayer, pick a visible friendly Skaven Infantry unit wholly within 13\" of them to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract 1 from wound rolls for attacks that target that unit until the start of your next turn. In addition, if the chanting roll was 8+, add 1 to save rolls for the target until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Filth-filth!': {\r\n    effects: [\r\n      {\r\n        name: `Filth-filth!`,\r\n        desc: `Answer value of 3 and a range of 13\". If answered, pick 1 friendly CLANS PESTILENS unit within range and visible to the chanter. Add 1 to wound rolls for attacks made by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rabid-rabid!': {\r\n    effects: [\r\n      {\r\n        name: `Rabid-rabid!`,\r\n        desc: `Answer value of and a range of 13\". If answered, pick 1 friendly CLANS PESTILENS unit within range and visible to the chanter. Add 1 to the Attacks characteristic of melee weapons used by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Unit prayers\r\n  'Pestilence-pestilence!': {\r\n    effects: [\r\n      {\r\n        name: `Pestilence-pestilence!`,\r\n        desc: `Answer value of 3 and a range of 13\". If answered, pick a point on the battlefield within range and visible to the chanter and roll a dice for each unit within 3\" of that point. On a 4+, that unit suffers D3 mortal wounds. If that unit is a Clans Pestilens unit, heal D3 wounds allocated to that unit instead.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Befoul-befoul!': {\r\n    effects: [\r\n      {\r\n        name: `Befoul-befoul!`,\r\n        desc: `Befoul-befoul! is a prayer that has an answer value of 3 and a range of 13\". If answered, pick an objective on the battlefield within range and visible to the chanter. That objective is befouled until the start of your next hero phase (see the Skabbik's Plaguepack warscroll). In addition, roll a dice for each friendly and enemy unit contesting that objective. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Prayers, 'prayer')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { END_OF_MOVEMENT_PHASE, HERO_PHASE, START_OF_SETUP } from 'types/phases'\r\n\r\nconst Scenery = {\r\n/*  Gnawhole: {\r\n    effects: [\r\n      {\r\n        name: `Setup`,\r\n        desc: `After territories are determined, you can set up this faction terrain feature more than 3\" from all objectives and other terrain features, more than 18\" from all other Gnawholes in your army, and wholly within 8\" of the battlefield edge. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Tunnels Through Reality`,\r\n        desc: `Once per turn, at the end of your movement phase, you can pick 1 friendly Skaven unit wholly within 6\" of this terrain feature and remove it from the battlefield. Set up that unit again wholly within 6\" of a different Gnawhole in your army that does not have any enemy units within 3\" of it, and more than 9\" from all enemy units.\r\n\r\n        Designer's Note: You can use this ability once per turn with each Gnawhole faction terrain feature in your army that is on the battlefield.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of the Horned Rat`,\r\n        desc: `Add 1 to chanting rolls for friendly Skaven Priests within 3\" of this terrain feature, and add 1 to casting, dispelling and unbinding rolls for friendly Skaven Wizards within 3\" of this terrain feature.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  // Lore of Ruin\r\n /* Scorch: {\r\n    effects: [\r\n      {\r\n        name: `Scorch`,\r\n        desc: `Casting value of 5 and a range of 13\". Pick 1 enemy unit within range and visible to the caster and roll a number of dice equal to the casting roll. For each 6, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Skitterleap: {\r\n    effects: [\r\n      {\r\n        name: `Skitterleap`,\r\n        desc: `Casting value of 6 and a range of 13\". Pick 1 friendly SKAVEN HERO with a wounds characteristic of 13 or less within range and visible to the caster. Remove that HERO from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. That HERO cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Death Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Death Frenzy`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick 1 friendly SKAVEN unit that is not a HERO within range and visible to the caster. Until your next hero phase, if any models in that unit are slain, those models can fight before they are removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Death Frenzy`,\r\n        desc: `If active, if any models in that unit are slain, those models can fight before they are removed from play.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Lore of Warpvolt Galvanism\r\n  'More-more-more Warp Power!': {\r\n    effects: [\r\n      {\r\n        name: `More-more-more Warp Power!`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick 1 friendly CLANS SKRYRE unit wholly within range and visible to the caster. Add 1 to hit rolls and wound rolls for attacks made by that unit until your next hero phase. However, that unit suffers D3 mortal wounds at the end of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chain Warp Lightning': {\r\n    effects: [\r\n      {\r\n        name: `Chain Warp Lightning`,\r\n        desc: `Casting value of 7 and a range of 13\". If successfully cast, each unit within range suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warp Lightning Shield': {\r\n    effects: [\r\n      {\r\n        name: `Warp Lightning Shield`,\r\n        desc: `Casting value of 6. If successfully cast, until your next hero phase, the first 3 wounds caused to the caster in each phase are negated. If a fourth wound is caused to the caster in the same phase, then the caster suffers 3 mortal wounds and this spell is unbound (the first wounds caused in that phase are still negated).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Unit spells\r\n  'Warp Lightning': {\r\n    effects: [\r\n      {\r\n        name: `Warp Lightning`,\r\n        desc: `Casting value of 5 and a range of 13\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. Alternatively, before making the casting roll, you can say that this unit will use its warp-power accumulator to augment the spell. If you do so, and the spell is successfully cast and not unbound, pick 1 enemy unit within range and visible to the caster. That unit suffers D6 mortal wounds. However, if the spell is not successfully cast or is unbound, this unit suffers D6 mortal wounds that cannot be negated.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Madness: {\r\n    effects: [\r\n      {\r\n        name: `Madness`,\r\n        desc: `Casting value of 8 and a range of 3\". Pick 1 enemy HERO within range and visible to the caster and roll a number of dice equal to the combined value of the Attacks characteristics of all melee weapons with which that HERO is armed. For each 4+, you can pick 1 enemy unit within 3\" of that HERO to suffer 1 mortal wound (you can pick different units to suffer the mortal wounds if you wish).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Dreaded Thirteenth Spell': {\r\n    effects: [\r\n      {\r\n        name: `The Dreaded Thirteenth Spell`,\r\n        desc: `Casting value of 8 and a range of 13\". Pick 1 enemy unit within range and visible to the caster and roll 13 dice. For each 4+, that unit suffers 1 mortal wound. You can then summon 1 unit of Clanrats to the battlefield and add it to your army. The summoned unit can have up to 1 model for each mortal wound that was caused by this spell. The summoned unit must be set up wholly within range of the caster and more than 9\" from all enemy units. The summoned unit cannot move in the following movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreaded Warpgale': {\r\n    effects: [\r\n      {\r\n        name: `Dreaded Warpgale`,\r\n        desc: `Casting value of 8 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D6 mortal wounds. In addition, run rolls and charge rolls for that unit are halved until your next hero phase, and if that unit can fly, it also cannot fly until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Wither: {\r\n    effects: [\r\n      {\r\n        name: `Wither`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick 1 enemy unit within range and visible to the caster and roll 2D6. If the roll is greater than that unit's Wounds characteristic, that unit suffers D3 mortal wounds and you can subtract 1 from hit rolls for attacks made with melee weapons by that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warp Lightning Storm': {\r\n    effects: [\r\n      {\r\n        name: `Warp Lightning Storm`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick up to D3 different enemy units within range and visible to the caster. Those units each suffer D3 mortal wounds. Alternatively, before making the casting roll, you can say that this unit will use its warp-power accumulator to augment the spell. If you do so, and the spell is successfully cast and not unbound, pick up to D3 different enemy units within range and visible to the caster. Those units each suffer D6 mortal wounds. However, if the spell is not successfully cast or is unbound, this unit suffers mortal wounds that cannot be negated.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreaded Death Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Dreaded Death Frenzy`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick up to D3 friendly SKAVEN units wholly within range and visible to the caster. Until your next hero phase, if any models in that unit are slain, those models can fight before they are removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dreaded Plague': {\r\n    effects: [\r\n      {\r\n        name: `Dreaded Plague`,\r\n        desc: `Casting value of 7 and a range of 13\". Pick 1 enemy unit within range and visible to the caster and roll a dice for each model in that unit. For each 4+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cracks Call': {\r\n    effects: [\r\n      {\r\n        name: `Cracks Call`,\r\n        desc: `Casting value of 6 and a range of 13\". Pick 1 enemy unit within range and visible to the caster and roll 2D6. If the roll is greater than that unit's Move characteristic, that unit suffers a number of mortal wounds equal to the difference between its Move characteristic and the roll (rounding up). This spell has no effect on units that can fly.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lore of Ruin': {\r\n    effects: [\r\n      {\r\n        name: `Wither: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Skaven Wizard to cast this spell, pick a visible enemy unit within 13\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Skitterleap: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Skaven Wizard to cast this spell, pick a visible friendly Skaven Hero wholly within 13\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warpgale: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Skaven Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has Strike-last for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_ROUND,\r\n  DURING_SETUP,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SETUP,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_END_OF_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport prayers from './prayers'\r\nimport rule_sources from './rule_sources'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const HiddenWeaponsTeamsEffects = [\r\n  {\r\n    name: `Hidden Weapon Team`,\r\n    desc: `When you select this unit to be part of your army, you can pick 1 friendly Clanrats or Stormvermin unit that has 10 or more models and is already part of your army to be the unit in which this unit is hiding. Record this information on a separate piece of paper. Do not set up this unit until it is revealed as described next. You can hide up to 1 unit in a Clanrats or Stormvermin unit for every 10 models in that Clanrats or Stormvermin unit. Hidden units are destroyed if the unit in which they are hiding is destroyed before they are revealed.`,\r\n    when: [START_OF_SETUP],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Hidden Weapon Team`,\r\n    desc: `At the start of your shooting phase, you can reveal this hidden unit. If you do so, set up this unit wholly within 3\" of the unit in which it was hiding and more than 3\" from all enemy units. This unit can shoot in the phase in which it is revealed as long as the unit in which it was hiding did not run in the same turn (it could have retreated).`,\r\n    when: [START_OF_SHOOTING_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst EshinToxinsEffect = {\r\n  name: `Eshin Toxins`,\r\n  desc: `If the unmodified hit roll for an attack made by this unit is 6, the target suffers D3 mortal wounds and the attack sequence ends (do not make a wound roll or save roll).`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst AltarOfTheHornedRatEffects = [\r\n  {\r\n    name: `Altar of the Horned Rat`,\r\n    desc: `This unit has a ward of 5+.`,\r\n    when: [WARDS_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Altar of the Horned Rat`,\r\n    desc: `At the start of your hero phase, you can say that this unit will beseech the Horned Rat instead of attempting to cast spells in that phase. If you do so, in that phase, this unit is treated as having the Priest keyword instead of the Wizard keyword.`,\r\n    when: [START_OF_HERO_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst RunningDeathEffect = {\r\n  name: `Running Death`,\r\n  desc: `This unit can run and still shoot later in the turn.`,\r\n  when: [MOVEMENT_PHASE, SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst RegeneratingMonstrosityEffect = {\r\n  name: `Regenerating Monstrosity`,\r\n  desc: `In your hero phase, you can heal up to D3 wounds allocated to this unit.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst ProtectionOfTheHornedRatEffect = {\r\n  name: `Protection of the Horned Rat`,\r\n  desc: `This unit has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst PoisonousFumesEffect = {\r\n  name: `Poisonous Fumes`,\r\n  desc: `Subtract 1 from wound rolls for attacks made with melee weapons that target this unit.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst FrenziedAssaultEffect = {\r\n  name: `Frenzied Assault`,\r\n  desc: `Add 1 to the Attacks characteristic of this unit's melee weapons if it made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CrackTheWhipEffect = {\r\n  name: `Crack the Whip`,\r\n  desc: `At the start of your movement phase, you can pick 1 friendly Clans Moulder Pack unit wholly within 13\" of this unit. Until your next movement phase, you can add 3 to run rolls and charge rolls for that unit. In addition, until your next movement phase, add 1 to wound rolls for attacks made with melee weapons by that unit. The same unit cannot benefit from this ability more than once per turn.`,\r\n  when: [START_OF_MOVEMENT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  'Thanquol on Boneripper': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Madness'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      //ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Warpre Braziers is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Staff of the Horned Rat - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warp-Amulet`,\r\n        desc: `Effect: Heal (D3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Boneripper Rampage - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3-5, inflict D3 mortal damage on the target. On a 6, inflict 2D3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Terrible Madness: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 13\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: The target cannot use commands until the start of your next turn. In addition, roll a number of dice equal to the number of models in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord Skreech Verminking': {\r\n  /*  mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['The Rat King'])],\r\n      spells: [keyPicker(spells, ['The Dreaded Thirteenth Spell'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     // ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `The Thirteen-Headed One`,\r\n        desc: `Effect: Pick 1 of the following effects to apply until the start of your next turn. You cannot pick the same effect more than once per battle. \r\n        Master of Dire Sorcery: Add 1 to casting rolls for friendly Masterclan Wizards while they are wholly within 13\" of this unit. \r\n        Commander of Vermin: Add 1 to charge rolls for friendly Verminus units while they are wholly within 13\" of this unit. \r\n        Knower of Warp-tech: Add 1 to hit rolls for shooting attacks made by friendly Skryre units while they are wholly within 13\" of this unit. \r\n        Deliverer of Weeping Blades: Add 1 to the Rend characteristic of melee weapons used by friendly Eshin units while they are wholly within 13\" of this unit. \r\n        Bringer of Plagues: Add 1 to chanting rolls for friendly Pestilens Priests while they are wholly within 13\" of this unit. \r\n        Shaper of Fleshcra: Heal (D3) each friendly Moulder unit wholly within 13\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Dreaded Thirteenth Spell: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 13\" to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 13 dice. For each 5+:  \r\n        Inflict 1 mortal damage on the target.  \r\n        You can return 1 slain model to a friendly Clanrats unit wholly within 13\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Terrifying Monstrosity - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+:  \r\n        The target cannot use commands for the rest of the turn.  \r\n        Subtract an amount equal to the roll from the targets control score until the start of your next turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Verminlord Warpseer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Dreaded Warpgale'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n     // ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `Divine the Future - Passive`,\r\n        desc: `Effect: While this unit is on the battlefield, add 2\" to the distance friendly units can move when using the Always Three Clawsteps Ahead ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arch-Manipulators - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Hurl Scry-Orb - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit cannot use the Divine the Future ability for the rest of the battle. Roll a dice. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tectonic Splintering: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from the number of dice rolled when making charge rolls for the target, to a minimum of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grey Seer': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Wither'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Warpstone Shards`,\r\n        desc: `Effect: The next time you make a casting roll for this unit this phase, roll 3D6 instead of 2D6. This roll cannot be re-rolled or modified. \r\n        If the casting roll is 13, the spell is successfully cast and cannot be unbound. After the effect of that spell has been resolved, inflict D3 mortal damage on this unit. \r\n        If the casting roll is not 13, remove 1 dice of your choice from the casting roll and use the remaining 2D6 as the casting roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Arch-Warlock': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Warp Lightning Storm'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Overseers of the Enginecovens - Passive`,\r\n        desc: `Effect: Each time a friendly Skryre unit wholly within 13\" of this unit uses the Covering Fire command, do not subtract 1 from hit rolls for attacks made as part of that ability.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warlock Engineer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Warp Lightning'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `More-More Warp Energy! - Reaction: You declared a Shoot ability for this unit, it was not set up this turn, and it has not used a Move ability turn`,\r\n        desc: `Effect: Roll a dice. On a 2+, set the Damage characteristic of this units Warplock Musket to 3 for the rest of the turn. On a 1, inflict D3 mortal damage on this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Sniper-Master - Once Per Turn`,\r\n        desc: `Declare: Pick a visible enemy Hero to be the target. \r\n        Effect: For the rest of the turn, this unit and friendly Warplock Jezzails units wholly within 13\" of this unit can ignore the effects of the Guarded Hero ability (Core Rules, 25.0) when picking the target for their shooting attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warlock Bombardier': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Warp Lightning'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `More-More Doom! - Reaction: You declared a Shoot ability for this unit, it was not set up this turn, and it has not used a Move ability turn`,\r\n        desc: `Effect: Roll a dice. On a 2+, set the Damage characteristic of its Doomrocket to D3+3 for the rest of the turn. On a 1, inflict D3 mortal damage on this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Explosive Payload - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this units shooting attacks that target an enemy unit that has 10 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Stormfiends: {\r\n    effects: [\r\n     // GenericEffects.Elite,\r\n      {\r\n        name: `Grinderfist Tunnellers`,\r\n        desc: `Declare: Pick this unit if it is in the tunnels below and includes any models armed with Grindersts. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Shock Gauntlets - Passive`,\r\n        desc: `Effect: Each time an attack made with this units Shock Gauntlets scores a critical hit, that attack scores D6 hits on the target unit instead of 1. Make a wound roll for each hit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warp Lightning Cannon': {\r\n    effects: [\r\n      {\r\n        name: `Warp Lightning Blast - Passive`,\r\n        desc: `Effect: Each attack made with this weapon in a single phase must target the same enemy unit. Each hit inflicts 1 mortal damage on the target and the attack sequence ends.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `More-More Warp Lightning! - Once Per Turn`,\r\n        desc: `Effect: If this unit is within the combat range of a friendly Skryre Hero, add 6 to the Attacks characteristic of this units Warp Lightning Blast for the rest of the turn. \r\n        However, for each unmodified hit roll of 1 for an attack made with this units Warp Lightning Blast, inflict D3 mortal damage on this unit after the Shoot ability has been resolved.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Acolyte Globadiers': {\r\n    effects: [\r\n      {\r\n        name: `Hidden Weapon Team - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Clanrats unit that has 5 or more models, and there are no other friendly Weapon Team units within that units combat range, this unit is not visible to enemy units more than 13\" away.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gas Clouds - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Poisoned Wind Globes for attacks that target an enemy unit that has 10 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  Doomwheel: {\r\n    effects: [\r\n      {\r\n        name: `Rolling Doom`,\r\n        desc: `Effect: This unit can move a distance up to its Move characteristic. This unit can pass through other models and the combat ranges of enemy units, but it cannot end that move in combat. \r\n        Then, pick up to 3 enemy units that this unit passed across during that move to be the targets. Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Warplock Jezzails': {\r\n    effects: [\r\n      {\r\n        name: `Warpstone Snipers`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, add 1 to hit rolls for this units shooting attacks for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Clanrats: {\r\n    effects: [\r\n      {\r\n        name: `Seething Swarm`,\r\n        desc: `Effect: You can return D3 slain models to this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Stormvermin: {\r\n    effects: [\r\n      {\r\n        name: `Elite Bodyguard - Passive`,\r\n        desc: `Effect: Friendly Skaven Infantry Heroes have Ward (5+) while they are within this units combat range.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n/*  \"Spiteclaw's Swarm\": {\r\n    effects: [\r\n      {\r\n        name: `Aversion to Death`,\r\n        desc: `After the first wound or mortal wound is allocated to this unit in any phase, this unit has a ward of 5+ until the end of that phase.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Champion`,\r\n        desc: `The leader of this unit is Krrk the Almost-trusted. Do not take battleshock tests for this unit while it includes Krrk the Almost-trusted.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Champion`,\r\n        desc: `The leader of this unit is Krrk the Almost-trusted. If Skritch Spiteclaw is slain, add 2 to the Attacks characteristic of Krrk's Rusty Spear for the rest of this battle.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Verminlord Warbringer': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Tyrant of Battle'])],\r\n      spells: [keyPicker(spells, ['Dreaded Death Frenzy'])],\r\n    }, */\r\n    effects: [\r\n   //   GenericEffects.WizardTwoSpellsEffect,\r\n    //  ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `Tyrant of Battle - Once Per Turn`,\r\n        desc: `Declare: Pick up to 2 friendly Verminus Infantry units wholly within 13\" of this unit to be the targets. \r\n        Effect: The targets can each use the All-out Attack or All-out Defence command this phase even if that command has been used by a friendly unit this phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Killing Blow - Once Per Turn`,\r\n        desc: `Declare: Pick a damaged enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is less than the number of damage points the target has, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  Clawlord: {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Gnash-gnaw on their Bones!'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Cornered Rat - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 3 to the Attacks characteristic of its Warpforged Blade.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gnash-Gnaw on their Bones! - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Verminus Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Skritch Spiteclaw': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Gnash-gnaw on their Bones!'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `There are Always More`,\r\n        desc: `At the start of your hero phase, if this unit is within 13\" of a friendly Spiteclaw's Swarm unit, you can return D3 slain models to that unit. You cannot return Krrk the Almost-trusted.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slynk Skittershank': {\r\n    effects: [\r\n      //EshinToxinsEffect,\r\n     // RunningDeathEffect,\r\n      {\r\n        name: `Misdirection`,\r\n        desc: `If this unit is within 1\" of a friendly Skittershank's Clawpack unit at the start of the combat phase, the strike-first effect applies to this unit in that combat phase. In addition, after this unit has fought for the first time in the combat phase, if this unit is within 1\" of a friendly Skittershank's Clawpack unit, this unit can retreat.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Skittershank's Clawpack\": {\r\n    effects: [\r\n     // EshinToxinsEffect,\r\n      {\r\n        name: `Kinwhisper's Ratlings`,\r\n        desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is infiltrating the foe as a reserve unit. If you do so, when you would set up a friendly Slynk Skittershank during deployment, you can say that it will join this unit infiltrating the foe as a reserve unit.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Kinwhisper's Ratlings`,\r\n        desc: `At the end of your first movement phase, you must set up this unit on the battlefield, wholly within 6\" of a terrain feature and more than 6\" from all enemy units. Then, if Slynk Skittershankj oined this unit in reserve, set up that unit within 1\" of this unit and more than 6\" from all enemy units.`,\r\n        when: [TURN_ONE_END_OF_MOVEMENT_PHASE],\r\n      },\r\n     // RunningDeathEffect,\r\n    ],\r\n  }, */\r\n  'Doom-Flayer': {\r\n    effects: [\r\n      {\r\n        name: `Whirling Doom`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ratling Gun': {\r\n    effects: [\r\n      {\r\n        name: `Hidden Weapon Team - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Clanrats unit that has 5 or more models, and there are no other friendly Weapon Team units within that units combat range, this unit is not visible to enemy units more than 13\" away.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // ...HiddenWeaponsTeamsEffects,\r\n    ],\r\n  },\r\n  'Warpfire Thrower': {\r\n    effects: [\r\n      {\r\n        name: `Hidden Weapon Team - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Clanrats unit that has 5 or more models, and there are no other friendly Weapon Team units within that units combat range, this unit is not visible to enemy units more than 13\" away.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // ...HiddenWeaponsTeamsEffects,\r\n    ],\r\n  },\r\n /* 'Warp-Grinder': {\r\n    effects: [\r\n      {\r\n        name: `Tunnel Skulkers`,\r\n        desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is set up tunnelling as a reserve unit. If you do so, when you would set up another friendly SKAVEN unit that is not a MONSTER or a War Machine during deployment, you can say that it will join this unit tunnelling as a reserve unit. 1 unit can join this unit in this way.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Tunnel Skulkers`,\r\n        desc: `At the end of your movement phase, you can set up this unit on the battlefield more than 9\" from all enemy units. Then, if a friendly SKAVEN unit joined this unit in reserve, set up that unit on the battlefield, wholly within 13\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Plagueclaw: {\r\n    effects: [\r\n      {\r\n        name: `Bubonic Barrage - Passive`,\r\n        desc: `Effect: Each time this unit uses a Shoot ability, if all of its attacks targeted the same enemy unit, after that ability has been resolved, roll a dice. If the result is equal to or less than the number of models in that enemy unit that were slain by attacks made by this units Plagueclaw Catapult this phase, that enemy unit has Strike-last for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Plague Monks': {\r\n    effects: [\r\n      {\r\n        name: `Spreaders of Filth and Disease - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 6+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Plague Censer Bearers': {\r\n    effects: [\r\n    //  FrenziedAssaultEffect,\r\n      {\r\n        name: `Plague Disciples`,\r\n        desc: `Add 1 to wound rolls for attacks made by this unit if it is wholly within 18\" of any friendly Plague Monks units.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  PoisonousFumesEffect,\r\n    ],\r\n  }, */\r\n  /*'Plague Priest': {\r\n    mandatory: {\r\n      prayers: [keyPicker(prayers, ['Pestilence-pestilence!'])],\r\n    }, \r\n    effects: [FrenziedAssaultEffect, PoisonousFumesEffect],\r\n  }, */\r\n  'Plague Priest on Plague Furnace': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, ['Pestilence-pestilence!'])],\r\n    }, */\r\n    effects: [\r\n     // ...AltarOfTheHornedRatEffects,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Great Plague Censer is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Corrupting Influence - Passive`,\r\n        desc: `Effect: Subtract 1 from ward rolls for enemy units while they are within 6\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Altar of the Great Corruptor - Passive`,\r\n        desc: `Effect: Friendly Pestilens units have Ward (6+) while they are wholly within 6\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    //  PoisonousFumesEffect,\r\n    ],\r\n  },\r\n  'Verminlord Corruptor': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Lord of Pestilence'])],\r\n      spells: [keyPicker(spells, ['Dreaded Plague'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    //  ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `Lord of Great Plagues - Once Per Turn`,\r\n        desc: `Effect: If the unmodified chanting roll for a friendly Pestilens Priest this phase was 6, pick 1 of the following effects to apply: \r\n        Crimsonweal Curse: Pick an enemy unit within 13\" of this unit to be the target. For the rest of the battle, each time the target uses a Move ability, inflict D3 mortal damage on it after the Move ability has been resolved. \r\n        The Neverplague: For the rest of the battle, you can re-roll chanting rolls for friendly Pestilens Priests. \r\n        Undulant Scourge: Pick a visible enemy unit within 13\" of this unit to be the target. Inflict 2D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Plaguemaster - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll.  \r\n        Give this unit 1 ritual point.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Grey Seer on Screaming Bell': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Cracks Call'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     // ...AltarOfTheHornedRatEffects,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Crushing Bulk is 4.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n      {\r\n        name: `Altar of the Horned Rat - Passive`,\r\n        desc: `Effect: Friendly Skaven Infantry units have Ward (6+) while they are wholly within 6\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Cracks Call: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit that does not have Fly and is within 13\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: If the casting roll exceeds the targets Move characteristic, inflict an amount of mortal damage on the target equal to the difference between the casting roll and its Move characteristic.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Peal of Doom`,\r\n        desc: `Effect: Roll a dice and apply the corresponding effect: \r\n        1 Magical Backlash: Inflict D3 mortal damage on this unit. \r\n        2-4 Wall of Unholy Sound: Until the start of your next turn, subtract 1 from hit rolls for combat attacks made by enemy units while they are within 13\" of this unit. \r\n        5-6 Apocalyptic Doom: Roll a D3 for each enemy unit within 13\" of this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hell Pit Abomination': {\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Gnashing Teeth and Flailing Fists is 8.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Avalanche of Flesh - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // RegeneratingMonstrosityEffect,\r\n      {\r\n        name: `Regenerating Monstrosity`,\r\n        desc: `Effect: Heal (D6) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Too Horrible to Die - Passive`,\r\n        desc: `Effect: The first time this unit would be destroyed, before removing it from the battlefield, roll a dice and apply the corresponding effect: \r\n        1 Dead: This unit is destroyed. \r\n        2-4 The Rats Emerge: Roll a D3 for each enemy unit in combat with this unit. On a 2+, inflict an amount of mortal damage on that unit equal to the roll. Then, this unit is destroyed. \r\n        5-6 Its Alive!: This unit is not destroyed and any remaining damage points inicted on it have no effect. Then, Heal (D6) this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Master Moulder': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Unleash More-more Beasts!'])],\r\n    }, */\r\n    effects: [\r\n     // CrackTheWhipEffect,\r\n      {\r\n        name: `Lord of Flesh-Grafting`,\r\n        desc: `Declare: Pick another friendly Moulder unit wholly within 13\" of this unit to be the target. \r\n        Effect: Heal (3) the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Tyrannical Packmaster`,\r\n        desc: `Declare: Pick another friendly Moulder unit within this units combat range to be the target. \r\n        Effect: Add 2 to charge rolls for the target for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Giant Rats': {\r\n    effects: [\r\n      {\r\n        name: `Wave of Rats`,\r\n        desc: `Improve the Rend characteristic of this unit's Vicious Teeth by 1 if it has 3-5 models. Improve the Rend characteristic of this unit's Vicious Teeth by 2 instead of 1 if it has 6 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rat Swarms': {\r\n    effects: [\r\n      {\r\n        name: `Endless Tide of Rats`,\r\n        desc: `At the end of the battleshock phase, you can return 1 slain model to this unit.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Rat Ogors': {\r\n    effects: [\r\n      {\r\n        name: `Unleashed Warp-Fury`,\r\n        desc: `Effect: Inflict D3 mortal damage on this unit. Then, add 1 to the Attacks characteristic of this units melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Packmasters: {\r\n    effects: [CrackTheWhipEffect],\r\n  }, */\r\n  'Verminlord Deceiver': {\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Lord of Assassins'])],\r\n      spells: [keyPicker(spells, ['Dreaded Skitterleap'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n     // ProtectionOfTheHornedRatEffect,\r\n      {\r\n        name: `Lord of Assassins - Reaction: You declared the Redeploy command for a friendly Eshin Infantry unit wholly within 13\" of this unit`,\r\n        desc: `Effect: If you roll a 1-3 when determining the distance that unit can move, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Burst from the Shadows - Once Per Turn`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 4+, you can pick a point on the battlefield within 13\" of this unit and within 1\" of any enemy units. Remove this unit from the battlefield and set it up again within 1\" of that point.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Deathmaster: {\r\n    effects: [\r\n      {\r\n        name: `Shadowy Killers - Passive`,\r\n        desc: `Effect: If the unmodified hit roll for an attack that targets this unit is 1-4, the attack fails and the attack sequence ends.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Running Death - Passive`,\r\n        desc: `Effect: While friendly Eshin units are wholly within 13\" of this unit, they can use Shoot and/or Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     // EshinToxinsEffect,\r\n     // RunningDeathEffect,\r\n    ],\r\n  },\r\n  'Night Runners': {\r\n    effects: [\r\n      {\r\n        name: `Sneaky Infiltrators - Passive`,\r\n        desc: `Effect: While each model in this unit is within 1\" of any terrain features, this unit cannot be targeted by shooting attacks unless the attacking model is within 9\" of it.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // RunningDeathEffect,\r\n      {\r\n        name: `Slinking Advance`,\r\n        desc: `Effect: This unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      //EshinToxinsEffect,\r\n    ],\r\n  },\r\n  'Ratling Warpblaster': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelming Fire - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this units shooting attacks that target an enemy unit that has 10 or more models.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n     // RunningDeathEffect,\r\n      {\r\n        name: `More-More Warpstone Bullets - Once Per Turn`,\r\n        desc: `Effect: If this unit is within the combat range of a friendly Skryre Hero, this units Hail of Warpstone Bullets has an Attacks characteristic of 6D6+3 instead of 3D6+3 for the rest of the turn. However, for each unmodified hit roll of 1 for an attack made with this units Hail of Warpstone Bullets, inflict 1 mortal damage on this unit after the Shoot ability has been resolved.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      //EshinToxinsEffect,\r\n    ],\r\n  },\r\n  'Clawlord on Gnaw-Beast': {\r\n    effects: [\r\n      {\r\n        name: `Cornered Rat - Passive`,\r\n        desc: `Effect: While each model in this unit is within 1\" of any terrain features, this unit cannot be targeted by shooting attacks unless the attacking model is within 9\" of it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // RunningDeathEffect,\r\n      {\r\n        name: `Cruel Commander`,\r\n        desc: `Declare: Pick a friendly non-Hero Verminus Infantry unit wholly within 13\" of this unit to be the target. \r\n        Effect: Inflict 1 mortal damage on the target. Then, add 5 to the targets control score until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      //EshinToxinsEffect,\r\n    ],\r\n  },\r\n /* 'Gutter Runners': {\r\n    effects: [\r\n    //  GenericEffects.Elite,\r\n    // RunningDeathEffect,\r\n      {\r\n        name: `Sneaky Infiltrators`,\r\n        desc: `During deployment, instead of setting up this unit on the battlefield, you can place it to one side and say that it is infiltrating the foe as a reserve unit. If you do so, at the end of your first movement phase, you must set up this unit wholly within 6\" of a terrain feature and more than 9\" from all enemy units.`,\r\n        when: [START_OF_SETUP, TURN_ONE_END_OF_MOVEMENT_PHASE],\r\n      },\r\n     // EshinToxinsEffect,\r\n    ],\r\n  }, */\r\n /* 'Skabbik Plagueseeker': {\r\n    mandatory: {\r\n      prayers: [keyPicker(prayers, ['Befoul-befoul!'])],\r\n    },\r\n    effects: [FrenziedAssaultEffect, PoisonousFumesEffect],\r\n  },\r\n  \"Skabbik's Plaguepack\": {\r\n    effects: [\r\n      {\r\n        name: `Rabidius Skench`,\r\n        desc: `1 model in this unit is Rabidius Skench. That model is armed with a Plague Censer instead of Plaguepack Weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skritter`,\r\n        desc: `1 model in this unit is Skritter. That model is armed with an Aura of Corruption instead of Plaguepack Weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aura of Corruption`,\r\n        desc: `Do not use the attack sequence for an attack made with an Aura of Corruption. Instead, roll a dice for each enemy unit that is within range. On a 4+, that unit suffers D3 mortal wounds.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ruinous Supremacy`,\r\n        desc: `While this unit contests a befouled objective, enemy models cannot contest that objective (see Befoul-befoul! on the Skabbik Plagueseeker warscroll).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: Brand`s Oathbound': {\r\n    effects: [\r\n      {\r\n        name: `Gunnar Brand: Carve a Path to Glory`,\r\n        desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n        Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n      {\r\n        name: `Gunnar Brand: Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Singri Brand: Swift as the Wind - Passive`,\r\n        desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },  \r\n      {\r\n        name: `Singri Brand: Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn Kin: Withering Death: Casting value of 5`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n      {\r\n        name: `Oathsworn Kin: Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of the Gods - Once Per Turn`,\r\n        desc: `Effect: If any enemy Heroes were slain this turn by the Gunnar Brand in this Regiment of Renown:  \r\n        Heal (5) each unit in this Regiment of Renown.  \r\n        Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: The Coven of Thryx': {\r\n    effects: [\r\n      {\r\n        name: `Magister: Magic-Touched`,\r\n        desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n        Add 1 to this units power level.  \r\n        If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pink Horrors: Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tome of Eyes: Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      }, \r\n      {\r\n        name: `Burning SIgil of Tzeentch: Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sparks of Profane Potential - Once Per Battle`,\r\n        desc: `Effect: If the Magister in the Regiment of Renown has been deployed, set up one of the following Manifestations within 1\" of them:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Skilled Summoner: Casting value of 6`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick 1 of the Manifestations from the list below that is not on the battlefield, then make a casting roll of 2D6:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum \r\n        Effect: If there is already a friendly Manifestation from the list above on the battlefield, it is immediately banished. Then, set up the Manifestation you picked within 1\" of the caster and visible to them. If that Manifestation is a Daemonic Simulacrum, it must also be set up more than 9\" away from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flickering Wyrdflame - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points inflicted on it this turn by Wyrdflame Spell abilities or attacks made with weapons that have the Wyrdflame weapon ability to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport { SKAVEN } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport BattleTraits from './battle_traits'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Prayers from './prayers'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [SKAVEN]: {\r\n    effects: pickEffects(BattleTraits, [SKAVEN]),\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battle_tactics: [BattleTactics],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n      prayers: [Prayers],\r\n      scenery: [Scenery],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { SKAVEN } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SkavenFaction = new Faction(SKAVEN, CHAOS, SubFactions, 'Battle Formations', rule_sources.BATTLETOME_SKAVEN)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SLAANESH } from 'meta/factions'\r\nimport {\r\n  DURING_GAME,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_ROUND,\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [SLAANESH]: {\r\n    effects: [\r\n      {\r\n        name: `An Excess of Depravity`,\r\n        desc: `Declare: Pick up to 3 friendly Hedonites of Slaanesh units to be the targets. \r\n        Effect: The targets have the Euphoric keyword for the rest of the battle round. \r\n        In addition, for each friendly unit you pick, give your opponent 1 temptation dice. Your opponent can use 1 temptation dice to replace 1 wound roll, 1 save roll, 1 ward roll or 1 run roll for a unit in their army with a 6, or they can use 2 temptation dice to replace 2 of the dice in a charge roll for a unit in their army with two 6s. \r\n        Each time your opponent uses a temptation dice, they must roll it. On a 1-2, inflict D3 mortal damage on the unit for which the roll was replaced immediately after the ability used by that unit has been resolved. \r\n        At the end of the battle round, any temptation dice that have not been used are lost.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Euphoric Killers - Passive`,\r\n        desc: `Effect: While a friendly unit has the Euphoric keyword:  \r\n        That units weapons have Crit (2 Hits).  \r\n        That unit can use a Run ability and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Fane of Slaanesh (Faction Terrain) - Damned Conduit`,\r\n        desc: `Declare: Pick a friendly Hedonites of Slaanesh unit wholly within 12\" of this terrain feature to be the target. \r\n        Effect: Allocate D3 damage points to the target (ward rolls cannot be made for those damage points). Then, pick 1 of the following effects to apply until the start of your next turn:  \r\n        Add 1 to wound rolls for the targets combat attacks.  \r\n        Add 1 to run rolls and charge rolls for the target.  \r\n        Add 1 to casting rolls and unbinding rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SLAANESH: {\r\n    name: 'Battletome: Hedonites of Slaanesh',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/05/W7v5cwPeasHlHU6e.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_TURN,\r\n  MOVEMENT_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  TURN_ONE_START_OF_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  // Invaders Host\r\n  'Threnody Voicebox': {\r\n    effects: [\r\n      {\r\n        name: `Threnody Voicebox - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, subtract 1 from the Attacks characteristic of melee weapons used by enemy units while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Icon of Infinite Excess': {\r\n    effects: [\r\n      {\r\n        name: `Icon of Infinite Excess - Once Per Battle`,\r\n        desc: `Declare: Pick a non-Hero Hedonites of Slaanesh unit wholly within 12\" of this unit to be the target. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pendant of Slaanesh': {\r\n    effects: [\r\n      {\r\n        name: `Pendant of Slaanesh`,\r\n        desc: `Effect: If any damage points were allocated to this unit this turn, Heal (3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  // Pretenders Host\r\n /* 'The Crown of Dark Secrets': {\r\n    effects: [\r\n      {\r\n        name: `The Crown of Dark Secrets`,\r\n        desc: `At the start of your first hero phase, pick 1 enemy unit on the battlefield. For the rest of the battle, while that unit is within 6\" of the bearer, the Attacks characteristic of that unit's melee weapons is 1.`,\r\n        when: [TURN_ONE_START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sceptre of Domination': {\r\n    effects: [\r\n      {\r\n        name: `Sceptre of Domination`,\r\n        desc: `At the start of the combat phase, roll a dice for each enemy unit within 3\" of the bearer. On a 5+, the strike-last effect applies to that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Breathtaker: {\r\n    effects: [\r\n      {\r\n        name: `Breathtaker`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If an enemy model is slain by an attack made with that weapon, all effects that would be triggered when that model is slain are ignored.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Godseekers Host\r\n  'Cameo of the Dark Prince': {\r\n    effects: [\r\n      {\r\n        name: `Cameo of the Dark Prince`,\r\n        desc: `Once per battle, at the start of your hero phase, you can say that the bearer will gaze upon the cameo. If you do so, until the end of that turn, the bearer can issue commands to friendly HEDONITES OF SLAANESH units without any command points being spent.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Girdle of the Realm-racer': {\r\n    effects: [\r\n      {\r\n        name: `Girdle of the Realm-racer`,\r\n        desc: `The bearer can fly.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Girdle of the Realm-racer`,\r\n        desc: `The bearer is eligible to fight in the combat phase if they are within 6\" of any enemy units instead of 3\", and they can move an extra 3\" when they pile in.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Threnody Voicebox': {\r\n    effects: [\r\n      {\r\n        name: `Threnody Voicebox`,\r\n        desc: `Once per battle, at the start of the combat phase, you can say that the bearer will play their melody. If you do so, until the end of that phase, subtract 1 from the Attacks characteristic of melee weapons used by enemy units within 6\" of the bearer (to a minimum of 1).`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { ExpertBattalionEffect, SlayersBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\n\r\nconst Battalions = {\r\n/*  'Epicurean Revellers': {\r\n    effects: [OneDropDeploymentEffect, SlayersBattalionEffect],\r\n  },\r\n  'Nobles of Excess': {\r\n    effects: [ExpertBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Death by a Thousand Cuts': {\r\n    effects: [\r\n      {\r\n        name: 'Death by a Thousand Cuts',\r\n        desc: `Pick 1 enemy unit. You complete this tactic if wounds caused by attacks made by 3 or more different friendly units are allocated to that unit in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'An Enrapturing Blur': {\r\n    effects: [\r\n      {\r\n        name: `An Enrapturing Blur`,\r\n        desc: `Pick 1 enemy HERO that has no wounds allocated to them. You complete this tactic if that unit is destroyed in the combat phase of this turn before it is picked to fight.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Grand Feast': {\r\n    effects: [\r\n      {\r\n        name: `The Grand Feast`,\r\n        desc: `You complete this tactic if you receive 12 or more depravity points from the Euphoric Killers battle trait during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Excessive Carnage': {\r\n    effects: [\r\n      {\r\n        name: `Excessive Carnage`,\r\n        desc: `Pick 1 enemy unit that is contesting an objective. You complete this tactic if you pick that unit using the Euphoric Killers battle trait (pg 79) and that unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Realm-racers': {\r\n    effects: [\r\n      {\r\n        name: `Realm-racers`,\r\n        desc: `You complete this tactic if 3 or more different friendly HEDONITES OF SLAANESH units make a charge move of 7\" or more during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Depraved Unity': {\r\n    effects: [\r\n      {\r\n        name: `Depraved Unity`,\r\n        desc: `Pick 1 objective that you do not control. You complete this tactic if you control that objective at the end of this turn and at least 1 friendly HEDONITES OF SLAANESH MORTAL unit and 1 friendly HEDONITES OF SLAANESH DAEMON unit are contesting that objective.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  // Invaders Host - Obessions of the Invader\r\n  'Strongest Alone': {\r\n    effects: [\r\n      {\r\n        name: `Strongest Alone - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units attacks while it is more than 6\" from all other friendly units.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glory Hog': {\r\n    effects: [\r\n      {\r\n        name: `Glory Hog - Passive`,\r\n        desc: `Effect: If an enemy Hero is destroyed by this unit, this unit has the Euphoric keyword for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Into the Fray': {\r\n    effects: [\r\n      {\r\n        name: `Into the Fray - Passive`,\r\n        desc: `Effect: If this unit charged this turn and the unmodified charge roll was 8+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Pretenders Host - Aspects of the Perfect Liege\r\n /* 'Strength of Godhood': {\r\n    effects: [\r\n      {\r\n        name: `Strength of Godhood`,\r\n        desc: `If this general issues a command to a different friendly HEDONITES OF SLAANESH unit, until the end of the turn, improve the Rend characteristic of this general's melee weapons by 1 and add 1 to the Damage characteristic of this general's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Monarch of Lies': {\r\n    effects: [\r\n      {\r\n        name: `Monarch of Lies`,\r\n        desc: `Roll a dice each time an enemy unit receives a command within 6\" of this general. On a 5+, that command is not received (it still counts as having been used) and the command point that was spent to issue that command is lost.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Strongest Alone': {\r\n    effects: [\r\n      {\r\n        name: `Strongest Alone`,\r\n        desc: `Add 1 to hit rolls and wound rolls for this general while they are more than 6\" from all other friendly units.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Godseekers Host\r\n  'Hunter Supreme': {\r\n    effects: [\r\n      {\r\n        name: `Hunter Supreme`,\r\n        desc: `MONSTER only: Enemy units within 3\" of this general cannot make pile-in moves if this general made a charge move in the same turn. In addition, add 1 to the Attacks characteristic of this general's melee weapons if they made a charge move in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Into the Fray': {\r\n    effects: [\r\n      {\r\n        name: `Into the Fray`,\r\n        desc: `The strike-first effect applies to this general if they made a charge move in the same turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Speed-chaser': {\r\n    effects: [\r\n      {\r\n        name: `Speed-chaser`,\r\n        desc: `After this general makes a charge move, you can pick 1 enemy unit within 1\" of this general and roll a number of dive equal to the charge roll for that charge move. For each 4+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  \"Depraved Carnival\": {\r\n    effects: [\r\n      {\r\n        name: `The Ecstatic Throngs - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for friendly Sybarite Infantry units while they are damaged or if they had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Seeker Cavalcade': {\r\n    effects: [\r\n      {\r\n        name: `NImble and Quick - Passive`,\r\n        desc: `Effect: Friendly Hedonites of Slaanesh Cavalry units can use a Retreat ability and still use Charge abilities later in the turn. In addition, no mortal damage is inflicted on Hedonites of Slaanesh Cavalry units by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Epicurean Revellers\": {\r\n    effects: [\r\n      {\r\n        name: `Exquistite Palate - Passive`,\r\n        desc: `Effect: Each time a friendly non-Hero Hedonites of Slaanesh Daemon uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Supreme Sybarites': {\r\n    effects: [\r\n      {\r\n        name: `Godly Ambitions - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of friendly non-Hero Hedonites of Slaanesh units while they are within the combat ranges of any friendly Hedonites of Slaanesh Heroes.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst EndlessSpells = {\r\n /* 'Wheels of Excruciation': {\r\n    effects: [\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 12\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Hedonites of Slaanesh Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Exquisite Agony`,\r\n        desc: `After this endless spell has moved, roll 6 dice for each unit that has any models it passed across. For each roll that is less than that unit's unmodified Save characteristic, that unit suffers 1 mortal wound. This ability has no effect on Hedonites of Slaanesh units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mesmerising Mirror': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6 and a range of 18\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Hedonites of Slaanesh Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irresistible Lure`,\r\n        desc: `If a unit starts a normal move, run or retreat within 12\" of this endless spell, that unit suffers D3 mortal wounds unless it finishes that move closer to this endless spell than it was at the start of the move. This ability has no effect on Hedonites of Slaanesh units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Gaze Not into its Depths`,\r\n        desc: `At the end of the movement phase, roll 6 dice for each unit within 6\" of this endless spell. For each 6, that unit's commanding player must choose whether that unit gazes into the mirror or resists temptation. If it resists temptation, that unit suffers D3 mortal wounds. If it gazes into the mirror, the player who summoned this endless spell gains D3 depravity points. This ability has no effect on friendly units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAANESH, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n    ],\r\n  },\r\n  'Dreadful Visage': {\r\n    effects: [\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7 and a range of 12\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Hedonites of Slaanesh Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flensing Tongues`,\r\n        desc: `After this endless spell has moved, roll 6 dice for the closest unit within 6\" of it. If more than 1 unit is equally close, the commanding player can choose which unit to roll for. For each 4+, that unit suffers 1 mortal wound. In addition, if any mortal wounds caused by this ability are allocated to that unit, the strike-last effect applies to that unit until the end of the following combat phase.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Terrifying Entity`,\r\n        desc: `Subtract 1 from the Bravery characteristic of units while they are within 12\" of this endless spell. Add 1 to the Bravery characteristic of Hedonites of Slaanesh units while they are within 12\" of this endless spell instead.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Coveted Riches': {\r\n    effects: [\r\n      {\r\n        name: `Coveted Riches`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no enemy units with artefacts of power on the battlefield and there are 1 or more friendly units with artefacts of power on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Arch-tempter': {\r\n    effects: [\r\n      {\r\n        name: `Arch-tempter`,\r\n        desc: `When the battle ends, you complete this grand strategy if you offered a Temptation Dice to your opponent for the same enemy unit 6 or more times during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Selfish Desire': {\r\n    effects: [\r\n      {\r\n        name: `Selfish Desire`,\r\n        desc: `When the battle ends, you complete this grand strategy if you did not summon any units using the Summon Slaaneshi Daemons battle trait (pg 79) during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Glutton for Depravity': {\r\n    effects: [\r\n      {\r\n        name: `Glutton for Depravity`,\r\n        desc: `When the battle ends, you complete this grand strategy if you have 36 or more unspent depravity points.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { END_OF_MOVEMENT_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\n\r\nconst Scenery = {\r\n /* 'Fane of Slaanesh': {\r\n    effects: [\r\n      GenericEffects.FactionTerrainSetup,\r\n      GenericEffects.Impassable,\r\n      {\r\n        name: `Power of Slaanesh`,\r\n        desc: `If you spend depravity points to summon a Hedonites of Slaanesh Daemon unit to the battlefield, you can set up that unit wholly within 12\" of this terrain feature and more than 9\" from all enemy units instead of wholly within 12\" of a Hedonites of Slaanesh Hero and more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Damned Conduit`,\r\n        desc: `At the start of your hero phase, you can pick 1 friendly Hedonites of Slaanesh Hero within 6\" of this terrain feature to make a sacrifice. If you do so, that Hero suffers 1 mortal wound and you must roll a dice. On a 2+, add 1 to wound rolls for attacks made by that Hero until your next hero phase.\r\n\r\n        If the Hero you picked has an artefact of power, instead of suffering 1 mortal wound, they can sacrifice that artefact of power. If they do so, that artefact of power can no longer be used and you must roll a dice. On a 2+, add 1 to wound rolls for attacks made by that Hero for the rest of the battle.\r\n\r\n        Designer's Note: You can sacrifice any artefacts of power, including those that can only be used a limited number of times during a battle and those that have already been used. If the artefact of power was used to enhance a weapon, that weapon reverts to its normal form. `,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of Extravagance': {\r\n    effects: [\r\n      {\r\n        name: `Sadistic Spite: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Hedonites of Slaanesh Wizard to cast this spell, pick a visible friendly Euphoric unit to be the target, then make a casting roll of 2D6. \r\n        Effect: The targets melee weapons have Crit (Mortal) instead of Crit (2 Hits) for the rest of the battle round.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Overwhelming Acquiescence: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Hedonites of Slaanesh Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Add 1 to wound rolls for attacks that target that enemy unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Phantasmagoria: Casting value of 5`,\r\n        desc: `Declare: Pick a friendly Hedonites of Slaanesh Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, each time the target is picked to use a Fight ability, before reactions are used, you can pick a friendly unit in combat with the target. That friendly unit can move 2D3\". It can pass through the combat ranges of enemy units and can end that move in combat.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Pavane of Slaanesh': {\r\n    effects: [\r\n      {\r\n        name: `Pavane of Slaanesh`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster, and roll a number of dice equal to that unit's Move characteristic. For each 5+, subtract 1\" from that unit's Move characteristic (to a minimum of 1\") for the rest of the battle. Ihe same unit cannot be affected by this ability more than once per battle.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hysterical Frenzy': {\r\n    effects: [\r\n      {\r\n        name: `Hysterical Frenzy`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster, and roll a number of dice equal to that unit's Bravery characteristic. For each 6, that unit suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* 'Soulslice Shards': {\r\n    effects: [\r\n      {\r\n        name: `Soulslice Shards`,\r\n        desc: `Casting value of 5 and a range of 12. Pick 1 enemy unit within range and visible to the caster, and roll 2D6. If the roll is greater than that unit's Bravery characteristic, that unit cannot issue or receive commands until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Phantasmagoria: {\r\n    effects: [\r\n      {\r\n        name: `Phantasmagoria`,\r\n        desc: `Casting value of 5 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, each time that unit is picked to fight, roll a dice. On a 3+, you can pick 1 friendly Hedonites of Slaanesh unit within 3\" of that unit. That friendly unit can retreat before that enemy unit piles in.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Born of Damnation': {\r\n    effects: [\r\n      {\r\n        name: `Born of Damnation`,\r\n        desc: `Casting value of 6. If successfully cast, roll 6 dice. For each 4+, you receive 1 depravity point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Paths of the Dark Prince': {\r\n    effects: [\r\n      {\r\n        name: `Paths of the Dark Prince`,\r\n        desc: `Casting value of 5. If successfully cast, roll 3D6 instead of 2D6 when making a charge roll for the caster until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Progeny of Damnation': {\r\n    effects: [\r\n      {\r\n        name: `Progeny of Damnation`,\r\n        desc: `Casting value of 5 and a range of 12\". Pick 1 friendly HEDONITES OF SLAANESH unit wholly within range and visible to the caster. Until your next hero phase, if that unit finishes a normal move, run or retreat within 9\" of any enemy units, those units cannot receive the Redeploy command.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slothful Stupor': {\r\n    effects: [\r\n      {\r\n        name: `Slothful Stupor`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, the Move characteristic of that unit is 3\" and all run rolls and charge rolls for that unit are treated as being 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cacophonic Choir': {\r\n    effects: [\r\n      {\r\n        name: `Cacophonic Choir`,\r\n        desc: `Casting value of 6 and a range of 6\". If successfully cast, roll 2D6. Each enemy unit within range that has a Bravery characteristic of less than the roll suffers D3 mortal wounds (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Acquiescence: {\r\n    effects: [\r\n      {\r\n        name: `Acquiescence`,\r\n        desc: `Casting value of 5 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Add 1 to wound rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Subvert: {\r\n    effects: [\r\n      {\r\n        name: `Subvert`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit cannot issue or receive commands until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Refine Senses': {\r\n    effects: [\r\n      {\r\n        name: `Refine Senses`,\r\n        desc: `Casting value of 4. If successfully cast, until your next hero phase, add 1 to hit rolls and wound rolls for attacks made by the caster that target an enemy Hero and add 1 to save rolls for attacks made by enemy Heroes that target the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Overwhelming Acquiescence': {\r\n    effects: [\r\n      {\r\n        name: `Overwhelming Acquiescence`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick up to D3 different enemy units within range and visible to the caster. Add 1 to wound rolls for attacks that target those units until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crippling Famishment': {\r\n    effects: [\r\n      {\r\n        name: `Crippling Famishment`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, halve the Move characteristic of that unit, and halve run rolls and charge rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reflection Eternal': {\r\n    effects: [\r\n      {\r\n        name: `Reflection Eternal`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1) until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Whispers of Doubt': {\r\n    effects: [\r\n      {\r\n        name: `Whispers of Doubt`,\r\n        desc: `Casting value of 6. Pick 1 enemy Hero visible to the caster and roll 3D6. If the roll is equal to or greater than that Hero's Bravery characteristic, add 1 to hit rolls and wound rolls for attacks that target that Hero until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\nimport Spells from './spells'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/*const BannerBearerEffect = {\r\n  name: `Banner Bearer`,\r\n  desc: `Add 1 to run rolls and charge rolls for this unit if it includes any Banner Bearers.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst IconBearerEffect = {\r\n  name: `Icon Bearer`,\r\n  desc: `If this unit receives the Rally command while it includes any Icon Bearers, when you roll a dice for a slain model from this unit, you can return 1 slain model to this unit on a 5+ instead of a 6.`,\r\n  when: [START_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in a Hedonites of Slaanesh army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst SoulscentEffect = {\r\n  name: `Soulscent`,\r\n  desc: `At the start of the combat phase, roll a dice for each enemy unit within 1\" of this unit. On a 4+, that unit suffers D3 mortal wounds. In addition, for each 4+, add 1 to the Attacks characteristic of this unit's melee weapons until the end of that phase. If that enemy unit has 10 or more models, both of the effects of this ability trigger on a 3+ instead.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst DarkTemptationsEffect = {\r\n  name: `Dark Temptations`,\r\n  desc: `Once per turn, at the start of the combat phase, if any friendly units with this ability are on the battlefield, you can pick 1 enemy unit within 3\" of a friendly unit with this ability. If you do so, your opponent must choose whether that unit resists or gives in to temptation. If it resists, that unit suffers D3 mortal wounds. If it gives in, you gain D3 depravity points.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst DelicatePrecisionEffect = {\r\n  name: `Delicate Precision`,\r\n  desc: `If the unmodified wound roll for an attack made by this unit is 6, that attack causes a number of mortal wounds to the target equal to the weapon's Damage characteristic and the attack sequence ends (do not make a save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst SinistrousHandEffect = {\r\n  name: `Sinistrous Hand`,\r\n  desc: `If this unit is armed with a Sinistrous Hand, at the end of the combat phase, if any enemy models were slain by wounds caused by this unit's attacks in that phase, you can heal up to 3 wounds allocated to this unit. If any enemy Heroes were slain by wounds caused by this unit's attacks in that phase, you can heal up to 6 wounds allocated to this unit instead.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst LivingWhipEffect = {\r\n  name: `Living Whip`,\r\n  desc: `If this unit is armed with a Living Whip, at the start of the combat phase, you can pick 1 enemy unit within 6\" of this unit and roll a dice. On a 2+, subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1) until the end of that phase. The same unit cannot be affected by this ability more than once per phase.`,\r\n  when: [START_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst ShiningAegisEffect = {\r\n  name: `Shining Aegis`,\r\n  desc: `If this unit is armed with a Shining Aegis, it has a ward of 5+.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst LitheAndSwiftEffect = {\r\n  name: `Lithe and Swift`,\r\n  desc: `This unit can run and still charge later in the same turn.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst HornBlowerEffect = {\r\n  name: `Musician`,\r\n  desc: `You can reroll failed battleshock tests for this unit if it includes any Hornblowers.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst HighTempterEffect = {\r\n  name: `High Tempter`,\r\n  desc: `1 model in this unit can be a High Tempter. Add 1 to the Attacks characteristic of that model's Blissbarb Bow.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst MesmerisingLepidopteraEffect = {\r\n  name: `Mesmerising Lepidoptera`,\r\n  desc: `Subtract 1 from hit rolls for attacks that target this unit.`,\r\n  when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst ImpossiblySwiftEffect = {\r\n  name: `Impossibly Swift`,\r\n  desc: `This model can retreat and still charge later in the same turn.`,\r\n  when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst ExcessOfBladesEffect = {\r\n  name: `Excess of Blades`,\r\n  desc: `After this unit finishes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a number of dice equal to the charge roll for that charge move. For each roll that is greater than that enemy unit's Save characteristic, that unit suffers 1 mortal wound.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n} */\r\n\r\n// Unit Names\r\nconst Units = {\r\n  'Keeper of Secrets': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Cacophonic Choir'])],\r\n    }, */\r\n    effects: [\r\n     /* DarkTemptationsEffect,\r\n      DelicatePrecisionEffect,\r\n      LivingWhipEffect,\r\n      ShiningAegisEffect,\r\n      SinistrousHandEffect,\r\n      GenericEffects.WizardTwoSpellsEffect, */\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Elegant Greatblade is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Supernatural Grace - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks that target this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Locus of Slaanesh`,\r\n        desc: `Declare: Pick a friendly Hedonites of Slaanesh Daemon unit that started the battle with 3 or more models and has been destroyed to be the target. \r\n        Effect: Roll a dice. On a 4+, set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dark Temptations - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Pick 1 of the following effects:  \r\n        Add 1 to hit rolls for the targets attacks for the rest of the turn.  \r\n        Add 1 to save rolls for the target for the rest of the turn.  \r\n        If the target is damaged, Heal (D3) the target. \r\n        Then, add 1 to the Damage characteristic of this units Elegant Greatblade for attacks that target that enemy unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Cacophonic Choir: Casting value of 6`,\r\n        desc: `Declare: Pick up to 3 visible enemy units within 6\" of this unit to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a dice for each target. If the roll exceeds the targets Control characteristic, inflict D3 mortal damage on it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Syll'Esske, the Vengeful Allegiance\": {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Subvert'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     // WarmasterEffect,\r\n      {\r\n        name: `Deadly Symbiosis`,\r\n        desc: `Declare: Pick a friendly non-Hero Sybarite unit and a friendly non-Hero Hedonites of Slaanesh Daemon unit to be the targets. Both units must be wholly within 12\" of this unit. \r\n        Effect: For the rest of the turn, if either target uses the All-out Attack or All-out Defence command, the other target can also use the same command in the same phase and no command points are spent to use the command a second time.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // LitheAndSwiftEffect,\r\n      {\r\n        name: `The Vengeful Allegiance - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Subvert: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: The target cannot use commands for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shalaxi Helbane': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Refine Senses'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Soulpiercer is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Supernatural Grace - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks that target this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  DelicatePrecisionEffect,\r\n      {\r\n        name: `Refine Senses: Casting value of 4`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: For the rest of the turn:  \r\n        Add 1 to wound rolls for this units attacks that target enemy Heroes.  \r\n        Add 1 to save rolls for attacks made by enemy Heroes that target this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // LivingWhipEffect,\r\n     // ShiningAegisEffect,\r\n      {\r\n        name: `Paramount Hunter - Once Per Turn - Reaction: Opponent declared a Charge ability for a Hero within 9\" of this unit`,\r\n        desc: `Effect: If this unit is not in combat, it can immediately move 2D6\". It can pass through the combat ranges of enemy units but it must end that move within 1/2\" of that Hero. If it does so, this unit has charged, and that Heros Charge ability has no effect.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Excess of Violence - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Hero Hedonites of Slaanesh unit wholly within 12\" of this unit to be the target. \r\n        Effect: The target can use 2 Fight abilities this turn. After the first is used, however, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'The Contorted Epitome': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Overwhelming Acquiescence'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Swallow Energy - Passive`,\r\n        desc: `Effect: If you make a successful ward roll for this unit, add 1 to this units power level until the end of your next turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Horrible Fascination - Reaction: Opponent declared a command or Retreat ability for a unit in combat with this unit`,\r\n        desc: `Effect: Inflict D3 mortal damage on that enemy unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'Infernal Enrapturess, Herald of Slaanesh': {\r\n    effects: [\r\n      {\r\n        name: `Discordant Disruption - Once Per Turn - Reaction: Opponent declared a Spell ability for a Wizard within 18\" of this unit`,\r\n        desc: `Effect: The casting roll for that spell must be re-rolled. If 2 or more dice in the re-rolled casting roll have the same value or if 1 of the dice is a 6, inflict D3 mortal damage on that Wizard after the effect of that spell has been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Masque': {\r\n    effects: [\r\n      {\r\n        name: `Staff of Masks`,\r\n        desc: `Effect: Pick 1 of the following effects:  \r\n        Add 3 to the Attacks characteristic of this units Razor-edged Claws for the rest of the turn.  \r\n        Heal (3) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Endless Dance`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n     // LitheAndSwiftEffect,\r\n    ],\r\n  },\r\n /* 'Viceleader, Herald of Slaanesh': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Acquiescence'])],\r\n    }, \r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Lightning Reflexes`,\r\n        desc: `This unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n     // LitheAndSwiftEffect,\r\n      {\r\n        name: `Lust for Violence`,\r\n        desc: `In the combat phase, when you pick this unit to fight for the first time in that phase, you can pick 1 friendly Daemonette Host unit wholly within 12\" of this unit that has not yet fought in that phase. This unit and that Daemonette Host unit can fight one after the other in the order of your choice.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n /* 'Bladebringer, Herald on Hellflayer': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Acquiescence'])],\r\n    }, \r\n    effects: [\r\n      //SoulscentEffect,\r\n      {\r\n        name: `Slavering for Sensation`,\r\n        desc: `While friendly Hellflayer units are wholly within 12\" of any friendly units with this ability, their Soulscent ability causes D3 mortal wounds on a 3+ instead of 4+.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAANESH, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  }, */\r\n /* 'Bladebringer, Herald on Seeker Chariot': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Acquiescence'])],\r\n    }, \r\n    effects: [\r\n      //ImpossiblySwiftEffect,\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Mutilating Blades`,\r\n        desc: `After this unit finishes a charge move, roll a dice for each enemy unit within 1\" of this unit. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Thrillseeker`,\r\n        desc: `While friendly Seeker Chariot units are wholly within 12\" of any friendly units with this ability, add 1 to the number of mortal wounds caused by their Mutilating Blades ability.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Hellflayer: {\r\n    effects: [\r\n    //  SoulscentEffect\r\n    {\r\n      name: `Soulscent`,\r\n      desc: `Declare: Pick up to 3 enemy units that this unit passed across this phase to be the targets. \r\n      Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If any models are slain by this ability, this unit has Ward (5+) for the rest of the turn.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    {\r\n      name: `Threshing Doom - Passive`,\r\n      desc: `Effect: When this unit moves, it can pass through models in enemy Infantry units and can pass through the combat ranges of enemy Infantry units, but it cannot end a move in combat unless specified in the ability used.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    \r\n    ],\r\n  },\r\n  'Seeker Chariots': {\r\n    effects: [\r\n     // ImpossiblySwiftEffect,\r\n      {\r\n        name: `Mutilating Blades`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bladebringer, Herald on Exalted Chariot': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Acquiescence'])],\r\n    },*/\r\n    effects: [\r\n    //  ExcessOfBladesEffect,\r\n      {\r\n        name: `Soulgorgers - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly non-Unique Hedonites of Slaanesh War Machines wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn. This ability also affects Companion weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Mutilating Blades`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  /*'Exalted Chariot': {\r\n    effects: [\r\n     // ExcessOfBladesEffect,\r\n      {\r\n        name: `Bitter Frenzy`,\r\n        desc: `Roll a dice each time this unit receives a command from a friendly Bladebringer Exalted Chariot unit. On a 4+, add 1 to the Damage characteristic of this unit's Flensing Whips until the end of that turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  Fiends: {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Disruptive Song - Passive`,\r\n        desc: `Effect: Subtract 1 from casting rolls and unbinding rolls for enemy Wizards while they are within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Soporific Musk - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Daemonettes: {\r\n    effects: [\r\n      {\r\n        name: `Lithe and Swift - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units Piercing Claws for the rest of the turn if this unit charged in the same turn`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  BannerBearerEffect,\r\n    //  IconBearerEffect,\r\n    //  HornBlowerEffect,\r\n    //  LitheAndSwiftEffect,\r\n    ],\r\n  },\r\n  Seekers: {\r\n    effects: [\r\n      {\r\n        name: `Quicksilver Speed - Passive`,\r\n        desc: `Effect: When making run rolls for this unit, if you roll a 1-3, you can use a value of 4 instead.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Hellstriders': {\r\n    effects: [\r\n     // BannerBearerEffect,\r\n     // IconBearerEffect,\r\n    //  HornBlowerEffect,\r\n      {\r\n        name: `Maiming Charge - Passive`,\r\n        desc: `Effect: If this unit charged this turn, subtract 3 from the control scores of enemy Infantry units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Pain': {\r\n    effects: [\r\n      {\r\n        name: `Share the Pain - Passive`,\r\n        desc: `Effect: Each time you make a successful ward roll for this unit for a damage point inflicted by a combat attack, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Diciples in Torment - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective, add 1 to wound rolls for combat attacks made by friendly Sybarite units wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Hubris': {\r\n    effects: [\r\n      {\r\n        name: `Only the Best Will Suffice`,\r\n        desc: `Declare: Pick a friendly Myrmidesh Painbringers or Symbaresh Twinsouls unit that is in combat and is wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, for the rest of the turn, each time a model in the target unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. For each 4+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `'You First, I Insist...'`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Your opponent must decide whether the target will accept or decline this units challenge. \r\n        Accept: The target has Strike-first for the rest of the turn. If this unit is in combat with the target when the target is picked to use a Fight ability, all of the targets attacks must target this unit. \r\n        Decline: The target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAANESH, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n    ],\r\n  },\r\n /* 'The Dread Pageant': {\r\n    effects: [\r\n      {\r\n        name: `Art of the Myrmidesh`,\r\n        desc: `Vasillac the Gifted has a ward of 4+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Deadliest Procession`,\r\n        desc: `Once per battle, at the end of the charge phase, you can say that this unit will draw on their combined experience. If you do so, the strike-first effect applies to this unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Glutos Orscollion, Lord of Gluttony': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Crippling Famishment'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `The Grand Gourmand - Passive`,\r\n        desc: `Effect: A different effect applies to friendly Sybarite units each battle round while they are wholly within 12\" of this unit, as shown below. The effects of all previous battle rounds also apply to those units while they are wholly within 12\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The Grand Gourmand: Starter (Battle Round 1)`,\r\n        desc: `Add 1 to run rolls and charge rolls for those units.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `The Grand Gourmand: Main (Battle Round 2)`,\r\n        desc: `Add 3 to those units control scores.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `The Grand Gourmand: Dessert (Battle Round 3)`,\r\n        desc: `Add 1 to hit rolls for those units attacks.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Grand Gourmand: Digestif (Battle Round 4+)`,\r\n        desc: `Add 1 to the Rend characteristic of those units melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crippling Punishment: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn:  \r\n        Halve the targets Move characteristic.  \r\n        Halve run rolls and charge rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Greatblade and Claws is 6.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gorge on Excess`,\r\n        desc: `Declare: Pick a friendly Sybarite unit wholly within 12\" of this unit to be the target. \r\n        Effect: Heal (6) the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n\r\n      // Companion abilities\r\n      // {\r\n      //   name: `Painbringer Kyazu`,\r\n      //   desc: `If the unmodified wound roll for an attack made with this model's Wailing Greatblade is 6, that attack inflicts 2 mortal wounds on the target and the attack sequence ends (do not make a save roll).`,\r\n      //   when: [COMBAT_PHASE],\r\n      // },\r\n      // {\r\n      //   name: `Lashmaster Vhyssk`,\r\n      //   desc: `You can reroll charge rolls for this model.`,\r\n      //   when: [CHARGE_PHASE],\r\n      // },\r\n      // {\r\n      //   name: `Priestess Dolece`,\r\n      //   desc: `In your hero phase, you can say that Dolece will call to Slaanesh to protect her master. If you do so, roll a dice. On a 1, nothing happens. On a 2+, until your next hero phase, you can roll a dice each time you allocate a wound or mortal wound to this model. On a 5+, that wound or mortal wound is negated.`,\r\n      //   when: [HERO_PHASE],\r\n      // },\r\n    ],\r\n  },\r\n  'Sigvald, Prince of Slaanesh': {\r\n    effects: [\r\n      {\r\n        name: `The Glorious Reborn - Passive`,\r\n        desc: `Effect: This unit has Strike-first if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Powered by Vainglory - Passive`,\r\n        desc: `Effect: If this unit charged this turn and the unmodified charge roll was 6+, the Attacks characteristic of this units Shardslash is equal to the unmodified charge roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shardslash - Passive`,\r\n        desc: `Effect: Ward rolls cannot be made for damage points inflicted by this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shardspeaker of Slaanesh': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Reflection Eternal'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Mist Lurkers - Passive`,\r\n        desc: `Effect: If this unit successfully casts a spell, until the start of your next turn, it can attack with its Shadow- cloaked Claws.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Twisted Mirror - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 8\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, subtract 1 from save rolls for the target until the start of your next turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blissbarb Archers': {\r\n    effects: [\r\n     // HighTempterEffect,\r\n      {\r\n        name: `Blissbarb Homonculus - Passive`,\r\n        desc: `Effect: This units Blissbrew Homonculus is a token. There is 1 Blissbrew Homonculus for every 10 models in this unit. \r\n        Subtract 1 from hit rolls for shooting attacks that target this unit while it has a Blissbrew Homonculus. If you make an unmodified save roll of 1 for this unit, remove the Blissbrew Homonculus from the battlefield after the Attack ability has been resolved (the damage point is still inflicted).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blissbarb Seekers': {\r\n    effects: [\r\n    //  HighTempterEffect,\r\n      {\r\n        name: `Glory Shots - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units ranged weapons for attacks that target units contesting an objective you do not control.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slickblade Seekers': {\r\n    effects: [\r\n      {\r\n        name: `Unrivalled Velocity - Passive`,\r\n        desc: `Effect: You can re-roll charge rolls for this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Myrmidesh Painbringers': {\r\n    effects: [\r\n      {\r\n        name: `Paragons of Battle - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Symbaresh Twinsouls': {\r\n    effects: [\r\n      {\r\n        name: `Ego-driven Excess - Passive`,\r\n        desc: `Effect: If this unit did not charge this turn, subtract 1 from the Attacks characteristic of melee weapons used by enemy units while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fiendish Reflexes - Passive`,\r\n        desc: `Effect: If this unit did not charge this turn, it has Ward (5+) while it is in combat.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Slaangor Fiendbloods': {\r\n    effects: [\r\n      {\r\n        name: `Slaughter At Any Cost - Enemy Shooting Phase`,\r\n        desc: `Effect: If any damage points were allocated to this unit this turn, this unit can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Dexcessa: {\r\n    effects: [\r\n      {\r\n        name: `Fleeting Dance of Death - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Joyous Battle Fury`,\r\n        desc: `Effect: If any enemy models were slain by this units combat attacks this turn, Heal (D3) this unit, then place a battle fury token next to it. \r\n        Add 1 to the Attacks characteristic of this units Impaling Talons for each battle fury token it has until the end of the next turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // MesmerisingLepidopteraEffect,\r\n      {\r\n        name: `Scion of Slaanesh - Passive`,\r\n        desc: `Effect: While a friendly Synessa is on the battlefield, subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Redolence of Violence - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick up to D3 other friendly non-Hero Hedonites of Slaanesh Daemon units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Synessa, The Voice of Slaanesh': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Whispers of Doubt'])],\r\n    }, */\r\n    effects: [\r\n    /*  GenericEffects.WizardOneSpellEffect,\r\n      WarmasterEffect,\r\n      MesmerisingLepidopteraEffect, */\r\n      {\r\n        name: `Enthralling Splendour - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Voice of Slaanesh`,\r\n        desc: `Declare: Pick a visible unit within 18\" of this unit to be the target. \r\n        Effect: If the target is a friendly unit, add 5 to the targets control score for the rest of the turn. If the target is an enemy unit, subtract 5 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Progeny of Slaanesh - Passive`,\r\n        desc: `Effect: While a friendly Dexcessa is on the battlefield, add 1 to this units power level.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Whispers of Doubt: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target. \r\n        Effect: Add 1 to hit rolls and wound rolls for combat attacks that target that enemy unit for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Brand`s Oathbound': {\r\n    effects: [\r\n      {\r\n        name: `Gunnar Brand: Carve a Path to Glory`,\r\n        desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n        Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n      {\r\n        name: `Gunnar Brand: Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Singri Brand: Swift as the Wind - Passive`,\r\n        desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },  \r\n      {\r\n        name: `Singri Brand: Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn Kin: Withering Death: Casting value of 5`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n      {\r\n        name: `Oathsworn Kin: Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of the Gods - Once Per Turn`,\r\n        desc: `Effect: If any enemy Heroes were slain this turn by the Gunnar Brand in this Regiment of Renown:  \r\n        Heal (5) each unit in this Regiment of Renown.  \r\n        Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: The Coven of Thryx': {\r\n    effects: [\r\n      {\r\n        name: `Magister: Magic-Touched`,\r\n        desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n        Add 1 to this units power level.  \r\n        If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Pink Horrors: Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tome of Eyes: Transfixed by Countless Eyes - Reaction: You declared a Spell ability for a Wizard within this Manifestations combat range`,\r\n        desc: `Effect: You can add 1 or 2 to the casting roll for that spell. Roll a number of dice equal to the amount added. For each 1-2, allocate 1 damage point to the caster. If the caster is destroyed by this ability, the spell has no effect.`,\r\n        when: [HERO_PHASE],\r\n      }, \r\n      {\r\n        name: `Burning SIgil of Tzeentch: Radiant Transmogrification`,\r\n        desc: `Declare: This Manifestation must use this ability in each movement phase. Pick each unit (friendly and enemy) within 9\" of this Manifestation to be the targets. \r\n        Effect: Roll 2 dice, pick either result, then apply the corresponding eect to all targets for the rest of the turn. \r\n        1-2 No effect. \r\n        3 Subtract 2\" from the targets Move characteristic. \r\n        4 Subtract 1 from hit rolls for the targets attacks. \r\n        5 Subtract 1 from wound rolls for the targets attacks. \r\n        6 Inflict D3 mortal damage on the target, then add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sparks of Profane Potential - Once Per Battle`,\r\n        desc: `Effect: If the Magister in the Regiment of Renown has been deployed, set up one of the following Manifestations within 1\" of them:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Skilled Summoner: Casting value of 6`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick 1 of the Manifestations from the list below that is not on the battlefield, then make a casting roll of 2D6:  \r\n        1 Burning Sigil of Tzeentch  \r\n        1 Tome of Eyes  \r\n        1 Daemonic Simulacrum \r\n        Effect: If there is already a friendly Manifestation from the list above on the battlefield, it is immediately banished. Then, set up the Manifestation you picked within 1\" of the caster and visible to them. If that Manifestation is a Daemonic Simulacrum, it must also be set up more than 9\" away from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Flickering Wyrdflame - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points inflicted on it this turn by Wyrdflame Spell abilities or attacks made with weapons that have the Wyrdflame weapon ability to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick the Magister in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import BeastsOfChaosUnits from 'factions/beasts_of_chaos/units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyOmitter, keyPicker } from 'factions/metatagger'\r\nimport SlavesToDarknessUnits from 'factions/slaves_to_darkness/units'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport EndlessSpells from './endless_spells'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport {\r\n  CHARGE_PHASE,\r\n  DURING_GAME,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { SLAANESH } from 'meta/factions'\r\n\r\nconst baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    grand_strategies: [GrandStrategies],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [SLAANESH]: {\r\n    //  ...baseSubfaction,\r\n      effects: [],\r\n  \r\n      available: {\r\n        artifacts: [Artifacts],\r\n        battalions: [Battalions],\r\n        battle_tactics: [BattleTactics],\r\n       // command_abilities: [CommandAbilities],\r\n        command_traits: [CommandTraits],\r\n        //endless_spells: [EndlessSpells],\r\n        flavors: [Flavors],\r\n        grand_strategies: [GrandStrategies],\r\n        //prayers: [Prayers],\r\n        spells: [Spells],\r\n        units: [Units],\r\n      },\r\n    }, \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n /* 'Invaders Host': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Figureheads of the Dark Prince`,\r\n        desc: `All friendly INVADERS HEROES are treated as generals even if they are not the model picked to be your general. In addition, roll a dice each time you pick a friendly INVADERS HERO to carry out a heroic action. On a 2+, you can pick 1 other eligible INVADERS HERO on the battlefield to also carry out that heroic action.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Escalating Havoc`,\r\n        desc: `This is a heroic action that you can carry out with 1 friendly INVADERS HERO instead of picking 1 from the table in the core rules. If you do so, pick 1 eligible command trait from the list below that that INVADERS HERO does not already have. That HERO is considered to have that command trait until the end of the turn. The same command trait cannot be picked with this ability more than once in the same turn. Unique units cannot benefit from this ability.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SLAANESH, rule_sources.ERRATA_APRIL_2023],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Pretenders Host': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Heir to the Throne`,\r\n        desc: `If the model picked to be your general is a PRETENDERS HERO, you receive 3 command points instead of 1 if they are on the battlefield at the start of the hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Warlord Supreme`,\r\n        desc: `If the model picked to be your general is a PRETENDERS HERO. they can issue the same command up to 3 times in the same phase. If it does so, each command must be received by a friendly PRETENDERS unit. No command points are spent the second and third times your general issues that command in that phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Godseekers Host': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Thundering Cavalcade`,\r\n        desc: `You can reroll charge rolls for friendly GODSEEKERS units while they are wholly within 12\" of a friendly GODSEEKERS HERO.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Maniacal Hunters`,\r\n        desc: `At the start of each battle round, before the players receive their starting command points, you can move up to friendly GODSEEKERS units that are more than 3\" from all enemy units up to D6\" (roll separately for each unit). Those units must finish the move more than 3\" from all enemy units.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { SLAANESH } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SlaaneshFaction = new Faction(\r\n  SLAANESH,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_SLAANESH,\r\n  pickEffects(battle_traits, [SLAANESH])\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SONS_OF_BEHEMAT: {\r\n    name: 'Battletome: Sons of Behemat',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_NOV_2020: {\r\n    name: 'Errata (November 2020)',\r\n    type: 'errata',\r\n  },\r\n  ERRATA_MARCH_2021: {\r\n    name: 'Errata (March 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/11/5hJh6gsSHuqScJiT.pdf',\r\n  },\r\n  ERRATA_JULY_2021: {\r\n    name: 'Errata (July 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/11/DFG60Pr3z7N58B4w.pdf',\r\n  },\r\n  WHITE_DWARF_AUGUST_2021: {\r\n    name: 'White Dwarf (August 2021)',\r\n    type: 'white_dwarf',\r\n  },\r\n  ERRATA_AUGUST_2021: {\r\n    name: 'Errata (August 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/11/JVwZBkal7nIn0oma.pdf',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2020/11/UAXqGclWKSPiDS3F.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Extra-calloused Feet': {\r\n    effects: [\r\n      {\r\n        name: `Extra-Calloused Feet - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic, Rend characteristic and Damage characteristic of this units Almighty Stomp or Almightier Stomp.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glowy Shield of Protectiness': {\r\n    effects: [\r\n      {\r\n        name: `Glowy Shield of Protectiness - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mantle of Tusk and Horns': {\r\n    effects: [\r\n      {\r\n        name: `Mantle of Tusk and Horns - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, add 1 to hit rolls for combat attacks made by friendly Sons of Behemat units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Amberbone Totem': {\r\n    effects: [\r\n      {\r\n        name: `Amberbone Totem - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn, this unit can use Charge abilities even if it used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Kingslaughter Cowl\": {\r\n    effects: [\r\n      {\r\n        name: `Kingslaughter Cowl - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons while this unit is in combat with an enemy Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glowy Lantern': {\r\n    effects: [\r\n      {\r\n        name: `Glowy Lantern - Once Per Battle`,\r\n        desc: `Effect: Pick 1 manifestation lore available to your faction. This unit can use Summon abilities from that manifestation lore as if it had Wizard (1).`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  // Stomper Tribe\r\n/*  'Club of the First Oak (Stomper Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Club of the First Oak (Stomper Tribe)`,\r\n        desc: `Warstomper only. In your hero phase, you can heal 1 wound allocated to the bearer. In addition, while the bearer has 25 or more wounds allocated to them, they have a ward of 5+.`,\r\n        when: [HERO_PHASE, WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Club of the First Oak (Stomper Tribe)`,\r\n        desc: `Warstomper only. In addition, while the bearer has 25 or more wounds allocated to them, they have a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mantle of the Destroyer (Stomper Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Mantle of the Destroyer (Stomper Tribe)`,\r\n        desc: `Warstomper only. Friendly Sons of Behemat units within 12\" of the bearer have a Bravery characteristic of 10.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Smasher Tribe\r\n  'The Shatterer (Smasher Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `The Shatterer (Smasher Tribe)`,\r\n        desc: `Beast-Smasher Only. If the unmodified wound roll for an attack made with the bearer's Menhir Club that targets an enemy Hero, Monster, or War Machine is 6, that unit's armour has been shattered. If a unit's armor has been shattered, until the end of the battle, ignore positive modifiers to save rolls for attacks that target that unit.`,\r\n        when: [COMBAT_PHASE, DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Mantle of Tusks and Horns (Smasher Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Mantle of Tusks and Horns (Smasher Tribe)`,\r\n        desc: `Beast-Smasher Only. Once per battle, at the start of the combat phase, you can say that the bearer will channel the Waaagh!. If you do so, add 1 to hit rolls for attacks made with melee weapons by friendly Sons of Behemat units until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Breaker Tribe\r\n  'The Great Wrecka (Breaker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `The Great Wrecka (Breaker Tribe)`,\r\n        desc: `Gatebreaker Only. If the unmodified hit roll for an attack made with the bearer's Fortcrusha Flail is 6, that attack causes D3 mortal wounds to the target in addition to any damage it inflicts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kingslaughter Cowl (Breaker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Kingslaughter Cowl (Breaker Tribe)`,\r\n        desc: `Gatebreaker Only. Add 1 to wound rolls for attacks made by the bearer that target an enemy Hero.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // King Brodd's Stomp Army of Renown\r\n  'Brand of the Gargant King': {\r\n    effects: [\r\n      {\r\n        name: `Brand of the Gargant King`,\r\n        desc: `If the bearer makes a charge move and the unmodified charge roll was 8+, the strike-first effect applies to them until the end of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lucky Shiny Hat': {\r\n    effects: [\r\n      {\r\n        name: `Lucky Shiny Hat`,\r\n        desc: `The bearer has a ward of 5+ against mortal wounds.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Crafty Creepers': {\r\n    effects: [\r\n      {\r\n        name: `Crafty Creepers`,\r\n        desc: `At the start of the combat phase, you can pick 1 enemy HERO that has an artefact of power and is within 1\" of the bearer and roll a dice. On a 5+, that artefact of power can no longer be used (if a weapon was picked when the artefact of power was selected, that weapon reverts to normal).`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { MagnificentBattalionEffect, SwiftBattalionEffect } from 'generic_rules/core_battalions'\r\nimport { OneDropDeploymentEffect } from 'generic_rules/core_rules'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n// Battalions from White Dwarf August 2021\r\nconst Battalions = {\r\n /* 'Bosses of the Stomp': {\r\n    effects: [MagnificentBattalionEffect, OneDropDeploymentEffect],\r\n  },\r\n  Footsloggas: {\r\n    effects: [OneDropDeploymentEffect, SwiftBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* \"That's Mine!\": {\r\n    effects: [\r\n      {\r\n        name: `That's Mine!`,\r\n        desc: `Pick 1 objective on the battlefield that is not within your territory. You complete this tactic if that objective is kicked away and is wholly within your territory at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wrecking Crew': {\r\n    effects: [\r\n      {\r\n        name: `Wrecking Crew`,\r\n        desc: `You complete this tactic if an enemy faction terrain feature was demolished during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Man-skittles': {\r\n    effects: [\r\n      {\r\n        name: `Man-skittles`,\r\n        desc: `You complete this tactic if a friendly Warstomper used its 'Hurled Body' ability, an enemy model was slain by the first part of the ability, and an enemy Battleline unit was picked for the second part of the ability and suffered any mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fury of Titans': {\r\n    effects: [\r\n      {\r\n        name: `Fury of Titans`,\r\n        desc: `You complete this tactic if you carry out the Beast Grapple, Earth-Shaking Roar and Colossal Slam monstrous rampages this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Splat!': {\r\n    effects: [\r\n      {\r\n        name: `Splat!`,\r\n        desc: `Pick 1 enemy Hero. You complete this tactic if that Hero is slain by wounds caused by an attack made with Throwin' Rocks, Hurled Debris or a Hurled Boulder during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Colossal Violence': {\r\n    effects: [\r\n      {\r\n        name: `Colossal Violence`,\r\n        desc: `Pick 1 friendly Mega-Gargant. You complete this tactic if you carried out the Titanic Duel monstrous rampage with that unit during this turn and the enemy Monster picked as the target was slain by attacks made by that unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // King Brodd's Stomp\r\n  \"'Good Shot! Hur Hur!'\": {\r\n    effects: [\r\n      {\r\n        name: `'Good Shot! Hur Hur!'`,\r\n        desc: `You complete this battle tactic if an enemy unit was destroyed during this turn by an attack made with the Hurled Terrain missile weapon.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"King's Conquest\": {\r\n    effects: [\r\n      {\r\n        name: `King's Conquest`,\r\n        desc: `You complete this battle tactic if a friendly KING BRODD and 1 other friendly KING BRODD'S STOMP unit are contesting the same objective at the end of this turn and that objective was controlled by your opponent at the start of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Clear 'Em Out\": {\r\n    effects: [\r\n      {\r\n        name: `Clear 'Em Out`,\r\n        desc: `Pick 1 objective on the battlefield that you do not control. You complete this battle tactic if, at the end of this turn, you control that objective and that objective is contested by a friendly KING BR0DD's STOMP unit that made a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  SHOOTING_PHASE,\r\n  START_OF_ANY_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Monstrously Tough': {\r\n    effects: [\r\n      {\r\n        name: `Monstrously Tough - Passive`,\r\n        desc: `Effect: This unit has a Health characteristic of 40 instead of 35.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Furious Temper': {\r\n    effects: [\r\n      {\r\n        name: `Furious Temper - Once Per Battle`,\r\n        desc: `Effect: For the rest of the turn:  \r\n        Add 2 to the Attacks characteristic of this units melee weapons.  \r\n        Subtract 1 from save rolls for this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Rabble Rouser': {\r\n    effects: [\r\n      {\r\n        name: `Rabble Rouser - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Sons of Behemat units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Taker Tribe\r\n /* 'Extremely Intimidating (Taker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Extremely Intimidating (Taker Tribe)`,\r\n        desc: `Enemy units within 6\" of this general cannot receive the Inspiring Presence or Rally commands.`,\r\n        when: [BATTLESHOCK_PHASE, START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Very Acquisitive (Taker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Very Acquisitive (Taker Tribe)`,\r\n        desc: `If you give an artefact of power to this general, you can pick 1 additional artefact of power and give it to them as well (this general can have 2 artefacts of power). Both artefacts of power must be different.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  // Stomper Tribe\r\n  'Inescapable Grip (Stomper Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Inescapable Grip (Stomper Tribe)`,\r\n        desc: `When you use this general's Hurled Body ability, you can reroll both dice rolls.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eager for the Fight (Stomper Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Eager for the Fight (Stomper Tribe)`,\r\n        desc: `You can attempt a charge with this general if it is within 18\" of an enemy unit instead of 12\". In addition, roll 3D6 instead of 2D6 when making a charge roll for this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Smasher Tribe\r\n  'Sees Green (Smasher Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Sees Green (Smasher Tribe)`,\r\n        desc: `Once per battle, at the start of a phase, you can say that this general is Gorkamorka made manifest. If you do so, this general has a ward of 4+ against mortal wounds until the end of that phase.`,\r\n        when: [START_OF_ANY_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Marrow-drinker (Smasher Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Marrow-drinker (Smasher Tribe)`,\r\n        desc: `Each time an enemy Monster is slain by this general, roll a number of dice equal to that Monster's Wounds chracteristic. For each 5+, you can heal 1 wound allocated to this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  // Breaker Tribe\r\n  'Extremely Bitter (Breaker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Extremely Bitter (Breaker Tribe)`,\r\n        desc: `You can pick a second fierce loathing that applies only to your general.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Sees Red (Breaker Tribe)': {\r\n    effects: [\r\n      {\r\n        name: `Sees Red (Breaker Tribe)`,\r\n        desc: `In the combat phase, if this general is within 3\" of a defensible terrain feature or an enemy unit that is wholly on a terrain feature, use the top row on this general's damage table, regardless of how many wounds they have suffered.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // King Brodd's Stomp Army of Renown\r\n  'High Expectations': {\r\n    effects: [\r\n      {\r\n        name: `High Expectations`,\r\n        desc: `Add 1 to the Attacks characteristic of Death Grip attacks made by friendly MEGA-GARGANTS while they are within 3\" of any other friendly MEGA-GARGANTS.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Big Eater': {\r\n    effects: [\r\n      {\r\n        name: `Big Eater`,\r\n        desc: `In the combat phase, if any enemy models are slain by attacks made by a friendly MEGA-GARGANT wholly within 12\" of this general, you can heal up to D3 wounds allocated to that MEGA-GARGANT after all of its attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Loud-mouthed Bully': {\r\n    effects: [\r\n      {\r\n        name: `Loud-mouthed Bully`,\r\n        desc: `Once per turn, in the combat phase, you can pick 1 friendly KING BRODD'S STOMP unit wholly within 12\" of this general, If you do so, until the end of that phase, use the top row on that unit's damage table, regardless of how many wounds it has suffered.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_SETUP,\r\n  START_OF_SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  'Taker Tribe': {\r\n    effects: [\r\n      {\r\n        name: `More Stuff For Me Collection - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly non-Unique Sons of Behemat Hero that does not have an artefact of power. \r\n        Effect: Give that Hero 1 artefact of power from Titanic Trophies.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Boss Tribe': {\r\n    effects: [\r\n      {\r\n        name: `Big Mouth - Once Per Turn - Reaction: You declared a Fight ability for a friendly Mega-Gargant`,\r\n        desc: `Used By: The Mega-Gargant using that Fight ability. \r\n        Effect: Pick a friendly Gargant unit that has not used a Fight ability this turn and is wholly within 12\" of this unit to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stomper Tribe': {\r\n    effects: [\r\n      {\r\n        name: `Revel in War - Passive`,\r\n        desc: `Effect: You can pick 2 friendly Mega-Gargants or Gargant units that have not used a Rampage ability this turn to use the Jump Up and Down ability instead of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Breaker Tribe': {\r\n    effects: [\r\n      {\r\n        name: `Besiieging Bulk - Passive`,\r\n        desc: `Effect: Friendly Mega-Gargants have Ward (6+) while they are within the combat ranges of any other friendly Mega-Gargants.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { END_OF_GAME, START_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Make the Land Tremble': {\r\n    effects: [\r\n      {\r\n        name: `Make the Land Tremble`,\r\n        desc: `When the battle ends, you complete this grand strategy if any friendly units made a run or charge move in every battle round (it does not have to be the same unit that runs or makes a charge move in every battle round).`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"Brodd's Revenge\": {\r\n    effects: [\r\n      {\r\n        name: `Brodd's Revenge`,\r\n        desc: `You can only pick this grand strategy if your army includes King Brodd. When the battle ends, you complete this grand strategy if the friendly KING BRODD has not been slain and you picked each of the 3 effects of the Power of Behemat prayer to apply at least once during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'On the Warpath': {\r\n    effects: [\r\n      {\r\n        name: `On the Warpath`,\r\n        desc: `When the battle ends, you complete this grand strategy if every friendly unit on the battlefield is within enemy territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \"Show 'Em Who's Boss!\": {\r\n    effects: [\r\n      {\r\n        name: `Show 'Em Who's Boss!`,\r\n        desc: `At the start of the battle, the enemy unit with the highest Wounds characteristic is marked as the big'un. If there are multiple enemy units tied for the highest Wounds characteristic, you can pick which of these will be the big'un. When the battle ends, you complete this grand strategy if the big'un has been slain and the model chosen to be your general has not been slain.`,\r\n        when: [START_OF_GAME, END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Flatten the Lands': {\r\n    effects: [\r\n      {\r\n        name: `Flatten the Lands`,\r\n        desc: `When the battle ends, you complete this battle tactic if there are no terrain features that are wholly or partially within enemy territory on the battlefield.`,\r\n        when: [START_OF_GAME, END_OF_GAME],\r\n        rule_sources: [meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SONS_OF_BEHEMAT } from 'meta/factions'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { CHARGE_PHASE, COMBAT_PHASE, DURING_GAME, SHOOTING_PHASE, WARDS_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [SONS_OF_BEHEMAT]: {\r\n    effects: [\r\n      {\r\n        name: `Timberrrrr! - Passive`,\r\n        desc: `Effect: Each time a friendly Mega-Gargant or Gargant model is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gargant Charge`,\r\n        desc: `Declare: Pick a friendly Mega-Gargant or Gargant unit that charged this turn and has not used a Rampage ability this turn to use this ability, then pick a visible enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Earthshaking Roar - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Mega-Gargant or Gargant unit that has not used a Rampage ability this turn to use this ability, then pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Colossal Slam - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Mega-Gargant that has not used a Rampage ability this turn to use this ability, then pick an enemy Monster or War Machine within 1\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, remove the target from the battlefield and set it up again within 1\" of the unit using this ability. Then, inflict D3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Jump Up and Down - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Mega-Gargant or Gargant unit that has not used a Rampage ability this turn to use this ability, then pick an enemy Infantry unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 3+, roll a dice for each model in the target unit. If the unit using this ability is a Gargant, inflict 1 mortal damage on the target for each 6. If it is a Mega-Gargant, inflict 1 mortal damage on the target for each 5+.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* \"King Brodd's Stomp\": {\r\n    effects: [\r\n      {\r\n        name: `These Realms Is Ours`,\r\n        desc: `Each MEGA-GARGANT has a Mightier Makes Righlier value listed on its damage table on its warscroll. For the purposes of contesting objectives, each MEGA-GARGANT model in a King Brodd's Stomp army counts as a number of models equal to its Mightier Makes Rightier value, while each MANCRUSHER GARGANT model counts as 10 models.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `The World Titan's Prophet`,\r\n        desc: `If your army includes KING BRODD, he has a ward of 5+ while he is within 3\" of any other friendly units.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Smash It All To Bits`,\r\n        desc: `Once per turn, in your shooting phase, you can pick 1 terrain feature that does not have any units with the Monster keyword wholly or partially on it and 1 friendly Mega-Gargant within 1\" of it. If you do so, roll a dice. On a 2+, that terrain feature is sundered.\r\n\r\n        If a terrain feature is sundered, roll a dice for each unit that has any models on or garrisoning that terrain feature. On a 2+, that unit suffers D3 mortal wounds. Then, starting with the active player, each player must remove all friendly models that were on or garrisoning that terrain feature and set them up wholly within 6\" of, but not on, that terrain feature and more than 3\" from all enemy units. Those models must be set up in coherency with any models in their unit, including those that were not on or garrisoning that terrain feature. If a model cannot be set up following these restrictions, it is slain. The terrain feature is then removed from play.\r\n\r\n        Finally, the Mega-Gargant you picked can make a shooting attack in that phase with the Hurled Terrain missile weapon below (this is treated as an additional weapon profile that can be used when you pick that unit to shoot)`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.ERRATA_DAWNBRINGERS_BOOK_2],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { SONS_OF_BEHEMAT } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandTraits from './command_traits'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Units from './units'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport battle_traits from './battle_traits'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst baseSubFaction = {\r\n  effects: [],\r\n\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_traits: [CommandTraits],\r\n    grand_strategies: [GrandStrategies],\r\n    flavors: [Flavors],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  'Sons Of Behemat': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(battle_traits, [SONS_OF_BEHEMAT]),\r\n  },\r\n\r\n /* \"King Brodd's Stomp\": {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(battle_traits, [\"King Brodd's Stomp\"]),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst MonstrousRampages = {\r\n/*  'Beast Grapple': {\r\n    effects: [\r\n      {\r\n        name: `Beast Grapple`,\r\n        desc: `Pick 1 enemy MONSTER within 3\" of this unit and roll a dice. On a 3+, until the end of the following combat phase, the strike-last effect applies to both that Monster and the unit carrying out this monstrous rampage.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Earth-shaking Roar': {\r\n    effects: [\r\n      {\r\n        name: `Earth-shaking Roar`,\r\n        desc: `Pick 1 enemy unit within 3\" of this model and roll a dice. On a 3+, that unit cannot issue or receive orders in the following combat phase. In addition, if the first roll was successful and that enemy unit has a Wounds characteristic of 1 or 2, roll 2D6. If that roll is higher than that unit's Bravery characteristic, for each point by which the roll exceeds the unit's Bravery characteristic, 1 model in that unit flees. That unit's commanding player decides which models flee. The effect of this monstrous rampage is not considered to be a battleshock test.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_SONS_OF_BEHEMAT,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'Colossal Slam': {\r\n    effects: [\r\n      {\r\n        name: `Colossal Slam`,\r\n        desc: `Pick 1 enemy MONSTER that is not part of a unit consisting of 2 or more models and that is within 1/2\" of this unit. Roll a dice. On a 3+, you can remove that MONSTER from the battlefield and set it up again anywhere wholly on open ground within 1/2\" of this unit. That MONSTER suffers D3 mortal wounds. In addition, subtract 1 from hit rolls for attacks made by the unit carrying out this monstrous rampage until the end of the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"The King's Stomp\": {\r\n    effects: [\r\n      {\r\n        name: `The King's Stomp`,\r\n        desc: `Only a model that has made a charge move in the same phase can carry out this monstrous rampage. This model can make a 3D6\" move but it must finish that move within 3\" of any enemy units. When it makes a move in this way, it can pass across models and terrain features in the same manner as a unit that can fly. At the end of the move, roll a dice for each unit it passed across. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { Faction } from 'factions/factionClass'\r\nimport { DESTRUCTION } from 'meta/alliances'\r\nimport { SONS_OF_BEHEMAT } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SonsOfBehematFaction = new Faction(\r\n  SONS_OF_BEHEMAT,\r\n  DESTRUCTION,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_SONS_OF_BEHEMAT,\r\n  []\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { SOULBLIGHT_GRAVELORDS } from 'meta/factions'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SHOOTING_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  [SOULBLIGHT_GRAVELORDS]: {\r\n    effects: [\r\n      {\r\n        name: `The Unquiet Dead`,\r\n        desc: `Declare: Pick a friendly Deathrattle or Deadwalkers unit that has not been deployed. \r\n        Effect: Set up that unit in reserve in the grave. It has now been deployed. You cannot set up more friendly units in the grave than there are on the battlefield.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Rising Dead`,\r\n        desc: `Declare: Pick a friendly unit that is in the grave. \r\n        Effect: Set up that unit wholly within 6\" of a terrain feature and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `The Hunger - Once Per Turn`,\r\n        desc: `Declare: Pick each friendly Vampire unit that used a Fight ability this turn to be the targets. \r\n        Effect: Heal (D3) each target. Heal (2D3) the target instead if it destroyed an enemy unit this turn using a Fight ability.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Command Ability - Endless Legions - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly non-Unique Deathrattle or Deadwalkers unit that started the battle with 2 or more models and that has been destroyed to be the target.\r\n        Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 12\" of a friendly Soulblight Gravelords Hero or wholly within 6\" of a terrain feature. It must be set up more than 9\" from all enemy units. If it is your movement phase, you can set up the replacement unit more than 3\" from all enemy units instead of more than 9\", but if you set it up within 9\" of any enemy units, it cannot use Charge abilities this turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Deathly Invocation - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Soulblight Gravelords Hero to use this ability, then pick up to 3 friendly Deathrattle or Deadwalkers units wholly within 12\" of that Hero to be the targets. \r\n        Effect: For each target:  \r\n        If the target is damaged, Heal (3) the target.  \r\n        If the target is not damaged, return a number of slain models to it with a combined Health characteristic of up to 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Orb of Enchantment': {\r\n    effects: [\r\n      {\r\n        name: `Orb of Enchantment - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Hero in combat to be the target. \r\n        Effect: The target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Shard of Night': {\r\n    effects: [\r\n      {\r\n        name: `Shard of Night - Passive`,\r\n        desc: `Effect: Ignore modifiers to save rolls for shooting attacks that target this unit (positive and negative).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Amulet of Screams': {\r\n    effects: [\r\n      {\r\n        name: `Amulet of Screams - Reaction: Opponent declared a Spell ability for a Wizard within 18\" of this unit`,\r\n        desc: `Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the caster equal to the roll. If the target is destroyed by this ability, do not resolve the effect of that Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Shard of Night': {\r\n    effects: [\r\n      {\r\n        name: `Shard of Night`,\r\n        desc: `Ignore negative modifiers to save rolls for attacks made with missile weapons that target the bearer.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Chiropteran Cloak': {\r\n    effects: [\r\n      {\r\n        name: `Chiropteran Cloak`,\r\n        desc: `If the unmodified hit roll for an attack made with a melee weapon that targets the bearer is 1, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Morbheg's Claw\": {\r\n    effects: [\r\n      {\r\n        name: `Morbheg's Claw`,\r\n        desc: `In your hero phase, if the bearer is more than 3\" from all enemy units, you can say that they will carve sigils into the ground using Morbheg's claw. If you do so, add 2 to casting rolls for friendly LEGION OF NIGHT WIZARDS wholly within 12\" of the bearer until your next hero phase. However, the bearer cannot make a normal move, run, retreat or attempt a charge until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Ulfenkarnian Phylactery': {\r\n    effects: [\r\n      {\r\n        name: `Ulfenkarnian Phylactery`,\r\n        desc: `Add 1 to ward rolls for friendly VYRKOS SUMMONABLE units for the purposes of the Deathless Minions battle trait while they are wholly within 9\" of the bearer.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Terminus Clock': {\r\n    effects: [\r\n      {\r\n        name: `Terminus Clock`,\r\n        desc: `At the start of the enemy hero phase, you can say that the bearer will stop the Terminus Clock. If you do so, roll a dice. On a 3+, until the end of that phase, subtract 1 from casting rolls for enemy WIZARDS.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Standard of the Ulfenwatch': {\r\n    effects: [\r\n      {\r\n        name: `Standard of the Ulfenwatch`,\r\n        desc: `If the bearer is on the battlefield, you can roll a dice each time your opponent spends a command point. On a 4+, you receive 1 extra command point.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Grave-sand Shard': {\r\n    effects: [\r\n      {\r\n        name: `Grave-sand Shard`,\r\n        desc: `Once per battle round, at the end of the battleshock phase, you can return 1 slain model to each friendly KASTELAI SUMMONABLE unit wholly within 18\" of the bearer.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fragment of the Keep': {\r\n    effects: [\r\n      {\r\n        name: `Fragment of the Keep`,\r\n        desc: `Subtract 1 from wound rolls for attacks made with melee weapons by enemy units within 3\" of the bearer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Red Casket': {\r\n    effects: [\r\n      {\r\n        name: `The Red Casket`,\r\n        desc: `Add 3 to run rolls and charge rolls for the bearer.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Breath of the Void Maw': {\r\n    effects: [\r\n      {\r\n        name: `Breath of the Void Maw`,\r\n        desc: `Once per battle, at the start of the combat phase, you can pick 1 enemy unit within 6\" of the bearer that is visible to them and roll a dice. On a 2+, that unit suffers a number of mortal wounds equal to the roll.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Ghorvar's Collar\": {\r\n    effects: [\r\n      {\r\n        name: `Ghorvar's Collar`,\r\n        desc: `Once per battle, at the start of the combat phase, you can say that the bearer will don Ghorvar's collar. If you do so, the strike-first effect applies to the bearer until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Furious Crown': {\r\n    effects: [\r\n      {\r\n        name: `The Furious Crown`,\r\n        desc: `Once per battle, at the start of your charge phase, you can say that the bearer will unleash the fury of the crown. If you do so, after the bearer makes a charge move in that phase, you can pick 1 enemy unit within 1\" of the bearer and roll a number of dice equal to the charge roll for that charge move. For each 4+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport rule_sources from './rule_sources'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\n\r\nconst BattleTactics = {\r\n /* 'Callous Overlord': {\r\n    effects: [\r\n      {\r\n        name: `Callous Overlord`,\r\n        desc: `Pick 1 friendly SUMMONABLE unit more than 3\" from all enemy units. You complete this tactic if that friendly unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cursed Unlife': {\r\n    effects: [\r\n      {\r\n        name: `Cursed Unlife`,\r\n        desc: `You complete this tactic if any wounds allocated to your general or to 2 other friendly VAMPIRE units are healed using The Hunger ability during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Grasping Dead': {\r\n    effects: [\r\n      {\r\n        name: `The Grasping Dead`,\r\n        desc: `Pick 1 friendly Summonable unit within 3\" of any enemy units. You complete this tactic if any enemy models were slain by that friendly unit this turn, and that friendly unit is within 3\" of any enemy units at the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_SOULBLIGHT_GRAVELORDS,\r\n          meta_rule_sources.BATTLESCROLL_NULLSTONE_CACHE,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  'The Choicest Vintage': {\r\n    effects: [\r\n      {\r\n        name: `The Choicest Vintage`,\r\n        desc: `Pick 1 enemy HERO on the battlefield. You complete this tactic if that enemy HERO is slain during this turn by an attack made by a friendly VAMPIRE HERO.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Expand the Grave-empires': {\r\n    effects: [\r\n      {\r\n        name: `Expand the Grave-empires`,\r\n        desc: `You complete this tactic if you control 2 or more objectives wholly outside your territory and each of those objectives is contested by a friendly SUMMONABLE or VAMPIRE unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Endless Nightmare': {\r\n    effects: [\r\n      {\r\n        name: `Endless Nightmare`,\r\n        desc: `Pick 1 friendly SOULBLIGHT GRAVELORDS SUMMONABLE unit on the battlefield. You complete this tactic if 6 or more slain models are returned to that unit during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_ROUND,\r\n  END_OF_SETUP,\r\n  END_OF_SHOOTING_PHASE,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\n\r\nconst CommandTraits = {\r\n  'Lash of the Sire': {\r\n    effects: [\r\n      {\r\n        name: `Lash of the Sire - Once Per Turn`,\r\n        desc: `Declare: Pick another friendly Soulblight Gravelords unit within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, if the target is not in combat, it can move D6\". If the target is in combat, it can make a pile-in move.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unbending Will': {\r\n    effects: [\r\n      {\r\n        name: `Unbending Will - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Deathrattle or Deadwalkers unit that has 2 or more models and is wholly within 12\" of this unit to be the target. \r\n        Effect: Add D6 to the targets control score for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unhinged Rampager': {\r\n    effects: [\r\n      {\r\n        name: `Unhinged Rampager - Passive`,\r\n        desc: `Effect: You can re-roll charge rolls for this unit in your charge phase.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Above Suspicion': {\r\n    effects: [\r\n      {\r\n        name: `Above Suspicion`,\r\n        desc: `During deployment, instead of setting up this general on the battlefield, you can place them to one side and say that they are set up in ambush as a reserve unit. If you do so, at the end of your movement phase, you can set up this general on the battlefield more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Above Suspicion`,\r\n        desc: `If you set this general up in ambush, at the end of your movement phase, you can set up this general on the battlefield more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unbending Will': {\r\n    effects: [\r\n      {\r\n        name: `Unbending Will`,\r\n        desc: `Models in friendly LEGION OF NIGHT SUMMONABLE units count as 2 models instead of 1 for the purposes of contesting objectives while they are wholly within 12\" of this general.`,\r\n        when: [END_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'The Bait': {\r\n    effects: [\r\n      {\r\n        name: `The Bait`,\r\n        desc: `While this general is on the battlefield, add 1 to save rolls and ward rolls for attacks that target friendly LEGION OF NIGHT SUMMONABLE units in the first battle round.`,\r\n        when: [WARDS_PHASE, SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Driven by Deathstench': {\r\n    effects: [\r\n      {\r\n        name: `Driven by Deathstench`,\r\n        desc: `You can reroll charge rolls for friendly VYRKOS units wholly within 9\" of this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Hunter's Snare\": {\r\n    effects: [\r\n      {\r\n        name: `Hunter's Snare`,\r\n        desc: `For the purposes of contesting objectives, this general counts as a number of models equal to their Wounds characteristic.`,\r\n        when: [END_OF_ROUND],\r\n      },\r\n    ],\r\n  },\r\n  'Spoor Trackers': {\r\n    effects: [\r\n      {\r\n        name: `Spoor Trackers`,\r\n        desc: `At the start of your hero phase, friendly VYRKOS DEADWALKERS units wholly within 9\" of this general can make a normal move of up to 3\".`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Swift and Deadly': {\r\n    effects: [\r\n      {\r\n        name: `Swift and Deadly`,\r\n        desc: `You can reroll charge rolls for friendly KASTELAI units while they are wholly within 12\" of this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Undead Bladelord': {\r\n    effects: [\r\n      {\r\n        name: `Undead Bladelord`,\r\n        desc: `Once per turn, if this general is on the battlefield when a friendly KASTELAI VAMPIRE unit gains an ability with the Might of the Crimson Keep battle trait that this general has not already gained, this general gains the same ability.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Shifting Keep': {\r\n    effects: [\r\n      {\r\n        name: `The Shifting Keep`,\r\n        desc: `During deployment, if this general is on the battlefield, instead of setting up a KASTELAI BLOOD KNIGHTS unit on the battlefield, you can place it to one side and say that it is set up in the Crimson Keep as a reserve unit. You can set up 1 unit in the Crimson Keep for each unit you have set up on the battlefield. At the end of your movement phase, you can set up 1 or more of the reserve units in the Crimson Keep on the battlefield, wholly within 6\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Shifting Keep`,\r\n        desc: `At the end of your movement phase, you can set up 1 or more of the reserve units in the Crimson Keep on the battlefield, wholly within 6\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Monstrous Might': {\r\n    effects: [\r\n      {\r\n        name: `Monstrous Might`,\r\n        desc: `Subtract 1 from wound rolls for attacks made with melee weapons that target friendly AVENGORII MONSTERS wholly within 12\" of this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Torment-driven Throes': {\r\n    effects: [\r\n      {\r\n        name: `Torment-driven Throes`,\r\n        desc: `At the start of the combat phase, you can roll a dice for each enemy unit within 3\" of this general. On a 5+, that unit suffers 1 mortal wound and the strike-last effect applies to that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Unhinged Rampager': {\r\n    effects: [\r\n      {\r\n        name: `Unhinged Rampager`,\r\n        desc: `You can reroll charge rolls for this general.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Unhinged Rampager`,\r\n        desc: `At the end of the shooting phase, if any wounds or mortal wounds were allocated to this general in that phase, and this general is more than 9\" from all enemy units, this general can move up to D6\".`,\r\n        when: [END_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Lust for Domination': {\r\n    effects: [\r\n      {\r\n        name: `Lust for Domination`,\r\n        desc: `When the battle ends, you complete this grand strategy if you control more gravesites than your opponent. Control of gravesites is determined in the same way as control of objectives. However, unlike objectives, gravesites do not remain under your control if there are no longer any friendly models contesting them.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Empire of Corpses': {\r\n    effects: [\r\n      {\r\n        name: `Empire of Corpses`,\r\n        desc: `When the battle ends, you complete this grand strategy if you replaced 3 or more friendly SUMMONABLE units that were destroyed during the battle.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Danse Macabre': {\r\n    effects: [\r\n      {\r\n        name: `The Danse Macabre`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are more friendly SUMMONABLE units than enemy units wholly within enemy territory.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Crimson Larder': {\r\n    effects: [\r\n      {\r\n        name: `Crimson Larder`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are no HEROES from your opponent's starting army on the battlefield and the only friendly HEROES on the battlefield are VAMPIRES.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Flavors = {\r\n  \"Legion of Shyish\": {\r\n    effects: [\r\n      {\r\n        name: `Horror Unending - Passive`,\r\n        desc: `Effect: You can pick 1 additional target when using the Deathly Invocation ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Bacchanal of Blood': {\r\n    effects: [\r\n      {\r\n        name: `Aristocracy - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for friendly Vampire units that are not in combat and add 1 to wound rolls for combat attacks made by friendly Vampire units that charged in the same turn.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  \"Deathstench Drove\": {\r\n    effects: [\r\n      {\r\n        name: `Dragged Down and Torn Apart - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Deadwalkers units in combat to be the targets. \r\n        Effect: For each target:  \r\n        Make a pile-in move.  \r\n        Then, pick an enemy unit in combat with the target and roll a D3. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Deathmarch': {\r\n    effects: [\r\n      {\r\n        name: `Tides of Bones and Blades - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of melee weapons used by friendly Deathrattle units that charged in the same turn for attacks that target a unit that has fewer models than the attacking unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Lore of Undeath': {\r\n    effects: [\r\n      {\r\n        name: `Vile Transference: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Soulblight Gravelords Wizard to cast this spell, pick a visible enemy unit within 18\" of them that has not been picked to be the target of this ability this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 6, inflict 1 mortal damage on that unit. If any enemy models were slain by this spell, Heal (D3) the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Prison of Grief: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Soulblight Gravelords Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has Strike-last until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Waste Away: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Soulblight Gravelords Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: For the rest of the turn, subtract 1 from the Damage characteristic of the targets melee weapons.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Soulpike: {\r\n    effects: [\r\n      {\r\n        name: `Soulpike`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, if that unit makes a charge move, roll a number of dice equal to the charge roll for that charge move. For each 4+, that unit suffers 1 mortal wound. If the unmodified casting roll for this spell is 9+ and this spell is not unbound, you can pick 2 different enemy units within range instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vile Transference': {\r\n    effects: [\r\n      {\r\n        name: `Vile Transference`,\r\n        desc: `Casting value of 6 and a range of 9\". Pick 1 enemy unit within range and visible to the caster. Roll a number of dice equal to that unit's Wounds characteristic. For each 5+, that unit suffers 1 mortal wound and you can heal 1 wound allocated to the caster. If the unmodified casting roll for this spell is 9+ and this spell is not unbound, the target suffers 1 mortal wound and you can heal 1 wound allocated to the caster for each 4+ instead of each 5+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fading Vigour': {\r\n    effects: [\r\n      {\r\n        name: `Fading Vigour`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Subtract 1 from the Attacks characteristic of that unit's melee weapons (to a minimum of 1) until your next hero phase. If the unmodified casting roll for this spell is 9+ and this spell is not unbound, subtract 2 from the Attacks characteristic instead of 1 (to a minimum of 1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Prison of Grief': {\r\n    effects: [\r\n      {\r\n        name: `Prison of Grief`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, the strike-last effect applies to that unit. If the unmodified casting roll for this spell is 9+ and this spell is not unbound, the range of this spell is 24\" instead of 12\".`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Wind of Death': {\r\n    effects: [\r\n      {\r\n        name: `Wind of Death`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Roll a dice for that unit and each other enemy unit within 6\" of that unit. On a 3+, the unit being rolled for suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dark Mist': {\r\n    effects: [\r\n      {\r\n        name: `Dark Mist`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 friendly LEGION OF BLOOD unit wholly within range and visible to the caster. Ignore negative modifiers to save rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Quickblood: {\r\n    effects: [\r\n      {\r\n        name: `Quickblood`,\r\n        desc: `Casting value of 7. If successfully cast, the strike-first effect applies to the caster until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Fiendish Lure': {\r\n    effects: [\r\n      {\r\n        name: `Fiendish Lure`,\r\n        desc: `Casting value of 5 and a range of 6\". Pick 1 enemy unit within range and visible to the caster. Add 1 to hit rolls and wound rolls for attacks that target that unit until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Under a Killing Moon': {\r\n    effects: [\r\n      {\r\n        name: `Under a Killing Moon`,\r\n        desc: `Casting value of 6 and a range of 24\". If successfully cast, until your next hero phase, if the unmodified hit roll for an attack made with a melee weapon by a friendly VYRKOS unit wholly within range of the caster is 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Lycancurse: {\r\n    effects: [\r\n      {\r\n        name: `Lycancurse`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers D3 mortal wounds. If any models in that unit were slain by this spell, before removing the last slain model, you can add 1 unit of Dire Wolves to your army. The number of models in the new unit must be equal to the number of models in the enemy unit that were slain by this spell. Set up the new unit within 3\" of the slain model's unit, and then remove the slain model from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Curse of Exsanguination': {\r\n    effects: [\r\n      {\r\n        name: `Curse of Exsanguination`,\r\n        desc: `Casting value of 7 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. That unit suffers 1 mortal wound. If that mortal wound is allocated to a model in that unit and the model is not slain by that mortal wound, roll a dice. On a 3+, that model suffers 1 mortal wound, and you can roll another dice if that mortal wound is allocated and the model is not slain. Keep rolling dice in this way until no mortal wound is caused, the mortal wound is negated or the model is slain.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blood Siphon': {\r\n    effects: [\r\n      {\r\n        name: `Blood Siphon`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy HERO within range and visible to the caster, and roll a dice. On a 1-2, the target suffers 1 mortal wound. On a 3-4, the target suffers D3 mortal wounds. On a 5-6, the target suffers D6 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Vanhel's Danse Macabre\": {\r\n    effects: [\r\n      {\r\n        name: `Vanhel's Danse Macabre`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 friendly SOULBLIGHT GRAVELORDS SUMMONABLE unit wholly within range, visible to the caster and within 3\" of any enemy units. That unit can immediately fight.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Retribution or Salvation': {\r\n    effects: [\r\n      {\r\n        name: `Retribution or Salvation`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 unit within range and visible to the caster. If that unit is an enemy unit, it suffers D3 mortal wounds. If that enemy unit has the CHAOS keyword, it suffers 3 mortal wounds instead of D3. If that unit is a friendly SOULBLIGHT GRAVELORDS SUMMONABLE unit, you can heal up to D3 wounds allocated to that unit or, if no wounds are allocated to that unit, you can return a number of slain models to it that have a combined Wounds characteristic of D3 or less.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Waste Away': {\r\n    effects: [\r\n      {\r\n        name: `Waste Away`,\r\n        desc: `Casting value of 6 and a range of 18\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, subtract 1 from wound rolls for attacks made with melee weapons by that unit and subtract 1 from the Damage characteristic of that unit's melee weapons (to a minimum of 1). If the unmodified casting roll for this spell is 9+ and this spell is not unbound, you can pick 2 different enemy units within range instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Undying Servitude': {\r\n    effects: [\r\n      {\r\n        name: `Undying Servitude`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 enemy HERO with a Wounds characteristic of 6 or less within range and visible to the caster. That unit suffers D3 mortal wounds. If that HERO is slain by this spell, before removing that HERO from play, you can add 1 Vampire Lord to your army. Set up that unit within 3\" of the slain HERO, and then remove the slain HERO from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Channelled Dynamism': {\r\n    effects: [\r\n      {\r\n        name: `Channelled Dynamism`,\r\n        desc: `Casting value of 3 and a range of 6\". Pick 1 friendly THE EXILED DEAD unit wholly within range and visible to the caster. Until your next hero phase, that unit can run and still charge later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"The Queen's Dictat\": {\r\n    effects: [\r\n      {\r\n        name: `The Queen's Dictat`,\r\n        desc: `Casting value of 6 and a range of 24\". Pick 1 enemy unit within range and visible to the caster. Until your next hero phase, friendly AVENGORII MONSTERS are eligible to fight in the combat phase if they are within 6\" of that enemy unit instead of 3\", and they can move an extra 3\" when they pile in.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Cursed Reflection': {\r\n    effects: [\r\n      {\r\n        name: `Cursed Reflection`,\r\n        desc: `Casting value of 5 and a range of 24\". Pick 1 friendly SOULBLIGHT GRAVELORDS MONSTER wholly within range and visible to the caster. That unit can use The Hunger ability from the caster's warscroll until your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { Nagash } from 'factions/nighthaunt/units'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_BATTLESHOCK_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport spells from './spells'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { move } from 'superagent'\r\nimport { Duplex } from 'stream'\r\n\r\n/*const VampiricAgilityEffect = {\r\n  name: `Vampiric Agility`,\r\n  desc: `When this unit makes a move, it can pass across terrain features in the same manner as a unit that can fly.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst CallToTheHuntEffect = {\r\n  name: `Call to the Hunt`,\r\n  desc: `In the combat phase, if this unit made a charge move in the same turn, add 1 to the Attacks characteristic of melee weapons used by friendly VYRKOS SUMMONABLE units while they are wholly within 12\" of this unit.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst StandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `You can reroll ward rolls of 1 for this unit for the purposes of the Deathless Minions battle trait if this unit includes any Standard Bearers.`,\r\n  when: [WARDS_PHASE],\r\n  shared: true,\r\n}\r\nconst BeheadingStrikeEffect = {\r\n  name: `Beheading Strike`,\r\n  desc: `If the unmodified hit roll for an attack made with a Baleful Tomb Blade is 6, that attack causes 2 mortal wounds to the target in addition to any damage it inflicts.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CursedWeaponsEffect = {\r\n  name: `Cursed Weapons`,\r\n  desc: `If the unmodified wound roll for an attack made with a melee weapon by this unit is 6, that attack causes 1 mortal wound to the target in addition to any damage it inflicts.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst LocusOfUndeathEffect = {\r\n  name: `Locus of Undeath`,\r\n  desc: `If the unmodified wound roll for an attack made by a friendly DEADWALKER ZOMBIES unit wholly within 12\" of any friendly units with this ability is 6, that attack causes 1 mortal wound to the target in addition to any damage it inflicts.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst TerrorEffect = {\r\n  name: `Terror`,\r\n  desc: `Enemy units cannot receive the Inspiring Presence command while they are within 3\" of any friendly units with this ability.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\nconst TheHungerEffect = {\r\n  name: `The Hunger`,\r\n  desc: `Each time this unit fights, after all of its attacks have been resolved, you can heal up to a number of wounds allocated to this unit equal to the number of wounds and mortal wounds caused by those attacks that were allocated to enemy units (to a maximum of 6).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst NightmaresMiasmaEffect = {\r\n  name: `Nightmares Miasma`,\r\n  desc: `While an enemy unit is within 3\" of any friendly units with this ability, worsen the Rend characteristic of that unit's melee weapons by 1 (to a minimum of '-').`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst WailOfTheDamnedEffect = {\r\n  name: `Wail of the Damned`,\r\n  desc: `In your shooting phase, roll a dice for each enemy unit within range of this unit's Wail of the Damned ability. The range of this unit's Wail of the Damned ability is shown on its damage table. On a 4+, that unit suffers D3 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst DeathlyChargeEffect = {\r\n  name: `Deathly Charge`,\r\n  desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit. If you do so, roll 2 dice for each model in this unit. For each 5+, the target suffers 1 mortal wound.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n // ...Nagash,\r\n 'Nagash, Supreme Lord of the Undead': {\r\n  effects: [\r\n    {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, subtract 3 from its power level.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `The Staff of Power - Passive`,\r\n      desc: `Effect: Add 2 to casting rolls for this unit while it has not miscast any spells this turn. If this unit miscasts a spell, ignore the restriction that would stop this unit from casting any more spells this turn.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Hand of Dust - Once Per Turn`,\r\n      desc: `Declare: Pick a visible enemy Hero or Monster in combat with this unit to be the target. \r\n      Effect: Hide a dice in one of your hands or under one of two appropriate containers. Your opponent must pick one of your hands or containers. If they pick the one hiding the dice, this ability has no effect. If they pick the empty one, the target is automatically destroyed.`,\r\n      when: [END_OF_TURN],\r\n    },\r\n    {\r\n      name: `Supreme Lord of the Undead - Once Per Battle`,\r\n      desc: `Declare: Pick a friendly non-Hero non-Unique Death unit that has been destroyed to be the target. \r\n      Effect: Set up a replacement unit identical to the target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Invocation of Nagash: Casting value of 7`,\r\n      desc: `Declare: This unit can cast this spell more than once per phase. Pick a visible unit wholly within 18\" of this unit that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n      Effect: If the target is an enemy unit, inflict D3 mortal damage on it. If the target is a friendly Death unit, pick 1 of the following effects:  \r\n      Return a number of slain models to the target unit with a combined Health characteristic of up to 3.  The target has Ward (5+) until the start of your next turn.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n  ],\r\n},\r\n  'Mannfred von Carstein': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Wind of Death'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Wind of Death: Casting value of 7`,\r\n        desc: `Declare: Pick a point on the battlefield within 18\" of the caster, pick up to 3 visible enemy units within 6\" of that point to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Sword of Unholy Power - Passive`,\r\n        desc: `Effect: If this unit has slain any enemy models this turn, for the rest of the turn, add 1 to the Attacks characteristic of melee weapons used by friendly Deathrattle and Deadwalkers units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Night - Reaction: You declared the Redeploy command for a Soulblight Gravelords unit wholly within 12\" of this unit`,\r\n        desc: `Effect: The unit using the Redeploy command can move into combat when using that ability.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Ashigaroths Claws is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ashigaroth's Hunger - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Neferata: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Dark Mist'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Nagadrons Claws is 3.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n      {\r\n        name: `Twilight's Allure - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks that target friendly Soulblight Gravelords units while they are wholly within 6\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mortarch of Blood`,\r\n        desc: `Declare: Pick up to 3 friendly Deathrattle Infantry or Deadwalkers Infantry units to be the targets. \r\n        Effect: Each target can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `The Adevore - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Hero that was allocated any damage points inflicted by this units Akmet-har this turn to be the target. \r\n        Effect: Roll a dice. On a 5+, the target is automatically destroyed.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Dark Mist: Casting value of 7`,\r\n        desc: `Declare: Pick a visible friendly non-Monster Soulblight Gravelords unit wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore modifiers to save rolls for the target (positive and negative) until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  TheHungerEffect,\r\n    ],\r\n  },\r\n\r\n  'Prince Vhordrai': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Quickblood'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n     // TheHungerEffect,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Shordemaires Claws is 5.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    // TerrorEffect,\r\n      {\r\n        name: `Saint of Slaughter`,\r\n        desc: `Declare: Pick a friendly non-Monster Vampire unit that destroyed a unit this turn using a Fight ability and is wholly within 12\" of this unit to be the target. \r\n        Effect: Pick 1 of the following effects to apply for the rest of the battle:  \r\n        Add 2\" to the targets Move characteristic.  \r\n        Add 1 to the Attacks characteristic of the targets melee weapons.  \r\n        Add 1 to the Damage characteristic of the targets melee weapons. \r\n        More than 1 effect can apply to a unit at the same time; however, each effect can only be applied to a unit once`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Quickblood: Casting value of 7`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: This unit has Strike-first until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Snapping Jaws - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 4+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  /*'Prince Duvalle': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Fiendish Lure'])],\r\n    }, \r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `'Come Then, Amuse Us'`,\r\n        desc: `At the start of the combat phase, if this unit and any friendly THE CRIMSON COURT models are within 3\" of the same enemy unit, your opponent must pick 1 of the following effects to apply until the end of that phase:\r\n        \r\n        - Improve the Rend characteristic of this unit's Possessed Blade by 1.\r\n        \r\n        - This unit cannot be picked as the target of attacks made with melee weapons.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n /* 'The Crimson Court': {\r\n    effects: [\r\n    //  TheHungerEffect,\r\n      {\r\n        name: `Gorath the Enforcer`,\r\n        desc: `Gorath the Enforcer has a Wounds characteristic of 4.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    //  VampiricAgilityEffect,\r\n    ],\r\n  }, */\r\n\r\n  'Lauka Vai': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, [\"The Queen's Dictat\"])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    //  TheHungerEffect,\r\n      {\r\n        name: `Nightmare Miasma - Passive`,\r\n        desc: `Effect: Subtract 1 from the Rend characteristic of melee weapons used by enemy units while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Impaling Talons - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. If the roll is equal to or less than the targets Health characteristic, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Queen's Dictat: Casting value of 6`,\r\n        desc: `Declare: Pick a visible friendly Soulblight Gravelords Monster wholly within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Pick 1 of the targets Companion melee weapons. Add D3 to the Attacks characteristic of that weapon for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n   //   NightmaresMiasmaEffect,\r\n    ],\r\n  },\r\n\r\n  'Vengorian Lord': {\r\n    /*mandatory: {\r\n      spells: [keyPicker(spells, ['Cursed Reflection'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    //  NightmaresMiasmaEffect,\r\n    //  TheHungerEffect,\r\n      {\r\n        name: `Festering Feast`,\r\n        desc: `Declare: Pick a visible friendly non-Hero Soulblight Gravelords Monster that destroyed an enemy unit this turn and that is wholly within 12\" of this unit to be the target. \r\n        Effect: Heal (6) the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Scything Talons - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice. On a 3+, roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nightmare Miasma - Passive`,\r\n        desc: `Effect: Subtract 1 from the Rend characteristic of melee weapons used by enemy units while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Belladamma Volga': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Under a Killing Moon', 'Lycancurse'])],\r\n    }, */\r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Wolfguard - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Dire Wolves unit:  \r\n        This unit has Ward (4+).  \r\n        Each time you make a successful ward roll for this unit, allocate 1 damage point to a friendly Dire Wolves unit within this units combat range after the damage sequence for this unit has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `First of the Vyrkos - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of friendly Radukar the Wolf, Radukar the Beast, Ivya Volga, Lady Annika, Kritza, Vyrkos Blood-born and Vargskyr units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Under a Killing Moon: Casting value of 7`,\r\n        desc: `Declare: Pick up to 3 visible friendly Dire Wolves units wholly within 18\" of this unit to be the targets, then make a casting roll of 2D6. \r\n        Effect: For the rest of the turn:  \r\n        Add 1 to the Rend characteristic of the targets melee weapons.  \r\n        The targets can ignore the effect of the Beast ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Lady Annika': {\r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Supernatural Speed`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve lying in wait. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Starving Nightmare`,\r\n        desc: `Declare: Pick this unit if it is lying in wait. \r\n        Effect: Set up this unit wholly within enemy territory and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Kiss of the Blade Proboscian`,\r\n        desc: `Declare: Pick an enemy unit that was allocated any damage points inflicted by this units combat attacks this turn to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from save rolls for the target for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Kritza: {\r\n    effects: [\r\n    //  TheHungerEffect,\r\n      {\r\n        name: `Scurrying Retreat`,\r\n        desc: `Effect: If this unit is in combat, roll a dice. On a 2+, this unit can immediately use the Retreat ability as if it were your movement phase without any mortal damage being inflicted on it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Verminous Court`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target, then pick an artefact of power that the target has. \r\n        Effect: Roll a dice. On a 3+, the target no longer has that artefact of power.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Radukar the Wolf': {\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    //  TheHungerEffect,\r\n     // CallToTheHuntEffect,\r\n      {\r\n        name: `Call to the Hunt - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to wound rolls for combat attacks made by friendly Deathrattle, Deadwalkers and Vyrkos Blood-born units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Master of the Pack: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, you can re-roll charge rolls for friendly Soulblight Gravelords Infantry units while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Radukar the Beast': {\r\n    effects: [\r\n    //  TheHungerEffect,\r\n    {\r\n      name: `Call to the Hunt - Passive`,\r\n      desc: `Effect: If this unit charged this turn, for the rest of the turn, add 1 to wound rolls for combat attacks made by friendly Deathrattle, Deadwalkers and Vyrkos Blood-born units while they are wholly within 12\" of this unit.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n     // CallToTheHuntEffect,\r\n      {\r\n        name: `Armour of the Night: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Subtract 1 from hit rolls and wound rolls for attacks that target this unit for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Beast Will Out - Once Per Turn`,\r\n        desc: `Effect: If this unit is not in combat, it can move D6\". It can move into combat.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Gorslav the Gravekeeper': {\r\n    effects: [\r\n      {\r\n        name: `Keeper of the Corpse-Gardens - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Deadwalker Zombies unit:  \r\n        This unit has Ward (4+).  \r\n        Each time you make a successful ward roll for this unit, allocate 1 damage point to a friendly Deadwalker Zombies unit within this units combat range after the damage sequence for this unit has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Arise! Arise! - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 friendly Deadwalker Zombies units wholly within 12\" of this unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, return up to a number of slain models to the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Torgillius the Chamberlain': {\r\n    effects: [\r\n      //GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Trusted Lieutenant - Passive`,\r\n        desc: `Effect: This unit can use the Deathly Invocation ability even if a dierent friendly unit has already used it this turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Failing Fortitude: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, subtract 1 from wound rolls for the targets attacks.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Vyrkos Blood-Born': {\r\n    effects: [\r\n      {\r\n        name: `Shadowfast`,\r\n        desc: `Effect: Roll a dice. On a 3+, this unit can use a Move ability as if it were your movement phase.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Cling to the Shadows - Passive`,\r\n        desc: `Effect: While each model in this unit is within 1\" of any terrain features, this unit cannot be targeted by shooting attacks unless the attacking model is within 9\" of it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    //  VampiricAgilityEffect,\r\n    //  TheHungerEffect,\r\n    ],\r\n  },\r\n\r\n  'Watch Captain Halgrim': {\r\n    effects: [\r\n      {\r\n        name: `Echoes of the Watch - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Deathrattle Skeletons unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Disciplined Advance - Passive`,\r\n        desc: `Effect: Each time you make a run roll for a friendly Deathrattle Skeletons unit wholly within 12\" of this unit, you can change that roll to a 4.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Vargskyr: {\r\n    effects: [\r\n      {\r\n        name: `Bounding Haste - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3. In addition, when this unit uses a Charge ability, it can pass through terrain features and enemy models as if it had Fly.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // TheHungerEffect,\r\n    ],\r\n  },\r\n\r\n  'Kosargi Nightguard': {\r\n    effects: [\r\n      {\r\n        name: `A Pact Maintained - Passive`,\r\n        desc: `Effect: While a friendly Radukar the Wolf or Radukar the Beast is within this units combat range, both that unit and this unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Vampire Lord on Zombie Dragon': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Curse of Exsanguination'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Draconic Claws is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `That Which Should Not Be - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, subtract 1 from the control scores of enemy units while they are in combat with this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Bloodthirsty Dominance - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // TerrorEffect,\r\n    ],\r\n  },\r\n\r\n  'Blood Knights': {\r\n    effects: [\r\n     // TheHungerEffect,\r\n     // StandardBearerEffect,\r\n      {\r\n        name: `Riders of Ruin - Passive`,\r\n        desc: `Effect: When this unit moves, it can pass through models in enemy Infantry units and can pass through the combat ranges of enemy Infantry units, but it cannot end a move in combat unless specified in the ability used.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Trampled to Dust`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this turn to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Vargheists: {\r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Death's Descent - Once Per Turn`,\r\n        desc: `Effect: If this unit is not in combat, remove it from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Vampire Lord': {\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Sanguine Blur - Once Per Turn`,\r\n        desc: `Effect: Roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy non-Hero units and more than 3\" from all enemy Heroes.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Bloodseeker Palanquin': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Blood Siphon'])],\r\n    }, */\r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `A Promising Concoction - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Vampire units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 1 to the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wails of the Damned - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // WailOfTheDamnedEffect,\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n\r\n  'Mortis Engine': {\r\n    effects: [\r\n    //  WailOfTheDamnedEffect,\r\n      {\r\n        name: `The Reliquary - Passive`,\r\n        desc: `Effect: When this unit is set up for the first time, place a stored energy dice beside it with the 1 facing up. Each time a friendly Soulblight Gravelords Wizard successfully casts a spell while it is within 12\" of this unit, increase the value of the stored energy dice beside this unit by 1 (to a maximum of 6).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Nexus of Death Energy - Passive`,\r\n        desc: `Effect: When a friendly Deathrattle or Deadwalkers unit wholly within 12\" of this unit is picked to be the target of the Deathly Invocation ability, add D3 to the number of damage points that can be healed or the combined Health characteristic of models that can be returned.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wave of Power - Once Per Turn`,\r\n        desc: `Declare: Pick up to 3 enemy units within 10\" of this unit to be the targets. \r\n        Effect: Roll a dice for each target. On a 3+, inflict an amount of mortal damage on the target equal to the value of this units stored energy dice. Then, change the value of the stored energy dice back to 1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Coven Throne': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Undying Servitude'])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    //  TheHungerEffect,\r\n      {\r\n        name: `Tactical Insight - Passive`,\r\n        desc: `Effect: Friendly Deathrattle and Deadwalkers units have Ward (5+) while they are wholly within 6\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Scrying Pool - Passive`,\r\n        desc: `Effect: If a friendly Soulblight Gravelords unit wholly within 12\" of this unit uses the Redeploy command, you can pick another friendly Soulblight Gravelords unit wholly within 12\" of this unit that has not used a command this phase to use the Redeploy command immediately after the first has been resolved (this is an exception to Commands, 1.2). No command point is spent the second time that command is used.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Necromancer: {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, [\"Vanhel's Danse Macabre\"])],\r\n    }, */\r\n    effects: [\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Undead Minions - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of a friendly Deathrattle or Deadwalkers unit:  \r\n        This unit has Ward (4+).  \r\n        Each time you make a successful ward roll for this unit, allocate 1 damage point to a friendly Deathrattle or Deadwalkers unit within this units combat range after the damage sequence for this unit has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Vanhel's Danse Macabre - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Deathrattle or Deadwalkers unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target can use 2 Fight abilities this phase. After the first is used, however, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Deadwalker Zombies': {\r\n    effects: [\r\n      {\r\n        name: `Mindless Ferocity - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 6+, inflict 1 mortal damage on the attacking unit after the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Corpse Cart': {\r\n    effects: [\r\n      {\r\n        name: `Locus of Undeath - Passive`,\r\n        desc: `Effect: Melee weapons used by other friendly Deadwalkers units have Crit (Auto-wound) while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // LocusOfUndeathEffect,\r\n    ],\r\n  },\r\n\r\n  'Zombie Dragon': {\r\n    effects: [\r\n      //...GenericEffects.ZombieDragon\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Eect: While this unit has 10 or more damage points, the Attacks characteristic of its Draconic Claws is 5.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Death on Tattered Wings`,\r\n        desc: `Declare: Pick this unit if it has not been deployed. \r\n        Effect: Set up this unit in reserve high above the battlefield. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Loathsome Descent`,\r\n        desc: `Declare: Pick this unit if it is high above the battlefield. \r\n        Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Armour Crunch - Once Per turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy Cavalry or Monster unit in combat with it to be the target. \r\n        Effect: Roll a dice. If the roll is equal to or exceeds the targets Save characteristic, inflict 3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  Terrorgheist: {\r\n    effects: [\r\n     // ...GenericEffects.Terrorgheist\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Skeletal Talons is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sonic Assault - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a dice for each model in the target unit. \r\n        If 3 or more of the dice have the same value, for the rest of the turn, this unit has Strike-first. \r\n        If 6 or more of the dice have the same value, for the rest of the turn, this unit has Strike-first and the target cannot use commands.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gaping Maw - Passive`,\r\n        desc: `Effect: Each time an attack made with this units Fanged Maw scores a critical hit, that attack inflicts 6 mortal damage on the target unit and the attack sequence ends.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Wight King': {\r\n    effects: [\r\n    //  BeheadingStrikeEffect,\r\n      {\r\n        name: `Ancient Strategies - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Deathrattle Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Wight King on Skeletal Steed': {\r\n    effects: [\r\n      {\r\n        name: `Royal Companions - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Deathrattle Cavalry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Lord of Trampling Bones - Passive`,\r\n        desc: `Effect: Add 1 to charge rolls for friendly Deathrattle Cavalry units while they are wholly within 12\" of this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Black Knights': {\r\n    effects: [\r\n    //  DeathlyChargeEffect,\r\n     // StandardBearerEffect,\r\n      {\r\n        name: `The Deathly Charge - Passive`,\r\n        desc: `Effect: If this unit charged this turn, its Barrow Lances have Crit (Mortal) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Grave Guard': {\r\n    effects: [\r\n      {\r\n        name: `Guardians of the King - Passive`,\r\n        desc: `Effect: While any friendly Soulblight Gravelords Infantry Heroes are within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Deathrattle Skeletons': {\r\n    effects: [\r\n      {\r\n        name: `Skeleton Legion`,\r\n        desc: `Effect: You can return D3 slain models to this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'The Sepulchral Guard': {\r\n    effects: [\r\n      {\r\n        name: `The Sepulchral Warden`,\r\n        desc: `The Sepulchral Warden has a Wounds characteristic of 3.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `The Sepulchral Warden`,\r\n        desc: `At the start of your hero phase, if this model is on the battlefield, you can return D3 slain models to this unit.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Frightening Speed`,\r\n        desc: `You can reroll charge rolls for this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Frightening Speed`,\r\n        desc: `This unit is eligible to fight in the combat phase if it is within 6\" of an enemy unit instead of 3\", and it can move an extra 3\" when it piles in.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Serve in Death`,\r\n        desc: `If the unmodified hit roll for an attack made by this unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound roll and save roll for each hit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  'Dire Wolves': {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `On the Hunt - Passive`,\r\n        desc: `Effect: This unit can use a Run ability and still use Charge abilities later in the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Fell Bats': {\r\n    effects: [\r\n    //  TheHungerEffect,\r\n    {\r\n      name: `Beast - Passive`,\r\n      desc: `Effect: This unit has a maximum control score of 1.`,\r\n      when: [END_OF_TURN],\r\n    },\r\n      {\r\n        name: `Fleet and Fell - Passive`,\r\n        desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Cado Ezechiar': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Retribution or Salvation'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     // TheHungerEffect,\r\n      {\r\n        name: `The Court of the Lost`,\r\n        desc: `Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply until the start of your next turn.  \r\n        This unit has a Move characteristic of 12\".  \r\n        Add 1 to casting rolls, unbinding rolls and banishment rolls for this unit.  \r\n        This units melee weapons have Crit (Mortal).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Retribution or Salvation: Casting value of 7`,\r\n        desc: `Declare: Pick a visible unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: If the target is an enemy unit, inflict D3 mortal damage on it. \r\n        If the target is a friendly Deathrattle or Deadwalkers unit, subtract 1 from wound rolls for combat attacks that target that unit for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'Deintalos the Exile': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Channelled Dynamism'])],\r\n    }, \r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n     //TheHungerEffect,\r\n      {\r\n        name: `Crackling Field`,\r\n        desc: `This unit has a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Terrible Dynamism`,\r\n        desc: `At the end of the battleshock phase, if a friendly THE EXILED DEAD unit is within 6\" of this unit, you can return 1 slain model to that unit.`,\r\n        when: [END_OF_BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  'Ivya Volga': {\r\n    effects: [\r\n     // TheHungerEffect,\r\n      {\r\n        name: `Shrieking Swarm - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Behemoth's Bane - Passive`,\r\n        desc: `Effect: Subtract 2 from the Attacks characteristic of enemy Monsters melee weapons while they are in combat with this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Total Dominance: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: For the rest of the turn, subtract 5 from the control scores of enemy Monsters while they are within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'King Morlak Velmorn': {\r\n    effects: [\r\n    //  BeheadingStrikeEffect,\r\n      {\r\n        name: `Deadly Command`,\r\n        desc: `Once per turn, this unit can issue a command to a friendly THE SONS OF VELMORN unit without a command point being spent.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Undying Dynasty`,\r\n        desc: `At the start of the combat phase, roll a dice for each slain model from a friendly THE SONS OF VELMORN unit wholly within 12\" of this unit. On a 4+, you can return 1 slain model to that unit.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n  'Askurgan Trueblades': {\r\n    effects: [\r\n      {\r\n        name: `Gut-Wrenching Howl`,\r\n        desc: `Declare: Pick an enemy unit in combat with this units Curseblood to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Creed of the Askurga Renkai - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks made by enemy Monsters that target this unit. \r\n        Add 1 to hit rolls for combat attacks made by this unit that target enemy Monsters.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n /* 'The Exiled Dead': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Prentice Marcov is the unit champion and has a Wounds characteristic of 3. Add 1 to casting and unbinding rolls for a friendly DEINTALOS THE EXILE if this unit includes Prentice Marcov.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dynamic Cage`,\r\n        desc: `If the unmodified hit roll for an attack made with an Arco-electric Weapon is 6, the target suffers 1 mortal wound and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crackling Field`,\r\n        desc: `While this unit is wholly within 9\" of a friendly DEINTALOS THE EXILE, Bault, Vlash, Ione and Coyl have a ward of 5+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n\r\n /* 'The Sons of Velmorn': {\r\n    effects: [\r\n      {\r\n        name: `Sir Jedran Falseborn`,\r\n        desc: `Sir Jedran Falseborn has a Wounds characteristic of 4.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n     // CursedWeaponsEffect,\r\n      {\r\n        name: `Shield Up!`,\r\n        desc: `Once per turn, at the start of the combat phase, you can say that this unit will form a shieldwall. If you do so, this unit has a Save characteristic of 3+ instead of 4+ until the end of that phase. However, if you do so, this unit cannot make pile-in moves in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Canny Strike`,\r\n        desc: `At the start of the combat phase, you can pick 1 enemy unit within 1\" of this unit and roll a dice. On a 2+, that unit cannot make pile-in moves in that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Sekhar, Fang of Nulahmia': {\r\n    effects: [\r\n      {\r\n        name: `The Time Swallower's Maw - Once Per Battle`,\r\n        desc: `Declare: Pick each enemy unit in combat with this unit to be the targets. \r\n        Effect: This unit cannot use the Serpentine Agility ability for the rest of the battle. Roll 2D6 for each target. If the roll exceeds the targets Move characteristic, inflict an amount of mortal damage on the target equal to the difference between the roll and its Move characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Serpentine Agility - Passive`,\r\n        desc: `Effect: If the unmodified hit roll for an attack that targets this unit is 1-4, the attack fails and the attack sequence ends.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Death's Construction: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, this unit, and any friendly Soulblight Gravelords units while they are wholly within 6\" of this unit, cannot be picked to be the target of abilities used by the target other than Fight abilities.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Summerking`s Entourage': {\r\n    effects: [\r\n      {\r\n        name: `Ushoran: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Monstrous Talons is 6.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Epicentre of Delusion`,\r\n          desc: `Effect: Pick 1 of the following effects to apply until the start of your next turn: \r\n          The Royal Hunt: Add 1 to wound rolls for attacks made by friendly Flesh-eater Courts units that target a Monster. \r\n          Crusading Army: Add 1 to run rolls and charge rolls for friendly Flesh-eater Courts units. \r\n          Defenders of the Realm: Add 1 to save rolls for friendly Flesh-eater Courts units while they are contesting an objective you control. \r\n          The Grand Tournament: Add 1 to hit rolls for attacks made by other friendly Flesh-eater Courts Heroes if they charged in the same turn.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Shroudcage Fragment - Once Per Turn`,\r\n          desc: `Declare: Pick up to 3 enemy units in combat with this unit to be the targets. \r\n          Effect: Roll a dice for each target. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Ushoran: Glimpse of Delusion: Casting value of 7`,\r\n          desc: `Declare: Pick a visible enemy model within 18\" of this unit to be the target, pick another enemy unit within the targets combat range to be the victim, then make a casting roll of 2D6. \r\n          Effect: Pick 1 of the targets melee weapons. Immediately resolve combat attacks made with that weapon against the victim.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Armoury of Madness - Reaction: You declared a Fight ability for this unit`,\r\n          desc: `Effect: If any damage points inflicted by attacks made as part of that Fight ability are allocated to any enemy units, those enemy units cannot use commands until the start of your next turn.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Crypt Guard: Royal Bodyguard - Passive`,\r\n          desc: `Effect: While any friendly Flesh-eater Courts Heroes are wholly within this units combat range, both this unit and those Heroes have Ward (5+).`,\r\n          when: [DURING_GAME],\r\n        },\r\n        {\r\n          name: `Morbheg Kinghts: Shrieking Charge`,\r\n          desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of this unit to be the target. \r\n          Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n          when: [CHARGE_PHASE],\r\n        },\r\n        {\r\n          name: `Morbheg Knights: Predator's Pounce - Passive`,\r\n          desc: `Effect: This unit can use Charge abilities even if it used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on this unit by Retreat abilities.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n        {\r\n          name: `Deranged Transformation: Casting value of 7 (UNLIMITED)`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to cast this spell, pick another visible unit in this Regiment of Renown wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n          Effect: Until the start of your next turn:  \r\n          Add 2\" to the targets Move characteristic.  \r\n          Add 1 to wound rolls for the targets combat attacks.`,\r\n          when: [HERO_PHASE],\r\n        },\r\n        {\r\n          name: `Maddening Radiance - Passive`,\r\n          desc: `Effect: Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown while they are wholly within 12\" of the Ushoran in this Regiment of Renown.`,\r\n          when: [COMBAT_PHASE],\r\n        },\r\n        {\r\n          name: `Summon Deluded Throngs - Once Per Battle`,\r\n          desc: `Declare: Pick the Ushoran in this Regiment of Renown to use this ability, then pick another unit in this Regiment of Renown that has been destroyed to be the target. \r\n          Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 6\" of a battlefield edge and more than 9\" from all enemy units. The replacement unit is part of this Regiment of Renown.`,\r\n          when: [MOVEMENT_PHASE],\r\n        },\r\n    ],\r\n  },\r\n  'ROR: Jerrion`s Delegation': {\r\n    effects: [\r\n      {\r\n        name: `Marrowscroll Herald: The King's Entreaty - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, pick 1 of the following effects: \r\n        Attack the Apostate!: Friendly Flesh-eater Courts units in combat with the target have Strike-first for the rest of the turn. \r\n        Welcome the Disciple!: The target has the Infected keyword for the rest of the battle. Each time your opponent declares a command, Spell ability or Prayer ability for an Infected unit, roll a dice. On a 5+:  \r\n        If they declared a command, that command has no effect. The command still counts as having been used and the command points spent to use the command are still lost.  \r\n        If they declared a Spell or Prayer ability, that spell or prayer fails.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Marrowscroll Herald: Don't Shoot the Messenger - Passive`,\r\n        desc: `Effect: While this unit is not in combat and is wholly within the combat ranges of 3 or more other friendly Flesh-eater Courts Infantry models, it is not visible to enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Crypt Ghouls: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Horrors: Royal Approval - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units melee weapons while it is wholly within 12\" of any friendly Courtiers or Abhorrants.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Crypt Flayers: Escort Courtier - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a friendly Flesh-eater Courts Infantry Hero that does not have Fly and is within this units combat range to be the target. \r\n        Effect: Remove the target from the battlefield. Then, this unit can move a distance up to its Move characteristic. It cannot end that move in combat. Then, set up the target within this units combat range and more than 3\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Urgent Missive - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown can use Charge abilities even if they used a Retreat ability in the same turn. In addition, no mortal damage is inflicted on units in this Regiment of Renown by Retreat abilities.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Liche`s Hand': {\r\n    effects: [\r\n      {\r\n        name: `Arkhan: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Razaraks Ebon Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: The Doom of Traitors - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit in combat with it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll. If the target is a Hero, double the amount of mortal damage inflicted.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    //  FeasterOfSoulsEffect,\r\n      {\r\n        name: `Arkhan: Staff of Spirits - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit. Each time this unit successfully casts a spell, Heal (1) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Curse of Years: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 10 dice. For each 6:  \r\n        Inflict 1 mortal damage on the target.  \r\n        Roll an extra dice. \r\n        For each 5+ on those extra dice, repeat the above bullet points. Then, do the same for each 4+, then each 3+, then each 2+.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arkhan: Mortarch of Sacrament - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Ossiarch Bonereapers unit wholly within 18\" of this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on that unit. This unit can use this ability more than once per phase but only once per Spell ability`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Ebon-Wrought Armour - Passive`,\r\n        desc: `Effect: This unit has Ward (3+) against damage points inflicted by Spell abilities, Prayer abilities and abilities used by Manifestations. If you make a successful ward roll for this unit, or if this unit destroys an enemy Manifestation, give this unit an arcane charge token. This unit cannot have more than 1 arcane charge token at once.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Morghast Archai: Discharge Armour`,\r\n        desc: `Declare: If this unit has an arcane charge token, pick a friendly Ossiarch Bonereapers Wizard wholly within 12\" of this unit to be the target. \r\n        Effect: Remove this units arcane charge token, then add 1 to casting rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Morghast Harbingers: Harbingers of Death - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Skeletal Splintering: Casting value of 8 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Arkhan the Black in this Regiment of Renown to cast this spell, pick a visible enemy unit within 18\" of them that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unholy Sacraments - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making banishment rolls for the Arkhan the Black in this Regiment of Renown, to a maximum of 3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Scions of the Necropolis': {\r\n    effects: [\r\n      {\r\n        name: `Katakros: Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Inda-Khaat is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Katakros: Prime Necrophoros - Passive`,\r\n        desc: `Effect: Add 3 to the control scores of other friendly Ossiarch Bonereapers units while they are wholly within 18\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Katakros: Aviarch Spymaster - Once Per Turn - Reaction: Opponent declared a command for a unit within 18\" of this unit`,\r\n        desc: `Effect: Roll a dice. On a 5+, that command has no effect, it still counts as having been used and the command points spent to use it are still lost.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Katakros: Command Ability - Supreme Lord of the Bonereaper Legions`,\r\n        desc: `Declare: Pick up to 3 friendly Ossiarch Bonereapers units wholly within 18\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, add 1 to save rolls for the targets while they are wholly within 18\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Immortis Guard: Soulbound Protectors - Passive`,\r\n        desc: `Effect: Add 1 to ward rolls for friendly Ossiarch Bonereapers Heroes within this units combat range. However, each time you make a ward roll of 1 for a friendly Ossiarch Bonereapers Hero within this units combat range, allocate 1 damage point to this unit after the damage sequence for that Hero has been resolved (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Bulwark of the Necropolis`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Subtract 2D6 from the targets control score for the rest of the turn.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Sorrowmourn Choir': {\r\n    effects: [\r\n      {\r\n        name: `Lady Olynder: Grief-Stricken: Casting value of 6`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Ignore positive modifiers to hit rolls, wound rolls and save rolls for the target for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Lady Olynder: Mortarch of Grief - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Lady Olynder: No Rest For the Wicked - Once Per Battle`,\r\n        desc: `Declare: Pick any number of friendly Nighthaunt units on the battlefield to be the targets. \r\n        Effect: For each target, you can return a number of slain models to that unit with a combined Health characteristic of up to D3+3.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Myrmourn Banshees: Spell-Eaters - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If a friendly Nighthaunt unit wholly within 12\" of this unit was picked to be the target of that spell, this unit can use the Unbind ability as if it had Wizard (1). Add 1 to the unbinding roll for that ability. If the spell is unbound, inflict D3 mortal damage on the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Harrowing Shriek - Passive`,\r\n        desc: `Effect: If this unit charged in the same turn, subtract 1 from wound rolls for attacks made by enemy units while they are in combat with this unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dreadscythe Harridans: Murderous Bloodlust - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units combat attacks while it is in combat with any damaged enemy units or while it is in combat with any enemy units that had any models slain in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ghostly Paths: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: This spell can be cast by the same Wizard more than once per phase. Pick the Lady Olynder in this Regiment of Renown to cast this spell, pick a visible friendly unit in this Regiment of Renown that is wholly within 12\" of them, that is not in combat and that has not been picked to be the target of this spell this turn to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Insubstantial - Passive`,\r\n        desc: `Effect: Ignore modifiers to save rolls (positive and negative) for units in the Regiment of Renown.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Harvesters of Sorrow - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with a unit in this Regiment of Renown to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Big Drogg Fort-Kicka': {\r\n    effects: [\r\n      {\r\n        name: `Pulverising Strike`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: This unit can make a pile-in move. Then, roll a dice. On a 4+, inflict 4D6 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Smash Down - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 3\" of this unit to be the target. \r\n        Effect: If the target is Faction Terrain, inflict D3+3 mortal damage on it. Then, roll a D3 for each non-Monster unit (friendly and enemy) within 3\" of the target. On a 2+, inflict an amount of mortal damage on that unit equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Fortcrusha Flail is 4 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grievous Halitosis - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 6, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  \r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_COMBAT_PHASE,\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\nimport { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport BattleTraits from './battle_traits'\r\nimport Artifacts from './artifacts'\r\nimport BattleTactics from './battle_tactics'\r\nimport CommandTraits from './command_traits'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Flavors from './flavors'\r\nimport Spells from './spells'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport Units from './units'\r\nimport { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { SOULBLIGHT_GRAVELORDS } from 'meta/factions'\r\n\r\n /*const baseSubfaction = {\r\n  effects: [],\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battle_tactics: [BattleTactics],\r\n    command_traits: [CommandTraits],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n} satisfies IItemDescription\r\n\r\n/*const subFactions = {\r\n  'Soulblight': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Unparalleled Expertise`,\r\n        desc: `If a friendly LEGION OF BLOOD VAMPIRE HERO is within 3\" of any enemy units, it is bloodthirsty. If a friendly LEGION OF BLOOD VAMPIRE HERO is more than 3\" from all enemy units, it is empowered. Add 1 to the Attacks characteristic of melee weapons used by a unit that is bloodthirsty. Add 1 to casting, dispelling and unbinding rolls for a unit that is empowered.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Unparalleled Expertise (Bloodthirsty)`,\r\n        desc: `Add 1 to the Attacks characteristic of melee weapons used by a unit that is bloodthirsty.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unparalleled Expertise (Empowered)`,\r\n        desc: `Add 1 to casting, dispelling and unbinding rolls for a unit that is empowered.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Premeditated Bloodshed`,\r\n        desc: `Pick 1 friendly LEGION OF BLOOD VAMPIRE HERO. Until the end of this turn, ward rolls cannot be made for wounds and mortal wounds caused by attacks made by this HERO.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Immortal Majesty`,\r\n        desc: `Pick 1 friendly LEGION OF BLOOD VAMPIRE HERO. Until the end of this turn, your opponent must spend 2 command points instead of 1 to issue the All-out Defence and Inspiring Presence commands to enemy units within 12\" of that HERO.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Legion of Night': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Ageless Cunning`,\r\n        desc: `Once per turn, during the enemy charge phase, after an enemy unit finishes a charge move, you can pick 1 friendly LEGION OF NIGHT unit within 12\" of that enemy unit and more than 3\" from all enemy units. That unit can attempt a charge.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Swift Form`,\r\n        desc: `At the start of the hero phase, you can carry out this heroic action with a friendly LEGION OF NIGHT VAMPIRE HERO instead of any other heroic action you can carry out with that HERO. Pick 1 friendly LEGION OF NIGHT VAMPIRE HERO more than 3\" from all enemy units. Remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. That HERO cannot move in the following movement phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Vyrkos Dynasty': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `The Strength of the Wolf is the Pack`,\r\n        desc: `In the combat phase, after a friendly VYRKOS HERO has fought for the first time in that phase, you can pick 1 friendly VYRKOS unit that has not yet fought in that combat phase, that is within 3\" of an enemy unit and that is wholly within 12\" of that friendly VYRKOS HERO. That unit fights immediately.\r\n\r\n        Designer's Note: If the unit you pick to fight immediately is a VYRKOS HERO, after that unit has fought, you cannot then use this ability to pick another friendly VYRKOS unit to fight immediately.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Pack Alpha`,\r\n        desc: `Pick 1 friendly VYRKOS VAMPIRE HERO. Then, pick 1 friendly VYRKOS DEADWALKERS unit within 12\" of that HERO and visible to them. You can add D3 models to that unit.\r\n\r\n        Designer's Note: This ability allows a friendly VYRKOS DEADWALKERS unit to be taken above its maximum unit size.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Kin of the Wolf`,\r\n        desc: `Pick 1 friendly VYRKOS VAMPIRE HERO. If you do so, you can add 1 unit of 10 Dire Wolves to your army. The unit must be set up wholly within 9\" of the HERO carrying out this heroic action and more than 9\" from all enemy units. That DIRE WOLVES unit cannot move in the following movement phase. You cannot carry out this heroic action more than once per battle.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Kastelai Dynasty': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Might of the Crimson Keep`,\r\n        desc: `At the end of the combat phase, if any enemy models were slain by attacks made with melee weapons by a friendly KASTELAI VAMPIRE unit in that phase, you can pick 1 relevant ability below to apply to that friendly unit for the rest of the battle. If more than 1 of the abilities below would apply to that unit, you must pick which ability that unit gains. A unit cannot gain the same ability more than once per battle.\r\n\r\n        If the slain model was a HERO or MONSTER:\r\n\r\n        Bloodied Strength: Add 1 to the Damage characteristic of that unit's melee weapons (excluding those of its mounts).\r\n\r\n        If the slain model had a Wounds characteristic of 3 or more and was not a HERO or MONSTER:\r\n\r\n        Seized Fervour: Add 1 to the Attacks characteristic of that unit's melee weapons (excluding those of its mounts).\r\n\r\n        If the slain model had a Wounds characteristic of 2 or less:\r\n        \r\n        Absorbed Speed: Add 1\" to that unit's Move characteristic.`,\r\n        when: [END_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: Masters of Retaliation`,\r\n        desc: `At the start of the hero phase, you can carry out this heroic action with a friendly KASTELAI VAMPIRE HERO instead of any other heroic action you can carry out with that HERO. Pick 1 friendly KASTELAI VAMPIRE HERO. Until the end of that turn, at the end of each phase, if any wounds or mortal wounds were allocated to that HERO in that phase and that HERO was not slain, roll a dice for each enemy unit within 3\" of that HERO. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'Avengorii Dynasty': {\r\n    ...baseSubfaction,\r\n    effects: [\r\n      {\r\n        name: `Cursed Abominations`,\r\n        desc: `Once per turn, at the start of the combat phase, you can pick 1 friendly AVENGORII MONSTER within 3\" of any enemy units. Until the end of that phase, use the top row on that unit's damage table, regardless of how many wounds it has suffered.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions */\r\n\r\nconst subFactions = {\r\n  [SOULBLIGHT_GRAVELORDS]: {\r\n    effects: pickEffects(BattleTraits, [SOULBLIGHT_GRAVELORDS]),\r\n\r\n   /* mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['All-out Slaughter'])],\r\n    }, */\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n     // battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n     // command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n     // endless_spells: [EndlessSpells],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n     // prayers: [Prayers],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  }, \r\n} satisfies TItemDescriptions \r\nexport default subFactions ","import { Faction } from 'factions/factionClass'\r\n//import { pickEffects } from 'factions/metatagger'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { SOULBLIGHT_GRAVELORDS } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SoulblightGravelordsFaction = new Faction(\r\n  SOULBLIGHT_GRAVELORDS,\r\n  DEATH,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  //rule_sources.BATTLETOME_SOULBLIGHT_GRAVELORDS,\r\n  //pickEffects(battle_traits, [SOULBLIGHT_GRAVELORDS])\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_SYLVANETH: {\r\n    name: 'Battletome: Sylvaneth',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/08/aYMD9OEkOOdb02oN.pdf',\r\n  },\r\n  ERRATA_JANUARY_2023: {\r\n    name: 'Errata (January 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/08/7iIV0GHcihoKuRXU.pdf',\r\n  },\r\n  ERRATA_NOVEMBER_2023: {\r\n    name: 'Errata (November 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/08/OoFjYBMRphTA30o3.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Greenwood Gladius': {\r\n    effects: [\r\n      {\r\n        name: `Greenwood Gladius`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Seed of Rebirth': {\r\n    effects: [\r\n      {\r\n        name: `Seed of Rebirth - Passive`,\r\n        desc: `Effect: If this unit would be destroyed, before removing it from play, roll a dice. On a 3+, this unit is not destroyed and any remaining damage points inflicted on it have no effect. Then, Heal (1) this unit. This unit cannot use this ability again for the rest of the battle.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Crown of Fell Bowers': {\r\n    effects: [\r\n      {\r\n        name: `Crown of Fell Bowers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On 3+, add 1 to wound rolls for combat attacks made by friendly Sylvaneth units that target that enemy unit this phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'Acorn of the Ages': {\r\n    effects: [\r\n      {\r\n        name: `Acorn of the Ages`,\r\n        desc: `Once per battle, if the bearer is on the battlefield, you can set up 1 AWAKENED WYLDWOOD wholly within 12\" of the bearer and more than 3\" from other models, endless spells, invocations, terrain features and objectives, and add it to your army.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Vesperal Gem': {\r\n    effects: [\r\n      {\r\n        name: `The Vesperal Gem`,\r\n        desc: `Once in each of your hero phases, when the bearer attempts to cast a spell from the Lore of the Deepwood, instead of making a casting roll you can say they are using the Vesperal Gem. If you do so, that spell is automatically cast (do not roll 2D6) and cannot be unbound. After the effect of that spell has been resolved, roll a D6. On a 1, the bearer suffers D3 mortal wounds.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Luneth's Lamp\": {\r\n    effects: [\r\n      {\r\n        name: `Luneth's Lamp`,\r\n        desc: `The bearer can attempt to banish 1 invocation in the hero phase even if they are not a PRIEST. In addition, add 2 to dispelling rolls and banishment rolls for the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Evergreen Hunt\r\n  'Heartwood Hunting Horn': {\r\n    effects: [\r\n      {\r\n        name: `Heartwood Hunting Horn`,\r\n        desc: `Once per battle, at the start of any battle round, the bearer can say that they will blow their Heartwood Hunting Horn. If they do so, you receive 1 additional Hunting Harmony chord for that battle round.`,\r\n        when: [START_OF_ROUND],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { StrategistsBattalionEffect } from 'generic_rules/core_battalions'\r\n\r\nconst Battalions = {\r\n /* 'Lords of the Clan': {\r\n    effects: [StrategistsBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Battalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Trophy Kill': {\r\n    effects: [\r\n      {\r\n        name: 'Trophy Kill',\r\n        desc: `You complete this tactic if the quarry was destroyed by an attack made with a melee weapon in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Encircled: {\r\n    effects: [\r\n      {\r\n        name: 'Encircled',\r\n        desc: `You complete this tactic if, at the end of this turn, all friendly units are in the same large quarter of the battlefield as the quarry.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spring the Trap': {\r\n    effects: [\r\n      {\r\n        name: 'Spring the Trap',\r\n        desc: `You complete this tactic if 4 or more friendly units made a charge move in this turn and 1 or more of those units made an attack with a melee weapon that targeted the quarry in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eradicate Trespassers': {\r\n    effects: [\r\n      {\r\n        name: 'Eradicate Trespassers',\r\n        desc: `Pick 1 enemy unit within 6\" of a friendly Awakened Wyldwood. You complete this battle tactic if that unit is destroyed during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Harness the Spirit Paths': {\r\n    effects: [\r\n      {\r\n        name: `Harness the Spirit Paths`,\r\n        desc: `You complete this battle tactic if any models in a friendly SYLVANETH unit that was set up using the From the Woodland Depths battle trait this turn make a charge move this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Balance the Cycle': {\r\n    effects: [\r\n      {\r\n        name: `Balance the Cycle`,\r\n        desc: `Pick 1 enemy unit within 12\" of an overgrown terrain feature or friendly Awakened Wyldwood. You complete this battle tactic if that unit is destroyed by an attack made by a friendly SYLVANETH unit that was added to your army this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'March of the Forest Lords': {\r\n    effects: [\r\n      {\r\n        name: `March of the Forest Lords`,\r\n        desc: `Pick 1 enemy MONSTER on the battlefield. You complete this battle tactic if that MONSTER is slain by an attack made by a friendly SPIRIT OF DURTHU, TREELORD ANCIENT or TREELORD during this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Unleash Ghyran's Wrath\": {\r\n    effects: [\r\n      {\r\n        name: `Unleash Ghyran's Wrath`,\r\n        desc: `Pick 1 friendly SYLVANETH WIZARD on the battlefield. You complete this battle tactic if a spell successfully cast by that WIZARD, or an endless spell summoned by that WIZARD, destroys an enemy unit this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { SYLVANETH } from 'meta/factions'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_ROUND,\r\n  WARDS_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTraits = {\r\n  [SYLVANETH]: {\r\n    effects: [\r\n      {\r\n        name: `Endless Growth - Once Per Turn`,\r\n        desc: `Declare: Pick any number of friendly Sylvaneth units wholly within 6\" of a friendly Awakened Wyldwood to be the targets. \r\n        Effect: Heal (D3) each target.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Walk the Hidden Paths - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Sylvaneth unit that is not in combat and is wholly within 6\" of a friendly Awakened Wyldwood to use this ability. \r\n        Effect: Remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units and wholly within 6\" of a different friendly Awakened Wyldwood.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Strike and Fade - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Sylvaneth unit that is in combat and is wholly within 6\" of a friendly Awakened Wyldwood to use this ability. \r\n        Effect: Remove that unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units and wholly within 6\" of a different friendly Awakened Wyldwood.`,\r\n        when: [END_OF_TURN],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_SYLVANETH,\r\n          rule_sources.ERRATA_OCTOBER_2022,\r\n          rule_sources.ERRATA_JANUARY_2023,\r\n        ],\r\n      },\r\n      {\r\n        name: `Awakened Wyldwood (Faction Terrain) - Deploy Wyldwood`,\r\n        desc: `Effect: Set up this terrain feature wholly within friendly territory, more than 3\" from all objectives and other terrain features. This terrain feature has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Awakened Wyldwood (Faction Terrain) - Growing Woods - Passive`,\r\n        desc: `Effect: Each time you set up an Awakened Wyldwood, you can place 1-3 scenery pieces (Terrain, 1.6). If you place more than 1 scenery piece, the tips at the end of each base must touch, forming a circle. Add 2 to the Health characteristic of this terrain feature for each additional scenery piece that is placed after the first.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Awakened Wyldwood (Faction Terrain) - Overgrown Wilderness - Passive`,\r\n        desc: `Effect: Enemy units can be targeted by shooting attacks made by friendly Sylvaneth units even if they are behind or wholly on this terrain feature (this is an exception to Terrain, 1.2).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Awakened Wyldwood (Faction Terrain) - Vengeful Forest Spirits - Once Per Turn`,\r\n        desc: `Declare: Pick each enemy unit within this terrain features combat range to be the targets. \r\n        Effect: Roll a dice for each target. On a 4+, inflict D3 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  // Seasons of War\r\n /* 'The Burgeoning': {\r\n    effects: [\r\n      {\r\n        name: `The Burgeoning`,\r\n        desc: `Friendly SYLVANETH units that did not charge in the same turn and are wholly within 9\" of an overgrown terrain feature or friendly Awakened Wyldwood have a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Reaping': {\r\n    effects: [\r\n      {\r\n        name: `The Reaping`,\r\n        desc: `Add 3 to the range within which you can pick friendly SYLVANETH units with the Places of Power and From the Woodland Depths battle traits.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Dwindling': {\r\n    effects: [\r\n      {\r\n        name: `The Dwindling`,\r\n        desc: `In the hero phase, you can reroll 1 casting roll, 1 unbinding roll and 1 dispelling roll, so long as the friendly WIZARD you pick is a SYLVANETH WIZARD that is wholly within 9\" of an overgrown terrain feature or friendly Awakened Wyldwood.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Everdusk: {\r\n    effects: [\r\n      {\r\n        name: `Everdusk`,\r\n        desc: `Subtract 3\" from the range within which you can pick friendly SYLVANETH units with the Places of Power and From the Woodland Depths battle traits. However, if the unmodified hit roll for an attack made with a melee weapon by a friendly SYLVANETH unit wholly within 6\" of an overgrown terrain feature or friendly Awakened Wyldwood is 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n\r\n  'The Evergreen Hunt': {\r\n    effects: [\r\n      {\r\n        name: `To Honour Kurnouth`,\r\n        desc: `Friendly EVERGREEN HUNT units that do not have the HERO keyword have the Battleline battlefield role.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Rhythm of the Chase`,\r\n        desc: `After deployment, before the players have determined who will take the first turn, you can pick 1 enemy unit on the battlefield to be the quarry. If the quarry is destroyed, at the start of your next hero phase, you can pick 1 enemy unit on the battlefield to be the new quarry.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Harmonies of the Hunt`,\r\n        desc: `At the start of each battle round, after the priority roll has been made, each player commanding an Evergreen Hunt army must determine their Hunting Harmony for that battle round, starting with the player taking the first turn. A Hunting Harmony is made up of a number of chords. You start with 0 chords and receive 1 chord for the following:\r\n\r\n        - If a friendly BELTHANOS is on the battlefield.\r\n        - For each friendly EVERGREEN HUNT unit wholly ewithin the same large quarter of the battlefield as the quarry.\r\n        - For each quarry destroyed during the battle.\r\n        \r\n        Add up the number of chords you received and consult the Hunting Harmony Table to see which effects will apply to your army for that battle round. These effects are cumulative: if you have 6 chords, all of the effects in the table will apply. Hunting Harmony chords are lost at the end of each battle round.\r\n        \r\n        0: Discordant: No effect.\r\n        1: Simple: Add 1 to run rolls and charge rolls for friendly units wholly within the same large quarter of the battlefield as the quarry.\r\n        2: Tuneful: Add 1 to hit rolls and wound rolls for attacks made with melee weapons that target an enemy unit wholly within the same large quarter of the battlefield as the quarry.\r\n        3-5: Melodic: Add 1 to the Attacks characteristic of melee weapons used by friendly units while they are within 3\" of the quarry.\r\n        6+: Mellifluous: While a friendly unit is wholly within the same large quarter of the battlefield as the quarry, it is eligible to fight in the combat phase if it is within 6\" of the quarry instead of 3\", and it can move an extra 3\" when it piles in. `,\r\n        when: [START_OF_ROUND],\r\n      },\r\n      {\r\n        name: `Adundant Growth`,\r\n        desc: `After territories are determined, before faction terrain features are set up, you can pick up to 3 terrain features on the battlefield that are wholly outside enemy territory. These terrain features are considered by you to be overgrown terrain features.\r\n\r\n        At the start of your hero phase, you can heal 1 wound allocated to each friendly EVERGREEN HUNT unit that is wholly within 9\" of an overgrown terrain feature.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Adundant Growth`,\r\n        desc: `At the start of your hero phase, you can heal 1 wound allocated to each friendly EVERGREEN HUNT unit that is wholly within 9\" of an overgrown terrain feature.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Action: A Prize Quarry is Sighted`,\r\n        desc: `Pick 1 friendly EVERGREEN HUNT HERO and 1 enemy unit within 9\" of that HERO. That enemy unit becomes the quarry instead of the enemy unit that was picked to be the quarry.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, START_OF_COMBAT_PHASE, START_OF_MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  // IRONBARK Flavor\r\n /* 'Stand Firm': {\r\n    effects: [\r\n      {\r\n        name: `Stand Firm`,\r\n        desc: `You can use this command ability at the start of the enemy combat phase. The unit that receives the command must be a friendly IRONBARK unit that is within 3\" of an enemy unit that made a charge move in the same turn. Pick 1 enemy unit within 3\" of that friendly IRONBARK unit and roll a dice. On a 2+, that enemy unit suffers D3 mortal wounds. You can use this command ability more than once in the same phase, but if you do SO, you cannot pick the same enemy unit more than once in the same phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // ARCH-REVENANT Commands\r\n  'Call to Battle': {\r\n    effects: [\r\n      {\r\n        name: `Call to Battle`,\r\n        desc: `You can use this command ability at the start of the combat phase. Pick 1 friendly SYLVANETH, add 1 to the Attacks characteristic of melee weapons used by that unit until the end of the phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Belthanos\r\n  'The Unending Hunt': {\r\n    effects: [\r\n      {\r\n        name: `The Unending Hunt`,\r\n        desc: `You can use this command ability at the start of your movement phase. The unit that receives the command must be a friendly SYLVANETH unit. That unit can retreat and still charge later in the turn.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SAVES_PHASE, START_OF_HERO_PHASE } from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst CommandTraits = {\r\n /* 'Gnarled Warrior': {\r\n    effects: [\r\n      {\r\n        name: `Gnarled Warrior`,\r\n        desc: `Ignore modifiers (positive and negative) to save rolls for attacks that target this general.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Spites': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Spites`,\r\n        desc: `In the combat phase, subtract 1 from the Attacks characteristic of melee weapons used by enemy units (to a minimum of 1) that finish a pile-in move within 3\" of this general until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Warsinger: {\r\n    effects: [\r\n      {\r\n        name: `Warsinger`,\r\n        desc: `Declare: Pick a friendly Sylvaneth unit wholly within 12\" of this unit to be the target. \r\n        Effect: Add 2\" to the Move characteristic of the target for the rest of the turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Nurtured by Magic': {\r\n    effects: [\r\n      {\r\n        name: `Nurtured by Magic`,\r\n        desc: `Once per turn, if this general successfully casts a spell that is not unbound, pick 1 friendly SYLVANETH unit wholly within 18\" of this general. If you do so, heal up to D3 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  Spellsinger: {\r\n    effects: [\r\n      {\r\n        name: `Spellsinger - Passive`,\r\n        desc: `Effect: While this unit is within the combat range of an Awakened Wyldwood: \r\n        If this unit is a Wizard, add 1 to casting rolls for this unit. \r\n        If this unit is not a Wizard, it has Wizard (1) instead.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [rule_sources.BATTLETOME_SYLVANETH, rule_sources.ERRATA_OCTOBER_2022],\r\n      },\r\n    ],\r\n  },\r\n  'Radiant Spirit': {\r\n    effects: [\r\n      {\r\n        name: `Radiant Spirit - Reaction: Opponent declared a Spell or Prayer ability`,\r\n        desc: `Used By: This unit if it is wholly within 12\" of a friendly Sylvaneth unit picked to be the target of that spell or prayer. \r\n        Effect: Roll a dice. On a 3+, ignore the effect of that spell or prayer on that unit. This unit can use this ability more than once per phase but only once per Spell or Prayer ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Evergreen Hunt\r\n/*  'Sapwood Leader': {\r\n    effects: [\r\n      {\r\n        name: `Sapwood Leader`,\r\n        desc: `When you use the Abundant Growth battle trait to heal this general, you can heal up to D3 wounds allocated to this general instead of 1.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n} from 'types/phases'\r\n\r\nconst EndlessSpells = {\r\n /* Gladewyrm: {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7. Set up this endless spell wholly within 6\" of the caster. Only SYLVANETH WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n      {\r\n        name: `Death From Below`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit within 1\" of it. On a 3+, that unit suffers D3 mortal wounds. This ability has no effect on SYLVANETH units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Healing Mist`,\r\n        desc: `After this endless spell has moved, roll a dice for each SYLVANETH unit within 6\" of this model. On a 3+, heal up to D3 wounds allocated to that unit.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spiteswarm Hive': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7. Set up this endless spell wholly within 15\" of the caster. Only SYLVANETH WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Hive Nourishes`,\r\n        desc: `At the end of the hero phase, if a SYLVANETH WIZARD or SYLVANETH HERO in that player's army is within 9\" of this endless spell, that unit's commanding player can use 1 of the following abilities:\r\n\r\n        Vital Venoms: Pick 1 friendly SYLVANETH unit wholly within 9\" of this endless spell. On a 2+, add 3\" to normal moves and charge moves for that unit until the end of that turn.\r\n\r\n        Shielding Swarm: Pick 1 friendly SYLVANETH unit wholly within 9\" of this endless spell. On a 2+, worsen the Rend characteristic of attacks that target that unit by 1 (to a minimum of ) until the end of that turn.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Vital Venoms`,\r\n        desc: `If active, add 3\" to normal moves and charge moves for that unit until the end of that turn.`,\r\n        when: [MOVEMENT_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Shielding Swarm`,\r\n        desc: `If active, worsen the Rend characteristic of attacks that target that unit by 1 (to a minimum of ) until the end of that turn.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vengeful Skullroot': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 6. Set up this endless spell wholly within 6\" of the caster. Only SYLVANETH WIZARDS can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Terrors Unearthed`,\r\n        desc: `If a unit fails a battleshock test within 3\" of this endless spell, add D3 to the number of models that flee. This ability has no effect on SYLVANETH units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Strangleroots`,\r\n        desc: `After this endless spell has moved, roll a dice for each unit that has any models it passed across and each other unit within 1\" of it at the end of its move. On a 2+, that unit suffers D3 mortal wounds, or D6 mortal wounds if that unit is also within 6\" of any AWAKENED WYLDWOODS. This ability has no effect on SYLVANETH units.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Eight_Inches,\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { keyPicker } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Lords of the Clan': {\r\n    effects: [\r\n      {\r\n        name: `Healing Song - Passive`,\r\n        desc: `Effect: When using the Endless Growth ability, friendly Sylvaneth Monsters can Heal (3) instead of Heal (D3).`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Forest Folk': {\r\n    effects: [\r\n      {\r\n        name: `Lacerating Strike - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of melee weapons used by friendly Sylvaneth non-Kurnothi Infantry units that charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Outcasts': {\r\n    effects: [\r\n      {\r\n        name: `The Terror in the Eaves - Passive`,\r\n        desc: `Effect: Subtract 3 from the control scores of enemy units while they are in combat with friendly Sylvaneth units.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Free Spirits': {\r\n    effects: [\r\n      {\r\n        name: `Fleet and Swift - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Sylvaneth Cavalry unit to use this ability. \r\n        Effect: This unit can use Charge abilities even if it used a Run ability this turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \r\n  \r\n  \r\n  \r\n  // Glades\r\n /* Oakenbrow: {\r\n    effects: [\r\n      {\r\n        name: `Our Roots Run Deep`,\r\n        desc: `When determining which row to use on the damage table of a friendly OAKENBROW TREELORD, TREELORD ANCIENT or SPIRIT OF DURTHU, it is treated as having suffered half the number of wounds that are actually allocated to it (rounding up).`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Gnarlroot: {\r\n    effects: [\r\n      {\r\n        name: `Keepers of the Arcane`,\r\n        desc: `Once per turn, when you make a casting roll or unbinding roll for a friendly GNARLROOT WIZARD that is wholly within 9\" of an overgrown terrain feature or friendly Awakened Wyldwood, you can roll 3D6 instead of 2D6. If you do so, remove 1 dice of your choice from the roll, and then use the remaining dice to determine that casting roll or unbinding roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Heartwood: {\r\n    effects: [\r\n      {\r\n        name: `Masters of the Hunt`,\r\n        desc: `After deployment but before the first battle round begins, you can pick up to 3 different enemy units on the battlefield to be the quarry of the hunt. If you do so, add 1 to hit rolls for attacks made by friendly HEARTWOOD units that target those units.`,\r\n        when: [DURING_SETUP, COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* Ironbark: {\r\n    /*mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Stand Firm'])],\r\n    }, \r\n    effects: [],\r\n  },\r\n  Winterleaf: {\r\n    effects: [\r\n      {\r\n        name: `Winters Bite`,\r\n        desc: `Enemy units within 3\" of a friendly WINTERLEAF unit cannot retreat. In addition, if you pick Everdusk from the Seasons of War battle trait, enemy units within 3\" of a friendly WINTERLEAF unit cannot be removed from the battlefield through an effect that would allow them to be set up again later in the battle.`,\r\n        when: [DURING_GAME, MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Dreadwood: {\r\n    effects: [\r\n      {\r\n        name: `Malicious Tormentors`,\r\n        desc: `Once per battle, you can use Walk the Hidden Paths twice in the same turn, but if you do so, at least one of the units you pick must be a friendly DEADWOOD SPITE-REVENANTS unit. In addition, once per battle, you can use Strike and Fade twice in the same turn, but if you do so, at least one of the units you pick must be a friendly DREADWOOD SPITE-REVENANTS unit.`,\r\n        when: [END_OF_MOVEMENT_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Harvestboon: {\r\n    effects: [\r\n      {\r\n        name: `Vibrant Surge`,\r\n        desc: `After deployment but before the first battle round begins, you can move each friendly HARVESTBOON SPITERIDER LANCERS and REVENANT SEEKERS unit up to 12\". If both players can move units before the first battle round begins, they must roll off and the winner chooses who moves their units first.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Chorus of the Woodlands': {\r\n    effects: [\r\n      {\r\n        name: `Chorus of the Woodlands`,\r\n        desc: `When the battle ends, you complete this grand strategy if you completed at least 4 battle tactics and every battle tactic you completed was from the 'Songs of War' list.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Vengeance and Spite': {\r\n    effects: [\r\n      {\r\n        name: `Vengeance and Spite`,\r\n        desc: `When the battle ends, you complete this grand strategy if the model picked to be your opponent's general was slain by an attack made by a friendly OUTCASTS unit.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'The Roots of Victory': {\r\n    effects: [\r\n      {\r\n        name: `The Roots of Victory`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is a friendly Awakened Wyldwood in each quarter of the battlefield and all enemy units are more than 6\" from all friendly Awakened Wyldwoods on the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  // Evergreen Hunt\r\n  'The Grand Hunt': {\r\n    effects: [\r\n      {\r\n        name: `The Grand Hunt`,\r\n        desc: `When the battle ends, you complete this grand strategy if you have destroyed 4 or more quarries.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_CHARGE_PHASE } from 'types/phases'\r\n\r\nconst MonstrousRampages = {\r\n /* 'Merciful Strike': {\r\n    effects: [\r\n      {\r\n        name: `Merciful Strike`,\r\n        desc: `If the quarry has any wounds allocated to it and is within 3\" of this unit, roll a dice and add the number of wounds allocated to the quarry to the roll. If the result is greater than the quarry's Wounds characteristic, 1 model in that unit is slain.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Groundshaker: {\r\n    effects: [\r\n      {\r\n        name: `Groundshaker`,\r\n        desc: `You can carry out this monstrous rampage instead of any others with this unit. Pick 1 enemy unit within 3\" of this unit and roll a dice. On a 3+, the strike-last effect applies to that enemy unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(MonstrousRampages, 'monstrous_rampage')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { DURING_GAME, END_OF_CHARGE_PHASE, START_OF_SETUP } from 'types/phases'\r\n\r\nconst Scenery = {\r\n /* 'Awakened Wyldwood': {\r\n    effects: [\r\n      {\r\n        name: `Setup`,\r\n        desc: `After territories are determined, you can set up this faction terrain feature wholly within your territory and more than 3\" from all objectives and other terrain features. If both players can set up faction terrain features at the same time, they must roll off and the winner chooses who sets up their faction terrain features first.\r\n\r\n        When you set up this terrain feature, it can be set up as small, medium, or large Awakened Wyldwood. Small consists of 1 scenery piece, medium consists of 2 scenery pieces, and large consists of 3 scenery pieces. \r\n\r\n        If this terrain feature is set up as medium or large, all of its scenery pieces must be set up touching so that they form a circle with an area of open ground inside the circle. This area is considered to be part of the terrain feature.\r\n        \r\n        Abilities that allow you to add Awakened Wyldwood terrain features to the battlefield will tell you how to set them up, and they may also specify the maximum number of pieces. In addition, it must be set up more than 3\" from all models, objectives, other terrain features, endless spells and invocations, unless noted otherwise.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Overgrown Wilderness`,\r\n        desc: `Visibility from units with the SYLVANETH keyword is not blocked by this terrain feature.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Vengeful Forest Spirits`,\r\n        desc: `At the end of the charge phase, roll a dice for each unit that does not have the SYLVANETH keyword that is within 1\" of any Awakened Wyldwood. Add 2 to the roll if any WIZARDS or endless spells are within 6\" of any Awakened Wyldwood. On a 6+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Scenery, 'scenery')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, SAVES_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  // Lore of the Deepwood\r\n /* 'Throne of Vines': {\r\n    effects: [\r\n      {\r\n        name: `Throne of Vines`,\r\n        desc: `At the end of each phase until the start of your next hero phase, you can heal 1 wound allocated to the caster.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Regrowth: {\r\n    effects: [\r\n      {\r\n        name: `Regrowth`,\r\n        desc: `Casting value of 5. Pick 1 friendly SYLVANETH unit wholly within 18\" of the caster and visible to them. You can heal up to D6 wounds allocated to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lore of the Deepwood': {\r\n    effects: [\r\n      {\r\n        name: `Treesong: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Sylvaneth Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: If there are fewer than 3 friendly Awakened Wyldwoods on the battlefield, you can set up an Awakened Wyldwood wholly within 18\" of the caster and more than 3\" from all enemy units, objectives and other terrain features. If there are already 3 friendly Awakened Wyldwoods on the battlefield, Heal (3) each friendly Awakened Wyldwood.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wrathful Spirits: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Sylvaneth Wizard to cast this spell, pick a friendly Awakened Wyldwood wholly within 18\" of the caster to be the target, then make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, add 1 to the Rend characteristic of melee weapons used by friendly Sylvaneth units while they are wholly within 6\" of the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `The Dwellers Below: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Sylvaneth Wizard to cast this spell, pick a visible enemy unit that is either within 12\" of this unit or within 6\" of an Awakened Wyldwood to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll a number of dice equal to the number of models in the target unit. For each 5+, inflict 1 mortal damage on the target unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Deadly Harvest': {\r\n    effects: [\r\n      {\r\n        name: `Deadly Harvest`,\r\n        desc: `Casting value of 6. Each enemy unit within 3\" of the caster suffers D3 mortal wounds (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Verdurous Harmony': {\r\n    effects: [\r\n      {\r\n        name: `Verdurous Harmony`,\r\n        desc: `Casting value of 7. Pick 1 friendly SYLVANETH unit wholly within 18\" of the caster and visible to them. You can return 1 slain model to that unit. If you picked a unit of DRYADS, TREE-REVENANTS or SPITE-REVENANTS, you can return up to D3 slain models to that unit instead of 1.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Treesong: {\r\n    effects: [\r\n      {\r\n        name: `Treesong`,\r\n        desc: `Casting value of 7. Pick 1 Awakened Wyldwood within 16\" of the caster. Until the start of your next hero phase, improve the Rend characteristic of melee weapons used by friendly SYLVANETH units by 1 while they are wholly within 9\" of that Awakened Wyldwood.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //BATLE TRAIT SPELLS\r\n  'Verdant Blessing': {\r\n    effects: [\r\n      {\r\n        name: `Verdant Blessing`,\r\n        desc: `Casting value of 6 and a range of 18\". If successfully cast, setup an Awakened Wyldwood terrain feature wholly within range and visible to the caster, and more than 3\" from all other models, endless spells, invocations, terrain features, and objectives, and add it to your army.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Alarielle Spells\r\n  Metamorphosis: {\r\n    effects: [\r\n      {\r\n        name: `Metamorphosis`,\r\n        desc: `Casting value of 7 and a range of 16\". Pick 1 enemy unit within range and visible to the caster, and roll a number of dice equal to the unmodified casting roll. For each 3+, there suffers 1 mortal wound.\r\n        \r\n        If a unit is destroyed by a mortal wound caused by this spell: before removing the last model from play you can set up 1 Awakened Wyldwood terrain feature consisting of 1 piece wholly within 12\" of that model and more than 3\" from all other models, terrain features and objectives and add it to your army.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Branchwych Spells\r\n  'Unleash Spites': {\r\n    effects: [\r\n      {\r\n        name: `Unleash Spites`,\r\n        desc: `Casting value of 5 and a range of 9\". Roll a number of dice equal to the unmodified casting roll for each enemy unit within range of the caster. For each 5+, That enemy unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Lady of Vines Spells\r\n  'Aspect of the Everqueen': {\r\n    effects: [\r\n      {\r\n        name: `Aspect of the Everqueen`,\r\n        desc: `Casting value of 7 and a range of 12\". Until your next hero phase, friendly Sylvaneth units have a ward of 5+ while they are wholly within range of the caster.`,\r\n        when: [HERO_PHASE, SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Drycha Spells\r\n  'Primal Terror': {\r\n    effects: [\r\n      {\r\n        name: `Primal Terror`,\r\n        desc: `Casting value of 6 and a range of 12\". Roll 2D6, each enemy unit within range that has a Bravery characteristic lower than the roll suffers D3 mortal wounds (roll separatly each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Warsong Revenant Spells\r\n  'Unleash Swarm of Spites': {\r\n    effects: [\r\n      {\r\n        name: `Unleash Swarm of Spites`,\r\n        desc: `Casting value of 7 and a range of 9\". Roll a number of dice equal to the unmodified casting roll for each enemy unit within range of the caster. For each 5+, that enemy unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //Treelord ancient Spells\r\n  'Awakening the Wood': {\r\n    effects: [\r\n      {\r\n        name: `Awakening the Wood`,\r\n        desc: `Casting value of 6. Pick 1 friendly Awakened Wyldwood on the battlefield. Each enemy unit within 3\" of it suffers D3 mortal wounds (roll separately for each unit).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //SKAETH'S WILD HUNT Spells\r\n  'Might of Kurnoth': {\r\n    effects: [\r\n      {\r\n        name: `Might of Kurnoth`,\r\n        desc: `Casting value of 7 and a range of 12\". Pick 1 friendly SYLVANETH unit within range and visible to the caster. Add 1 to wound rolls for attacks made with melee weapons by that unit until the start of your next hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Might of Kurnoth`,\r\n        desc: `If active, add 1 to wound rolls for attacks made with melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  //YLTHARI ancient Spells\r\n  'The Reaping': {\r\n    effects: [\r\n      {\r\n        name: `The Reaping`,\r\n        desc: `Casting value of 6 and a range of 12\". Pick 1 enemy unit within range and visible to the caster, roll 6 dice. For each 5+, that unit suffers 1 mortal wound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_ROUND,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport rule_sources from './rule_sources'\r\nimport scenery from './scenery'\r\nimport spells from './spells'\r\nimport monstrous_rampages from './monstrous_rampages'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/* const BlessingsOfTheForestEffect = {\r\n  name: `Blessings of the Forest`,\r\n  desc: `Subtract 1 from hit rolls and wound rolls for attacks that target this unit if it is wholly within 9\" of any overgrown or friendly AWAKENED WYLDWOODS.`,\r\n  when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst TreeLordBaseEffects = [\r\n  {\r\n    name: `Spirit Paths`,\r\n    desc: `At the start of your movement phase, if this unit is wholly within 6\" of an overgrown terrain or Awakened Wyldwood in your army, it can walk the spirit paths instead of making a move in that phase. If it does so, remove this unit from the battlefield and set it up wholly within 6\" of a different overgrown terrain or AWAKENED WYLDWOOD in your army and more than 9\" from any enemy units.`,\r\n    when: [START_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\n\r\nconst BugRiderEffects = [\r\n  {\r\n    name: `Champion`,\r\n    desc: `1 model in this unit can be a champion. Add 1 to the Attacks characteristic of that model's melee weapons, this has no effect on the mount.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Banner Bearer`,\r\n    desc: `1 in every 3 models in this unit can be a Banner bearer. This unit can pile-in up to 6\" instead of 3\" while it includes any Standard Bearers.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Musician`,\r\n    desc: `1 in every 3 models in this unit can be a Hornblower. When this unit receives the Rally command it can return 1 slain model for each roll of 5+ instead of only 6 while it includes any Hornblowers.`,\r\n    when: [START_OF_HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Thrumming with Life`,\r\n    desc: `At the end of each phase, if any enemy models were slain by an attack made by this unit in that phase, you can heal all wounds allocated to this unit.`,\r\n    when: [DURING_GAME, WOUND_ALLOCATION_PHASE],\r\n    rule_sources: [rule_sources.BATTLETOME_SYLVANETH, rule_sources.ERRATA_OCTOBER_2022],\r\n    shared: true,\r\n  },\r\n]\r\nconst WarmasterEffect = {\r\n  name: `Warmaster`,\r\n  desc: `If this unit is included in a Sylvaneth army, it is treated as a general even if it is not the model picked to be the army's general.`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  'Alarielle The Everqueen': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Metamorphosis'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Wardroths Great Antlers is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Lifebloom`,\r\n        desc: `Effect: Pick 1 of the following effects:  \r\n        Add 1 to casting rolls for this unit for the rest of the turn.  \r\n        Heal (2D3) this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Metamorphosis: Casting value of 7  `,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 2D3 mortal damage on the target. If the target is destroyed by this spell, you can immediately resolve the effect of the Treesong spell as if this unit had successfully cast it.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Living Battering Ram - Once Per Turn`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy Infantry unit within 1\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Rite of Life`,\r\n        desc: `Declare: Pick a friendly Sylvaneth unit that has been destroyed to be the target. This unit can use this ability if it has been destroyed, but if it does, this unit must be the target. \r\n        Effect: Roll a dice. On a 4+, set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 9\" of a friendly Awakened Wyldwood and more than 9\" from all enemy units. If the target was a Monster, allocate 8 damage points to the replacement unit (ward rolls cannot be made for those damage points).`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Drycha Hamadreth': {\r\n   /* mandatory: { spells: [keyPicker(spells, ['Primal Terror'])] }, */\r\n    effects: [\r\n     // WarmasterEffect,\r\n      {\r\n        name: `Primal Terror - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, halve the targets control score (rounding up) for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mercurial Aspect - Once Per Turn`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Enraged: Add 10 to the Attacks characteristic of this units Flitterfuries. \r\n        Embittered: Add 10 to the Attacks characteristic of this units Swarm of Squirmlings.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Song of Spite: Casting value of 6`,\r\n        desc: `Declare: Pick an enemy Infantry unit within 12\" of the caster to be the target, then make a casting roll of 2D6. \r\n        Effect: The following effects apply for the rest of the turn: \r\n        Add 1 to hit rolls for combat attacks made by friendly Sylvaneth units that target that enemy unit. \r\n        In addition, add 1 to wound rolls for combat attacks made by friendly Spite-Revenants or The Twistweald units that target that enemy unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  'Spirit of Durthu': {\r\n  /*  mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Groundshaker'])],\r\n    }, */\r\n    effects: [\r\n     // ...TreeLordBaseEffects,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Guardian Sword is 3.`,\r\n      when: [COMBAT_PHASE],\r\n     },\r\n      {\r\n        name: `Titanic Duel - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wrathful Guardian - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for this units combat attacks while the target is within 3\" of an Awakened Wyldwood.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Treelord Ancient': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Awakening the Wood'])],\r\n      scenery: [keyPicker(scenery, ['Awakened Wyldwood'])],\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Groundshaker'])],\r\n    }, */\r\n    effects: [\r\n     // ...TreeLordBaseEffects,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Sweeping Blows is 3.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Groundshaker - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 4+, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Awakening the Wood - Once Per Turn`,\r\n        desc: `Declare: Pick a visible friendly Awakened Wyldwood wholly within 18\" of this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage equal to the roll on each enemy unit within the targets combat range.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  Treelord: {\r\n    /*mandatory: {\r\n      monstrous_rampages: [keyPicker(monstrous_rampages, ['Groundshaker'])],\r\n    },*/\r\n    effects: [\r\n     // ...TreeLordBaseEffects,\r\n      {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Sweeping Blows is 3.`,\r\n      when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Lash and Tangle - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, subtract 1 from wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Entangling Grasp`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by attacks made with this units Strangleroots to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use Run or Retreat abilities until the start of your next turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Arch-Revenant': {\r\n   /* mandatory: { command_abilities: [keyPicker(command_abilities, ['Call to Battle'])] }, */\r\n    effects: [\r\n      {\r\n        name: `Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Champion of Kurnoth - Passive`,\r\n        desc: `Effect: Add 1 to wound rolls for combat attacks made by friendly Kurnothi units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'The Lady of Vines': {\r\n   /* mandatory: { spells: [keyPicker(spells, ['Aspect of the Everqueen'])] }, */\r\n    effects: [\r\n     // WarmasterEffect,\r\n      {\r\n        name: `Writhing Vines - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, pick 1 of the following effects to apply for the rest of the turn: \r\n        Barrier: Subtract 1 from hit rolls for the targets attacks. \r\n        Ensnare: Add 1 to hit rolls for attacks made by friendly units that target that enemy unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Aspect of the Everqueen: Casting value of 7`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, friendly Sylvaneth units have Ward (5+) while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Verdian Crown - Passive`,\r\n        desc: `Effect: This unit counts as an Awakened Wyldwood for the purposes of the Endless Growth, Walk the Hidden Paths and Strike and Fade abilities.`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  Branchwych: {\r\n    /*mandatory: { spells: [keyPicker(spells, ['Unleash Spites'])] }, */\r\n    effects: [\r\n      {\r\n        name: `Fury of the Forest - Once Per Turn`,\r\n        desc: `Declare: If this unit is wholly within 6\" of any friendly Awakened Wyldwoods, pick a friendly Sylvaneth unit wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n /* Ylthari: {\r\n   /* mandatory: { spells: [keyPicker(spells, ['The Reaping'])] }, \r\n    effects: [\r\n      {\r\n        name: `Vigour and Wrath`,\r\n        desc: `You can reroll wound rolls of 1 for attacks made by this model.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  \"Ylthari's Guardians\": {\r\n    effects: [\r\n      {\r\n        name: `Martial Memories`,\r\n        desc: `Once per turn, this unit can receive the All-out Attack or All-out Defence command without the command being issued and without a command point being spent.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vigour and Wrath`,\r\n        desc: `You can reroll wound rolls of 1 for attacks made by this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },*/\r\n  'Tree-Revenants': {\r\n    effects: [\r\n      {\r\n        name: `Waypiper's Dance - Once Per Turn`,\r\n        desc: `Effect: If this unit is not in combat, remove it from the battlefield, and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spite-Revenants': {\r\n    effects: [\r\n      {\r\n        name: `Unbridled Malice`,\r\n        desc: `Declare: Pick an enemy Infantry unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kurnoth Hunter Greatswords': {\r\n    effects: [\r\n      {\r\n        name: `Envoys of the Everqueen - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective, friendly Sylvaneth units contesting that objective have Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Trample Underfoot`,\r\n        desc: `Declare: If this unit charged this turn, pick an enemy unit that is in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in this unit. For each 3+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kurnoth Hunter Scythes': {\r\n    effects: [\r\n      {\r\n        name: `Envoys of the Everqueen - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective, friendly Sylvaneth units contesting that objective have Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Tanglethorn Thicket`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in this unit. For each 3+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Kurnoth Hunter Greatbows': {\r\n    effects: [\r\n      {\r\n        name: `Envoys of the Everqueen - Passive`,\r\n        desc: `Effect: While this unit is contesting an objective, friendly Sylvaneth units contesting that objective have Ward (6+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Steady Aim`,\r\n        desc: `Effect: This unit can ignore the Guarded Hero ability (Core Rules, 25.0) for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Dryads: {\r\n    effects: [\r\n      {\r\n        name: `Blessings of the Forest - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls and wound rolls for attacks that target this unit while it is wholly within 6\" of any friendly Awakened Wyldwoods.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n     // BlessingsOfTheForestEffect,\r\n    ],\r\n  },\r\n /* \"Skaeth's Wild Hunt\": {\r\n   /* mandatory: { spells: [keyPicker(spells, ['Might of Kurnoth'])] }, \r\n    effects: [\r\n      {\r\n        name: `Fleet of Foot`,\r\n        desc: `This unit can run and still shoot and/or charge later in the same turn.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Karthaen (Wizard)`,\r\n        desc: `While Karthaen is still in the unit, this unit is considered a Wizard and can cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Skaeth`,\r\n        desc: `Skaeth has a Wounds characteristic of 2.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Qulathis the Exile': {\r\n    effects: [\r\n      {\r\n        name: `Strike Unseen`,\r\n        desc: `The cover modifier adds 2 to save rolls vs missile weapons for this model, instead of 1.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Oaken Arrows`,\r\n        desc: `If the unmodified hit roll for an attack made with Winter's Call is 6, inflict 1 mortal wound on the target in addition to normal damage.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Guardian of the Enga'la Weald`,\r\n        desc: `ENGA'LA WEALD is a Glade keyword (this means that this model cannot gain another Glade keyword if it is included in a Sylvaneth army - see the Glades battle trait in Battletome: Sylvaneth).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  'Warsong Revenant': {\r\n   /* mandatory: { spells: [keyPicker(spells, ['Unleash Swarm of Spites'])] }, */\r\n    effects: [\r\n      {\r\n        name: `Alarielle's Song - Passive`,\r\n        desc: `Effect: Friendly Sylvaneth units have Ward (6+) while they are wholly within 12\" of this unit. Subtract 1 from ward rolls for enemy units while they are within 12\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Unleash Swarm of Spites: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Awakened Wyldwood wholly within 18\" of this unit, pick up to 3 visible enemy units within 9\" of that terrain feature to be the targets, then make a casting roll of 2D6. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Wyldwood Revenants - Passive`,\r\n        desc: `Effect: Add 1 to unbinding rolls and banishment rolls for this unit while it is wholly within 6\" of any Awakened Wyldwoods.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spiterider Lancers': {\r\n    effects: [\r\n     // ...BugRiderEffects,\r\n     {\r\n      name: `Forest Fighters - Passive`,\r\n      desc: `Effect: This unit has a coherency range of 2\".`,\r\n      when: [DURING_GAME],\r\n    }, \r\n     {\r\n        name: `Descent of the Spiteriders`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Thrumming with Life`,\r\n        desc: `Effect: Heal (3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Revenant Seekers': {\r\n    effects: [\r\n     // ...BugRiderEffects,\r\n     {\r\n      name: `Forest Fighters - Passive`,\r\n      desc: `Effect: This unit has a coherency range of 2\".`,\r\n      when: [DURING_GAME],\r\n    }, \r\n     {\r\n        name: `Harvesters of the Lamentiri - Passive`,\r\n        desc: `Effect: Each time a friendly unit wholly within 12\" of any friendly Revenant Seekers units uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Thrumming with Life`,\r\n        desc: `Effect: Heal (3) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'The Twistweald': {\r\n    effects: [\r\n     // ...BugRiderEffects,\r\n      {\r\n        name: `Eruption of Thorned Vines`,\r\n        desc: `Declare: If this unit is more than 6\" from all other friendly Sylvaneth units, pick an enemy unit within 12\" of this unit to be the target. \r\n        Effect: Subtract D3 from charge rolls for the target for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gossamid Archers': {\r\n    effects: [\r\n      {\r\n        name: `Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Belthanos: {\r\n   /* mandatory: { command_abilities: [keyPicker(command_abilities, ['The Unending Hunt'])] }, */\r\n    effects: [\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Carnelian Greatspites Razor-like Mandibles is 3.`,\r\n        when: [COMBAT_PHASE],\r\n        },\r\n      {\r\n        name: `Nature Aetheric - Once Per Battle`,\r\n        desc: `Declare: Pick a terrain feature within 6\" of this unit to be the target. \r\n        Effect: For the rest of the battle, the target gains the Place of Power terrain ability (Terrain 1.2) and counts as a friendly Awakened Wyldwood for the purposes of the Endless Growth, Walk the Hidden Paths and Strike and Fade abilities.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Rhythm of the Chase - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll, then you can remove this unit from the battlefield and set it up again on the battlefield within 1\" of the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Kurnothi War-horn`,\r\n        desc: `Declare: Pick up to 3 friendly Sylvaneth units to be the target. \r\n        Effect: Each target can use Charge abilities even if they used a Run ability in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Fjori`s Flamebearers': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    /* mandatory: {\r\n       prayers: [keyPicker(prayers, ['Vessel of Sigmar'])],\r\n     }, */\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: The Blacktalons': {\r\n    effects: [\r\n      {\r\n        name: `Neave Blacktalon: Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Neave Blacktalon: Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Neave's Companions: Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Lorai: Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lorai: Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Justice Will Be Served - Once Per Battle`,\r\n        desc: `Declare: Pick the Neave Blacktalon in this Regiment of Renown to be the target if it is in combat with an enemy Hero. \r\n        Effect: The target can use 2 Fight abilities this phase. Each time it does so, if it is in combat with an enemy Hero, all of its attacks must target an enemy Hero. In addition, after the first Fight ability is used, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport MonstrousRampages from './monstrous_rampages'\r\nimport Scenery from './scenery'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { SYLVANETH } from 'meta/factions'\r\n\r\nconst baseSubFaction = {\r\n /* mandatory: {\r\n    spells: [keyPicker(Spells, ['Verdant Blessing'])],\r\n  }, */\r\n  available: {\r\n    artifacts: [Artifacts],\r\n    battalions: [Battalions],\r\n    battle_tactics: [BattleTactics],\r\n    command_abilities: [CommandAbilities],\r\n    command_traits: [CommandTraits],\r\n    endless_spells: [EndlessSpells],\r\n    flavors: [Flavors],\r\n    grand_strategies: [GrandStrategies],\r\n    monstrous_rampages: [MonstrousRampages],\r\n    scenery: [Scenery],\r\n    spells: [Spells],\r\n    units: [Units],\r\n  },\r\n  effects: [],\r\n} satisfies IItemDescription\r\n\r\n\r\nconst subFactions = {\r\n  [SYLVANETH]: {\r\n    //  ...baseSubfaction,\r\n    effects: pickEffects(BattleTraits, [SYLVANETH]),\r\n  \r\n      available: {\r\n        artifacts: [Artifacts],\r\n        battalions: [Battalions],\r\n        battle_tactics: [BattleTactics],\r\n        command_abilities: [CommandAbilities],\r\n        command_traits: [CommandTraits],\r\n        endless_spells: [EndlessSpells],\r\n        flavors: [Flavors],\r\n        grand_strategies: [GrandStrategies],\r\n        monstrous_rampages: [MonstrousRampages],\r\n       // mount_traits: [MountTraits],\r\n       // prayers: [Prayers],\r\n        spells: [Spells],\r\n        units: [Units],\r\n      },\r\n    }, \r\n\r\n/*const subFactions = {\r\n  'The Burgeoning': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['The Burgeoning', SYLVANETH]),\r\n  },\r\n  'The Reaping': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['The Reaping', SYLVANETH]),\r\n  },\r\n  'The Dwindling': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['The Dwindling', SYLVANETH]),\r\n  },\r\n  Everdusk: {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['Everdusk', SYLVANETH]),\r\n  },\r\n  'The Evergreen Hunt': {\r\n    ...baseSubFaction,\r\n    effects: pickEffects(BattleTraits, ['The Evergreen Hunt']),\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { SYLVANETH } from 'meta/factions'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const SylvanethFaction = new Faction(\r\n  SYLVANETH,\r\n  ORDER,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_SYLVANETH\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  'Deathless Minions': {\r\n    effects: [\r\n      {\r\n        name: `Deathless Minions`,\r\n        desc: `Each time you allocate a wound or mortal wound to a friendly DEATH model within 6\" of your general or a friendly DEATH HERO, roll a D6. On a 6+ the wound is negated.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, SHOOTING_PHASE, WOUND_ALLOCATION_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Ancient Curse': {\r\n    effects: [\r\n      {\r\n        name: `Ancient Curse`,\r\n        desc: `If this model is slain, the unit that inflicted the final wound upon him suffers D6 mortal wounds after all of its attacks have been made.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"And He Did Say 'War', and the World Did Tremble\": {\r\n    effects: [\r\n      {\r\n        name: `And He Did Say 'War', and the World Did Tremble`,\r\n        desc: `If a Tomb King on Exalted Chariot uses this command ability, then in your next combat phase you can add 1 to hit rolls for Tomb Kings units in your army while they are within 18\" of this model. If a Desert Legions unit is affected by this ability, you can also add 1 to their wound rolls in the combat phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Supernatural Speed': {\r\n    effects: [\r\n      {\r\n        name: `Supernatural Speed`,\r\n        desc: `When an enemy unit within 3\" of this model is picked to pile in and attack in the combat phase, if this model has not yet attacked this phase, you can immediately pile in and attack with it before that enemy unit does.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blessing of Accuracy': {\r\n    effects: [\r\n      {\r\n        name: `Blessing of Accuracy`,\r\n        desc: `If a Tomb Queen uses this command ability, add 1 to hit rolls made by friendly Desert Legions units during your next shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Tomb Shield': {\r\n    effects: [\r\n      {\r\n        name: `Royal Tomb Shield`,\r\n        desc: `You can reroll failed save rolls for a Tomb King with a Royal Tomb Shield.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'My Will Be Done': {\r\n    effects: [\r\n      {\r\n        name: `My Will Be Done`,\r\n        desc: `If a Tomb King uses this command ability, pick one Desert Legions unit within 18\". Until your next hero phase add 1 to all hit, run and charge rolls for that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Royal Chariot': {\r\n    effects: [\r\n      {\r\n        name: `Royal Chariot`,\r\n        desc: `In the combat phase, if this model charged in the same turn, add 2 to the Attacks characteristic of the Tomb King's Dynastic Blade and double the Attacks characteristic of the Skeletal Steed's Thundering Hooves. 'And the Tomb Kings Rode to War': If a Tomb King in Royal Chariot uses this command ability you can reroll charge rolls for this model and friendly units of Desert Legion Chariots that are within 18\" of him in your next charge phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Who Dares Disturb My Slumber?': {\r\n    effects: [\r\n      {\r\n        name: `Who Dares Disturb My Slumber?`,\r\n        desc: `If this model uses this ability, pick an enemy unit that is visible to it. Until your next hero phase, add 1 to all wound rolls for friendly Embalmed and Desert Legion units that target the chosen unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Righteous Smiting': {\r\n    effects: [\r\n      {\r\n        name: `Righteous Smiting`,\r\n        desc: `Casting value of 5. Pick a Desert Legions or Reanimant unit within 18\". Until your next hero phase, all models in the unit are imbued with magical power; each time you roll a hit roll of 6+ for a model in this unit, make one additional hit roll for the same weapon at the same target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport command_abilities from './command_abilities'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst getIconBearerEffect = (strength: `1` | `D3` | `D6`) => {\r\n  const plural = strength === `1` ? `` : `s`\r\n  return {\r\n    name: `Icon Bearer`,\r\n    desc: `You can return ${strength} slain model${plural} to this unit in your hero phase if it includes any Icon Bearers.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  }\r\n}\r\nconst HornblowerEffect = {\r\n  name: `Hornblower`,\r\n  desc: `A unit that includes any Hornblowers can always move up to 6\" when it charges, unless its charge roll is higher.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst WarsphinxBaseEffects = [\r\n  {\r\n    name: `Thundercrush Attack`,\r\n    desc: `After this model completes a charge move, pick one enemy unit that is within 1\" of it and roll a D6. If the dice roll is less than or equal to the number of models in the chosen unit, that unit suffers D3 mortal wounds.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Sacred War Statue`,\r\n    desc: `Halve the Damage characteristic (rounding up) of weapons that target this model. In addition, halve the number of mortal wounds this model suffers from spells and abilities (rounding up).`,\r\n    when: [WOUND_ALLOCATION_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst TombShieldEffect = {\r\n  name: `Tomb Shield`,\r\n  desc: `This unit can create a shield fortress instead of running or charging in its turn. If it does so, add 1 to save rolls for the unit until its next movement phase.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  'Tomb King On Exalted Chariot': {\r\n    mandatory: {\r\n      command_abilities: [\r\n        keyPicker(command_abilities, ['Ancient Curse', \"And He Did Say 'War', and the World Did Tremble\"]),\r\n      ],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Crown of the Desert Kingdoms`,\r\n        desc: `If this model is your general, Embalmed Heroes from your army that are within 18\" of it in your hero phase can use command abilities even though they are not your general. Note that a unit can only be affected by each of the following command abilities once per battle round: 'And He Did Say 'War', and the World Did Tremble...', 'Blessing of Accuracy', 'My Will Be Done' and 'Who Dares Disturb My Slumber?'`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Exalted Chariot`,\r\n        desc: `In the combat phase, if this model made a charge move in the same turn, add 2 to the Attacks characteristic of its Blessed Blade. In addition, double the Attacks characteristic of, and add 1 to wound rolls for, the Skeletal Steeds' Thundering Hooves.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Incantation of the Desert Wind`,\r\n        desc: `In your hero phase this model can invoke the Incantation of the Desert Wind. If he does so, pick a Desert Legions unit within 18\" and roll a D6; on a roll of 1 this model suffers a mortal wound. On a roll of 2+ the incantation is successfully carried out - the chosen unit's Move characteristic is doubled and it can fly for the duration of your next movement phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scarab Amulet`,\r\n        desc: `Roll a D6 each time this model suffers a wound or a mortal wound. On a roll of 5+ the wound is negated.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Queen': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Supernatural Speed', 'Blessing of Accuracy'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `The Tomb Queen's Curse`,\r\n        desc: `If this model is slain, the unit that inflicted the final wound upon it suffers D3 mortal wounds after all of its attacks have been made.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb King': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Royal Chariot', 'My Will Be Done'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `The Tomb King's Curse`,\r\n        desc: `If a Tomb King is slain, the unit that inflicted the final wound upon him suffers D3 mortal wounds after all of its attacks have been made.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb King In Royal Chariot': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Royal Chariot'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `The Tomb King's Curse`,\r\n        desc: `If a Tomb King in Royal Chariot is slain, the unit that inflicted the final wound upon him suffers D3 mortal wounds after all of its attacks have been made.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Scarab Prince': {\r\n    effects: [\r\n      {\r\n        name: `Soul Reaper`,\r\n        desc: `Add 1 to hit and wound rolls for this model's Cursed Dagger if the target is a HERO.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Scarab Prince`,\r\n        desc: `This model heals one wound in each of your hero phases.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Scarab Prince`,\r\n        desc: `If this model is slain, before it is removed it can immediately make a Tide of Scuttling Scarabs attack as if it were the shooting phase.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Desert Revenant`,\r\n        desc: `Instead of setting up this model on the battlefield, you can place it to one side and say that it is set up entombed beneath the sands. In any of your movement phases, you can set it up on the battlefield more than 9\" from any enemy models. This counts as this models move for that movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Herald': {\r\n    effects: [\r\n      {\r\n        name: `Skeletal Steed`,\r\n        desc: `A Herald can ride a skeletal steed. If he does so, his Move is increased to 12\" and his steed can attack with its Thundering Hooves.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Sworn Bodyguard`,\r\n        desc: `If a friendly Embalmed model from your army is allocated a wound or mortal wound while within 3\" of this model, the Tomb Herald can leap in front of the attack. Roll a D6 for each wound or mortal wound. On a 2+ that wound or mortal wound is allocated to the Tomb Herald instead.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n      {\r\n        name: `Standard of the Undying Legion`,\r\n        desc: `In your hero phase, a Tomb Herald can plant his standard and cause fallen warriors to return to the fight once more. If he does so, you may not move the Tomb Herald until your next hero phase, but you can immediately return 1 slain model to each friendly Desert Legions unit within 24\".`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Liche Priest': {\r\n    mandatory: {\r\n      spells: [keyPicker(spells, ['Righteous Smiting'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Skeletal Steed`,\r\n        desc: `A Liche Priest can ride a skeletal steed. If he does so, his Move is increased to 12\" and he gains the Thundering Hooves attack.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Hierophant's Scrolls`,\r\n        desc: `Once per game, when a Liche Priest attempts to unbind a spell, he can read from his ancient scrolls; if he does, that unbinding attempt is automatically successful.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magic`,\r\n        desc: `A Liche Priest is a wizard. He can attempt to cast one spell in each of your hero phases, and attempt to unbind one spell in each enemy hero phase. He knows the Arcane Bolt, Mystic Shield and Righteous Smiting spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Casket Of Souls': {\r\n    effects: [\r\n      {\r\n        name: `Covenant of Power`,\r\n        desc: `While a Liche Priest from your army is within 18\" of this model, add 1 to their casting rolls.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Casket`,\r\n        desc: `This model cannot make charge moves.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Casket`,\r\n        desc: `You can add 1 to all save rolls for this model in the shooting phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Keeper's Scrolls`,\r\n        desc: `The Keeper can attempt to unbind one spell in the enemy hero phase as if he were a WIZARD.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Unleashed Souls`,\r\n        desc: `In your hero phase you can declare that the Keeper of the Casket will unleash the tortured souls of the damned. If you do so, pick a visible enemy unit within 20\" and roll a D6. On a 3+ that unit suffers D3 mortal wounds (if its Bravery is 4 or less it suffers D6 mortal wounds instead). Then roll a D6 for each other enemy unit within 6\" of the first unit. On a 5+ that unit is also attacked by the vengeful souls, and suffers D3 mortal wounds (if its Bravery is 4 or less it suffers D6 mortal wounds instead).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skeletal Legionnaires': {\r\n    effects: [\r\n      {\r\n        name: `Skeleton Champion`,\r\n        desc: `The leader of this unit is a Skeleton Champion. Add 1 to the Attacks characteristic of the Skeleton Champion's Ancient Blade or Ancient Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getIconBearerEffect(`D6`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Serve in Death`,\r\n        desc: `Add 1 to this unit's hit rolls while it is within 18\" of any friendly Embalmed Hero.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Skeleton Legion`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's melee weapons if it has 20 or more models. If it has 30 or more models, add 2 instead.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      TombShieldEffect,\r\n    ],\r\n  },\r\n  'Skeleton Archers': {\r\n    effects: [\r\n      {\r\n        name: `Master Of Arrows`,\r\n        desc: `The leader of this unit is a Master of Arrows. Add 1 to hit rolls for a Master of Arrows' attacks in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      getIconBearerEffect(`D6`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Hail of Ancient Arrows`,\r\n        desc: `Add 1 to the Attacks characteristic of this unit's Ancient Bows while it has 20 or more models and there are no enemy models within 3\" of it.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skeleton Horsemen': {\r\n    effects: [\r\n      {\r\n        name: `Master Of Horse`,\r\n        desc: `The leader of this unit is a Master of Horse. Add 1 to the Attacks characteristic of the Master of Horse's Bronze-tipped Cavalry Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getIconBearerEffect(`D3`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Deathly Charge`,\r\n        desc: `Add 1 to wound rolls for attacks made with this unit's Bronzetipped Cavalry Spears if it charged in the same turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Horsemen's Shield`,\r\n        desc: `Add 1 to the save rolls for this unit in the combat phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `First to Face the Foe`,\r\n        desc: `This unit can charge even if it ran in the same turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skeleton Horse Archers': {\r\n    effects: [\r\n      {\r\n        name: `Master Of Scouts`,\r\n        desc: `The leader of this unit is a Master of Scouts. Add 1 to hit rolls for a Master of Scouts' attacks in the shooting phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      getIconBearerEffect(`D3`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Like the Angry Desert Wind`,\r\n        desc: `This unit can shoot instead of moving in the movement phase. If it does so, it can move in the shooting phase of the same turn, but cannot shoot. If it moves in the shooting phase, it can retreat.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Skeleton Chariots': {\r\n    effects: [\r\n      {\r\n        name: `Master Of Chariots`,\r\n        desc: `The leader of this unit is a Master of Chariots; Add 1 to the Attacks characteristic of the Master of Chariot's Charioteer's Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getIconBearerEffect(`1`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Crush them Beneath Our Wheels`,\r\n        desc: `If this unit makes a charge move, then in the subsequent combat phase you may double the number of attacks it makes with its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Guard': {\r\n    effects: [\r\n      {\r\n        name: `Tomb Captain`,\r\n        desc: `The leader of this unit is a Tomb Captain. Add 1 to the Attacks characteristic of the Tomb Captain's Tomb Blade or Bronze Halberd.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getIconBearerEffect(`D3`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Cursed Weapons`,\r\n        desc: `If the wound roll for an attack made by a model from this unit is 6+, add 1 to the Damage characteristic of their Tomb Blade or Bronze Halberd for that attack.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      TombShieldEffect,\r\n    ],\r\n  },\r\n  Necrotect: {\r\n    effects: [\r\n      {\r\n        name: `Stern Taskmaster`,\r\n        desc: `In your hero phase, you can pick a friendly Desert Legions unit within 8\" of this model. That unit can move an extra 3\" in your next movement phase. In addition, reroll wound rolls of 1 for that unit in your next combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Necropolis Knights': {\r\n    effects: [\r\n      {\r\n        name: `Necropolis Captain`,\r\n        desc: `The leader of this unit is a Necropolis Captain. Add 1 to the Attacks characteristic of the Necropolis Captain's Knight's Heavy Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      getIconBearerEffect(`1`),\r\n      HornblowerEffect,\r\n      {\r\n        name: `Necrovenom`,\r\n        desc: `Each time you make a wound roll of 6+ for a Necroserpent's Poisoned Fangs, that attack inflicts 1 mortal wound in addition to its normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Necropolis Shield`,\r\n        desc: `Add 1 to the save rolls for a unit of Necropolis Knights with Necropolis shields in the combat phase.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Scorpions': {\r\n    effects: [\r\n      {\r\n        name: `Entombed Beneath the Sands`,\r\n        desc: `Instead of setting up a unit of Tomb Scorpions on the battlefield, you can place them to one side and say that they are set up beneath the ground. In any of your movement phases, you can set the unit up on the battlefield more than 9\" from any enemy models. This is the unit's move for that movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Liche Priest's Sarcophagi`,\r\n        desc: `Roll a D6 each time a model in this unit suffers a wound or a mortal wound caused by a spell. Add 1 to the roll if the model is within 18\" of a friendly Necrotect. On a 5+ that wound or mortal wound is negated and has no effect.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Ushabti: {\r\n    effects: [\r\n      {\r\n        name: `War-Statuary`,\r\n        desc: `Add 2 to save rolls for this unit against attacks that have a Damage characteristic of 1.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `The Likeness of Ancient Gods`,\r\n        desc: `Reroll save rolls of 1 for this unit while it is within 18\" of a friendly Necrotect.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Warsphinx: {\r\n    effects: [...WarsphinxBaseEffects],\r\n  },\r\n  'Royal Warsphinx': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(command_abilities, ['Who Dares Disturb My Slumber?'])],\r\n    },\r\n    effects: [\r\n      ...WarsphinxBaseEffects,\r\n      {\r\n        name: `The Tomb King's Curse`,\r\n        desc: `If a Royal Warsphinx is slain, the unit that inflicted the final wound upon it suffers D3 mortal wounds after all of its attacks have been made.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Necrosphinx: {\r\n    effects: [\r\n      {\r\n        name: `Need to Destroy`,\r\n        desc: `If a Necrosphinx is within 12\" of the enemy in the charge phase, it must attempt to charge even if it ran in the preceding movement phase. In addition, when you make a charge roll for this model, roll 3 dice rather than 2 and use the two highest rolls.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Sacred War Statue`,\r\n        desc: `Halve the Damage characteristic (rounding up) of weapons that target this model. In addition, halve the number of mortal wounds this model suffers from spells and abilities (rounding up).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Decapitating Strike`,\r\n        desc: `If a Necrosphinx directs all of its attacks with its Gigantic Scything Blades at the same Monster, and two or more of the wound rolls have a result of 6+, the MONSTER suffers 10 mortal wounds in addition to the normal damage.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sepulchral Stalkers': {\r\n    effects: [\r\n      {\r\n        name: `Transmogrifying Gaze`,\r\n        desc: `When this unit makes a Transmogrifying Gaze attack, choose an enemy unit within 10\". Roll a D6 for each model in the attacking unit; for each roll of 1, a Sepulchral Stalker has caught a glimpse of its own reflection and the attacking unit suffers 1 mortal wound. On a 2 or 3 the target unit keeps its eyes shut and nothing happens. On a 4 or 5 the target unit suffers 1 mortal wound as it briefly meets the Stalker's gaze, but on a 6 it suffers D3 mortal wounds as it foolishly stares into the Stalker's eyes and crumbles to sand.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Underground Stalkers`,\r\n        desc: `Instead of setting up a unit of Sepulchral Stalkers on the battlefield, you can place them to one side and say that they are set up beneath the ground. In any of your movement phases, you can set the unit up on the battlefield more than 9\" from any enemy models. This is the unit's move for that movement phase. The Sepulchral Stalkers can burrow back underground in any of your future movement phases. If they do, remove the unit from the battlefield - it can return in a later turn as described above.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Bone Giant': {\r\n    effects: [\r\n      {\r\n        name: `Unstoppable Assault`,\r\n        desc: `For each hit roll of 6+ for a Bone Giant's attacks, it can immediately make one extra attack using the same weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Colossus of War`,\r\n        desc: `After this unit has attacked for the first time in the combat phase, roll a D6. Add 1 to the result if a friendly Necrotect is within 18\". On a 5+ this unit can immediately pile in and attack for a second time this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Screaming Skull Catapult': {\r\n    effects: [\r\n      ...GenericEffects.CrewedWarMachine('Crewed War Machine'),\r\n      {\r\n        name: `Arcing Skulls`,\r\n        desc: `This war machine can shoot at targets that are not visible to it.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Screaming Ammunition`,\r\n        desc: `A unit that suffers any wounds from Screaming Skulls must subtract 2 from its Bravery characteristic until the end of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Deathless Overseer`,\r\n        desc: `You can fire Screaming Skulls an additional time in your shooting phase if there are any friendly Necrotects within 1\" of the war machine.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Carrion: {\r\n    effects: [\r\n      {\r\n        name: `Circling High Above`,\r\n        desc: `When first set up, units of Carrion are assumed to be flying high above the battlefield. As long as they remain high in the sky, they cannot be charged, attacked, targeted by spells or affected by abilities used by either side, and they also cannot make any attacks themselves as they soar far above their foes. Other units ignore the Carrion as they move (they move underneath them).`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Scavenger's Dive`,\r\n        desc: `The first time this unit declares a charge, you can roll 3 dice rather than 2 to see how far it charges (when doing so, you can declare a charge if it is within 18\" of the enemy, rather than 12\"). As they charge, the Carrion are assumed to drop down to low level, and the Circling High Above ability no longer applies to the unit for the rest of the battle.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tomb Swarm': {\r\n    effects: [\r\n      {\r\n        name: `Underground Scuttlers`,\r\n        desc: `Instead of setting up a Tomb Swarm on the battlefield, you can place them to one side and say that they are set up beneath the ground. In any of your movement phases, you can set the unit up on the battlefield more than 9\" from any enemy models. This is the unit's move for that movement phase. The unit can burrow back underground in any of your future movement phases. If it does, remove the unit from the battlefield - it can return in a later turn as described above.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Hidden Abodes`,\r\n        desc: `If a Tomb Swarm burrows back underground as described above, it is joined by more of its scuttling brethren who had remained hidden. You may restore D3 slain models to the unit.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TOMB_KINGS } from 'meta/factions'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [TOMB_KINGS]: {\r\n    effects: [],\r\n    available: {\r\n      command_abilities: [CommandAbilities],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { DEATH } from 'meta/alliances'\r\nimport { TOMB_KINGS } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const TombKingsFaction = new Faction(\r\n  TOMB_KINGS,\r\n  DEATH,\r\n  SubFactions,\r\n  undefined,\r\n  undefined,\r\n  pickEffects(battle_traits, ['Deathless Minions'])\r\n)\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_TZEENTCH: {\r\n    name: 'Battletome: Disciples of Tzeentch',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_JANUARY_2022: {\r\n    name: 'Errata (January 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2018/07/GXWsABT46yRGS413.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n} from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  // Fated Artefacts - Arcanites Only\r\n /* Changeblade: {\r\n    effects: [\r\n      {\r\n        name: `Changeblade`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Each time an enemy Hero is slain by attacks made with that weapon, you can say it is transformed into a Spawn instead of being slain (pg 65).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Timeslip Pendant': {\r\n    effects: [\r\n      {\r\n        name: `Timeslip Pendant`,\r\n        desc: `Once per battle, in the combat phase, after the bearer has fought for the first time in that phase, you can say that you are using the Timeslip Pendant. If you do so, they do not count as having fought in that phase but the strike-last effect applies to them until the end of that phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Daemonheart: {\r\n    effects: [\r\n      {\r\n        name: `Daemonheart`,\r\n        desc: `Once per battle, at the start of the combat phase, pick 1 enemy unit within 1\" of the bearer. That unit suffers a number of mortal wounds equal to the number of the current battle round.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  \"Ambition's End\": {\r\n    effects: [\r\n      {\r\n        name: `Ambition's End`,\r\n        desc: `Once per battle, at the start of your hero phase, you can pick 1 enemy wizard within 1\" of the bearer. That wizard suffers a number of mortal wounds equal to the number of the current battle round. In addition, that wizard cannot attempt to unbind any spells until your next hero phase.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Secret-eater': {\r\n    effects: [\r\n      {\r\n        name: `Secret-eater`,\r\n        desc: `Pick 1 of the bearer's weapons. If the unmodified hit roll for any attack made with that weapon is 6 and you have fewer than 9 Destiny Dice, you can roll a dice and add it to your Destiny Dice.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Spiteful Shield': {\r\n    effects: [\r\n      {\r\n        name: `Spiteful Shield`,\r\n        desc: `If the unmodified save roll for an attack made with a melee weapon that targets the bearer is 6, the attacking unit suffers 2 mortal wounds afer all of its attacks have been resolved.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Daemonic Treasures - Daemons Only\r\n  'Warpfire Blade': {\r\n    effects: [\r\n      {\r\n        name: `Warpfire Blade`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If the unmodified hit roll for an attack made with that weapon is 6, that attack inflicts 2 mortal wounds on the target in addition to any damage it inflicts.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Blade of Fate': {\r\n    effects: [\r\n      {\r\n        name: `Blade of Fate`,\r\n        desc: `Pick 1 of the bearer's melee weapons. Once per battle, if the unmodified hit roll for an attack made with that weapon is 6, you can replace one of your Destiny Dice with that roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Pyrofyre Stave': {\r\n    effects: [\r\n      {\r\n        name: `Pyrofyre Stave`,\r\n        desc: `Pick 1 of the bearer's melee weapons. If any wounds inflicted by that weapon are allocated to an enemy Wizard and that model is not slain, that Wizard cannot unbind spells for the rest of the battle.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Wyrdflame Blade': {\r\n    effects: [\r\n      {\r\n        name: `Wyrdflame Blade - Passive`,\r\n        desc: `Effect: If any damage points are allocated to an enemy unit by this units combat attacks, that enemy unit has the Burning keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nine-Eyed Tome': {\r\n    effects: [\r\n      {\r\n        name: `Nine-Eyed Tome - Passive`,\r\n        desc: `Effct: Add 1 to casting rolls and banishment rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ambitions End': {\r\n    effects: [\r\n      {\r\n        name: `Ambitions End - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy Wizard in combat with this unit to be the target. \r\n        Effect: Inflict D3 mortal damage on the target. In addition, subtract 1 from casting rolls for the target for the rest of the battle.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { StrategistsBattalionEffect } from 'generic_rules/core_battalions'\r\n\r\nconst TzeentchBattalions = {\r\n /* 'Battle Formations': {\r\n    effects: [StrategistsBattalionEffect],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(TzeentchBattalions, 'battalion')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport { START_OF_HERO_PHASE } from 'types/phases'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst BattleTactics = {\r\n /* 'Call for Change': {\r\n    effects: [\r\n      {\r\n        name: `Call for Change`,\r\n        desc: `You complete this battle tactic if you summon a Lord of Change to the battlefield this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Mass Conjuration': {\r\n    effects: [\r\n      {\r\n        name: `Mass Conjuration`,\r\n        desc: `Pick 1 friendly Disciples of Tzeentch Wizard. You complete this battle tactic if that Wizard successfully casts 3 or more spells in that turn and none of those spells are unbound.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Ninefold Dismantelment': {\r\n    effects: [\r\n      {\r\n        name: `Ninefold Dismantelment`,\r\n        desc: `Pick 1 enemy unit that has 9 or more models, or pick 1 enemy Hero or Monster with a Wounds characteristic of 9 ore more. You complete this battle tactic if that unit is destroyed by the end of this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Reckless Abandon': {\r\n    effects: [\r\n      {\r\n        name: `Reckless Abandon`,\r\n        desc: `Pick 1 friendly Mortal Disciples of Tzeentch unit that is more than 18\" from all enemy units. You complete this battle tactic if that unit completes a charge move in this turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tides of Anarchy': {\r\n    effects: [\r\n      {\r\n        name: `Tides of Anarchy`,\r\n        desc: `You complete this battle tactic if you gain control of an objective that was controlled by your opponent at the start of your hero phase, and you have 9 ore more friendly models within 6\" of that objective when you gain control of it.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTactics, 'battle_tactic')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { TZEENTCH } from 'meta/factions'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_SHOOTING_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  TURN_FIVE_HERO_PHASE,\r\n  TURN_ONE_HERO_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  TURN_THREE_HERO_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  // Tzeentch Allegiance\r\n  [TZEENTCH]: {\r\n \r\n    effects: [\r\n        {\r\n          name: `Masters of Destiny`,\r\n          desc: `Effect: Roll 9 dice and place them to one side. These are your destiny dice. Destiny dice can be spent during the battle to change certain dice rolls. You can never have more than 9 destiny dice at once. \r\n          During the battle, instead of making a roll from the list below for a friendly Disciples of Tzeentch unit, you can spend your destiny dice. The roll you would have made is replaced with the roll on the destiny dice you spend. If you want to replace a 2D6 roll, 3D6 roll, etc. you must spend a number of destiny dice equal to the number before D6. Any rolls that have been replaced count as unmodified rolls, and they cannot be re-rolled, they cannot be changed and they cannot be modified by other friendly abilities (but they can be modied by enemy abilities). You cannot spend destiny dice to replace re-rolls. Destiny dice can be spent in place of the following dice rolls:  \r\n          - Casting rolls  \r\n          - Unbinding rolls  \r\n          - Banishment rolls  \r\n          - Run rolls  \r\n          - Charge rolls in your turn  \r\n          - Hit rolls  \r\n          - Wound rolls  \r\n          - Save rolls`,\r\n          when: [DURING_SETUP],\r\n        },\r\n      {\r\n        name: `Conflagration of Tzeentch - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by Wyrdflame Spell abilities or shooting attacks made with weapons that have the Wyrdame weapon ability to be the target. \r\n        Effect: The target has the Burning keyword.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Wyrdflame - Once Per Turn`,\r\n        desc: `Effect: Roll a D3 for each Burning enemy unit. On a 2-3, inflict an amount of mortal damage on that unit equal to the roll. On a 1, that unit no longer has the Burning keyword.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Quenching the Flames - Passive`,\r\n        desc: `Effect: If a Burning enemy unit uses an ability that would heal or return slain models to it, instead of healing or returning slain models to it, that unit no longer has the Burning keyword.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      // Omitted Change Covens (you can pick 1 of the following subfactions)... not necessary\r\n    ],\r\n  }, \r\n\r\n  // Eternal Conflagration Flavor\r\n /* 'Masters of Destiny': {\r\n    effects: [\r\n      {\r\n        name: `Masters of Destiny`,\r\n        desc: `Effect: Roll 9 dice and place them to one side. These are your destiny dice. Destiny dice can be spent during the battle to change certain dice rolls. You can never have more than 9 destiny dice at once. \r\n        During the battle, instead of making a roll from the list below for a friendly Disciples of Tzeentch unit, you can spend your destiny dice. The roll you would have made is replaced with the roll on the destiny dice you spend. If you want to replace a 2D6 roll, 3D6 roll, etc. you must spend a number of destiny dice equal to the number before D6. Any rolls that have been replaced count as unmodified rolls, and they cannot be re-rolled, they cannot be changed and they cannot be modified by other friendly abilities (but they can be modied by enemy abilities). You cannot spend destiny dice to replace re-rolls. Destiny dice can be spent in place of the following dice rolls:  \r\n        Casting rolls  \r\n        Unbinding rolls  \r\n        Banishment rolls  \r\n        Run rolls  \r\n        Charge rolls in your turn  \r\n        Hit rolls  \r\n        Wound rolls  \r\n        Save rolls`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  // Hosts Duplicitous Flavor\r\n  'Ranks of Mischievous Mirages': {\r\n    effects: [\r\n      {\r\n        name: `Ranks of Mischievous Mirages`,\r\n        desc: `Enemy units within 3\" of a friendly Hosts Duplicitous unit models cannot retreat.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ranks of Mischievous Mirages`,\r\n        desc: `Once per battle, when a Hosts Horrors of Tzeentch unit from your starting army is destroyed a dice. On a 4+, add a Hosts Duplicitous Horrors of Tzeentch models to your army. Set up the new unit wholly within 12\" of a friendly Hosts Duplicitious Hero and more than 9\" from all enemy units.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Hosts Arcanum Flavor\r\n  'Thieves of All Things Arcane': {\r\n    effects: [\r\n      {\r\n        name: `Thieves of All Things Arcane`,\r\n        desc: `Once per turn, in the first, third, and fifth battle rounds, when a friendly Host Arcanum Wizard attempts to unbind a spell, you can choose for the spell to be automatically unbound (do not roll 2D6).`,\r\n        when: [TURN_ONE_HERO_PHASE, TURN_THREE_HERO_PHASE, TURN_FIVE_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Cult of Transient Form Flavor\r\n  'The Change-gift': {\r\n    effects: [\r\n      {\r\n        name: `The Change-gift`,\r\n        desc: `Roll a dice each time a friendly Cult of the Transient Form Kairic Acolyte model is slain in the combat phase. On a 2-5, before removing that model from play, that model can fight. On a 6, before removing that model from play, you can add 1 Tzaangor model to a friendly Tzaangor Host unit within 9\" of the slain model. The new model can only be set up within 3\" of an enemy unit if the unit to which it is added is within 3\" of that enemy unit.'`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Pyrofane Cult Flavor\r\n /* 'Arrows of Tzeentch': {\r\n    effects: [\r\n      {\r\n        name: `Arrows of Tzeentch`,\r\n        desc: `Add 1 to hit rolls for attacks made with Sorcerous Bolts by friendly Pyrofane Cult Kairic Acolytes units. In addition, at the end of your shooting phase, roll a dice for each enemy unit that suffered any wounds caused by attacks made with Sorcerous Bolts by friendly Pyrofane Cult units in that phase. On a 5+, that unit suffers D3 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Arrows of Tzeentch`,\r\n        desc: `At the end of your shooting phase, roll a dice for each enemy unit that suffered any wounds caused by attacks made with Sorcerous Bolts by friendly Pyrofane Cult units in that phase. On a 5+, that unit suffers D3 mortal wounds.`,\r\n        when: [END_OF_SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Guild of Summoners Flavor\r\n  'Scions of the Exiled': {\r\n    effects: [\r\n      {\r\n        name: `Scions of the Exiled`,\r\n        desc: `If your army has the Guild of Summoners keyword, your Fate Points can only be used to summon Lord of Change units. Instead of a Fate Point cost of 30, a Guild of Summoners Lord of Change costs 9 Fate Points to summon the first time, and 18 Fate Points each time thereafter for the rest of the battle. In addition, Lord of Change units summoned in this way must be set up wholly within 9\" of a Guild of Summoners Arcanite Hero and more than 9\" from all enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_SETUP,\r\n} from 'types/phases'\r\nconst CommandTraits = {\r\n  // Arcanites\r\n  'Cult Demagogue': {\r\n    effects: [\r\n      {\r\n        name: `Cult Demagogue - Passive`,\r\n        desc: `Effect: If each dice in a casting roll for this unit has the same value and the spell is not miscast, add 3 to the casting roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Illusionist': {\r\n    effects: [\r\n      {\r\n        name: `Illusionist - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target friendly units while they are wholly within this units combat range.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Nexus of Fate': {\r\n    effects: [\r\n      {\r\n        name: `Nexus of Fate`,\r\n        desc: `Effect: Roll a dice. You must replace 1 of your destiny dice with that roll.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* Illusionist: {\r\n    effects: [\r\n      {\r\n        name: `Illusionist`,\r\n        desc: `Subtract 1 from hit rolls for attacks that target this general.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Daemons\r\n  Daemonspark: {\r\n    effects: [\r\n      {\r\n        name: `Daemonspark`,\r\n        desc: `Once per battle, in your hero phase, you can unleash the Daemonspark. If you do so, you immediately gain 3 Fate Points.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Incorporeal Form': {\r\n    effects: [\r\n      {\r\n        name: `Incorporeal Form`,\r\n        desc: `Each time this general is affected by a spell or endless spell, you can roll a dice. On a 5+, ignore the effect of that spell or the effects of that endless spell on this general.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  //Shared\r\n  'Arch-sorcerer': {\r\n    effects: [\r\n      {\r\n        name: `Arch-sorcerer`,\r\n        desc: `WIZARDS only. This general knows 2 extra spells from their spell lore.`,\r\n        when: [START_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Nexus of Fate': {\r\n    effects: [\r\n      {\r\n        name: `Nexus of Fate`,\r\n        desc: `At the start of your hero phase, if this general is on the battlefield, you can roll a dice. If you do so, you can replace one of your Destiny Dice with that roll.`,\r\n        when: [START_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport { END_OF_HERO_PHASE, END_OF_MOVEMENT_PHASE, HERO_PHASE, MOVEMENT_PHASE } from 'types/phases'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n// Endless prayers.\r\nconst EndlessSpells = {\r\n /* 'Daemonic Simulacrum': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 7 and range of 12\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Disciples of Tzeentch Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      GenericEffects.Predatory.Nine_Inches,\r\n      {\r\n        name: `Snapping Jaws`,\r\n        desc: `After this endless spell has moved, roll 9 dice for the closest unit within 6\" of it. If more than 1 such unit is equally close, the commanding player can choose which unit to roll for. For each 5+, that unit suffers 1 mortal wound. If that unit is a Wizard, it suffers 1 mortal wound for each 4+ instead.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tome of Eyes': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['The Parchment Curse'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `This endless spell is summoned with a spell that has a casting value of 5 and range of 1\". If successfully cast, set up this endless spell within range and visible to the caster, and more than 1\" from all other models, other endless spells and invocations. Only Disciples of Tzeentch Wizards can attempt to summon this endless spell.\r\n\r\n        A Wizard in a garrison cannot attempt to summon this endless spell, and if this endless spell is summoned, the Wizard that summoned it cannot join a garrison until this endless spell has been removed from play.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Linked`,\r\n        desc: `After the model that summoned this endless spell has moved, remove this endless spell from the battlefield and set it up again within 1\" of that model and more than 1\" from all other models, other endless spells and invocations. If the model that summoned this endless spell is removed from play, then this endless spell is removed from play.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      GenericEffects.Linked,\r\n      {\r\n        name: `Transfixed by Countless Eyes`,\r\n        desc: `You can reroll casting rolls for the model that summoned this endless spell while this endless spell is on the battlefield.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Burning Sigil of Tzeentch': {\r\n    effects: [\r\n      {\r\n        name: `Summoning`,\r\n        desc: `Casting value of 5 and range of 18\". If successfully cast, set up this endless spell wholly within range and visible to the caster, and more than 1\" from all models, other endless spells and invocations. Only Disciples of Tzeentch Wizards can attempt to summon this endless spell.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Radiant Transmogrification`,\r\n        desc: `At the end of the movement phase, roll a dice for each unit within 9\" of this endless spell. On a 4+, that unit suffers D3 mortal wounds. If any models were slain by this spell, before removing the first slain model, the commanding player of the model that summoned this endless spell can add 1 Tzeentch Chaos Spawn to their army and set it up within 3\" of the slain model's unit. Then, remove the slain model.`,\r\n        when: [END_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(EndlessSpells, 'endless_spell')\r\n","import { pickEffects } from 'factions/metatagger'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_ROUND,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport BattleTraits from './battle_traits'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst Flavors = {\r\n  'Arcanite Cabal': {\r\n    effects: [\r\n      {\r\n        name: `Sinister Counter-Hexes - Passive`,\r\n        desc: `Effect: Add 1 to unbinding rolls for friendly Arcanite units. In addition, if a friendly Arcanite unit unbinds a spell, no command points are spent for that unit to use the Magical Intervention command in that phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Change Host': {\r\n    effects: [\r\n      {\r\n        name: `Twist of Fate - Once Per Battle`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Daemon unit that is in combat to be the target. \r\n        Effect: Roll a dice. On a 3+, remove the target from the battlefield and set it up again on the battlefield. Each model in the target unit must be set up in combat with any of the enemy units that the target was in combat with before it was removed from the battlefield.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Coven': {\r\n    effects: [\r\n      {\r\n        name: `Screeching Warflock - Passive`,\r\n        desc: `Effect: Each time a friendly Warflock unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wyrdflame Host': {\r\n    effects: [\r\n      {\r\n        name: `Mutagenic Inferno - Passive`,\r\n        desc: `Effect: Subtract 1 from wound rolls for attacks made by Burning enemy units.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  'The Eternal Conflagration': {\r\n    effects: [...pickEffects(BattleTraits, ['Twisters of Materiality'])],\r\n  },\r\n\r\n  'Hosts Duplicitous': {\r\n    effects: [...pickEffects(BattleTraits, ['Ranks of Mischievous Mirages'])],\r\n  },\r\n\r\n  'Hosts Arcanum': {\r\n    effects: [...pickEffects(BattleTraits, ['Thieves of All Things Arcane'])],\r\n  },\r\n\r\n  'Cult of the Transient Form': {\r\n    effects: [...pickEffects(BattleTraits, ['The Change-gift'])],\r\n  },\r\n\r\n  'Pyrofane Cult': {\r\n    effects: [...pickEffects(BattleTraits, ['Arrows of Tzeentch'])],\r\n  },\r\n\r\n  'Guild of Summoners': {\r\n    effects: [...pickEffects(BattleTraits, ['Scions of the Exiled'])],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default Flavors\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { END_OF_GAME } from 'types/phases'\r\n\r\nconst GrandStrategies = {\r\n /* 'Dominate Arcane Nexus': {\r\n    effects: [\r\n      {\r\n        name: `Dominate Arcane Nexus`,\r\n        desc: `When the battle ends, you complete this grand strategy if there is at least 1 friendly Disciples of Tzeentch Wizard, Horrors of Tzeentch unit or Kairic Acolyte unit wholly within each large quarter of the battlefield.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Master of Destiny': {\r\n    effects: [\r\n      {\r\n        name: `Master of Destiny`,\r\n        desc: `When the battle ends, add the rolls of any Destiny Dice that you have not used. You complete this grand strategy if the total is 9 or more.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Preponderance of Fate': {\r\n    effects: [\r\n      {\r\n        name: `Preponderance of Fate`,\r\n        desc: `When the battle ends, you complete this grand strategy if you have more than 27 unspent Fate Points.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Realm of Magic': {\r\n    effects: [\r\n      {\r\n        name: `Realm of Magic`,\r\n        desc: `When the battle ends, you complete this grand strategy if there are two or more endless spells on the battlefield that are under your control.`,\r\n        when: [END_OF_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(GrandStrategies, 'grand_strategy')\r\n","import { tagAs } from 'factions/metatagger'\r\nimport {\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  HERO_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport rule_sources from './rule_sources'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nconst Spells = {\r\n  // Common\r\n  'Lore of Fate': {\r\n    effects: [\r\n      {\r\n        name: `Glimpse the Future: Casting value of 7 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, then make a casting roll of 2D6. \r\n        Effect: Set aside any destiny dice that have a value of 6, and roll all of your other destiny dice again. If you have no destiny dice, roll a dice and add it to your destiny dice.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Infernal Gateway: Casting value of 6`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll either 4 dice or a number of dice equal to the number of destiny dice you have left, whichever is greater. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Shield of Fate: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, pick a visible friendly unit wholly within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: The target has Ward (5+) until the start of your next turn. In addition, if you have 4 or more destiny dice left, subtract 1 from hit rolls for attacks that target that unit until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  // Lore of Fate - Mortal/Arcanite Only\r\n  'Lore of Change': {\r\n    effects: [\r\n      {\r\n        name: `Bolt of Tzeentch: Casting value of 6 (UNLIMITED)`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, pick a visible enemy unit within 18\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Fold Reality: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, pick a visible friendly Disciples of Tzeentch unit wholly within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Remove the target from the battlefield and set it up again on the battlefield more than 9\" from all enemy units.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Transformed to Spawn: Casting value of 7`,\r\n        desc: `Declare: Pick a friendly Disciples of Tzeentch Wizard to cast this spell, pick a visible enemy unit within 12\" of them to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict D3 mortal damage on the target. If any models are slain by this ability, pick a friendly Chaos Spawn of Tzeentch unit that is in reserve as a potential fate or that has been destroyed. If you picked a unit in reserve as a potential fate, set it up on the battlefield in combat with the target. \r\n        If you picked a unit that has been destroyed, set up an identical replacement unit on the battlefield in combat with the target.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport rule_sources from 'factions/slaves_to_darkness/rule_sources'\r\n// import { BookOfProfaneSecretsEffect, LordsOfTheSilverTowerEffect } from 'factions/slaves_to_darkness/units'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport {\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_GAME,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_TURN,\r\n  TURN_ONE_MOVEMENT_PHASE,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\n/* export const TzaangorChampionEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be an Aviarch. Add 1 to the Attacks characteristic of that model's Tzeentchian Spear.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nexport const BabblingStreamOfSecretsEffect = {\r\n  name: `Babbling Stream of Secrets`,\r\n  desc: `In the combat phase, enemy units within 3\" of any friendly units with this ability cannot receive commands.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst GuidedByThePastEffect = {\r\n  name: `Guided by the Past`,\r\n  desc: `You can add 1 to wound rolls for attacks made with melee weapons by friendly units with this ability if you are taking the second turn in the current battleround. This ability does not affect attacks made by a mount.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst SilveredPortalEffect = {\r\n  name: `Silvered Portal`,\r\n  desc: `After you have deployed this unit, when you would set up another friendly TZEENTCH unit that is not a MONSTER, you can say that it is in this Gaunt Summoner's Silver Tower as a reserve unit. Up to 2 units can be set up in reserve in this way. At the end of any of your movement phases, you can set up 1 or more of these units on the battlefield wholly within 9\" of this unit and more than 9\" from all enemy units. At the start of the fourth battle round, reserve units that are still in a Silver Tower are destroyed.`,\r\n  when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_SLAVES_TO_DARKNESS, rule_sources.ERRATA_JANUARY_2023],\r\n  shared: true,\r\n}\r\nconst ArcaneTomeEffect = {\r\n  name: `Arcane Tome`,\r\n  desc: `Once per battle, you can reroll 1 casting roll for this unit. If you do so, add 3 to the new casting roll.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst CapriciousWarpflameEffect = {\r\n  name: `Capricious Warpflame`,\r\n  desc: `Add 1 to hit rolls for attacks made by this unit's Warpflame, Billowing Warpflame or Flaming Maws weapon if the target unit has 5 or more models.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst MagicTouchedEffect = {\r\n  name: `Magic-touched`,\r\n  desc: `If the first casting attempt made by this unit in your hero phase is successful and the spell is not unbound, this unit can attempt to cast 1 extra spell in that phase. If it does so and the casting roll for that extra spell is a double, the casting attempt automatically fails and this unit is slain. If this happens, you can choose for this unit to be transformed into a Spawn (pg 65) instead of being slain.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst BeaconOfSorcery = {\r\n  name: `Beacon of Sorcery`,\r\n  desc: `Add 1 to casting rolls, dispelling rolls and unbinding rolls for friendly Tzeentch Wizards while they are wholly within 18\" of this unit. In addition, this unit knows all of the spells from the Lore of Change.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst MasteryOfMagicEffect = {\r\n  name: `Mastery of Magic`,\r\n  desc: `When you make a casting, unbinding or dispelling roll for this unit, you can change the lowest D6 to match the highest D6.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst SpellThiefEffect = {\r\n  name: `Spell-thief`,\r\n  desc: `If this unit successfully dispels an endless spell, instead of dispelling it, you can say that it will steal it. If you do so, this unit gains control of that endless spell and counts as the Wizard that summoned it until its dispelled or another unit steals it.`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst WakeofFireEffect = {\r\n  name: `Wake of Fire`,\r\n  desc: `After this unit has made a normal move, pick 1 enemy unit and roll a dice if this unit passed across any models in that enemy unit. On a 2+, that enemy unit suffers D3 mortal wounds.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n} */\r\n\r\nconst Units = {\r\n  // Daemons\r\n  'Lord of Change': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Gateway'])],\r\n    }, */\r\n    effects: [\r\n      //MasteryOfMagicEffect, SpellThiefEffect, BeaconOfSorcery, GenericEffects.WizardTwoSpellsEffect\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Curved Beak is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Summon Daemons of Tzeentch - Once Per Turn`,\r\n        desc: `Declare: Discard 1 destiny dice. Then, pick a friendly non-Hero non-Unique Disciples of Tzeentch Daemon unit that has been destroyed to be the target. \r\n        Effect: Set up a replacement unit with half the number of models from the target unit (rounding up) wholly within 9\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Locus of Change - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for combat attacks that target friendly Disciples of Tzeentch Daemon units while they are wholly within 12\" of this unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Tzeentch's Firestorm: Casting value of 7`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of the caster to be the target, then make a casting roll of 2D6. \r\n        Effect: Roll 9 dice. For each 6, inflict D3 mortal damage on the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      ],\r\n  },\r\n  'Kairos Fateweaver': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Gateway'])],\r\n    }, */\r\n    effects: [\r\n     // MasteryOfMagicEffect,\r\n      //BeaconOfSorcery,\r\n      //SpellThiefEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Curved Beaks is 3.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mastery of Magic - Passive`,\r\n        desc: `Effect: When you make a casting roll for this unit, you can change the lowest D6 to match the highest D6.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Beacon of Sorcery - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls and unbinding rolls for friendly Disciples of Tzeentch Wizards while they are wholly within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Suggestion: Casting value of 8`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Pick 1 of the following effects to apply to the target until the start of your next turn: \r\n        Its Hopeless: The target cannot use commands. \r\n        Drop Your Weapons: Subtract 1 from hit rolls and wound rolls for the targets attacks. \r\n        Kneel: Subtract 1 from save rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Oracle of Eternity - Once Per Battle - Reaction: You declared the \"Tactical Gambit\" ability`,\r\n        desc: `Effect: Pick 1 of the following effects: \r\n        Read the Past: You can pick 1 battle tactic that you have already attempted. \r\n        Read the Future: You can pick 2 battle tactics that you have not yet attempted, but you can only complete 1 of them (even if you meet the conditions to complete both). The other does not count as having been attempted. If you do not complete either battle tactic, you can pick which does not count as having been attempted.`,\r\n        when: [START_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Gaunt Summoner': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Flames'])],\r\n    }, */\r\n    effects: [\r\n      //BookOfProfaneSecretsEffect,\r\n      //LordsOfTheSilverTowerEffect,\r\n     // SilveredPortalEffect,\r\n      //GenericEffects.WizardTwoSpellsEffect,\r\n      {\r\n        name: `Minions of the Silver Tower`,\r\n        desc: `Declare: Pick a friendly unit that has not been deployed to be the target. \r\n        Effect: The target is set up in reserve in a Silver Tower. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Book of Profane Secrets`,\r\n        desc: `Declare: Pick a friendly unit in a Silver Tower to be the target. \r\n        Effect: Set up the target on the battlefield wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Divert Realmgate: Casting value of 7`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Units set up this turn using this units Book of Profane Secrets ability can be set up wholly within 18\" of this unit and more than 7\" from all enemy units instead of the distances in the ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Gaunt Summoner on Disc of Tzeentch': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Flames'])],\r\n    }, */\r\n    effects: [\r\n     // BookOfProfaneSecretsEffect,\r\n     // LordsOfTheSilverTowerEffect,\r\n    //  SilveredPortalEffect,\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    {\r\n      name: `Minions of the Silver Tower`,\r\n      desc: `Declare: Pick a friendly unit that has not been deployed to be the target. \r\n      Effect: The target is set up in reserve in a Silver Tower. It has now been deployed.`,\r\n      when: [DURING_SETUP],\r\n    },\r\n    {\r\n      name: `Book of Profane Secrets`,\r\n      desc: `Declare: Pick a friendly unit in a Silver Tower to be the target. \r\n      Effect: Set up the target on the battlefield wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    {\r\n      name: `Arcane Imprisonment: Casting value of 7`,\r\n      desc: `Declare: Pick an enemy Hero in combat with this unit to be the target, then make a casting roll of 2D6. \r\n      Effect: If the unmodified casting roll exceeds the targets Health characteristic, it is automatically destroyed. For the rest of the battle, that unit cannot be picked to be the target of an ability that allows a replacement unit to be set up.`,\r\n      when: [HERO_PHASE],\r\n    },  \r\n  ],\r\n  },\r\n  'Fateskimmer, Herald of Tzeentch on Burning Chariot': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Red Fire of Tzeentch'])],\r\n    }, */\r\n    effects: [\r\n    //  ArcaneTomeEffect, WakeofFireEffect, GenericEffects.WizardOneSpellEffect\r\n    {\r\n      name: `Wake of Fire`,\r\n      desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n      Effect: Roll a dice. On a 3+, the target has the Burning keyword.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    {\r\n      name: `Fueling the Inferno`,\r\n      desc: `Declare: Pick up to 3 Burning enemy units within 12\" of this unit to be the targets. \r\n      Effect: Inflict 1 mortal damage on each target.`,\r\n      when: [END_OF_TURN],\r\n    },\r\n  ],\r\n  },\r\n /* 'Fluxmaster, Herald of Tzeentch on Disc': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Blue Fire of Tzeentch'])],\r\n    }, \r\n    effects: [\r\n    //  ArcaneTomeEffect, GenericEffects.WizardOneSpellEffect\r\n    ],\r\n  }, */\r\n  'The Changeling': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Deceiver`,\r\n        desc: `Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Discord and Confusion: Casting value of 6`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Subtract 1 from hit rolls for attacks that target this unit until the start of your next turn. \r\n        In addition, until the start of your next turn, roll a dice each time this unit is targeted by an ability that is not an Attack ability. On a 4+, another eligible unit must be targeted by that ability instead of this unit. If it is not possible to target another unit, that ability has no effect.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Puckish Misdirection - Enemy Hero Phase`,\r\n        desc: `Declare: Pick an enemy unit within 9\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, halve the targets Move characteristic for the rest of the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n  'Changecaster, Herald of Tzeentch': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Pink Fire of Tzeentch'])],\r\n    }, */\r\n    effects: [\r\n    //  ArcaneTomeEffect, GenericEffects.WizardOneSpellEffect\r\n    {\r\n      name: `Lurid Flames - Passive`,\r\n      desc: `Effect: Add 1 to hit rolls for combat attacks made by friendly units that target a Burning enemy unit within 12\" of this unit.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    {\r\n      name: `Daemonic Locus - Passive`,\r\n      desc: `Effect: Each time a friendly Disciples of Tzeentch Daemon unit wholly within 12\" of this unit uses the Rally command, you can make 3 additional rally rolls of D6.`,\r\n      when: [HERO_PHASE],\r\n    },  \r\n  ],\r\n  },\r\n  /* 'The Blue Scribes': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Boon of Tzeentch'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `Frantic Scribbling`,\r\n        desc: `If this unit is part of a Disciples of Tzeentch army, each time an enemy Wizard within 9\" of this unit successfully casts a spell, and that spell is not unbound, you can roll a dice. On a 3+, you receive 1 Fate Point.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Scrolls of Sorcery`,\r\n        desc: `This unit knows all of the spells from the Lore of Fate and Lore of Change. In addition, once in each of your hero phases, when this unit attempts to cast a spell, instead of making a casting roll, you can say that it will read from its scrolls of sorcery. If you do so, roll a dice. On a 2+, that spell is succesfully cast and cannot be unbound.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ], \r\n  }, */\r\n  'Screamers of Tzeentch': {\r\n    effects: [\r\n      {\r\n        name: `Slashing Fins`,\r\n        desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n        Effect: Roll a dice for each model in this unit that passed across the target. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Burning Chariots of Tzeentch': {\r\n    effects: [\r\n     // CapriciousWarpflameEffect, WakeofFireEffect, GenericEffects.Elite\r\n     {\r\n      name: `Wake of Fire`,\r\n      desc: `Declare: Pick an enemy unit that this unit passed across this phase to be the target. \r\n      Effect: Roll a dice. On a 3+, the target has the Burning keyword.`,\r\n      when: [MOVEMENT_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Exalted Flamers of Tzeentch': {\r\n    effects: [\r\n    //  CapriciousWarpflameEffect, GenericEffects.Elite\r\n    {\r\n      name: `Capricious Wyrdflame`,\r\n      desc: `Effect: Add 1 to wound rolls for this units shooting attacks that target a Burning enemy unit.`,\r\n      when: [SHOOTING_PHASE],\r\n    },  \r\n    {\r\n      name: `Transmogrifying Beacon - Once Per Turn`,\r\n      desc: `Declare: Pick another friendly Exalted Flamer of Tzeentch or Flamers of Tzeentch unit within this units combat range to be the target. \r\n      Effect: Roll a dice. On a 3+, the targets ranged weapons have Crit (2 Hits) for the rest of the turn.`,\r\n      when: [SHOOTING_PHASE],\r\n    },\r\n  ],\r\n  },\r\n  'Flamers of Tzeentch': {\r\n    effects: [\r\n      //CapriciousWarpflameEffect,\r\n      {\r\n        name: `Capricious Wyrdflame`,\r\n        desc: `Effect: Add 1 to wound rolls for this units shooting attacks that target a Burning enemy unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      }, \r\n    ],\r\n  },\r\n  'Pink Horrors': {\r\n    effects: [\r\n      {\r\n        name: `Lunatic Demise - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain, before removing the model from play, pick 1 of the following effects: \r\n        Split: Pick a friendly Blue Horrors and Brimstone Horrors unit within 12\" of this unit. Return up to 2 slain Blue Horror models to that unit. \r\n        Petty Vengeance: Pick an enemy unit in combat with this unit to be the target and roll a dice. On a 4+, inflict 1 mortal damage on the target.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Blue and Brimstone Horrors': {\r\n    effects: [\r\n      {\r\n        name: `Split Again - Passive`,\r\n        desc: `Effect: Each time a Blue Horror model in this unit is slain, before removing the model from play, roll a dice. On a 3+, you can add 1 Brimstone Horrors model to this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  // Mortals\r\n  'Magister on Disc of Tzeentch': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Bolt of Change'])],\r\n    },*/\r\n    effects: [\r\n    //  MagicTouchedEffect, GenericEffects.WizardOneSpellEffect\r\n    {\r\n      name: `Magic-Touched`,\r\n      desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n      Add 1 to this units power level.  \r\n      If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Master of the Blazing Skies - Passive`,\r\n      desc: `Effect: While they are within this units combat range, friendly Disc of Tzeentch units can use Charge abilities even if they used a Run ability in the same turn..`,\r\n      when: [CHARGE_PHASE],\r\n    }, \r\n  ],\r\n  },\r\n  Magister: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Bolt of Change'])],\r\n    }, */\r\n    effects: [\r\n    //  MagicTouchedEffect, GenericEffects.WizardOneSpellEffect\r\n    {\r\n      name: `Magic-Touched`,\r\n      desc: `Effect: If this unit successfully cast a spell this phase, for the rest of the turn:  \r\n      Add 1 to this units power level.  \r\n      If 2 or more dice in a casting roll for this unit have the same value, the spell fails, its effect is not resolved and D6 mortal damage is inflicted on this unit.`,\r\n      when: [HERO_PHASE],\r\n    },\r\n    {\r\n      name: `Web of Intrigue`,\r\n      desc: `Declare: Pick an enemy unit within 12\" of this unit to be the target. \r\n      Effect: Until the start of your next turn, each time your opponent declares a Move ability for the target, before reactions are used, you can pick a friendly Arcanite unit that is not in combat and is within 12\" of the target. That friendly unit can move 3\", but it cannot move into combat during any part of that move.`,\r\n      when: [HERO_PHASE],\r\n    },  \r\n  ],\r\n  },\r\n  'Curseling, Eye of Tzeentch': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Glean Magic'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Infusion Arcanum: Casting value of 5`,\r\n        desc: `Declare: Make a casting roll of 2D6. \r\n        Effect: Until the start of your next turn, add 1 to the Rend and Damage characteristics of this units Staff of Tzeentch and Blazing Sword.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Disrupter of the Arcane - Passive`,\r\n        desc: `Effect: Each time this unit unbinds a spell, roll a dice. On a 4+, subtract 1 from the power level of the enemy Wizard that used that Spell ability, to a minimum of 0, until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  GenericEffects.WizardTwoSpellsEffect,\r\n    ],\r\n  },\r\n/*  'The Eyes of the Nine': {\r\n    effects: [\r\n      {\r\n        name: `Arcanite Shield`,\r\n        desc: `Narvia and Turosh have a ward of 6+.`,\r\n        when: [WARDS_PHASE],\r\n      },\r\n      {\r\n        name: `Split`,\r\n        desc: `If the Blue Horror model from this unit is slain, you can add 1 Brimstone Horrors model to that unit. The Brimstone Horrors model is armed with Magical Flames and Taloned Hands. Its Magical Flames have an Attacks characteristic of 1 instead of 2, and its Taloned Hands have an Attacks characteristic of 2 instead of 1.`,\r\n        when: [WOUND_ALLOCATION_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vortemis the All-seeing': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Sorcerous Insight'])],\r\n    }, \r\n    effects: [\r\n    //  MagicTouchedEffect, GenericEffects.WizardOneSpellEffect\r\n    ],\r\n  }, \r\n  Fatemaster: {\r\n    effects: [\r\n      {\r\n        name: `Lord of Fate`,\r\n        desc: `Add 1 to wound rolls for attacks made by friendly Disciples of Tzeentch units wholly within 9\" of this unit.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Soulbound Shield`,\r\n        desc: `Each time this unit is affected by a spell or the ability of an endless spell, you can roll a dice. If you do so, on a 4+, ignore the effects of that spell or that endless spell's ability on this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Ogroid Thaumaturge': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(Spells, ['Choking Tendrils'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Thaumaturge Rage - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls and wound rolls for this units combat attacks while it is damaged.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Burning Fury - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by this units combat attacks to be the target. \r\n        Effect: The target has the Burning keyword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // GenericEffects.WizardOneSpellEffect,\r\n    ],\r\n  },\r\n  'Kairic Acolytes': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Gestalt Sorcery'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.ArcaniteShieldEffect,\r\n      {\r\n        name: `Vulcharc - Passive`,\r\n        desc: `Effect: While this unit includes any models accompanied by Vulcharcs, subtract 1 from casting rolls for enemy Wizards within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Gestalt Sorcery`,\r\n        desc: `Effect: If this unit includes any models carrying a Scroll of Dark Arts, roll a dice. Add 1 to the roll for each other friendly Kairic Acolytes unit within this units combat range. On a 5+, add 1 to the Rend characteristic of this units Sorcerous Bolts for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tzeentch Chaos Spawn': {\r\n    effects: [\r\n      {\r\n        name: `A Twisted Fate`,\r\n        desc: `Declare: This unit must be deployed using this ability. \r\n        Effect: Set up this unit in reserve as a potential fate. It has now been deployed.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Waves of Mutation - Passive`,\r\n        desc: `Effect: Each friendly Chaos Spawn of Tzeentch unit can be replaced any number of times.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  // Tzaangors\r\n  'Tzaangor Shaman': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(Spells, ['Boon of Mutation'])],\r\n    }, */\r\n    effects: [\r\n     // GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Rite of Haste`,\r\n        desc: `Declare: Pick a friendly Warflock unit that does not have Fly and is wholly within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, for the rest of the turn, the target can use a Run ability and still use Shoot and/or Charge abilities later in the turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Mutagenic Sorcery`,\r\n        desc: `Declare: Pick an enemy unit within 12\" of this unit to be the enemy target. Then, pick a friendly Tzaangors unit in combat with that enemy unit to be the friendly target. \r\n        Effect: Roll a D3. On a 2+:  Inflict an amount of mortal damage on the enemy target equal to the roll.  Return a number of slain models to the friendly target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Skyfires': {\r\n    effects: [\r\n      {\r\n        name: `Guided by the Future - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to hit rolls and wound rolls for this units shooting attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Judgement from Afar`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it by this units attacks this phase to be the target. \r\n        Effect: Add 1 to hit rolls for combat attacks made by friendly Warflock units that target that enemy unit for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Tzaangor Enlightened': {\r\n    effects: [\r\n     // TzaangorChampionEffect, BabblingStreamOfSecretsEffect, GuidedByThePastEffect\r\n     {\r\n      name: `Babbling Stream of Secrets`,\r\n      desc: `Declare: If this unit charged this phase, pick an enemy unit in combat with it to be the target. \r\n      Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n      when: [CHARGE_PHASE],\r\n    },\r\n    ],\r\n  },\r\n  'Tzaangor Enlightened on Discs of Tzeentch': {\r\n    effects: [\r\n    //  TzaangorChampionEffect, BabblingStreamOfSecretsEffect, GuidedByThePastEffect\r\n    {\r\n      name: `Guided by the Past - Passive`,\r\n      desc: `Effect: This units Tzeentchian Spears and Vicious Beaks have Charge (+1 Damage) if you are the underdog or it was determined at the start of the battle round that you would take the second turn.`,\r\n      when: [COMBAT_PHASE],\r\n    },  \r\n  ],\r\n  },\r\n  Tzaangors: {\r\n    effects: [\r\n      {\r\n        name: `Screeching Raiders - Passive`,\r\n        desc: `Effect: While this unit is wholly within enemy territory, its weapons have Crit (2 Hits).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Jade Obelisk': {\r\n    effects: [\r\n    //  TzaangorChampionEffect, BabblingStreamOfSecretsEffect, GuidedByThePastEffect\r\n    {\r\n      name: `Stone-Cursed Resolve - Passive`,\r\n      desc: `Effect: Ignore all modifiers to save rolls for this unit (positive and negative).`,\r\n      when: [DURING_GAME],\r\n    },  \r\n    {\r\n      name: `Cast Down the Idol - Passive`,\r\n      desc: `Effect: Add 1 to the Damage characteristic of this units melee weapons for attacks that target Faction Terrain.`,\r\n      when: [COMBAT_PHASE],\r\n    }, \r\n  ],\r\n  },\r\n /* 'Exalted Greater Demon of Tzeentch': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Infernal Gateway'])],\r\n    },\r\n    effects: [\r\n      MasteryOfMagicEffect,\r\n      SpellThiefEffect,\r\n      GenericEffects.WizardTwoSpellsEffect,\r\n      // Intentionally placed command ability here thanks to duplicate key names and different effects.\r\n      {\r\n        name: `Beacon of Sorcery`,\r\n        desc: `You can use this command ability at the start of your hero phase. If you do so, pick 1 friendly model with this command ability. Until your next hero phase, you can add 1 to casting and unbinding rolls for friendly TZEENTCH DAEMON WIZARDS while they are wholly within 24\" of that model. The same unit cannot benefit from this command ability more than once per turn.`,\r\n        when: [START_OF_HERO_PHASE],\r\n        command_ability: true,\r\n      },\r\n    ],\r\n  }, */\r\n  'ROR: Brand`s Oathbound': {\r\n    effects: [\r\n      {\r\n        name: `Gunnar Brand: Carve a Path to Glory`,\r\n        desc: `Declare: This unit can only use this ability if it is in combat with an enemy Hero. \r\n        Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strike-last for the rest of the turn. This unit can only use the second Fight ability if it is in combat with an enemy Hero, and if it does so, it must pick an enemy Hero to be the target of all of its attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n      {\r\n        name: `Gunnar Brand: Oath of Bloodshed - Once Per Battle`,\r\n        desc: `Declare: This unit can only use this ability if any enemy Heroes were slain by this units combat attacks this turn. \r\n        Effect: Friendly Gunnars Oathsworn units have Ward (4+) for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Singri Brand: Swift as the Wind - Passive`,\r\n        desc: `Effect: Only critical hits score successful hits for shooting attacks that target this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },  \r\n      {\r\n        name: `Singri Brand: Uncanny Shot - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Singris Warbow for attacks that target enemy units that are within 6\" of a friendly Gunnar Brand.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn Kin: Withering Death: Casting value of 5`,\r\n        desc: `Declare: Pick a visible enemy Hero within 18\" of this unit to be the target, then make a casting roll of 2D6. \r\n        Effect: Inflict 1 mortal damage on the target and subtract 1 from the Attacks characteristic of the targets melee weapons until the start of your next turn.`,\r\n        when: [HERO_PHASE],\r\n      },  \r\n      {\r\n        name: `Oathsworn Kin: Broken Nadja - Passive`,\r\n        desc: `Effect: While this units Broken Nadja is on the battlefield, it has Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Favour of the Gods - Once Per Turn`,\r\n        desc: `Effect: If any enemy Heroes were slain this turn by the Gunnar Brand in this Regiment of Renown:  \r\n        Heal (5) each unit in this Regiment of Renown.  \r\n        Add 1 to the Attacks characteristic of melee weapons used by units in this Regiment of Renown for the rest of the battle.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Hargax`s Pit-Beasts': {\r\n    effects: [\r\n      {\r\n        name: `Ogroid Myrmidon: Myrmidon Rage - Passive`,\r\n        desc: `Effect: While this unit is damaged, add 2 to the Attacks characteristic of its melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fomoroid Crusher: Cursed Destroyers - Once Per Turn`,\r\n        desc: `Declare: Pick a terrain feature within 1\" of this unit, then pick each other unit (friendly and enemy) within 3\" of that terrain feature to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Mindstealer Sphiranx: Dominate Mind - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit within 6\" of this unit to be the target. \r\n        Effect: Roll a dice. If the roll exceeds the targets Control characteristic, the target has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Bestial Domination - Reaction: You declared a Fight ability for a unit in this Regiment of Renown`,\r\n        desc: `Used By: The unit using that Fight ability. \r\n        Effect: Pick a unit in this Regiment of Renown that has not used a Fight ability this turn to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },  \r\n    ],\r\n  },\r\n  'ROR: Phulgoth`s Shudderhood': {\r\n    effects: [\r\n      {\r\n        name: `Harbinger of Decay: Knell of Doom - Once Per Battle - Enemy Hero Phase`,\r\n        desc: `Declare: Pick up to 3 enemy units within 24\" of this unit to be the targets. \r\n        Effect: Until the start of your next turn, subtract 1\" from the Move characteristic of each target and subtract 1 from run rolls and charge rolls for each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Harbinger of Decay: Omens of Decay: Chant value of 4`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effect: Subtract twice the current battle round number from the targets control score for the rest of the turn. If the chanting roll was 10+, this ability aects all enemy units within 12\" of this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Putrid Blightkinds: Bloated Bulk - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while each model in this unit is contesting an objective you control.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Pusgoyle Blightlords: Relentless Attackers - Passive`,\r\n        desc: `Effect: Add 1 to the Rend characteristic of this units Flyriders Arsenal for attacks that target units contesting an objective you do not control.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Fog of Despair - Passive`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target units in this Regiment of Renown while they are wholly within 9\" of the Harbinger of Decay in this Regiment of Renown.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Nauseating Convalescence - Once Per Turn`,\r\n        desc: `Effect: Heal (1) each unit in this Regiment of Renown.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: One-Eyed Grunnock': {\r\n    effects: [\r\n      {\r\n        name: `Hurled Body`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. If the roll is at least double the targets Health characteristic, 1 model in that unit is slain and you can pick a visible enemy unit within 12\" of this unit. Inflict an amount of mortal damage on that unit equal to the targets Health characteristic.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Titanic Boulderclub - Passive`,\r\n        desc: `Effect: If all of the attacks made with this units Titanic Boulderclub target the same enemy unit, for every 5 models in the target unit, add 2 to its Attacks characteristic for the rest of the phase.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Titanic Boulderclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shake the Earth - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+:  \r\n        Inflict an amount of mortal damage on the target equal to the roll. If the target is Infantry, double the amount of mortal damage inflicted.  \r\n        Subtract 1 from hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { IItemDescription, TItemDescriptions } from 'factions/factionTypes'\r\nimport { keyPicker, pickEffects } from 'factions/metatagger'\r\nimport Artifacts from './artifacts'\r\nimport Battalions from './battalions'\r\nimport BattleTactics from './battle_tactics'\r\nimport BattleTraits from './battle_traits'\r\nimport CommandTraits from './command_traits'\r\nimport EndlessSpells from './endless_spells'\r\nimport Flavors from './flavors'\r\nimport GrandStrategies from './grand_strategies'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { SYLVANETH, TZEENTCH } from 'meta/factions'\r\n\r\n\r\nconst baseSubFaction = {\r\n  /* mandatory: {\r\n     spells: [keyPicker(Spells, ['Verdant Blessing'])],\r\n   }, */\r\n   available: {\r\n     artifacts: [Artifacts],\r\n     battalions: [Battalions],\r\n     battle_tactics: [BattleTactics],\r\n    //command_abilities: [CommandAbilities],\r\n     command_traits: [CommandTraits],\r\n     endless_spells: [EndlessSpells],\r\n     flavors: [Flavors],\r\n     grand_strategies: [GrandStrategies],\r\n   //  monstrous_rampages: [MonstrousRampages],\r\n    // scenery: [Scenery],\r\n     spells: [Spells],\r\n     units: [Units],\r\n   },\r\n   effects: [],\r\n } satisfies IItemDescription\r\n\r\nconst subFactions = {\r\n  [TZEENTCH]: {\r\n    effects: pickEffects(BattleTraits, [TZEENTCH]),\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      battalions: [Battalions],\r\n      battle_tactics: [BattleTactics],\r\n      command_traits: [CommandTraits],\r\n      spells: [Spells],\r\n      endless_spells: [EndlessSpells],\r\n      units: [\r\n        Units,\r\n       /* keyOmitter(SlavesToDarknessUnits, [\r\n          'Theddra Skull-Scryer',\r\n          'Godsworn Hunt',\r\n          'Darkoath Warqueen',\r\n          'Darkoath Chieftain',\r\n          'Furies',\r\n          'Raptoryx',\r\n          'Splintered Fang',\r\n          'Corvus Cabal',\r\n          'The Unmade',\r\n          'Cypher Lords',\r\n          'Iron Golems',\r\n          'Untamed Beasts',\r\n          'Spire Tyrants',\r\n          'Scions of the Flame',\r\n          \"Be'Lakor\",\r\n          'Mutalith Vortex Beast',\r\n          'Fomoroid Crusher',\r\n          'Mindstealer Sphiranx',\r\n        ]), \r\n        keyPicker(BeastsOfChaosUnits, [\r\n          'Beastlord',\r\n          'Bestigors',\r\n          'Bullgors',\r\n          'Centigors',\r\n          'Cygor',\r\n          'Doombull',\r\n          'Dragon Ogor Shaggoth',\r\n          'Dragon Ogors',\r\n          'Ghorgon',\r\n          'Gors',\r\n          'Great Bray-Shaman',\r\n          'Tuskgor Chariots',\r\n          'Ungor Raiders',\r\n          'Ungors',\r\n        ]), */\r\n      ],\r\n      flavors: [Flavors],\r\n      grand_strategies: [GrandStrategies],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { CHAOS } from 'meta/alliances'\r\nimport { TZEENTCH } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport rule_sources from './rule_sources'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const TzeentchFaction = new Faction(\r\n  TZEENTCH,\r\n  CHAOS,\r\n  SubFactions,\r\n  'Battle Formations',\r\n  rule_sources.BATTLETOME_TZEENTCH,\r\n// pickEffects(battle_traits, ['Allegiance Abilities'])\r\n)\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { BATTLESHOCK_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, START_OF_MOVEMENT_PHASE } from 'types/phases'\r\n\r\nconst BattleTraits = {\r\n  Wanderers: {\r\n    effects: [\r\n      {\r\n        name: `Defiant Hunters`,\r\n        desc: `You can reroll battleshock tests for friendly WANDERERS units.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n      {\r\n        name: `Realm Wanderers`,\r\n        desc: `At the start of your movement phase, 1 friendly WANDERERS unit wholly within 6\" of the edge of the battlefield can leave to travel along a hidden pathway instead of making a normal move. If they do so, remove that unit from the battlefield. Then set that unit up on the battlefield, anywhere wholly within 6\" of the edge of the battlefield by which it left, and more than 9\" from any enemy units.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Navigate Realmroots`,\r\n        desc: `Friendly WANDERERS units can retreat and still shoot later in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(BattleTraits, 'battle_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE, START_OF_COMBAT_PHASE } from 'types/phases'\r\n\r\nconst Artifacts = {\r\n  'Falcon of Holthaven': {\r\n    effects: [\r\n      {\r\n        name: `Falcon of Holthaven`,\r\n        desc: `Roll a D6 each time an enemy unit ends a normal move within 12\" of the bearer. On a 4+ that unit suffers 1 mortal wound.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Starcaster Longbow': {\r\n    effects: [\r\n      {\r\n        name: `Starcaster Longbow`,\r\n        desc: `In your shooting phase, you can pick an enemy unit within 20\" of the bearer and roll a D6. On a 2-5 that unit suffers 1 mortal wound; on a 6+ that unit suffers D3 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Splinterbirch Blade': {\r\n    effects: [\r\n      {\r\n        name: `Splinterbirch Blade`,\r\n        desc: `Improve the Rend characteristic of this weapon by 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wending Wand': {\r\n    effects: [\r\n      {\r\n        name: `Wending Wand`,\r\n        desc: `Once per battle, a unit returning to the battlefield after using the Realm Wanderers battle trait can be set up wholly within 18\" of the bearer, wholly within 6\" of any edge of the battlefield, not just the one it left by, and more than 9\" from any enemy models. This counts as that unit's move for that movement phase.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Viridescent Shawl': {\r\n    effects: [\r\n      {\r\n        name: `Viridescent Shawl`,\r\n        desc: `Add 1 to casting rolls for friendly WANDERER WIZARDS within 9\" of the bearer.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Viridescent Shawl`,\r\n        desc: `Subtract 1 from hit rolls for missile weapons that target the bearer.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Forget-me-knot': {\r\n    effects: [\r\n      {\r\n        name: `Forget-me-knot`,\r\n        desc: `Once per battle, at the start of the combat phase, pick an enemy HERO within 3\" of the bearer. That HERO cannot fight or use abilities in that combat phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Artifacts, 'artifact')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst CommandAbilities = {\r\n  'Lord of the Deepwood Host': {\r\n    effects: [\r\n      {\r\n        name: `Lord of the Deepwood Host`,\r\n        desc: `If a Nomad Prince uses this ability, then until your next hero phase you can reroll all hit rolls of 1 for Wanderer units from your army that are within 8\" of him when they attack.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Bravest of the Brave': {\r\n    effects: [\r\n      {\r\n        name: `Bravest of the Brave`,\r\n        desc: `If a Wayfinder uses this ability, then until your next hero phase, Wanderers from your army that are within 18\" of him in the battleshock phase may use his Bravery instead of their own. In addition, if you roll a 1 for any of these units' battleshock tests, that unit can immediately shoot as if it were the shooting phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Boldest of the Bold': {\r\n    effects: [\r\n      {\r\n        name: `Boldest of the Bold`,\r\n        desc: `If a Waystrider uses this ability, then until your next hero phase, Wanderers from your army that are within 18\" of him in the battleshock phase may use his Bravery instead of their own. In addition, if you roll a 1 for any of these units' battleshock tests, that unit can immediately pile in and attack as if it were the combat phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'See, But Do Not Be Seen': {\r\n    effects: [\r\n      {\r\n        name: `See, But Do Not Be Seen`,\r\n        desc: `If a Waywatcher uses this ability, then until your next hero phase, Wanderers from your army that are within 18\" of him gain the Invisible Hunter ability (see left).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandAbilities, 'command_ability')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { COMBAT_PHASE, HERO_PHASE, MOVEMENT_PHASE, SHOOTING_PHASE } from 'types/phases'\r\nconst CommandTraits = {\r\n  'Stalker of the Hidden Paths': {\r\n    effects: [\r\n      {\r\n        name: `Stalker of the Hidden Paths`,\r\n        desc: `If a friendly WANDERER unit wholly within 12\" of this general leaves the battlefield using the Realm Wanderers battle trait instead of making a normal move, it can be set up on the battlefield wholly within 6\" of any edge of the battlefield, not just the one it left by, and more than 9\" from any enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Myst Walker': {\r\n    effects: [\r\n      {\r\n        name: `Myst Walker`,\r\n        desc: `Enemy units can only attack this general if it is the closest enemy model.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Masterful Hunter': {\r\n    effects: [\r\n      {\r\n        name: `Masterful Hunter`,\r\n        desc: `Add 1 to hit rolls for attacks made with missile weapons by this general. If this general does not have a missile weapon, they receive a Hunting Hawk instead, and can use the Hawk's Beak missile weapon from the Nomad Prince warscroll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eagle-eyed': {\r\n    effects: [\r\n      {\r\n        name: `Eagle-eyed`,\r\n        desc: `You can reroll hit rolls of 1 for attacks made with melee weapons by this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord of Blades': {\r\n    effects: [\r\n      {\r\n        name: `Lord of Blades`,\r\n        desc: `You can reroll hit rolls of 1 for attacks made with melee weapons by this general.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Singer of Spells': {\r\n    effects: [\r\n      {\r\n        name: `Singer of Spells`,\r\n        desc: `Add 1 to casting, unbinding and dispelling rolls for this general. If this general is not a WIZARD, they gain the WIZARD keyword, and can attempt to unbind one spell in the enemy hero phase, and dispel one endless spell in your hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(CommandTraits, 'command_trait')\r\n","import { TItemDescriptions } from 'factions/factionTypes'\r\nimport { tagAs } from 'factions/metatagger'\r\nimport { HERO_PHASE } from 'types/phases'\r\n\r\nconst Spells = {\r\n  'Blessing of Life': {\r\n    effects: [\r\n      {\r\n        name: `Blessing of Life`,\r\n        desc: `Casting value of 5. Select a Wanderers unit within 16\". You can return D3 slain models to that unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Armour of Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Armour of Thorns`,\r\n        desc: `7+ casting value. Pick 1 friendly WANDERERS unit wholly within 18\" of the caster that is visible to them. Until that unit moves, that unit is treated as being in cover. In addition, until that unit moves, if the unmodified save roll for an attack made with a melee weapon that targets that unit is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Spells, 'spell')\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  END_OF_SETUP,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n} from 'types/phases'\r\nimport CommandAbilities from './command_abilities'\r\nimport Spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst HornblowerEffect = {\r\n  name: `Hornblower`,\r\n  desc: `You can reroll the dice when determining how far this unit can run if it includes any Hornblowers.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst StandardBearerEffect = {\r\n  name: `Standard Bearer`,\r\n  desc: `If the unit includes any Standard Bearers, add 1 to the Bravery of its models. Add 2 their Bravery instead if the unit is in cover.`,\r\n  when: [BATTLESHOCK_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst Units = {\r\n  'Nomad Prince': {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Lord of the Deepwood Host'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Eye Thief`,\r\n        desc: `If an enemy model suffers any wounds from a Hunting Hawk's Beak and is not slain, the hawk has pecked out one of its eyes. For the rest of the battle, your opponent must subtract 1 from any hit roll made for the affected model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Deepwood Shield`,\r\n        desc: `You can reroll any failed save rolls for a Nomad Prince.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Spellweaver: {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Blessing of Life'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Ancient Blessings`,\r\n        desc: `Once per game, this model can call upon these blessings when attempting to unbind a spell. When it does so, that attempt is automatically successful.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Magic`,\r\n        desc: `A Spellweaver is a wizard. A Spellweaver can attempt to cast one spell in each of your own hero phases, and attempt to unbind one spell in each enemy hero phase. A Spellweaver knows the Arcane Bolt, Mystic Shield and Blessing of Life spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Wayfinder: {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Bravest of the Brave'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Hail of Doom Arrow`,\r\n        desc: `Once per game, a Wayfinder can fire its Hail of Doom Arrow during your shooting phase. When he does so he makes 3D6 attacks with his Greatbow that phase instead of 3.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Waystrider: {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['Boldest of the Bold'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Heartseeker Arrow`,\r\n        desc: `After set-up is complete, roll a D6 if the enemy general is visible to at least one Waystrider from your army; on a 5 or more that general suffers a mortal wound.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  Waywatcher: {\r\n    mandatory: {\r\n      command_abilities: [keyPicker(CommandAbilities, ['See, But Do Not Be Seen'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Invisible Hunter`,\r\n        desc: `Your opponent subtracts 1 from any hit rolls that target a model with this ability in the shooting phase.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Solitary Marksman`,\r\n        desc: `Add 1 to hit rolls made for a Waywatcher's shooting attacks if it did not move in its preceding movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hawk-eyed Archer`,\r\n        desc: `When a Waywatcher shoots his Waystalker Bow, he can choose to make either Fast Shots or Precise Shots (he cannot make Fast and Precise Shots in the same shooting phase): Fast Shots: A Waywatcher firing Fast Shots makes three extra attacks with his Waystalker Bow. In addition, each time you roll a hit roll of 6 or more for this model when making a Fast Shot, it can make one additional attack with its bow. Precise Shots: A Waywatcher firing Precise Shots inflicts double damage with its Waystalker Bow. In addition, each time you roll a wound roll of 6 or more for this model when making Precise Shots, that shot is resolved with a Rend of -2 instead of -1.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sisters of the Thorn': {\r\n    mandatory: {\r\n      spells: [keyPicker(Spells, ['Armour of Thorns'])],\r\n    },\r\n    effects: [\r\n      HornblowerEffect,\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Magic`,\r\n        desc: `This unit is a wizard while it has 2 or more models. It can attempt to cast 1 spell in your hero phases and attempt to unbind 1 spell in the enemy hero phase. It knows the Arcane Bolt, Mystic Shield and Armour of Thorns spells.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Handmaiden Of The Thorn`,\r\n        desc: `The leader of this unit is the Handmaiden of the Thorn. A Handmaiden of the Thorn makes 2 attacks with her Deepwood Coven Staff rather than 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Sisters of the Watch': {\r\n    effects: [\r\n      {\r\n        name: `High Sister`,\r\n        desc: `The leader of this unit is a High Sister. A High Sister makes 2 attacks rather than 1 with her Watch Bow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Eldritch Arrowsr`,\r\n        desc: `You can add 1 to any wound roll made when a Sister of the Watch targets a Chaos unit with her Watch Bow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Quicksilver Shot`,\r\n        desc: `A unit of Sisters of the Watch can attack twice in their shooting phase if they did not move in their movement phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Loose Until the Last`,\r\n        desc: `Once per turn, if an enemy unit ends its charge move within 1/2\" of this unit, the Sisters of the Watch can immediately shoot their Watch Bows against the charging unit.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Glade Guard': {\r\n    effects: [\r\n      HornblowerEffect,\r\n      {\r\n        name: `Peerless Archery`,\r\n        desc: `You can add 1 to all hit rolls made for a unit of Glade Guard in the Shooting phase if it has 20 or more models and there are no enemy models within 3\".`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Bodkins`,\r\n        desc: `Once per game, this unit can fire enchanted arrows called arcane bodkins in your shooting phase instead of their normal arrows. If they do, the Rend of their Longbows is -3 until the end of that phase.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Lord's Bowman`,\r\n        desc: `The leader of this unit is the Lord's Bowman. A Lord's Bowman makes 2 attacks rather than 1 with his Longbow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Pennant Bearer`,\r\n        desc: `If the unit includes any Pennant Bearers, add 1 to the Bravery of its models. Add 2 their Bravery instead if the unit is in cover.`,\r\n        when: [BATTLESHOCK_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Eternal Guard': {\r\n    effects: [\r\n      HornblowerEffect,\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Fortress of Boughs`,\r\n        desc: `In your hero phase, this unit can form a fortress of boughs. If it does so, it cannot move until your next hero phase, but until then you can add 1 to all hit rolls, wound rolls and save rolls made for models in this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Glade Shields`,\r\n        desc: `You can reroll failed save rolls of 1 for a unit with Glade Shields. You can reroll failed save rolls of 1 or 2 instead if a unit with Glade Shields is in cover.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Eternal Warden`,\r\n        desc: `The leader of this unit is the Eternal Warden. An Eternal Warden makes 2 attacks rather than 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wild Riders': {\r\n    effects: [\r\n      HornblowerEffect,\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Wild Hunter`,\r\n        desc: `The leader of this unit is a Wild Hunter. A Wild Hunter makes 3 attacks rather than 2 with his Hunting Spear.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Unbound Fury`,\r\n        desc: `Wild Riders can run and charge in the same turn. You can add 1 to any wound roll made for a Wild Rider's Hunting Spear if it charged during the same turn.`,\r\n        when: [DURING_GAME, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Wildwood Rangers': {\r\n    effects: [\r\n      HornblowerEffect,\r\n      StandardBearerEffect,\r\n      {\r\n        name: `Guardians of the Kindreds`,\r\n        desc: `Rangers' Draichs inflict D3 Damage on MONSTERS instead of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Wildwood Warden`,\r\n        desc: `The leader of this unit is a Wildwood Warden. A Wildwood Warden makes 3 attacks rather than 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { WANDERERS } from 'meta/factions'\r\nimport Artifacts from './artifacts'\r\nimport CommandAbilities from './command_abilities'\r\nimport CommandTraits from './command_traits'\r\nimport Spells from './spells'\r\nimport Units from './units'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\n\r\nconst subFactions = {\r\n  [WANDERERS]: {\r\n    effects: [],\r\n\r\n    available: {\r\n      artifacts: [Artifacts],\r\n      command_abilities: [CommandAbilities],\r\n      command_traits: [CommandTraits],\r\n      spells: [Spells],\r\n      units: [Units],\r\n    },\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default subFactions\r\n","import { Faction } from 'factions/factionClass'\r\nimport { pickEffects } from 'factions/metatagger'\r\nimport { ORDER } from 'meta/alliances'\r\nimport { WANDERERS } from 'meta/factions'\r\nimport battle_traits from './battle_traits'\r\nimport SubFactions from './subfactions'\r\n\r\nexport const WanderersFaction = new Faction(\r\n  WANDERERS,\r\n  ORDER,\r\n  SubFactions,\r\n  undefined,\r\n  undefined,\r\n  pickEffects(battle_traits, ['Wanderers'])\r\n)\r\n","import { BeastOfChaosFaction } from 'factions/beasts_of_chaos'\r\nimport { CitiesOfSigmarFaction } from 'factions/cities_of_sigmar'\r\nimport { DaughtersOfKhaineFaction } from 'factions/daughters_of_khaine'\r\nimport { DispossessedFaction } from 'factions/dispossessed'\r\nimport { FleshEaterCourtsFaction } from 'factions/flesh_eater_courts'\r\nimport { FyreslayersFaction } from 'factions/fyreslayers'\r\nimport { GloomspiteGitzFaction } from 'factions/gloomspite_gitz'\r\nimport { ChaosFaction, DeathFaction, DestructionFaction, OrderFaction } from 'factions/grand_alliances'\r\nimport { GreenskinzFaction } from 'factions/greenskinz'\r\nimport { IdonethDeepkinFaction } from 'factions/idoneth_deepkin'\r\nimport { KharadronOverlordsFaction } from 'factions/kharadron_overlords'\r\nimport { KhorneFaction } from 'factions/khorne'\r\nimport { LegionsOfNagashFaction } from 'factions/legions_of_nagash'\r\nimport { LegionOfAzgorhFaction } from 'factions/legion_of_azgorh'\r\nimport { LegionOfGriefFaction } from 'factions/legion_of_grief'\r\nimport { LegionOfTheFirstPrinceFaction } from 'factions/legion_of_the_first_prince'\r\nimport { LethisianDefendersFaction } from 'factions/lethisian_defenders'\r\nimport { LuminethRealmlordsFaction } from 'factions/lumineth_realmlords'\r\nimport { MegaGargantMercenariesFaction } from 'factions/mega_gargant_mercenaries'\r\nimport { MercenaryCompaniesFaction } from 'factions/mercenary_companies'\r\nimport { NighthauntFaction } from 'factions/nighthaunt'\r\nimport { NurgleFaction } from 'factions/nurgle'\r\nimport { OgorMawtribesFaction } from 'factions/ogor_mawtribes'\r\nimport { OrrukWarclansFaction } from 'factions/orruk_warclans'\r\nimport { OssiarchBonereapersFaction } from 'factions/ossiarch_bonereapers'\r\nimport { SeraphonFaction } from 'factions/seraphon'\r\nimport { SkavenFaction } from 'factions/skaven'\r\nimport { SlaaneshFaction } from 'factions/slaanesh'\r\nimport { SlavesToDarknessFaction } from 'factions/slaves_to_darkness'\r\nimport { SonsOfBehematFaction } from 'factions/sons_of_behemat'\r\nimport { SoulblightGravelordsFaction } from 'factions/soulblight_gravelords'\r\nimport { StormcastFaction } from 'factions/stormcast_eternals'\r\nimport { SylvanethFaction } from 'factions/sylvaneth'\r\nimport { TombKingsFaction } from 'factions/tomb_kings'\r\nimport { TzeentchFaction } from 'factions/tzeentch'\r\nimport { WanderersFaction } from 'factions/wanderers'\r\nimport {\r\n  BEASTS_OF_CHAOS,\r\n // JS CHAOS_GRAND_ALLIANCE,\r\n  CITIES_OF_SIGMAR,\r\n  DAUGHTERS_OF_KHAINE,\r\n  DEATH_GRAND_ALLIANCE,\r\n  DESTRUCTION_GRAND_ALLIANCE,\r\n  DISPOSSESSED,\r\n  FLESH_EATER_COURTS,\r\n  FYRESLAYERS,\r\n  GLOOMSPITE_GITZ,\r\n  GREENSKINZ,\r\n  IDONETH_DEEPKIN,\r\n  KHARADRON_OVERLORDS,\r\n  KHORNE,\r\n  LEGIONS_OF_NAGASH,\r\n  LEGION_OF_AZGORH,\r\n  LEGION_OF_GRIEF,\r\n  LEGION_OF_THE_FIRST_PRINCE,\r\n  LETHISIAN_DEFENDERS,\r\n  LUMINETH_REALMLORDS,\r\n  MEGA_GARGANT_MERCENARIES,\r\n  MERCENARY_COMPANIES,\r\n  NIGHTHAUNT,\r\n  NURGLE,\r\n  OGOR_MAWTRIBES,\r\n  ORDER_GRAND_ALLIANCE,\r\n  ORRUK_WARCLANS,\r\n  OSSIARCH_BONEREAPERS,\r\n  SERAPHON,\r\n  SKAVEN,\r\n  SLAANESH,\r\n  SLAVES_TO_DARKNESS,\r\n  SONS_OF_BEHEMAT,\r\n  SOULBLIGHT_GRAVELORDS,\r\n  STORMCAST_ETERNALS,\r\n  SYLVANETH,\r\n  TOMB_KINGS,\r\n  TSupportedFaction,\r\n  TZEENTCH,\r\n  WANDERERS,\r\n} from 'meta/factions'\r\nimport { logInvalidFactionLookup } from 'utils/analytics'\r\n\r\n// Enable as you add them to /factions/\r\nconst FactionList = {\r\n  [BEASTS_OF_CHAOS]: { ...BeastOfChaosFaction },\r\n  // JS [CHAOS_GRAND_ALLIANCE]: { ...ChaosFaction },\r\n  [CITIES_OF_SIGMAR]: { ...CitiesOfSigmarFaction },\r\n  [DAUGHTERS_OF_KHAINE]: { ...DaughtersOfKhaineFaction },\r\n  [DEATH_GRAND_ALLIANCE]: { ...DeathFaction },\r\n  [DESTRUCTION_GRAND_ALLIANCE]: { ...DestructionFaction },\r\n  [DISPOSSESSED]: { ...DispossessedFaction },\r\n  [FLESH_EATER_COURTS]: { ...FleshEaterCourtsFaction },\r\n  [FYRESLAYERS]: { ...FyreslayersFaction },\r\n  [GLOOMSPITE_GITZ]: { ...GloomspiteGitzFaction },\r\n  [GREENSKINZ]: { ...GreenskinzFaction },\r\n  [IDONETH_DEEPKIN]: { ...IdonethDeepkinFaction },\r\n  [KHARADRON_OVERLORDS]: { ...KharadronOverlordsFaction },\r\n  [KHORNE]: { ...KhorneFaction },\r\n  [LEGION_OF_AZGORH]: { ...LegionOfAzgorhFaction },\r\n  [LEGION_OF_GRIEF]: { ...LegionOfGriefFaction },\r\n  [LEGION_OF_THE_FIRST_PRINCE]: { ...LegionOfTheFirstPrinceFaction },\r\n  [LEGIONS_OF_NAGASH]: { ...LegionsOfNagashFaction },\r\n  [LETHISIAN_DEFENDERS]: { ...LethisianDefendersFaction },\r\n  [LUMINETH_REALMLORDS]: { ...LuminethRealmlordsFaction },\r\n  [MEGA_GARGANT_MERCENARIES]: { ...MegaGargantMercenariesFaction },\r\n  [MERCENARY_COMPANIES]: { ...MercenaryCompaniesFaction },\r\n  [NIGHTHAUNT]: { ...NighthauntFaction },\r\n  [NURGLE]: { ...NurgleFaction },\r\n  [OGOR_MAWTRIBES]: { ...OgorMawtribesFaction },\r\n  [ORDER_GRAND_ALLIANCE]: { ...OrderFaction },\r\n  [ORRUK_WARCLANS]: { ...OrrukWarclansFaction },\r\n  [OSSIARCH_BONEREAPERS]: { ...OssiarchBonereapersFaction },\r\n  [SERAPHON]: { ...SeraphonFaction },\r\n  [SKAVEN]: { ...SkavenFaction },\r\n  [SLAANESH]: { ...SlaaneshFaction },\r\n  [SLAVES_TO_DARKNESS]: { ...SlavesToDarknessFaction },\r\n  [SONS_OF_BEHEMAT]: { ...SonsOfBehematFaction },\r\n  [SOULBLIGHT_GRAVELORDS]: { ...SoulblightGravelordsFaction },\r\n  [STORMCAST_ETERNALS]: { ...StormcastFaction },\r\n  [SYLVANETH]: { ...SylvanethFaction },\r\n  [TOMB_KINGS]: { ...TombKingsFaction },\r\n  [TZEENTCH]: { ...TzeentchFaction },\r\n  [WANDERERS]: { ...WanderersFaction },\r\n}\r\n\r\nexport const getFactionList = () => FactionList\r\n\r\nexport const getFactionFromList = (factionName: TSupportedFaction) => {\r\n  const faction = FactionList[factionName]\r\n  if (!faction) {\r\n    logInvalidFactionLookup(factionName)\r\n    console.error(\r\n      `${factionName} is not supported! Contact the developer team for more information: https://github.com/daviseford/aos-reminders/issues/new/choose`\r\n    )\r\n  }\r\n  return faction\r\n}\r\n\r\n/**\r\n * The functions below are unused right now, but might be useful one day\r\n */\r\n\r\n// export const getSubFactionKeys = (factionName: TSupportedFaction) => FactionList[factionName].subFactionKeys\r\n\r\n// export const getAggregatedArmyList = () =>\r\n//   Object.entries(ArmyList).reduce((a, [k, v]) => {\r\n//     a[k] = v.AggregateArmy\r\n//     return a\r\n//   }, {} as Record<keyof typeof ArmyList, TInitialArmy>)\r\n\r\n// export const getSubFactionFromList = (factionName: TSupportedFaction, subFactionName: string) => {\r\n//   const subfaction = ArmyList[factionName].SubFactions[subFactionName]\r\n//   if (!subfaction) {\r\n//     throw new Error(`Invalid faction/subFaction combo: ${factionName}, ${subFactionName}`)\r\n//   }\r\n//   return subfaction\r\n// }\r\n","import {\r\n  CHAOS_GRAND_ALLIANCE,\r\n  DEATH_GRAND_ALLIANCE,\r\n  DESTRUCTION_GRAND_ALLIANCE,\r\n  ORDER_GRAND_ALLIANCE,\r\n} from 'meta/factions'\r\n\r\ntype TChaos = 'Chaos'\r\ntype TDeath = 'Death'\r\ntype TDestruction = 'Destruction'\r\ntype TOrder = 'Order'\r\nexport type TGrandAlliances = TChaos | TDeath | TDestruction | TOrder\r\n\r\nexport const CHAOS: TChaos = 'Chaos'\r\nexport const DEATH: TDeath = 'Death'\r\nexport const DESTRUCTION: TDestruction = 'Destruction'\r\nexport const ORDER: TOrder = 'Order'\r\n\r\nexport type TGrandAllianceFactions =\r\n  | 'CHAOS_GRAND_ALLIANCE'\r\n  | 'DEATH_GRAND_ALLIANCE'\r\n  | 'DESTRUCTION_GRAND_ALLIANCE'\r\n  | 'ORDER_GRAND_ALLIANCE'\r\n\r\nexport const GRAND_ALLIANCE_FACTIONS: TGrandAllianceFactions[] = [\r\n  CHAOS_GRAND_ALLIANCE,\r\n  DEATH_GRAND_ALLIANCE,\r\n  DESTRUCTION_GRAND_ALLIANCE,\r\n  ORDER_GRAND_ALLIANCE,\r\n]\r\n\r\ntype TMarkKhorne = 'Khorne'\r\ntype TMarkNurgle = 'Nurgle'\r\ntype TMarkSlaanesh = 'Slaanesh'\r\ntype TMarkTzeentch = 'Tzeentch'\r\ntype TMarkUndivided = 'Undivided'\r\n\r\nexport const MARK_KHORNE: TMarkKhorne = 'Khorne'\r\nexport const MARK_NURGLE: TMarkNurgle = 'Nurgle'\r\nexport const MARK_SLAANESH: TMarkSlaanesh = 'Slaanesh'\r\nexport const MARK_TZEENTCH: TMarkTzeentch = 'Tzeentch'\r\nexport const MARK_UNDIVIDED: TMarkUndivided = 'Undivided'\r\n","import { IReminder } from 'types/data'\r\nimport { hashCode } from 'utils/textUtils'\r\n\r\nexport const getVisibleReminders = (reminders: IReminder, hiddenReminders: string[]): IReminder => {\r\n  return Object.keys(reminders).reduce((a, when) => {\r\n    const actions = reminders[when].filter(action => {\r\n      return !hiddenReminders.some(hr => hr.includes(action.id))\r\n    })\r\n    if (actions.length > 0) a[when] = actions\r\n    return a\r\n  }, {} as IReminder)\r\n}\r\n\r\nexport const hashReminder = (phase: string, name: string, desc: string): string => {\r\n  const str = `${phase}_${name}_${desc}`.split(' ').join('_')\r\n  return `${phase}_${hashCode(str)}`\r\n}\r\n","import { TTurnAction } from 'types/data'\r\nimport * as Phases from 'types/phases'\r\n\r\nexport type TGameStructure = Record<Phases.TTurnWhen, TTurnAction[]>\r\n\r\nexport const Game: TGameStructure = {\r\n  // General actions\r\n  [Phases.START_OF_GAME]: [],\r\n  [Phases.START_OF_SETUP]: [],\r\n  [Phases.DURING_SETUP]: [],\r\n  [Phases.END_OF_SETUP]: [],\r\n  [Phases.DURING_GAME]: [],\r\n\r\n  // Artificial phases\r\n  [Phases.SAVES_PHASE]: [],\r\n  [Phases.WARDS_PHASE]: [],\r\n  [Phases.WOUND_ALLOCATION_PHASE]: [],\r\n\r\n  // Any Turn/Round Actions\r\n  [Phases.START_OF_ANY_PHASE]: [],\r\n  [Phases.DURING_ANY_PHASE]: [],\r\n  [Phases.END_OF_ANY_PHASE]: [],\r\n  [Phases.START_OF_TURN]: [],\r\n  [Phases.START_OF_ROUND]: [],\r\n  [Phases.DURING_TURN]: [],\r\n  [Phases.DURING_ROUND]: [],\r\n\r\n  // General Hero Phase\r\n  [Phases.START_OF_HERO_PHASE]: [],\r\n  [Phases.HERO_PHASE]: [],\r\n  [Phases.END_OF_HERO_PHASE]: [],\r\n  // General Movement Phase\r\n  [Phases.START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.MOVEMENT_PHASE]: [],\r\n  [Phases.END_OF_MOVEMENT_PHASE]: [],\r\n  // General Shooting Phase\r\n  [Phases.START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.SHOOTING_PHASE]: [],\r\n  [Phases.END_OF_SHOOTING_PHASE]: [],\r\n  // General Charging Phase\r\n  [Phases.START_OF_CHARGE_PHASE]: [],\r\n  [Phases.CHARGE_PHASE]: [],\r\n  [Phases.END_OF_CHARGE_PHASE]: [],\r\n  // General Combat Phase\r\n  [Phases.START_OF_COMBAT_PHASE]: [],\r\n  [Phases.COMBAT_PHASE]: [],\r\n  [Phases.END_OF_COMBAT_PHASE]: [],\r\n  // General Battleshock Phase\r\n  [Phases.START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.BATTLESHOCK_PHASE]: [],\r\n  [Phases.END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Any Turn/Round End\r\n  [Phases.END_OF_ROUND]: [],\r\n  [Phases.END_OF_TURN]: [],\r\n  // Game End\r\n  [Phases.END_OF_GAME]: [],\r\n\r\n  // Per-turn actions\r\n  [Phases.TURN_ONE_START_OF_TURN]: [],\r\n  [Phases.TURN_ONE_START_OF_ROUND]: [],\r\n  [Phases.TURN_ONE_DURING_TURN]: [],\r\n  [Phases.TURN_ONE_DURING_ROUND]: [],\r\n  // Hero\r\n  [Phases.TURN_ONE_START_OF_HERO_PHASE]: [],\r\n  [Phases.TURN_ONE_HERO_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_HERO_PHASE]: [],\r\n  // Movement\r\n  [Phases.TURN_ONE_START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_ONE_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_MOVEMENT_PHASE]: [],\r\n  // Shooting\r\n  [Phases.TURN_ONE_START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_ONE_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_SHOOTING_PHASE]: [],\r\n  // Charging\r\n  [Phases.TURN_ONE_START_OF_CHARGE_PHASE]: [],\r\n  [Phases.TURN_ONE_CHARGE_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_CHARGE_PHASE]: [],\r\n  // Combat\r\n  [Phases.TURN_ONE_START_OF_COMBAT_PHASE]: [],\r\n  [Phases.TURN_ONE_COMBAT_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_COMBAT_PHASE]: [],\r\n  // Battleshock\r\n  [Phases.TURN_ONE_START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_ONE_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_ONE_END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Turn End\r\n  [Phases.TURN_ONE_END_OF_TURN]: [],\r\n  [Phases.TURN_ONE_END_OF_ROUND]: [],\r\n\r\n  [Phases.TURN_TWO_START_OF_TURN]: [],\r\n  [Phases.TURN_TWO_START_OF_ROUND]: [],\r\n  [Phases.TURN_TWO_DURING_TURN]: [],\r\n  [Phases.TURN_TWO_DURING_ROUND]: [],\r\n  // Hero\r\n  [Phases.TURN_TWO_START_OF_HERO_PHASE]: [],\r\n  [Phases.TURN_TWO_HERO_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_HERO_PHASE]: [],\r\n  // Movement\r\n  [Phases.TURN_TWO_START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_TWO_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_MOVEMENT_PHASE]: [],\r\n  // Shooting\r\n  [Phases.TURN_TWO_START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_TWO_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_SHOOTING_PHASE]: [],\r\n  // Charging\r\n  [Phases.TURN_TWO_START_OF_CHARGE_PHASE]: [],\r\n  [Phases.TURN_TWO_CHARGE_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_CHARGE_PHASE]: [],\r\n  // Combat\r\n  [Phases.TURN_TWO_START_OF_COMBAT_PHASE]: [],\r\n  [Phases.TURN_TWO_COMBAT_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_COMBAT_PHASE]: [],\r\n  // Battleshock\r\n  [Phases.TURN_TWO_START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_TWO_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_TWO_END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Turn End\r\n  [Phases.TURN_TWO_END_OF_TURN]: [],\r\n  [Phases.TURN_TWO_END_OF_ROUND]: [],\r\n\r\n  [Phases.TURN_THREE_START_OF_TURN]: [],\r\n  [Phases.TURN_THREE_START_OF_ROUND]: [],\r\n  [Phases.TURN_THREE_DURING_TURN]: [],\r\n  [Phases.TURN_THREE_DURING_ROUND]: [],\r\n  // Hero\r\n  [Phases.TURN_THREE_START_OF_HERO_PHASE]: [],\r\n  [Phases.TURN_THREE_HERO_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_HERO_PHASE]: [],\r\n  // Movement\r\n  [Phases.TURN_THREE_START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_THREE_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_MOVEMENT_PHASE]: [],\r\n  // Shooting\r\n  [Phases.TURN_THREE_START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_THREE_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_SHOOTING_PHASE]: [],\r\n  // Charging\r\n  [Phases.TURN_THREE_START_OF_CHARGE_PHASE]: [],\r\n  [Phases.TURN_THREE_CHARGE_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_CHARGE_PHASE]: [],\r\n  // Combat\r\n  [Phases.TURN_THREE_START_OF_COMBAT_PHASE]: [],\r\n  [Phases.TURN_THREE_COMBAT_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_COMBAT_PHASE]: [],\r\n  // Battleshock\r\n  [Phases.TURN_THREE_START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_THREE_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_THREE_END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Turn End\r\n  [Phases.TURN_THREE_END_OF_TURN]: [],\r\n  [Phases.TURN_THREE_END_OF_ROUND]: [],\r\n\r\n  [Phases.TURN_FOUR_START_OF_TURN]: [],\r\n  [Phases.TURN_FOUR_START_OF_ROUND]: [],\r\n  [Phases.TURN_FOUR_DURING_TURN]: [],\r\n  [Phases.TURN_FOUR_DURING_ROUND]: [],\r\n  // Hero\r\n  [Phases.TURN_FOUR_START_OF_HERO_PHASE]: [],\r\n  [Phases.TURN_FOUR_HERO_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_HERO_PHASE]: [],\r\n  // Movement\r\n  [Phases.TURN_FOUR_START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_FOUR_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_MOVEMENT_PHASE]: [],\r\n  // Shooting\r\n  [Phases.TURN_FOUR_START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_FOUR_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_SHOOTING_PHASE]: [],\r\n  // Charging\r\n  [Phases.TURN_FOUR_START_OF_CHARGE_PHASE]: [],\r\n  [Phases.TURN_FOUR_CHARGE_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_CHARGE_PHASE]: [],\r\n  // Combat\r\n  [Phases.TURN_FOUR_START_OF_COMBAT_PHASE]: [],\r\n  [Phases.TURN_FOUR_COMBAT_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_COMBAT_PHASE]: [],\r\n  // Battleshock\r\n  [Phases.TURN_FOUR_START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_FOUR_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_FOUR_END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Turn End\r\n  [Phases.TURN_FOUR_END_OF_TURN]: [],\r\n  [Phases.TURN_FOUR_END_OF_ROUND]: [],\r\n\r\n  [Phases.TURN_FIVE_START_OF_TURN]: [],\r\n  [Phases.TURN_FIVE_START_OF_ROUND]: [],\r\n  [Phases.TURN_FIVE_DURING_TURN]: [],\r\n  [Phases.TURN_FIVE_DURING_ROUND]: [],\r\n  // Hero\r\n  [Phases.TURN_FIVE_START_OF_HERO_PHASE]: [],\r\n  [Phases.TURN_FIVE_HERO_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_HERO_PHASE]: [],\r\n  // Movement\r\n  [Phases.TURN_FIVE_START_OF_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_FIVE_MOVEMENT_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_MOVEMENT_PHASE]: [],\r\n  // Shooting\r\n  [Phases.TURN_FIVE_START_OF_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_FIVE_SHOOTING_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_SHOOTING_PHASE]: [],\r\n  // Charging\r\n  [Phases.TURN_FIVE_START_OF_CHARGE_PHASE]: [],\r\n  [Phases.TURN_FIVE_CHARGE_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_CHARGE_PHASE]: [],\r\n  // Combat\r\n  [Phases.TURN_FIVE_START_OF_COMBAT_PHASE]: [],\r\n  [Phases.TURN_FIVE_COMBAT_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_COMBAT_PHASE]: [],\r\n  // Battleshock\r\n  [Phases.TURN_FIVE_START_OF_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_FIVE_BATTLESHOCK_PHASE]: [],\r\n  [Phases.TURN_FIVE_END_OF_BATTLESHOCK_PHASE]: [],\r\n  // Turn End\r\n  [Phases.TURN_FIVE_END_OF_TURN]: [],\r\n  [Phases.TURN_FIVE_END_OF_ROUND]: [],\r\n}\r\n","import { uniq } from 'lodash'\r\nimport { TGrandAlliances } from 'meta/alliances'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport { TRuleSource } from 'meta/rule_sources'\r\nimport { TSubfactionArmy } from 'types/army'\r\nimport { SELECTION_TYPES, TEffects } from 'types/data'\r\nimport { TSelectionTypes } from 'types/selections'\r\nimport { TItemDescriptions, TItemKey } from './factionTypes'\r\nimport { getAggregateArmy, temporaryAdapter } from './temporaryAdapter'\r\n\r\n/**\r\n * This class is used to manage Factions\r\n */\r\nexport class Faction<\r\n  F extends TSupportedFaction,\r\n  G extends TGrandAlliances,\r\n  S extends TItemDescriptions,\r\n  K extends Extract<keyof S, string>,\r\n  RS extends TRuleSource,\r\n  BT extends TEffects[]\r\n> {\r\n  public readonly AggregateArmy: TSubfactionArmy\r\n  public readonly flavorKeys: string[] = []\r\n  public readonly subFactionKeys: string[]\r\n  public readonly subFactionKeyMap: Record<K, K>\r\n  public readonly subFactionArmies: Record<K, TSubfactionArmy>\r\n\r\n  constructor(\r\n    public readonly factionName: F,\r\n    public readonly GrandAlliance: G,\r\n    public readonly SubFactions: S,\r\n    public readonly flavorLabel = 'Flavors',\r\n    public readonly rule_source?: RS,\r\n    /**\r\n     * Battle traits that are shared for the whole faction\r\n     *  (useful when there are multiple subfactions\r\n     *  that have their own battle traits,\r\n     *  but share the parent factions battle traits as well,\r\n     *  e.g. Soulblight Gravelords)\r\n     */\r\n    public readonly factionBattleTraits?: BT,\r\n    public readonly isMercenary = false\r\n  ) {\r\n    this.AggregateArmy = getAggregateArmy(SubFactions, flavorLabel)\r\n\r\n    this.flavorKeys = this.AggregateArmy.Flavors.map(x => x.name)\r\n\r\n    this.subFactionKeys = Object.keys(SubFactions) as K[]\r\n\r\n    this.subFactionKeyMap = this.subFactionKeys.reduce((a, k) => {\r\n      a[k] = k\r\n      return a\r\n    }, {} as Record<K, K>)\r\n\r\n    this.subFactionArmies = this.subFactionKeys.reduce((a, subFactionName) => {\r\n      a[subFactionName] = temporaryAdapter(this.SubFactions[subFactionName], subFactionName, this.flavorLabel)\r\n      return a\r\n    }, {} as Record<K, TSubfactionArmy>)\r\n\r\n    this.checkForDataEntryErrors()\r\n  }\r\n\r\n  /** Throw an error if we've got bad data (this will discover bad data entry) */\r\n  private checkForDataEntryErrors = () => {\r\n    const validSelectionKeys: TItemKey[] = [...SELECTION_TYPES, 'allied_units']\r\n\r\n    this.subFactionKeys.forEach(k => {\r\n      const allKeys = uniq([\r\n        ...Object.keys(this.SubFactions[k]?.available ?? {}),\r\n        ...Object.keys(this.SubFactions[k]?.mandatory ?? {}),\r\n      ]) as TSelectionTypes[]\r\n\r\n      allKeys.forEach(selection => {\r\n        if (!validSelectionKeys.includes(selection)) {\r\n          throw new Error(\r\n            `${this.factionName} subfaction ${k} has an invalid/unknown key: ${selection}. Please check your data in this faction's subfactions.ts file`\r\n          )\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\n// export type TGenericFaction = Faction<\r\n//   TSupportedFaction,\r\n//   TGrandAlliances,\r\n//   TItemDescriptions,\r\n//   string,\r\n//   TRuleSource,\r\n//   TEffects[]\r\n// >\r\n","import request from 'superagent'\r\nimport { TThemeType } from 'types/theme'\r\nimport { isDev, SUBSCRIPTION_AUTH_KEY } from 'utils/env'\r\n\r\nconst devEndpoint = `https://pitljgzx18.execute-api.us-east-1.amazonaws.com/dev`\r\nconst prodEndpoint = `https://kd0sjpg6oe.execute-api.us-east-1.amazonaws.com/prod`\r\n\r\nconst api = isDev ? devEndpoint : prodEndpoint\r\n\r\ninterface ICancel {\r\n  userName: string\r\n  subscriptionId: string\r\n}\r\n\r\ninterface IUpdateTheme {\r\n  id: string\r\n  userName: string\r\n  theme: TThemeType\r\n}\r\n\r\ninterface IRedeemCoupon {\r\n  couponId: string\r\n  userName: string // userName receiving the gift\r\n}\r\n\r\ninterface IRedeemGift {\r\n  giftId: string\r\n  userId: string // userId of the referrer\r\n  userName: string // userName receiving the gift\r\n}\r\n\r\nconst withAuth = (data: Record<string, any>) => ({ ...data, authKey: SUBSCRIPTION_AUTH_KEY })\r\n\r\nconst cancelSubscription = (data: ICancel) => request.post(`${api}/cancel`).send(withAuth(data))\r\nconst getSubscription = (userName: string) => request.get(`${api}/user/${userName}`)\r\nconst redeemCoupon = (data: IRedeemCoupon) => request.post(`${api}/redeem_coupon`).send(withAuth(data))\r\nconst redeemGift = (data: IRedeemGift) => request.post(`${api}/redeem`).send(withAuth(data))\r\nconst requestGrant = (userName: string) => request.post(`${api}/paypal_grant`).send(withAuth({ userName }))\r\nconst updateTheme = (data: IUpdateTheme) => request.post(`${api}/theme`).send(withAuth(data))\r\n\r\nexport const SubscriptionApi = {\r\n  cancelSubscription,\r\n  getSubscription,\r\n  redeemCoupon,\r\n  redeemGift,\r\n  requestGrant,\r\n  updateTheme,\r\n}\r\n","import { keyPicker, tagAs } from 'factions/metatagger'\r\nimport { GenericEffects } from 'generic_rules'\r\nimport meta_rule_sources from 'meta/rule_sources'\r\nimport {\r\n  BATTLESHOCK_PHASE,\r\n  CHARGE_PHASE,\r\n  COMBAT_PHASE,\r\n  DURING_GAME,\r\n  DURING_SETUP,\r\n  END_OF_ANY_PHASE,\r\n  END_OF_CHARGE_PHASE,\r\n  END_OF_COMBAT_PHASE,\r\n  END_OF_HERO_PHASE,\r\n  END_OF_MOVEMENT_PHASE,\r\n  END_OF_SETUP,\r\n  END_OF_TURN,\r\n  HERO_PHASE,\r\n  MOVEMENT_PHASE,\r\n  SAVES_PHASE,\r\n  SHOOTING_PHASE,\r\n  START_OF_BATTLESHOCK_PHASE,\r\n  START_OF_CHARGE_PHASE,\r\n  START_OF_COMBAT_PHASE,\r\n  START_OF_HERO_PHASE,\r\n  START_OF_MOVEMENT_PHASE,\r\n  START_OF_SHOOTING_PHASE,\r\n  TURN_ONE_START_OF_ROUND,\r\n  WARDS_PHASE,\r\n  WOUND_ALLOCATION_PHASE,\r\n} from 'types/phases'\r\nimport prayers from './prayers'\r\nimport rule_sources from './rule_sources'\r\nimport spells from './spells'\r\nimport { TItemDescriptions } from 'factions/factionTypes'\r\nimport { PassThrough } from 'stream'\r\n\r\n/*const InescapableVengeanceEffect = {\r\n  name: `Inescapable Vengeance`,\r\n  desc: `If the unmodified hit roll for an attack made with a melee weapon by this unit is 6, the target suffers 2 mortal wounds and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst BlastToAshesEffect = {\r\n  name: `Blast to Ashes`,\r\n  desc: `If the unmodified hit roll for an attack made with a Lightning Hammer is 6, the target suffers 2 mortal wounds and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CelestialBlastEffect = {\r\n  name: `Celestial Blast`,\r\n  desc: `If the unmodified hit roll for an attack made with a Skybolt Bow is 6, the target suffers 1 mortal wound and the attack sequence ends (do not make a wound or save roll).`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst EvocatorChampionEffect = {\r\n  name: `Champion`,\r\n  desc: `1 model in this unit can be an Evocator-Prime. Add 1 to the Attacks characteristic of that model's Tempest Blade and Stormstave or Grandstave.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst ArcaneHeritageEffect = {\r\n  name: `Arcane Heritage`,\r\n  desc: `Each time this unit is affected by a spell or the abilities of an endless spell, you can roll a dice. On a 4+, ignore the effect of that spell or the effects of that endless spell's abilities on this unit.`,\r\n  when: [HERO_PHASE, END_OF_HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst DraconicFlamestreamEffect = {\r\n  name: `Draconic Flamestream`,\r\n  desc: `Do not use the attack sequence for an attack made with a Draconic Flamestream. Instead, roll a dice. On a 1-2, nothing happens. On a 3-4, the target suffers D3 mortal wounds. On a 5-6, the target suffers D6 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst DraggedIntoTheTempestEffect = {\r\n  name: `Dragged into the Tempest`,\r\n  desc: `In the combat phase, after all of this unit's attacks have been resolved, you can pick 1 enemy unit within 1\" of this unit and roll a dice. If the roll is greater than that unit's Wounds characteristic, your opponent must pick 1 model in that unit. That model is slain.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst DispersedFormationEffect = {\r\n  name: `Dispersed Formation`,\r\n  desc: `If this unit has 2 to 5 models, it is coherent if each model in the unit is within 3\" horizontally of at least 1 other model in the unit instead of 1\". If this unit has more than 5 models, it is coherent if each model in the unit is within 3\" horizontally of at least 2 other models in the unit instead of 1\".`,\r\n  when: [DURING_GAME],\r\n  shared: true,\r\n}\r\nconst ImpalingStrikesEffect = {\r\n  name: `Impaling Strikes`,\r\n  desc: `This unit's Stormstrike Glaive has a Damage characteristic of 3 instead of 1 if this unit made a charge move in the same turn.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst CleavingBlowEffect = {\r\n  name: `Cleaving Blow`,\r\n  desc: `Add 2 to the Attacks characteristic of a Thunderaxe if the number of models in the target unit is greater than the number of models in this unit.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst AncientMasterOfWarEffect = {\r\n  name: `Ancient Master of War`,\r\n  desc: `Subtract 1 from the Attacks characteristic of melee weapons that target this unit (to a minimum of 1).`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst BlazingTempestEffect = {\r\n  name: `Blazing Tempest`,\r\n  desc: `Do not use the attack sequence for an attack made with a Blazing Tempest. Instead, roll a dice. On a 1-2, the target suffers 1 mortal wound. On a 3-4, the target suffers D3 mortal wounds. On a 5-6, the target suffers D6 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst CalamitousTailEffect = {\r\n  name: `Calamitous Tail`,\r\n  desc: `The Attacks characteristic of a Calamitous Tail is equal to the number of enemy models within 3\" of the attacking model.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst VoidstormScrollEffect = {\r\n  name: `Voidstorm Scroll`,\r\n  desc: `Once per battle, in the enemy hero phase, when this unit attempts to unbind a spell, you can say that it is using its voidstorm scroll. If you do so, that spell is automatically unbound (do not make an unbinding roll).`,\r\n  when: [HERO_PHASE],\r\n  shared: true,\r\n}\r\nconst SoulChargedIconEffect = {\r\n  name: `Soul-Charged Icon`,\r\n  desc: `You can reroll charge rolls for friendly STORMCAST ETERNALS units wholly within 12\" of this unit.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst SigmariteThundershieldEffect = {\r\n  name: `Sigmarite Thundershield`,\r\n  desc: `If the unmodified save roll for an attack made with a melee weapon that targets this unit is 6, the attacking unit suffers 1 mortal wound after all of its attacks have been resolved.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst CometTrailEffect = {\r\n  name: `Comet Trail`,\r\n  desc: `After this unit has made a normal move, add 1 to hit rolls for attacks made by friendly STORMCAST ETERNALS and Cities of Sigmar units within 3\" of this unit until your next hero phase.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst StormBlastEffect = {\r\n  name: `Stormblast`,\r\n  desc: `Do not use the attack sequence for an attack made with a Stormblast. Instead, roll a dice. On a 4+, the target suffers D3 mortal wounds.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst AstralCompassEffect = {\r\n  name: `Astral Compass`,\r\n  desc: `If this unit includes any models carrying Astral Compasses, at the start of your movement phase, instead of taking a normal move, you can say that this unit will navigate the winds aetheric. If you do so, remove this unit from the battlefield and set it up again on the battlefield wholly within 6\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n  when: [START_OF_MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst RideTheWindsAethericEffect = {\r\n  name: `Ride the Winds Aetheric`,\r\n  desc: `Instead of picking this unit to make a normal move or retreat, you can say that it will ride the winds aetheric. If you do so, remove this unit from the battlefield and set it up again on the battlefield more than 1\" from all terrain features and objectives and more than 9\" from all enemy units.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst CycleOfTheStormEffect = {\r\n  name: `Cycle of the Storm`,\r\n  desc: `Once per turn, before you allocate a wound or mortal wound to another friendly STORMCAST ETERNALS unit within 18\" of this unit, and that wound or mortal wound would cause a model in that unit to be slain, you can say that this unit will capture and return that warrior's soul. If you do so, that wound or mortal wound is negated.`,\r\n  when: [WOUND_ALLOCATION_PHASE],\r\n  rule_sources: [rule_sources.BATTLETOME_STORMCAST_ETERNALS, rule_sources.ERRATA_OCTOBER_2021],\r\n  shared: true,\r\n}\r\nconst SigmariteShieldEffect = {\r\n  name: `Sigmarite Shields`,\r\n  desc: `Add 1 to save rolls for attacks that target this unit if at least half of the models in this unit (rounding down) are armed with Sigmarite Shields.`,\r\n  when: [SAVES_PHASE],\r\n  shared: true,\r\n}\r\nconst CelestialLightningArcEffect = {\r\n  name: `Celestial Lightning Arc`,\r\n  desc: `After this unit has fought for the first time in a phase and all of its attacks have been resolved, you can pick 1 enemy unit within 3\" of this unit. Roll 2 dice for each model in this unit. For each 4+, that enemy unit suffers 1 mortal wound.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\n\r\nconst IntolerableDamageEffect = {\r\n  name: `Intolerable Damage`,\r\n  desc: `If the unmodified wound roll for an attack made with a Dracoth's Claws and Fangs is 6, that attack has a Damage of D6 instead of 1.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst StarsoulMaceEffect = {\r\n  name: `Starsoul Mace`,\r\n  desc: `Do not use the attack sequence for an attack made with a Starsoul Mace. Instead, roll a dice. On a 2+, the target sufers D3 mortal wounds.`,\r\n  when: [COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst ThunderousPounceEffect = {\r\n  name: `Thunderous Pounce`,\r\n  desc: `You can reroll charge rolls for this unit.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst WindriderEffect = {\r\n  name: `Windrider`,\r\n  desc: `Instead of picking this unit to make a normal move or retreat, you can say that it will ride the winds aetheric. If you do so, remove this unit from the battlefield and set it up again on the battlefield more than 1\" from all terrain features and objectives and more than 9\" from all enemy units.`,\r\n  when: [MOVEMENT_PHASE],\r\n  shared: true,\r\n}\r\nconst TirelessHuntersEffect = {\r\n  name: `Tireless Hunters`,\r\n  desc: `This unit can run and still shoot in the same turn.`,\r\n  when: [SHOOTING_PHASE],\r\n  shared: true,\r\n}\r\nconst LayLowTheTyrantsEffect = {\r\n  name: `Lay Low the Tyrants`,\r\n  desc: `At the end of the combat phase, you can pick 1 enemy unit that is both within 1\" of this unit and within 6\" of an objective, and roll a dice. On a 4+, that unit suffers D3 mortal wounds.`,\r\n  when: [END_OF_COMBAT_PHASE],\r\n  shared: true,\r\n}\r\nconst HeraldsOfRighteousnessEffect = {\r\n  name: `Heralds of Righteousness`,\r\n  desc: `You can attempt a charge with this unit if it is within 18\" of an enemy unit instead of 12\". Roll 3D6 instead of 2D6 when making a charge roll for this unit.`,\r\n  when: [CHARGE_PHASE],\r\n  shared: true,\r\n}\r\nconst StardrakeBaseEffects = [\r\n  {\r\n    name: `Arcane Lineage`,\r\n    desc: `Add 1 to casting rolls for friendly Wizards within 18\" of this unit and subtract 1 from casting rolls for enemy Wizards within 18\" of this unit.`,\r\n    when: [HERO_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Cavernous Jaws`,\r\n    desc: `After this unit makes a pile-in move, you can say that this unit's Stardrake will bite the enemy with its cavernous jaws. If you do so, pick a number of enemy models within 3\" of this unit equal to or less than the Cavernous Jaws value shown on this unit's damage table, and roll a dice for each. If the roll is greater than that model's Wounds characteristic, it is slain.`,\r\n    when: [COMBAT_PHASE],\r\n    shared: true,\r\n  },\r\n]\r\nconst AnnihilatorBaseEffects = [\r\n  {\r\n    name: `Blazing Impact`,\r\n    desc: `After this unit is set up on the battlefield for the first time, roll a dice for each enemy unit within 10\" of this unit. On a 3+, that unit suffers D3 mortal wounds. In addition, you can reroll charge rolls for this unit if it was set up on the battlefield in the same turn.`,\r\n    when: [DURING_SETUP, END_OF_MOVEMENT_PHASE],\r\n    shared: true,\r\n  },\r\n  {\r\n    name: `Force of a Falling Star`,\r\n    desc: `After this unit makes a charge move, you can pick 1 enemy unit within 1\" of this unit and roll a number of dice equal to the unmodified charge roll for that charge move. Subtract 1 from the roll if this unit only has 2 models. Subtract 2 from the roll if this unit only has 1 model. For each 4+, that enemy unit suffers 1 mortal wound.`,\r\n    when: [CHARGE_PHASE],\r\n    shared: true,\r\n  },\r\n] */\r\n\r\nconst Units = {\r\n  'Celestant-Prime': {\r\n    effects: [\r\n      {\r\n        name: `Cometstrike Sceptre - Passive`,\r\n        desc: `Effect: Each time this unit attacks with its Cometstrike Sceptre, if the attack scores a hit, inflict D3 mortal damage on the target.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Retribution from On High - Once Per Battle`,\r\n        desc: `Declare: Pick this unit if it is in the Celestial Realm. \r\n        Effect: Subtract the current battle round number from 10 to determine this units strike zone. Set up this unit on the battlefield more than a number of inches equal to its strike zone from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Aventis Firestrike': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Pyroelectric Blast'])],\r\n    }, \r\n    effects: [\r\n     // CometTrailEffect,\r\n    //  CycleOfTheStormEffect,\r\n      {\r\n        name: `Thunderhead Crown`,\r\n        desc: `In your hero phase, you can heal up to D3 wounds allocated to this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /*'Astreia Solbright': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Lightning Pulse'])],\r\n    },\r\n    effects: [\r\n     // CycleOfTheStormEffect,\r\n     // ThunderousPounceEffect,\r\n      {\r\n        name: `Soul Energy of the First Host`,\r\n        desc: `At the start of the combat phase, you can pick 1 friendly Hammers of Sigmar Sacrosanct unit wholly within 12\" of this unit. Add 1 to save rolls for attacks made with melee weapons that target that unit until the end of that phase.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Vandus Hammerhand': {\r\n    effects: [\r\n     // StormBlastEffect,\r\n      {\r\n        name: `Lord of the Hammerhands Passive`,\r\n        desc: `Effect: Add 3 to the control scores of friendly Warrior Chamber units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Vengeance Unleashed - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Warrior Chamber unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Neave Blacktalon': {\r\n    effects: [\r\n      {\r\n        name: `Justice from Azyr`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Whirlwind Axes for attacks that target Heroes.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Windrider`,\r\n        desc: `Declare: If this unit is in combat or charged this turn, this unit can make a pile-in move. Then, if this unit is in combat, you must pick 1 or more enemy units to be the target(s) of this units attacks. \r\n        Effect: Resolve combat attacks against the target unit(s). Then, roll a dice. On a 3+, remove this unit from the battlefield and set it up again on the battlefield more than 3\" from all enemy units and wholly within the combat range of a friendly The Blacktalons unit that is not in combat.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  \"Neave's Companions\": {\r\n    effects: [\r\n      GenericEffects.Elite,\r\n      {\r\n        name: `Shield of Azyr`,\r\n        desc: `Effect: While any friendly The Blacktalons Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  Lorai: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Nebulous Sea-fog'])],\r\n    }, */\r\n    effects: [\r\n      //GenericEffects.WizardOneSpellEffect,\r\n      {\r\n        name: `Aquatic Illusions`,\r\n        desc: `Effect: Subtract 1 from hit rolls for attacks that target this unit.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Nebulous Sea-Fog: Casting value of 6`,\r\n        desc: `Effect: Until the start of your next turn, while a friendly The Blacktalons unit is wholly within 6\" of this unit, if the unmodified hit roll for a shooting attack that targets that unit is 1-5, the attack fails and the attack sequence ends.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n/* 'Gavriel Sureheart': {\r\n    effects: [\r\n     // InescapableVengeanceEffect,\r\n      {\r\n        name: `Once More, For Sigmar, Charge!`,\r\n        desc: `You can reroll charge rolls for this unit. In addition, once per turn, this unit can issue the Forward to Victory command (core rules, 1 1.2) to a friendly Hammers of Sigmar unit without a command point being spent.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // SigmariteThundershieldEffect,\r\n    ],\r\n  }, */\r\n  'Karazai the Scarred': {\r\n    effects: [\r\n      //AncientMasterOfWarEffect,\r\n      //BlazingTempestEffect,\r\n      //CalamitousTailEffect,\r\n      {\r\n        name: `Fires of Retribution - Passive`,\r\n        desc: `Effect: While this unit has 5-9 damage points, add 1 to the Attacks characteristic of its melee weapons. While this unit has 10 or more damage points, add 2 to the Attacks characteristic of its melee weapons instead.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ancient Master of War`,\r\n        desc: `Declare: Pick an enemy unit within this units combat range to be the target. \r\n        Effect: Subtract 1 from the Attacks characteristic of the targets melee weapons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Calamitous Tail Sweep - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in the target unit. For each 5+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* \"Steelheart's Champions\": {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Severin Steelheart is the unit champion. If the target unit has 5 or more models, you can reroll failed hit rolls for attacks made with that model's Broadsword.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Heroic Guard`,\r\n        desc: `If an enemy unit finishes a charge move within 1/2\" of this unit, add 1 to save rolls for attacks that target this unit until the end of that turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // LayLowTheTyrantsEffect,\r\n    ],\r\n  },\r\n  'The Farstriders': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `Sanson Farstrider is the unit champion. Sanson Farstrider is accompanied by a Star Falcon and carries an Astral Compass. Add 1 to the Attacks characteristic of that model's Stormwrought Weapon.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Star Falcon`,\r\n        desc: `If this unit includes Sanson Farstrider, at the start of your shooting phase, you can pick 1 enemy unit within 18\" of this unit and roll a dice. On a 4+, that unit suffers 1 mortal wound.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Astral Compass`,\r\n        desc: `If this unit includes Sanson Farstrider, at the start of your movement phase, instead of making a normal move, you can say that this unit will navigate the winds aetheric. If you do so, remove this unit from the battlefield and set it up again on the battlefield wholly within 6\" of the battlefield edge and more than 9\" from all enemy units.`,\r\n        when: [START_OF_MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n /* 'Lord-Arcanum': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Thunderclap'])],\r\n    }, \r\n    effects: [\r\n     // CycleOfTheStormEffect,\r\n      {\r\n        name: `Aetheric Manipulation`,\r\n        desc: `When moving a predatory endless spell controlled by this unit, add 6\" to the distance that the endless spell can be moved in that phase.`,\r\n        when: [END_OF_HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Arcanum on Tauralon': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Lightning Orb'])],\r\n    }, \r\n    effects: [\r\n    //  CycleOfTheStormEffect, CometTrailEffect\r\n    ],\r\n  },\r\n  'Lord-Arcanum on Celestial Dracoline': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Storm Lance'])],\r\n    }, \r\n    effects: [\r\n     // CycleOfTheStormEffect,\r\n     // ThunderousPounceEffect,\r\n      {\r\n        name: `Pack Alpha`,\r\n        desc: `Add 1 to the Attacks characteristic of Monstrous Claws used by friendly Dracoline units wholly within 18\" of any friendly units with this ability.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Arcanum on Gryph-Charger': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Healing Light'])],\r\n    }, \r\n    effects: [\r\n    //  RideTheWindsAethericEffect, CycleOfTheStormEffect\r\n    ],\r\n  }, */\r\n  'Lord-Aquilor': {\r\n    effects: [\r\n      //RideTheWindsAethericEffect,\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Ride the Winds Aetheric`,\r\n        desc: `Declare: If this unit is not in combat, you can pick up to 2 friendly Vanguard-Palladors units that are not in combat to be the targets. \r\n        Effect: Remove this unit and the targets (if any) from the battlefield. Set this unit up again on the battlefield more than 9\" from all enemy units. Then, set up each target wholly within 12\" of this unit and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Celestant on Dracoth': {\r\n    effects: [\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      },\r\n     // SigmariteThundershieldEffect,\r\n     // StormBlastEffect,\r\n      {\r\n        name: `Righteous Avengers - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Extremis Chamber Cavalry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // ImpalingStrikesEffect,\r\n     // BlastToAshesEffect,\r\n     // CleavingBlowEffect,\r\n    ],\r\n  },\r\n  'Lord-Celestant on Stardrake': {\r\n    effects: [\r\n     // ...StardrakeBaseEffects,\r\n     // SigmariteThundershieldEffect,\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stardrakes Cavernous Jaws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Lord of the Host - Once Per Battle`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of other friendly Extremis Chamber units wholly within 12\" of this unit for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      },\r\n      {\r\n        name: `Cavernous Jaws - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that equals or exceeds the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Celestant': {\r\n    effects: [\r\n     // InescapableVengeanceEffect,\r\n      {\r\n        name: `Furious Retribution - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly non-Hero Warrior Chamber Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to wound rolls for the targets attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Lord-Castellant': {\r\n    effects: [\r\n      {\r\n        name: `Warding Lantern`,\r\n        desc: `In your hero phase, you can either pick 1 friendly STORMCAST ETERNALS unit wholly within 18\" of this unit or 1 enemy unit wholly within 18\" of this unit.\r\n\r\n        If you pick a friendly STORMCAST ETERNALS unit, add 1 to save rolls for attacks that target that unit until your next hero phase.\r\n\r\n        If you pick an enemy unit, roll a dice. On a 2+, the target suffers D3 mortal wounds. The same unit cannot be affected by this ability more than once per turn.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Gryph-Hounds': {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Warning Cry`,\r\n        desc: `Declare: Pick an enemy unit within 12\" of this unit that was set up this turn. Then, pick up to 3 friendly Stormcast Eternals units armed with ranged weapons that are within 12\" of that enemy unit to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on that enemy unit equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight-Relictor': {\r\n    effects: [\r\n      {\r\n        name: `Relic Censer`,\r\n        desc: `Declare: Pick an enemy unit within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, subtract 1 from ward rolls made by the target for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Relictor': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, ['Healing Storm', 'Lightning Storm'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Mortis Priest - Passive`,\r\n        desc: `Effect: Add 1 to chanting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Lord-Exorcist': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Purifying Blast'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `Redemptor Casket`,\r\n        desc: `Slain models cannot be returned to enemy units that are within 9\" of any friendly units with this ability.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Ordinator': {\r\n    effects: [\r\n      {\r\n        name: `Arcane Engineer`,\r\n        desc: `Add 1 to hit rolls for attacks made by friendly Order War Machines wholly within 9\" of any friendly units with this ability.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Comet Strike`,\r\n        desc: `If the unmodified hit roll for an attack made with a melee weapon by this unit is 6, the target suffers 2 mortal wounds and the attack sequence ends (do not make a wound or save roll).`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Lord-Veritant': {\r\n   /* mandatory: {\r\n      prayers: [keyPicker(prayers, ['Sanction'])],\r\n    },*/\r\n    effects: [\r\n      {\r\n        name: `Ruination Chamber - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n        desc: `Effect: Make a resistance roll of D6. On a 4+, that ability has no effect on this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Sense Unholy Sorcery - Passive`,\r\n        desc: `Effect: This units Gryph-crow is a token. Subtract 1 from casting rolls and chanting rolls for enemy units within 12\" of this unit while its Gryph-crow is on the battlefield. If you make an unmodified save roll of 1 for this unit, remove its Gryph-crow from the battlefield aer the Attack ability has been resolved (the damage point is still inflicted).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Staff of Abjuration - Passive`,\r\n        desc: `Effect: This unit can use Unbind abilities as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight-Arcanum': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Blaze of the Heavens'])],\r\n    },*/\r\n    effects: [\r\n      {\r\n        name: `Indomitable Loreseekers - Passive`,\r\n        desc: `Effect: Add 1 to casting rolls for this unit when it uses a Summon ability and add 1 to banishment rolls for this unit. Enemy Manifestations cannot pass through or end any move within this units combat range unless they started that move within this units combat range. This unit has Ward (4+) against mortal damage inflicted by Manifestations.`,\r\n        when: [DURING_GAME, HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* 'Knight-Azyros': {\r\n    effects: [\r\n      {\r\n        name: `The Light of Sigmar`,\r\n        desc: `Once per turn, at the end of the charge phase, you can pick 1 enemy unit within 9\" of this unit. Add 1 to hit rolls for attacks made by friendly STORMCAST ETERNALS units that target that enemy unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Knight-Draconis': {\r\n    effects: [\r\n   //   ArcaneHeritageEffect,\r\n    //  DraconicFlamestreamEffect,\r\n      {\r\n        name: `Wrath of the Draconith - Once Per Turn`,\r\n        desc: `Declare: Pick a friendly Stormdrake Guard unit within this units combat range to be the target. \r\n        Effect: Roll a dice. On a 2+, add 1 to the Attacks characteristic of both this units and the targets Draconiths Fangs and Talons for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Arcane Heritage - Reaction: Opponent declared a Spell ability`,\r\n        desc: `Effect: If this unit or a friendly Stormdrake Guard unit wholly within 12\" of this unit was picked to be the target of that spell, roll a dice. On a 4+, ignore the effect of that spell on this unit or that friendly unit. This unit can use this ability more than once per phase but only once per Spell ability.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      },\r\n    // DraggedIntoTheTempestEffect,\r\n    ],\r\n  },\r\n /* 'Knight-Venator': {\r\n    effects: [\r\n      {\r\n        name: `Star-fated Arrow`,\r\n        desc: `Once per battle, in your shooting phase, you can say that this unit will shoot a star-fated arrow instead of attacking with its missile weapons. If you do so, pick 1 enemy unit within 30\" of this unit and roll a dice. On a 3+, the target suffers D3 mortal wounds. If the target is a HERO or Monster, it suffers D6 mortal wounds instead of D3.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight-Incantor': {\r\n  /*  mandatory: {\r\n      spells: [keyPicker(spells, ['Spirit Storm'])],\r\n    },\r\n    effects: [\r\n      //VoidstormScrollEffect\r\n    ],\r\n  },\r\n  'Knight-Heraldor': {\r\n    effects: [\r\n      {\r\n        name: `Thunderblast`,\r\n        desc: `In your shooting phase, you can pick 1 terrain feature wholly within 18\" of this unit. Roll a dice for each enemy unit within 3\" of that terrain feature. On a 2+, that unit suffers D3 mortal wounds.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Errant-Questor': {\r\n    effects: [\r\n      {\r\n        name: `Implacable Determination`,\r\n        desc: `When you make save rolls for this model, ignore the enemy's Rend characteristic.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `Oathsworn`,\r\n        desc: `After setup, you must declare an oath for each Errant-Questor in your army to fulfil:\r\n\r\n        Sworn Protector: Pick a HERO in your army for the Errant-Questor to protect. Whilst this model is within 3\" of the HERO you picked, you can choose to allocate any unsanved or mortal wound inflicted upon that model to the Errant-Questor instead.\r\n\r\n        Blood Feud: Pick a HERO in the enemy army. You can reroll all failed hit and wound rolls when attacking that HERO with this model. If you have more than one Errant-Questor in your army that chooses this oath, you must pick a different enemy HERO to be the target of each blood feud.\r\n\r\n        Fueled by Vengeance: Keep track of how many unsaved wounds this model inflicts upon enemy models in battle. Add 1 to the Attacks characteristic of this model's Rune-etched Greatblade for every 10 wounds he inflicts during the battle.`,\r\n        when: [END_OF_SETUP],\r\n      },\r\n      {\r\n        name: `Relentless Purpose`,\r\n        desc: `You can reroll failed charge rolls for an Errant-Questor.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Knight-Questor': {\r\n    effects: [\r\n      {\r\n        name: `Heroic Retribution - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Questor Soulsworn unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Ordained Quest - Once Per Battle`,\r\n        desc: `Effect: Pick an objective wholly outside friendly territory. That objective is considered by you to be questmarked.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `His Will Be Done - Passive`,\r\n        desc: `Effect: While this unit is contesting a questmarked objective:  \r\n        Add 3 to this units control score.  \r\n        This unit has Ward (5+).`,\r\n        when: [DURING_GAME, END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  /*'Knight-Questor Larissa Shadowstalker': {\r\n    effects: [\r\n      {\r\n        name: `Deathstrike`,\r\n        desc: `If the unmodified hit roll for an attack made with this model's Stormstrike Glaive that targets a MONSTER is 6, that attack has a Damage characteristic of D6 instead of 1.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `The Malleus Occulum`,\r\n        desc: `If your battle is taking place in Ulgu, the Realm of Shadow, you can reroll charge rolls for this model.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Protector Discipline`,\r\n        desc: `Add 1 to save rolls for attacks made with missile weapons that target this model.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n      {\r\n        name: `The Shadowstalker's Quarry`,\r\n        desc: `If this model is within 6\" of an enemy MONSTER in the combat phase, it is eligible to fight and can move an extra 3\" when it piles in, but must end that pile-in move within 1\" of an enemy MONSTER. In addition, you can reroll hit rolls for attacks made by this model if the target of the attack is a MONSTER.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Knight-Vexillor': {\r\n    effects: [\r\n      {\r\n        name: `The Banner of the Reforged`,\r\n        desc: `Declare: Pick D3 friendly Stormcast Eternals units wholly within 12\" of this unit to be the targets. \r\n        Effect: Add 3 to each targets control score for the rest of the turn. In addition, Heal (D3) each target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  SoulChargedIconEffect,\r\n    ],\r\n  },\r\n /* 'Knight-Vexillor with Banner of Apotheosis': {\r\n    effects: [\r\n      {\r\n        name: `The Banner of the Reforged`,\r\n        desc: `Once per battle, in your hero phase, you can pick up to 3 friendly STORMCAST ETERNALS units wholly within 12\" of this unit to be affected by the banner's energy (you can pick the same unit multiple times).\r\n\r\n        If you pick a unit once with this ability, you can heal up to D3 wounds allocated to that unit or, if no wounds are allocated to it, you can return a number of slain models to that unit that have a combined Wounds characteristic of D3 or less. If you pick a unit twice with this ability, you can heal up to 2D3 wounds allocated to that unit or, if no wounds are allocated to it, you can return a number of slain models to that unit that have a combined Wounds characteristic of 2D3 or less. If you pick a unit three times with this ability, you can heal up to 3D3 wounds allocated to that unit or, if no wounds are allocated to it, you can return a number of slain models to that unit that have a combined Wounds characteristic of 3D3 or less.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // SoulChargedIconEffect,\r\n    ],\r\n  }, \r\n  'Knight-Zephyros': {\r\n    effects: [\r\n    //  TirelessHuntersEffect, WindriderEffect\r\n    ],\r\n  }, */\r\n  'Drakesworn Templar': {\r\n    effects: [\r\n     // ...StardrakeBaseEffects,\r\n     {\r\n      name: `Battle Damaged - Passive`,\r\n      desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Stardrakes Cavernous Jaws is 4.`,\r\n      when: [COMBAT_PHASE],\r\n    },\r\n    {\r\n      name: `Extremis Chamber - Passive`,\r\n      desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n      when: [COMBAT_PHASE]\r\n    },\r\n      {\r\n        name: `Monsterous Challenge - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy Monster in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, for the rest of the turn:  \r\n        Add 1 to the Damage characteristic of this units Stardrakes Cavernous Jaws for attacks that target that unit.  \r\n        If the target is also a Hero, add 1 to the Damage characteristic of this units Templar Weapons for attacks that target that unit.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // CelestialBlastEffect,\r\n    ],\r\n  },\r\n  // Fulminators: {\r\n  //   effects: [\r\n  //     IntolerableDamageEffect,\r\n  //     SigmariteShieldEffect,\r\n  //     StormBlastEffect,\r\n  //     {\r\n  //       name: `Impaling Strikes`,\r\n  //       desc: `Add 2 to the Damage of this unit's Stormstrike Glaives if the unit made a charge move in the same turn.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //     {\r\n  //       name: `Glaivewall`,\r\n  //       desc: `Add 1 to save rolls for attacks made with missiles weapons that target this unit.`,\r\n  //       when: [SAVES_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // Desolators: {\r\n  //   effects: [\r\n  //     IntolerableDamageEffect,\r\n  //     SigmariteShieldEffect,\r\n  //     StormBlastEffect,\r\n  //     {\r\n  //       name: `Fury of the Storm`,\r\n  //       desc: `While this unit has 4 or more models, add 1 to the Attacks of this unit's Thunderaxes. While this unit has 6 or more models, add 2 to the Attacks instead.`,\r\n  //       when: [COMBAT_PHASE],\r\n  //     },\r\n  //   ],\r\n  // },\r\n /* Tempestors: {\r\n    effects: [\r\n      //IntolerableDamageEffect,\r\n     // SigmariteShieldEffect,\r\n      //StormBlastEffect,\r\n      {\r\n        name: `Disruptive Fire`,\r\n        desc: `Subtract 1 from hit rolls for missile attacks used by enemy units while they are within 12\" of one or more friendly TEMPESTORS.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  }, \r\n  Protectors: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Protector-Prime. Add 1 to the Attacks characteristic of that model's Stormstrike Glaive.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Shield of the Storm`,\r\n        desc: `Add 1 to save rolls for attacks that target this unit if at least half of the models in this unit (rounding down) are armed with Stormstrike Glaives.`,\r\n        when: [SAVES_PHASE],\r\n      },\r\n     // StarsoulMaceEffect,\r\n    ],\r\n  },\r\n  Decimators: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Decimator-Prime. Add 1 to the Attacks characteristic of that model's Thunderaxe.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // StarsoulMaceEffect,\r\n     // CleavingBlowEffect,\r\n    ],\r\n  }, */\r\n  Liberators: {\r\n    effects: [\r\n      {\r\n        name: `Stalwart Defenders - Passive`,\r\n        desc: `Effect: Add 3 to this units control score while it is contesting an objective wholly within friendly territory.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n     // LayLowTheTyrantsEffect,\r\n     // SigmariteShieldEffect,\r\n    ],\r\n  },\r\n /* Retributors: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Retributor-Prime. Add 1 to the Attacks characteristic of that model's Lightning Hammer.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n     // BlastToAshesEffect,\r\n     // StarsoulMaceEffect,\r\n    ],\r\n  },\r\n  'Prosecutors with Stormcall Javelins': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Prosecutor-Prime. Add 1 to the Attacks characteristic of that model's Stormcall Javelin.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n     // DispersedFormationEffect,\r\n     // HeraldsOfRighteousnessEffect,\r\n     // SigmariteShieldEffect,\r\n    ],\r\n  }, */\r\n  'Prosecutors': {\r\n    effects: [\r\n      {\r\n        name: `Ruination Chamber - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n        desc: `Effect: Make a resistance roll of D6. On a 4+, that ability has no effect on this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Dispersed Formation - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Heralds of Righteousness - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n     // DispersedFormationEffect,\r\n     // HeraldsOfRighteousnessEffect,\r\n     // SigmariteShieldEffect,\r\n    ],\r\n  },\r\n /* 'Judicators with Boltstorm Crossbows': {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Judicator-Prime. Add 1 to the Attacks characteristic of that model's Boltstorm Crossbow or Thunderbolt Crossbow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Rapid Fire`,\r\n        desc: `If an attack made with a Boltstorm Crossbow scores a hit, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Judicators with Skybolt Bows': {\r\n    effects: [\r\n    //  CelestialBlastEffect\r\n    ],\r\n  }, */\r\n  'Vanguard-Raptors with Hurricane Crossbows': {\r\n    effects: [\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Coordinated Strike - Passive`,\r\n        desc: `Effect: Add 1 to wound rolls for this units shooting attacks if the target is in combat with any friendly Vanguard Chamber units.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vanguard-Raptors with Longstrike Crossbows': {\r\n    effects: [\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Headshot`,\r\n        desc: `Effect: If this unit has not used a Move ability this turn and was not set up this turn, for the rest of the turn, this unit can ignore the effects of the Guarded Hero ability (Core Rules, 25.0) when picking targets for its shooting attacks.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Vanguard-Hunters': {\r\n    effects: [\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Astral Compass - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit to be the target. \r\n        Effect: The target has the Hunted keyword for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Star-Marked - Passive`,\r\n        desc: `Effect: Add 2\" to this units Move characteristic while a Hunted enemy unit is on the battlefield. In addition, add 1 to hit rolls for this units attacks that target a Hunted enemy unit.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n   //  AstralCompassEffect,\r\n    ],\r\n  },\r\n  'Vanguard-Palladors with Javelins': {\r\n    effects: [\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Charging Volley`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit in combat with it to be the target. \r\n        Effect: This unit can immediately use a Shoot ability as if it were your shooting phase, but it must target that enemy unit. This units Starstrike Javelins have Shoot in Combat this phase.`,\r\n        when: [CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    //  RideTheWindsAethericEffect,\r\n    ],\r\n  },\r\n  'Vanguard-Palladors with Handaxes': {\r\n    effects: [\r\n      {\r\n        name: `Vanguard Chamber - Passive`,\r\n        desc: `Effect: This unit can use Shoot and/or Charge abilities even if it used a Run or Retreat ability in the same turn.`,\r\n        when: [MOVEMENT_PHASE, SHOOTING_PHASE, CHARGE_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Shocking Strikes - Passive`,\r\n        desc: `Effect: If any damage points are allocated to an enemy unit by attacks made with this units Shock Handaxes, subtract 1 from wound rolls for that enemy units combat attacks for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    //  RideTheWindsAethericEffect,\r\n    ],\r\n  },\r\n  Aetherwings: {\r\n    effects: [\r\n      {\r\n        name: `Beast - Passive`,\r\n        desc: `Effect: This unit has a maximum control score of 1.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Marked for Destruction - Passive`,\r\n        desc: `Effect: Add 1 to hit rolls for shooting attacks made by friendly Vanguard Chamber units if the target is within 9\" of this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  /*'Celestar Ballista': {\r\n    effects: [\r\n      {\r\n        name: `Versatile Weapon`,\r\n        desc: `Each time this unit shoots, choose either the Lightning-charged Shot or Rapid Fire weapon characteristics for all the attacks it makes with its Celestar Stormbolts.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Castigators: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Castigator-Prime. Add 1 to the Attacks characteristic of that model's Thunderhead Greatbow.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Castigator Aetheric Channelling`,\r\n        desc: `At the start of the shooting phase, you must say whether this unit will increase either the accuracy or the power of its Thunderhead Greatbows.\r\n\r\n        If you pick accuracy, until the end of that phase, add 1 to hit rolls for attacks made with this unit's Thunderhead Greatbows.\r\n\r\n        If you pick power, until the end of that phase, this unit's Thunderhead Greatbows have a Rend characteristic of -2 instead of -1.`,\r\n        when: [START_OF_SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Burst of Celestial Energy`,\r\n        desc: `If the unmodified hit roll for an attack made with a Thunderhead Greatbow that targets a Malignant or Daemon unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Sequitors: {\r\n    effects: [\r\n      {\r\n        name: `Champion`,\r\n        desc: `1 model in this unit can be a Sequitor-Prime. Add 1 to the Attacks characteristic of that model's Sacrosanct Weapons or Stormsmite Greatmace. If a Sequitor-Prime is armed with Sacrosanct Weapons and a Soulshield, it can also carry a Redemption Cache.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Sequitor Aetheric Channelling`,\r\n        desc: `At the start of the combat phase, you must say whether this unit will channel aetheric power into its weapons or into its shields.\r\n\r\n        If you pick its weapons, until the end of that phase, if the unmodified hit roll for an attack made by this unit is 6, that attack scores 2 hits on the target instead of 1. Make a wound and save roll for each hit.\r\n        \r\n        If you pick its shields, until the end of that phase, this unit has a ward of 5+.`,\r\n        when: [START_OF_COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Redemption Cache`,\r\n        desc: `Slain models cannot be returned to enemy units that are within 3\" of this unit's Sequitor-Prime.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  }, */\r\n  Vanquishers: {\r\n    effects: [\r\n      {\r\n        name: `Lightning Strikes - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Celestial Greatswords for attacks that target an enemy unit that has 5 or more models.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n/*  Evocators: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Empower'])],\r\n    },\r\n    effects: [\r\n      {\r\n        name: `Wizard`,\r\n        desc: `This unit is a Wizard while this unit has 2 or more models. It can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase. It only knows the Empower spell and cannot attempt to cast any other spells. Any number of Evocators units can attempt to cast Empower in the same hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  EvocatorChampionEffect,\r\n    //  CelestialLightningArcEffect,\r\n    ],\r\n  },\r\n  'Evocators on Celestial Dracolines': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Empower'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `Wizard`,\r\n        desc: `This unit is a Wizard while it has 2 or more models. It can attempt to cast 1 spell in your hero phase and attempt to unbind 1 spell in the enemy hero phase. It only knows the Empower spell and cannot attempt to cast any other spells. Any number of Evocators units can attempt to cast Empower in the same hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n     // EvocatorChampionEffect,\r\n     // ThunderousPounceEffect,\r\n    //  CelestialLightningArcEffect,\r\n    ],\r\n  }, */\r\n  // Removed in 2021 (?)\r\n  // 'Lynus Ghalmorian on Gryph Charger': {\r\n  //   mandatory: {\r\n  //     command_abilities: [keyPicker(command_abilities, ['Sombre Exemplar'])],\r\n  //     spells: [keyPicker(spells, ['Amethyst Gale'])],\r\n  //   },\r\n  //   effects: [\r\n  //     AetherealStrikeEffect,\r\n  //     RideTheWindsAethericEffect,\r\n  //     CycleOfTheStormEffect,\r\n  //     SpiritFlaskEffect,\r\n  //     {\r\n  //       name: `Shield of the Pale Knight`,\r\n  //       desc: `You can reroll save rolls of 1 for attacks made with missile weapons that target this model or any friendly ANVILS OF HELDENHAMMER units wholly within 12\" of this model.`,\r\n  //       when: [SAVES_PHASE],\r\n  //     },\r\n  //     PrimeElectridsEffect,\r\n  //   ],\r\n  // },\r\n /* 'Averon Stormsire': {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Stormsire'])],\r\n    }, \r\n    effects: [\r\n    //  VoidstormScrollEffect\r\n    ],\r\n  }, */\r\n  'Bastian Carthalos': {\r\n    effects: [\r\n      {\r\n        name: `Voice of Thunder - Passive`,\r\n        desc: `Effect: Each time a friendly Stormcast Eternals unit wholly within 12\" of this unit uses the All-out Attack command, no command points are spent.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Castellan of Azyr`,\r\n        desc: `Declare: Pick up to 3 friendly Stormcast Eternals Infantry units to be the targets. \r\n        Effect: Each target can use the Normal Move ability as if it were your movement phase.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Mantle of the First Storm`,\r\n        desc: `Effect: If any enemy models were slain by this units attacks this turn, Heal (4) this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  /*\"Stormsire's Cursebreakers\": {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Empower'])],\r\n    }, \r\n    effects: [\r\n      {\r\n        name: `Wizard`,\r\n        desc: `This unit is a Wizard while it has 2 models. It can attempt to cast one spell in your hero phase, and attempt to unbind one spell in the enemy hero phase. It knows the Empower spell. It cannot attempt to cast any spells other than Empower, but any number of units of Evocators can attempt to cast Empower in the same hero phase.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    //  CelestialLightningArcEffect,\r\n    ],\r\n  }, */\r\n  'Gardus Steel Soul': {\r\n    effects: [\r\n      {\r\n        name: `Aura of Purity - Passive`,\r\n        desc: `Effect: If this unit charged this turn, for the rest of the turn, friendly Stormcast Eternals units have Ward (5+) while they are wholly within 12\" of this unit.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Saintly Assault - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 visible friendly Stormcast Eternals Infantry units wholly within 6\" of this unit to be the targets. \r\n        Effect: For the rest of the turn:  \r\n        Add 1 to charge rolls for the targets.  \r\n        Add 1 to the Attacks characteristic of the targets melee weapons.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Yndrasta: {\r\n    effects: [\r\n      {\r\n        name: `The Prime Huntress - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units Thengavar for attacks that target Monsters.`,\r\n        when: [COMBAT_PHASE, SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `On Wings of Brilliance - Passive`,\r\n        desc: `Effect: Add 1 to the number of dice rolled when making charge rolls for this unit, to a maximum of 3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Dazzling Radiance - Passive`,\r\n        desc: `Effect: Ignore negative modifiers to the control scores of friendly Stormcast Eternals units while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Imperatant': {\r\n    effects: [\r\n      {\r\n        name: `Loyal Gryph-Hound - Passive`,\r\n        desc: `Effect: This units Gryph-hound is a token. This unit has Ward (5+) while its Gryph-hound is on the battlefield. If you make an unmodified save roll of 1 for this unit, remove its Gryph-hound from the battlefield after the Attack ability has been resolved (the damage point is still inflicted).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Guided by Lightning - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Stormcast Eternals units wholly within 12\" of this unit that were set up this turn using the Scions of the Storm ability to be the targets. \r\n        Effect: Each target can immediately move D3\". The targets cannot move into combat during any part of that move.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Praetors: {\r\n    effects: [\r\n      {\r\n        name: `Soul-Bonded`,\r\n        desc: `Effect: Pick a friendly Stormcast Eternals Hero to be this units soul-bonded charge for the rest of the battle.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Soul-forged Guardians - Passive`,\r\n        desc: `Effect: While this units soul-bonded charge is within this units combat range, both this unit and that soul-bonded charge have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  Vindictors: {\r\n    effects: [\r\n      {\r\n        name: `Hold the Shieldwall`,\r\n        desc: `Effect: If this unit did not charge this turn and is in combat with an enemy unit that charged this turn, roll a dice. On a 4+, this unit has Strike-first for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Annihilators: {\r\n    effects: [\r\n      {\r\n        name: `Brace for Impact`,\r\n        desc: `Declare: Pick an enemy unit that charged this turn and is in combat with this unit to be the target. \r\n        Effect: Roll a dice for each model in this unit. If any of the rolls are a 6, the target has Strike-last for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Blazing Impact`,\r\n        desc: `Declare: If this unit was set up this turn using the Scions of the Storm ability, pick up to 3 enemy units within 10\" of it to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n     // ...AnnihilatorBaseEffects,\r\n    ],\r\n  },\r\n  'Annihilators with Meteoric Grandhammers': {\r\n    effects: [\r\n      {\r\n        name: `Force of a Falling Star`,\r\n        desc: `Declare: If this unit charged this phase and the unmodified charge roll was 8+, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: The target has Strike-last for the rest of the turn.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Blazing Impact`,\r\n        desc: `Declare: If this unit was set up this turn using the Scions of the Storm ability, pick up to 3 enemy units within 10\" of it to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      //...AnnihilatorBaseEffects,\r\n    ],\r\n  },\r\n  'Stormstrike Chariot': {\r\n    effects: [\r\n      {\r\n        name: `Celestial Blaze - Passive`,\r\n        desc: `Effect: When this unit uses the Power Through command, inflict an additional D3 mortal damage on the target and add D6\" to the distance this unit can move as part of that ability.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Azyr Unleashed`,\r\n        desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Knight-Judicator with Gryph-Hounds': {\r\n    effects: [\r\n      {\r\n        name: `Faithful Gryph-hounds - Passive`,\r\n        desc: `Effect: This units Gryph-hounds are tokens. After setting up this unit on the battlefield for the first time, place both Gryph-hounds next to it.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n      {\r\n        name: `Hunting Hounds - Once Per Turn`,\r\n        desc: `Declare: If this unit was not set up this turn and any of this units Gryph-hounds are on the battlefield, pick an enemy unit within 12\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 1, remove 1 of this units Gryph-hounds from the battlefield. On a 2+, pick 1 of this units Gryph-hounds that is next to this unit or next to an enemy unit and place it next to the target instead. \r\n        While any of this units Gryph-hounds are next to an enemy unit, add 1 to hit rolls and wound rolls for this units shooting attacks that target that unit. \r\n        If an enemy unit is destroyed or removed from the battlefield while any of this units Gryph-hounds are next to it, place those Gryph-hounds next to this unit.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  Krondys: {\r\n   /* mandatory: {\r\n      spells: [keyPicker(spells, ['Atavistic Tempest'])],\r\n    }, */\r\n    effects: [\r\n      //BlazingTempestEffect,\r\n     // AncientMasterOfWarEffect,\r\n     // CalamitousTailEffect,\r\n      {\r\n        name: `Regalia Fulmentarus - Passive`,\r\n        desc: `Effect: Add 2 to casting rolls for this unit.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of its Apex Maw is 2.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Soul-Shaking Roar - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Atavistic Tempest: Casting value of 8`,\r\n        desc: `Declare: Pick a visible enemy unit within 18\" of the caster to be the target, then make a casting roll of 2D6. \r\n        Effect: Pick 1 of the following effects to apply to the target until the start of your next turn: \r\n        Blinding Gales: Subtract 1 from hit rolls for the targets attacks. \r\n        Meteor-hail: Subtract 1 from the Rend characteristic of the targets weapons. \r\n        Flash-freezing Blizzard: Subtract 1 from save rolls for the target.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Dracothian Guard Concussors': {\r\n    effects: [\r\n      //GenericEffects.Elite, StormBlastEffect, BlastToAshesEffect\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      },  \r\n      {\r\n        name: `Thunderstruck - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a dice. On a 3+, the target cannot use commands for the rest of the turn.`,\r\n        when: [COMBAT_PHASE]\r\n      },\r\n    ],\r\n  },\r\n  'Dracothian Guard Desolators': {\r\n    effects: [\r\n      //GenericEffects.Elite, StormBlastEffect, CleavingBlowEffect\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      },  \r\n      {\r\n        name: `Cleaving Blow - Passive`,\r\n        desc: `Effect: Add 1 to the Damage characteristic of this units Thunderaxes if the target unit has 10 or more models.`,\r\n        when: [COMBAT_PHASE]\r\n      },  \r\n    ],\r\n  },\r\n  'Dracothian Guard Fulminators': {\r\n    effects: [\r\n    //  GenericEffects.Elite, ImpalingStrikesEffect, StormBlastEffect\r\n    {\r\n      name: `Extremis Chamber - Passive`,\r\n      desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n      when: [COMBAT_PHASE]\r\n    },  \r\n    {\r\n      name: `Impaling Strikes`,\r\n      desc: `Declare: If this unit charged this phase, pick an enemy unit within 1\" of it to be the target. \r\n      Eect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n      when: [CHARGE_PHASE]\r\n    },   \r\n  ],\r\n  },\r\n  'Dracothian Guard Tempestors': {\r\n    effects: [\r\n      GenericEffects.Elite,\r\n      //StormBlastEffect,\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      }, \r\n      {\r\n        name: `Overwhelming Volleystorm`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by attacks made with this units Volleystorm Crossbows to be the target. \r\n        Effect: Roll a dice. On a 2+, the target cannot use the All-out Defence command in the following combat phase.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n  'Stormdrake Guard': {\r\n    effects: [\r\n      {\r\n        name: `Extremis Chamber - Passive`,\r\n        desc: `Effect: Each time you make an unmodified save roll of 6 for a combat attack that targets this unit, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE]\r\n      }, \r\n      {\r\n        name: `Dispersed Formation - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n     // DispersedFormationEffect,\r\n     // ArcaneHeritageEffect,\r\n     // DraconicFlamestreamEffect,\r\n     // DraggedIntoTheTempestEffect,\r\n      {\r\n        name: `Draconic Onslaught - Once Per Turn`,\r\n        desc: `Effect: If this unit charged this turn, roll a dice. On a 3+, this unit can move 2D6\". It can pass through the combat ranges of enemy units and can end that move in combat. Then, pick an enemy unit that this unit passed across during that move. Inflict D3 mortal damage on that enemy unit`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [\r\n          rule_sources.BATTLETOME_STORMCAST_ETERNALS,\r\n          rule_sources.ERRATA_JULY_2022,\r\n          meta_rule_sources.BATTLESCROLL_GALLETIAN_CHAMPIONS_JANUARY_2022,\r\n          meta_rule_sources.BATTLESCROLL_ANDTOR_SEPTEMBER_2023,\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  Vigilors: {\r\n    effects: [\r\n      {\r\n        name: `Navigators of the Storm - Passive`,\r\n        desc: `Effect: If an enemy unit had any damage points allocated to it this turn by this units shooting attacks, add 1 to hit rolls for attacks made by friendly Stormcast Eternals units that target that unit for the rest of the turn.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n    ],\r\n  },\r\n /* \"Xandire's Truthseekers\": {\r\n    effects: [\r\n      {\r\n        name: `Blazing Arrows`,\r\n        desc: `If the unmodified hit roll for an attack made with this unit's Stormcaller Bow is 6, the target suffers 2 mortal wounds and the attack sequence ends (do not make a wound roll or save roll).`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Kinetic Lodestone`,\r\n        desc: `After an enemy unit finishes a charge move within 3\" of Dhoraz Giant-fell, roll a dice. On a 3+, that unit suffers D3 mortal wounds. If that unit has a mount or is a MONSTER, it suffers 3 mortal wounds instead of D3.`,\r\n        when: [CHARGE_PHASE],\r\n      },\r\n      {\r\n        name: `Lantern Astrala`,\r\n        desc: `Once per turn, at the end of the charge phase, you can pick 1 enemy unit within 9\" of this unit. Add 1 to hit rolls for attacks made by friendly STORMCAST ETERNALS units that target that enemy unit in the following combat phase.`,\r\n        when: [END_OF_CHARGE_PHASE],\r\n      },\r\n    ],\r\n  }, */\r\n  'Questor Soulsworn': {\r\n    effects: [\r\n      {\r\n        name: `His Will Be Done - Passive`,\r\n        desc: `Effect: While this unit is contesting a questmarked objective:  \r\n        Add 3 to this units control score.  \r\n        This unit has Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Relictor Soulguide - Once Per Battle`,\r\n        desc: `Declare: You can pick a friendly Knight-Questor within this units combat range to be the target. \r\n        Effect: Remove this unit from the battlefield and set it up again on the battlefield more than 9\" from all enemy units. Then, if you picked a target, remove it from the battlefield and set it up again within this units combat range and more than 9\" from all enemy units.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Ordained Quest - Once Per Battle`,\r\n        desc: `Effect: Pick an objective wholly outside friendly territory. That objective is considered by you to be questmarked.`,\r\n        when: [DURING_SETUP],\r\n      },\r\n    ],\r\n  },\r\n  'Ionus Cryptborn': {\r\n  /*  mandatory: {\r\n      prayers: [keyPicker(prayers, ['Lightning Tempest'])],\r\n    }, */\r\n    effects: [\r\n      {\r\n        name: `Spirit-Scouring Flames - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit that had any damage points allocated to it this turn by attacks made with this units Spirit-scouring Flames to be the target. \r\n        Effect: The target has the Soulburned keyword for the rest of the battle.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 10 or more damage points, the Attacks characteristic of Cthoraks Ancient Claws is 4.`,\r\n        when: [COMBAT_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Lightning Tempest: Chant value of 5`,\r\n        desc: `Declare: Pick a visible enemy unit within 12\" of this unit to be struck by lightning, then make a chanting roll of D6. \r\n        Effect: Inflict D3 mortal damage on that unit, then roll a dice. On a 1-2, the sequence ends. On a 3+, pick another enemy unit within 3\" of that unit to be struck by lightning and inflict D3 mortal damage on it. If the chanting roll was 10+, you can pick another enemy unit within 6\" of that unit instead of 3\". Keep rolling dice in this way until the sequence ends or there are no other enemy units eligible to be struck by lightning. A unit cannot be struck by lightning more than once per turn.`,\r\n        when: [HERO_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n      {\r\n        name: `Soulburned`,\r\n        desc: `Declare: This unit can use this ability even if it has been destroyed. Pick any number of Soulburned enemy units to be the targets. \r\n        Effect: Roll a D3 for each target. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n        rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n      },\r\n    ],\r\n  },\r\n  'Lord-Vigilant': {\r\n    /*  mandatory: {\r\n        prayers: [keyPicker(prayers, ['Lightning Tempest'])],\r\n      }, */\r\n      effects: [\r\n        {\r\n          name: `Ruination Chamber - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n          desc: `Effect: Make a resistance roll of D6. On a 4+, that ability has no effect on this unit.`,\r\n          when: [DURING_GAME],\r\n        },\r\n        {\r\n          name: `Deliver Judgement - Once Per Battle`,\r\n          desc: `Declare: Pick a friendly non-Hero Ruination Chamber unit wholly within 12\" of this unit. \r\n          Effect: That unit can use 2 Fight abilities this phase. After the first is used, however, that unit has Strike-last for the rest of the turn.`,\r\n          when: [COMBAT_PHASE],\r\n          rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n        },\r\n      ],\r\n    },\r\n    'Lord-Terminos': {\r\n      /*  mandatory: {\r\n          prayers: [keyPicker(prayers, ['Lightning Tempest'])],\r\n        }, */\r\n        effects: [\r\n          {\r\n            name: `Ruination Chamber - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n            desc: `Effect: Make a resistance roll of D6. On a 4+, that ability has no effect on this unit.`,\r\n            when: [DURING_GAME],\r\n          },\r\n          {\r\n            name: `Memorian - Passive`,\r\n            desc: `Effect: This units Memorian is a token. Add 3 to the control scores of friendly Ruination Chamber units wholly within 12\" of this unit while its Memorian is on the battlefield. If you make an unmodified save roll of 1 for this unit, remove its Memorian from the battlefield after the Attack ability has been resolved (the damage point is still inflicted).`,\r\n            when: [END_OF_TURN],\r\n            rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n          },\r\n          {\r\n            name: `Earn an Honourable Death - Reaction: You declared a Fight ability for this unit`,\r\n            desc: `Effect: Pick a friendly non-Hero Ruination Chamber Infantry unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved. If it is picked to do so, add 1 to hit rolls for the targets attacks for the rest of the turn.`,\r\n            when: [COMBAT_PHASE],\r\n            rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n          },\r\n        ],\r\n      },\r\n      'Reclusians': {\r\n        /*  mandatory: {\r\n            prayers: [keyPicker(prayers, ['Lightning Tempest'])],\r\n          }, */\r\n          effects: [\r\n            {\r\n              name: `Ruination Chamber - Once Per Turn - Reaction: This unit was picked as the target of a Non-Core ability`,\r\n              desc: `Effect: Make a resistance roll of D6. On a 4+, that ability has no effect on this unit.`,\r\n              when: [DURING_GAME],\r\n            },\r\n            {\r\n              name: `Memorian Descendants - Passive`,\r\n              desc: `Effect: This units Memorians are tokens. There are 2 Memorians for every 3 models in this unit. While any of this units Memorians are on the battlefield, add 1 to this units resistance rolls when using the Ruination Chamber ability. Each time you make an unmodified save roll of 1 for this unit, remove 1 of its Memorians from the battlefield aer the Attack ability has been resolved (the damage point is still inflicted).`,\r\n              when: [DURING_GAME],\r\n              rule_sources: [meta_rule_sources.BOOK_DAWNBRINGERS_BOOK_3],\r\n            },\r\n          ],\r\n        },\r\n        'ROR: Fjori`s Flamebearers': {\r\n    effects: [\r\n      {\r\n        name: `Grimhold Exile: Last of the Lodge-fire - Once Per Battle`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a number of dice equal to the targets Health characteristic. For each 4+, inflict 1 mortal damage on the target.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Grimhold Exile: Honour to Grimnir! - Once Per Battle`,\r\n        desc: `Declare: Pick up to 3 friendly Fyreslayers Infantry units wholly within 12\" of this unit to be the targets. \r\n        Effect: You can re-roll charge rolls for the targets for the rest of the turn`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Auric Hearthguard: Molten Rockbolts - Passive`,\r\n        desc: `Effect: Each time a shooting attack made by this unit scores a critical hit, subtract 1\" from the target units Move characteristic until the start of your next turn. This ability cannot reduce the target units unmodified Move characteristic below half.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers: Duty Unto Death - Passive`,\r\n        desc: `Effect: While any friendly Fyreslayers Infantry Heroes are wholly within this units combat range, both this unit and those friendly units have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Poleaxes: Smouldering Braziers`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll a D3. On a 2+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Hearthguard Berzerkers with Broadaxes: Fires of Vengeance - Passive`,\r\n        desc: `Effect: While this unit is within the combat ranges of any damaged friendly Fyreslayers Heroes, add 1 to the Attacks characteristic of this unit's melee weapons.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Slingshields: Berserk Fury - Passive`,\r\n        desc: `Effect: Each time a model in this unit is slain by a combat attack and that model was in combat with the attacking unit, roll a dice. On a 5+, inflict 1 mortal damage on the attacking unit aer the Fight ability has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Vulkite Berzerkers with Handaxes: Whirlwind of Destruction - Passive`,\r\n        desc: `Effect: Add 1 to the Attacks characteristic of this units melee weapons if this unit charged this turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toe to Toe - Passive`,\r\n        desc: `Effect: Subtract 10 from the control scores of enemy Monsters while they are in combat with any units in this Regiment of Renown.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n      {\r\n        name: `Grimnir's Defiance - Passive`,\r\n        desc: `Effect: Units in this Regiment of Renown cannot be picked to be the target of Rampage abilities used by enemy units.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Saviours of Cinderfall': {\r\n    effects: [\r\n      {\r\n        name: `Callis and Toll: Right Tools for the Job - Passive`,\r\n        desc: `Effect: Double the Damage characteristic of this units weapons for attacks that target Wizards, Priests and Manifestations.`,\r\n        when: [SHOOTING_PHASE, COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Wily to the Last - Passive`,\r\n        desc: `Effect: If this unit has 2 models and would be automatically destroyed, it is not automatically destroyed. Instead, 1 model in this unit is slain.`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Callis and Toll: Get it Done - Reaction: You declared a Fight ability for this unit`,\r\n        desc: `Effect: Pick a friendly Tolls Companions unit that has not used a Fight ability this turn and is within this units combat range to be the target. The target can be picked to use a Fight ability immediately after the Fight ability used by this unit has been resolved.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Toll's Companions: Hidden Agents`,\r\n        desc: `Declare: Pick this unit and a friendly Callis and Toll unit in the same regiment as this unit if those units have not been deployed. \r\n        Effect: Set up those units in reserve in the shadows. Those units have now been deployed.`,\r\n        when: [DURING_SETUP],\r\n       },\r\n       {\r\n        name: `Toll's Companions: Saviours of Cinderfall - Passive`,\r\n        desc: `Effect: While a friendly Callis and Toll unit is wholly within this units combat range, both this unit and that Callis and Toll unit have Ward (5+).`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Toll's Companions: Emerge from the Shadows`,\r\n         desc: `Declare: Pick this unit if it is in the shadows. \r\n         Effect: Set up this unit anywhere on the battlefield more than 9\" from all enemy units. Then, set up the Callis and Toll unit that was set up in the shadows with this unit wholly within 6\" of it and more than 9\" from all enemy units.`,\r\n         when: [MOVEMENT_PHASE],\r\n       },\r\n       {\r\n        name: `Duty Bound - Passive`,\r\n        desc: `Effect: While every model in the same unit in the Regiment of Renown is contesting the same objective, add 1 to save rolls and ward rolls for that unit.`,\r\n        when: [DURING_GAME],\r\n       },\r\n       {\r\n         name: `Sigmar's Justice - Once Per Turn`,\r\n         desc: `Declare: Pick an enemy unit to be marked for justice. You can pick a unit that is in reserve. \r\n         Effect: For the rest of the battle, add 1 to wound rolls for combat attacks made by units in this Regiment of Renown that target a unit that is marked for justice.`,\r\n         when: [DURING_SETUP],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Norgrimm`s Rune Throng': {\r\n    effects: [\r\n      {\r\n        name: `Runelord: Runes of Spellbreaking - Passive`,\r\n        desc: `Effect: This unit can use the Unbind ability as if it had Wizard (1).`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Runelord: Forgefire: Chant value of 5`,\r\n        desc: `Declare: Pick a friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit to be the target, then make a chanting roll of D6. \r\n        Effct: Until the start of your next turn, add 1 to the Rend characteristic of the targets melee weapons. In addition, if the chanting roll was 10+, pick another friendly Cities of Sigmar Duardin unit wholly within 12\" of this unit. Add 1 to the Rend characteristic of that units melee weapons until the start of your next turn as well.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Irondrakes: Cinderblast Bomb - Once Per Turn`,\r\n        desc: `Declare: If this unit is not in combat, pick a visible enemy unit within 6\" of it to be the target. \r\n        Effect: Roll a dice. On a 3+, inflict an amount of mortal damage on the target equal to the roll.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n      {\r\n        name: `Longbeards: I Thought Duardin Were Made of Sterner Stuff! - Passive`,\r\n        desc: `Effect: Add 2 to the control scores of friendly Cities of Sigmar Duardin units, excluding Longbeards units, while they are wholly within 12\" of this unit.`,\r\n        when: [END_OF_TURN],\r\n      },\r\n       {\r\n        name: `Rune of Restored Hearth - Once Per Battle`,\r\n        desc: `Effect: If the Runelord in the Regiment of Renown is contesting an objective, for the rest of the battle, units in this Regiment of Renown have Ward (5+) while they are contesting that objective.`,\r\n        when: [HERO_PHASE],\r\n       },\r\n       {\r\n         name: `Wrath and Ruin: Chant value of 4`,\r\n         desc: `Declare: Pick the Runelord in this Regiment of Renown to chant this prayer, pick a visible enemy unit within 18\" of them to be the target, then make a chanting roll of D6. \r\n         Effect: Roll 6 dice. If the chanting roll was 8+, roll 9 dice instead. For each 5+, inflict 1 mortal damage on the target. If 3 or more damage points are allocated to the target as a result of those dice rolls, ignore positive modifiers to save rolls for the target until the start of your next turn.`,\r\n         when: [HERO_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Elthwin`s Thorns': {\r\n    effects: [\r\n      {\r\n        name: `Arch-Revenant: Crescent Shield`,\r\n        desc: `Effect: Pick 1 of the following effects to apply to this unit for the rest of the turn: \r\n        Defensive Stance: This unit has Ward (4+). \r\n        Aggressive Stance: Add 1 to the Attacks characteristic of this units melee weapons, and add 1 to wound rolls for this units combat attacks.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Forest Fighters - Passive`,\r\n        desc: `Effect: This unit has a coherency range of 2\".`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Gossamid Archers: Zephyrspites - Once Per Turn`,\r\n        desc: `Effect: If this unit used a Shoot ability this phase, this unit can move D6\". It cannot move into combat during any part of that move.`,\r\n        when: [SHOOTING_PHASE],\r\n      },\r\n       {\r\n        name: `Gossamid Champion`,\r\n        desc: `Declare: Pick the Arch-Revenant in this Regiment of Renown to use this ability, the pick a visible enemy unit within 12\" of them to be the target. \r\n        Effect: Until the start of your next turn, subtract X from charge rolls for the target, where X is the number of damage points allocated to the target this phase by shooting attacks made by the Gossamid Archers unit in the Regiment of Renown, to a maximum of 6.`,\r\n        when: [SHOOTING_PHASE],\r\n       },\r\n       {\r\n         name: `Flight of the Zephyrspites - Once Per Turn`,\r\n         desc: `Effect: If both units in this Regiment of Renown are within each others combat range and neither unit is in combat, roll a dice. On a 3+, remove both units from the battlefield, then set them up again within each others combat range, wholly within 3\" of a terrain feature and more than 9\" from all enemy units.`,\r\n         when: [SHOOTING_PHASE],\r\n       },\r\n    ],\r\n  },\r\n  'ROR: Gotrek Gurnisson': {\r\n    effects: [\r\n      {\r\n        name: `Command Ability - Unstoppable Battle Fury`,\r\n        desc: `Effect: This unit can use 2 Fight abilities this phase. After the first is used, however, this unit has Strikelast for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `I'll Get There Myself! - Passive`,\r\n        desc: `Effect: This unit cannot be set up in reserve and cannot be targeted by abilities that would remove it from the battlefield.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n  'ROR: Bundo Whalebiter': {\r\n    effects: [\r\n      {\r\n        name: `Get Orf Me Land! - Once Per Turn`,\r\n        desc: `Declare: Pick an objective within 1\" of this unit to be the target. \r\n        Effect: Roll a dice. On a 2+, move the target 2D6\" to a new position on the battlefield more than 1\" from all models, terrain features and other objectives.`,\r\n        when: [HERO_PHASE],\r\n      },\r\n      {\r\n        name: `Stuff 'Em In Me Net - Once Per Turn`,\r\n        desc: `Declare: Pick an enemy unit in combat with this unit to be the target. \r\n        Effect: Roll 3 dice. For each roll that is at least double the targets Health characteristic, 1 model in the target unit is slain.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Son of Behemat - Passive`,\r\n        desc: `Effect: If this unit would be automatically destroyed, it is not automatically destroyed. Instead, allocate 6 damage points to it (ward rolls cannot be made for those damage points).`,\r\n        when: [DURING_GAME],\r\n      },\r\n      {\r\n        name: `Longshanks - Passive`,\r\n        desc: `Effect: This unit can pass through models in non-Monster units and parts of terrain features that are less than 4\" tall.`,\r\n        when: [MOVEMENT_PHASE],\r\n      },\r\n      {\r\n        name: `Battle Damaged - Passive`,\r\n        desc: `Effect: While this unit has 15 or more damage points, the Attacks characteristic of its Shipwrecka Warclub is 3 and this unit has a Control characteristic of 10.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Dead Cunning for a Gargant - Once Per Turn`,\r\n        desc: `Effect: For the rest of the turn, add 1 to the Attacks characteristic of this units weapons. Then, roll a dice. On a 4+, this unit has Strike-last for the rest of the turn.`,\r\n        when: [COMBAT_PHASE],\r\n      },\r\n      {\r\n        name: `Timberrr! - Passive`,\r\n        desc: `Effect: When the Mega-Gargant in this regiment of renown is slain, before removing it from play, the players must roll off. The winner picks a point on the battlefield within 3\" of that model. Inflict D3 mortal damage on each unit (friendly and enemy) within 3\" of that point that has a lower Health characteristic than that model.`,\r\n        when: [DURING_GAME],\r\n      },\r\n    ],\r\n  },\r\n} satisfies TItemDescriptions\r\n\r\nexport default tagAs(Units, 'unit')\r\n","import { TRuleSources } from 'meta/rule_sources'\r\n\r\nconst rule_sources = {\r\n  BATTLETOME_STORMCAST_ETERNALS: {\r\n    name: 'Battletome: Stormcast Eternals (2021)',\r\n    type: 'battletome',\r\n  },\r\n  ERRATA_OCTOBER_2021: {\r\n    name: 'Errata (October 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/3F3KApyA8t95NC7g.pdf',\r\n  },\r\n  ERRATA_DECEMBER_2021: {\r\n    name: 'Errata (December 2021)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/S5aRxVeqC9NTilRc.pdf',\r\n  },\r\n  ERRATA_JULY_2022: {\r\n    name: 'Errata (July 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/K12650xacakOrNCt.pdf',\r\n  },\r\n  ERRATA_OCTOBER_2022: {\r\n    name: 'Errata (October 2022)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/y8MJra9HoDU6VlqR.pdf',\r\n  },\r\n  ERRATA_APRIL_2023: {\r\n    name: 'Errata (April 2023)',\r\n    type: 'errata',\r\n    url: 'https://www.warhammer-community.com/wp-content/uploads/2019/10/eGLbgZceSvG1dJnx.pdf',\r\n  },\r\n} satisfies TRuleSources\r\n\r\nexport default rule_sources\r\n","import { entryKeyToSelectionsKey, TEntry, TEntryProperties, TTurnAction } from 'types/data'\r\n\r\nconst isSelectionKey = (val: string): val is TEntryProperties => !!val && !!entryKeyToSelectionsKey[val]\r\n\r\n/**\r\n * This utility helps extract a given tag from an entry\r\n *\r\n * Useful for figuring out if something is a command_ability, spell, etc.\r\n *\r\n * @example\r\n *\r\n * const tag = getTagFromEntry({ name: 'A Name', effects: [], spell: true })\r\n * // returns \"spell\"\r\n *\r\n *\r\n * @param entry\r\n * @returns string\r\n */\r\nexport const getTagFromEntry = (entry: TEntry | TTurnAction): TEntryProperties | undefined => {\r\n  let tag = ''\r\n  Object.keys(entryKeyToSelectionsKey).forEach(k => {\r\n    if (tag) return\r\n    if (entry?.[k] === true) tag = k\r\n  })\r\n\r\n  return isSelectionKey(tag) ? tag : undefined\r\n}\r\n","import { useTheme } from 'context/useTheme'\r\nimport React from 'react'\r\nimport { centerContentClass } from 'theme/helperClasses'\r\n\r\ntype ButtonProps = React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>\r\n\r\nconst GenericButton = ({ children, ...props }: React.PropsWithChildren<ButtonProps>) => {\r\n  const { theme } = useTheme()\r\n\r\n  return (\r\n    <button type=\"button\" className={theme.genericButtonBlock} {...props}>\r\n      <div className={centerContentClass}>{children}</div>\r\n    </button>\r\n  )\r\n}\r\n\r\nexport default GenericButton\r\n","import React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport { logEvent } from 'utils/analytics'\r\n\r\ninterface IAppStatusProvider {\r\n  isGameMode: boolean\r\n  isOffline: boolean\r\n  isOnline: boolean\r\n  hasNewContent: boolean\r\n  toggleGameMode: () => void\r\n}\r\n\r\nconst timeout = (ms: number, promise: Promise<any>) => {\r\n  return new Promise(function (resolve, reject) {\r\n    setTimeout(function () {\r\n      reject(new Error('timeout'))\r\n    }, ms)\r\n    promise.then(resolve, reject)\r\n  })\r\n}\r\n\r\nconst AppStatusContext = React.createContext<IAppStatusProvider | void>(undefined)\r\n\r\nconst AppStatusProvider = ({ children }: React.PropsWithChildren<{}>) => {\r\n  const [isGameMode, setIsGameMode] = useState(false)\r\n  const [isOffline, setIsOffline] = useState(false)\r\n  const [hasNewContent, setHasNewContent] = useState(false)\r\n\r\n  const toggleGameMode = useCallback(() => {\r\n    logEvent(`ToggleGameMode-${isGameMode ? 'Off' : 'On'}`)\r\n    setIsGameMode(!isGameMode)\r\n  }, [isGameMode])\r\n\r\n  const setOffline = () => {\r\n    console.log('App is running in offline mode.')\r\n    setIsOffline(true)\r\n  }\r\n\r\n  const setContent = () => {\r\n    console.log(\r\n      'New content is available and will be used when all tabs for this page are closed. See https://create-react-app.dev/docs/making-a-progressive-web-app/#offline-first-considerations.'\r\n    )\r\n    setHasNewContent(true)\r\n  }\r\n\r\n  useEffect(() => {\r\n    let updateChannel: BroadcastChannel | null = null\r\n    // Broadcastchannel is not supported in IE, Edge, or Safari\r\n    if (typeof BroadcastChannel !== 'undefined') {\r\n      updateChannel = new BroadcastChannel('app-update')\r\n      updateChannel.addEventListener('message', setContent)\r\n    }\r\n    window.addEventListener('isOffline', setOffline)\r\n    window.addEventListener('hasNewContent', setContent)\r\n\r\n    const poll = async () => {\r\n      try {\r\n        await timeout(\r\n          10000,\r\n          fetch('https://google.com', {\r\n            method: 'GET',\r\n            mode: 'no-cors',\r\n            headers: { 'Access-Control-Allow-Origin': '*' },\r\n          })\r\n        )\r\n      } catch (error) {\r\n        if (!isOffline) setOffline()\r\n      }\r\n    }\r\n\r\n    poll() // See if we're on the Internet\r\n\r\n    return () => {\r\n      window.removeEventListener('isOffline', setOffline)\r\n      window.removeEventListener('hasNewContent', setContent)\r\n      if (updateChannel) updateChannel.removeEventListener('message', setContent)\r\n    }\r\n  })\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      isGameMode,\r\n      isOffline,\r\n      isOnline: !isOffline,\r\n      hasNewContent,\r\n      toggleGameMode,\r\n    }),\r\n    [isGameMode, isOffline, hasNewContent, toggleGameMode]\r\n  )\r\n\r\n  return <AppStatusContext.Provider value={value}>{children}</AppStatusContext.Provider>\r\n}\r\n\r\nconst useAppStatus = () => {\r\n  const context = React.useContext(AppStatusContext)\r\n  if (context === undefined) {\r\n    throw new Error('useAppStatus must be used within a AppStatusProvider')\r\n  }\r\n  return context\r\n}\r\n\r\nexport { AppStatusProvider, useAppStatus }\r\n","import { sortBy, sortedUniqBy, without } from 'lodash'\r\nimport { CHAOS, DEATH, DESTRUCTION, ORDER, TGrandAlliances } from 'meta/alliances'\r\nimport {\r\n  // JS CHAOS_GRAND_ALLIANCE,\r\n  DEATH_GRAND_ALLIANCE,\r\n  DESTRUCTION_GRAND_ALLIANCE,\r\n  KHARADRON_OVERLORDS,\r\n  ORDER_GRAND_ALLIANCE,\r\n  TSupportedFaction,\r\n} from 'meta/factions'\r\nimport { getFactionList } from 'meta/faction_list'\r\nimport { TEntry, upperToLowerLookup } from 'types/data'\r\n\r\n/**\r\n * Gets all items associated with this grand alliance\r\n * @param grandAlliance\r\n * @param type\r\n */\r\nexport const getAllianceItems = (\r\n  grandAlliance: TGrandAlliances,\r\n  type: keyof typeof upperToLowerLookup,\r\n  originalEntries: TEntry[] = []\r\n): TEntry[] => {\r\n  const factionName = {\r\n    // JS [CHAOS]: CHAOS_GRAND_ALLIANCE,\r\n    [DEATH]: DEATH_GRAND_ALLIANCE,\r\n    [DESTRUCTION]: DESTRUCTION_GRAND_ALLIANCE,\r\n    [ORDER]: ORDER_GRAND_ALLIANCE,\r\n  }[grandAlliance]\r\n\r\n  const FactionList = getFactionList()\r\n\r\n  const allianceItems = without(Object.keys(FactionList), factionName).reduce((a, k) => {\r\n    let faction = k as TSupportedFaction\r\n\r\n    // Skip on these conditions\r\n    if (!FactionList?.[faction] || FactionList[faction].GrandAlliance !== grandAlliance) {\r\n      return a\r\n    }\r\n\r\n    const _values = FactionList[faction].AggregateArmy?.[type]\r\n    if (_values) a = a.concat(..._values)\r\n\r\n    return a\r\n  }, [] as TEntry[])\r\n\r\n  return sortedUniqBy(sortBy(allianceItems.concat(originalEntries), 'name'), 'name')\r\n}\r\n\r\n/**\r\n * Used for KO, since they can take ANY endless spell in the game now\r\n */\r\nconst getAllEndlessSpells = (): TEntry[] => {\r\n  return [\r\n    ...getAllianceItems(CHAOS, 'EndlessSpells', []),\r\n    ...getAllianceItems(DEATH, 'EndlessSpells', []),\r\n    ...getAllianceItems(DESTRUCTION, 'EndlessSpells', []),\r\n    ...getAllianceItems(ORDER, 'EndlessSpells', []),\r\n  ]\r\n}\r\n\r\nexport const getGrandAllianceEndlessSpells = (\r\n  grandAlliance: TGrandAlliances,\r\n  originalEntries: TEntry[] = [],\r\n  factionName: TSupportedFaction\r\n): TEntry[] => {\r\n  if (factionName === KHARADRON_OVERLORDS) {\r\n    return getAllEndlessSpells()\r\n  } else {\r\n    return getAllianceItems(grandAlliance, 'EndlessSpells', originalEntries)\r\n  }\r\n}\r\n","import { mergeParentEffectObjs } from 'factions/temporaryAdapter'\r\nimport { isString, sortBy, uniqBy } from 'lodash'\r\nimport { IArmy, TCollection, TInitialArmy } from 'types/army'\r\nimport { entryKeyToSelectionsKey, lowerToUpperLookup, TEffects, TEntry } from 'types/data'\r\nimport { getTagFromEntry } from 'utils/getTag'\r\n\r\n/**\r\n * There are spells/artifacts/etc that only occur if a certain\r\n * allegiance/battalion/unit is selected. We want to make sure\r\n * that those are represented in the dropdowns.\r\n * @param army\r\n */\r\nexport const getCollection = (army: TInitialArmy): TCollection => {\r\n  const Collection: TCollection = {\r\n    Artifacts: [],\r\n    Battalions: [],\r\n    BattleTactics: [],\r\n    CommandAbilities: [],\r\n    CommandTraits: [],\r\n    CoreRules: [],\r\n    EndlessSpells: [],\r\n    Flavors: [],\r\n    GrandStrategies: [],\r\n    Incarnates: [],\r\n    MonstrousRampages: [],\r\n    MountTraits: [],\r\n    Prayers: [],\r\n    Scenery: [],\r\n    Spells: [],\r\n    Triumphs: [],\r\n    Units: [],\r\n    Manifestations: [],\r\n  }\r\n\r\n  if (!army) return Collection\r\n\r\n  // Brute force it\r\n  const types = [\r\n    army.AlliedUnits || [],\r\n    army.Artifacts || [],\r\n    army.Battalions || [],\r\n    army.BattleTactics || [],\r\n    army.CommandAbilities || [],\r\n    army.CommandTraits || [],\r\n    army.CoreRules || [],\r\n    army.EndlessSpells || [],\r\n    army.Flavors || [],\r\n    army.GrandStrategies || [],\r\n    army.Incarnates || [],\r\n    army.MonstrousRampages || [],\r\n    army.MountTraits || [],\r\n    army.Prayers || [],\r\n    army.Scenery || [],\r\n    army.Spells || [],\r\n    army.Triumphs || [],\r\n    army.Units || [],\r\n    army.Manifestations || [],\r\n  ]\r\n\r\n  // Go through each thing and get spells, artifacts, etc that are unusual\r\n  // TODO: Get rid of this?\r\n  // Might need to keep it as a backup in case people don't use the new data structure correctly\r\n  types.forEach(items =>\r\n    items?.forEach(item => {\r\n      item.effects.forEach(effect => checkEffects(effect, Collection))\r\n    })\r\n  )\r\n\r\n  // This is now our preferred way of checking for side effects/mandatory items\r\n  const checkForMandatoryItems = (entry?: TEntry): void => {\r\n    if (!entry?.mandatory) return\r\n\r\n    Object.keys(entry.mandatory).forEach(sliceKey => {\r\n      const slice = entry?.mandatory?.[sliceKey as keyof TEntry]\r\n      if (!slice || !slice.length) return\r\n\r\n      const mergedEntries = mergeParentEffectObjs(slice)\r\n\r\n      mergedEntries.forEach(_entry => {\r\n        const { effects } = _entry as TEntry\r\n        const _tag = getTagFromEntry(_entry)\r\n        const upperSlice = isString(slice)\r\n          ? lowerToUpperLookup[slice]\r\n          : !!_tag\r\n          ? lowerToUpperLookup[entryKeyToSelectionsKey[_tag]]\r\n          : undefined\r\n\r\n        effects.forEach(effect => checkEffects(effect, Collection, upperSlice))\r\n      })\r\n    })\r\n  }\r\n\r\n  // Check the subfaction, and then each group of items beneath it\r\n  checkForMandatoryItems(army.SubFaction)\r\n  types.forEach(x => x?.forEach(checkForMandatoryItems))\r\n\r\n  return {\r\n    Artifacts: sortBy(Collection.Artifacts, 'name'),\r\n    Battalions: sortBy(Collection.Battalions, 'name'),\r\n    BattleTactics: sortBy(Collection.BattleTactics, 'name'),\r\n    CommandAbilities: sortBy(Collection.CommandAbilities, 'name'),\r\n    CommandTraits: sortBy(Collection.CommandTraits, 'name'),\r\n    CoreRules: sortBy(Collection.CoreRules, 'name'),\r\n    EndlessSpells: sortBy(Collection.EndlessSpells, 'name'),\r\n    Flavors: sortBy(Collection.Flavors, 'name'),\r\n    GrandStrategies: sortBy(Collection.GrandStrategies, 'name'),\r\n    Incarnates: sortBy(Collection.Incarnates, 'name'),\r\n    MonstrousRampages: sortBy(Collection.MonstrousRampages, 'name'),\r\n    MountTraits: sortBy(Collection.MountTraits, 'name'),\r\n    Prayers: sortBy(Collection.Prayers, 'name'),\r\n    Scenery: sortBy(Collection.Scenery, 'name'),\r\n    Spells: sortBy(Collection.Spells, 'name'),\r\n    Triumphs: sortBy(Collection.Triumphs, 'name'),\r\n    Units: sortBy(Collection.Units, 'name'),\r\n    Manifestations: sortBy(Collection.Manifestations, 'name'),\r\n  }\r\n}\r\n\r\nconst checkEffects = (effect: TEffects, Collection: TCollection, forceKey?: keyof IArmy) => {\r\n  let stopped = false\r\n\r\n  Object.entries(lowerToUpperLookup).forEach(([key, value]) => {\r\n    if (stopped || !effect[key]) return\r\n    addToCollection(effect, Collection[value])\r\n    stopped = true\r\n  })\r\n\r\n  // We can't trust \"Units\" - this will cause a bug if you remove this check.\r\n  if (!stopped && forceKey && forceKey !== 'Units') {\r\n    addToCollection(effect, Collection[forceKey])\r\n  }\r\n}\r\n\r\nconst addToCollection = (effect: TEffects, collection: TEntry[] = []): void => {\r\n  const existingIdx = collection.findIndex(x => x.name === effect.name)\r\n  if (existingIdx > -1) {\r\n    const existingEntry = { ...collection[existingIdx] }\r\n    const effects = uniqBy([...existingEntry.effects, effect], 'name')\r\n    collection[existingIdx] = { ...existingEntry, effects }\r\n  } else {\r\n    collection.push(effectToEntry(effect))\r\n  }\r\n}\r\n\r\nconst effectToEntry = (effect: TEffects): TEntry => {\r\n  return {\r\n    name: effect.name,\r\n    effects: [effect],\r\n    isSideEffect: true,\r\n  }\r\n}\r\n","import { ChaosFaction, DeathFaction, DestructionFaction, OrderFaction } from 'factions/grand_alliances'\r\nimport { CHAOS, DEATH, DESTRUCTION, ORDER, TGrandAlliances } from 'meta/alliances'\r\nimport { IArmy } from 'types/army'\r\n\r\ntype IGrandAllianceConfig = Record<TGrandAlliances, Pick<IArmy, 'Artifacts' | 'CommandTraits' | 'Units'>>\r\n\r\nexport const GrandAllianceConfig: IGrandAllianceConfig = {\r\n  [CHAOS]: {\r\n    Artifacts: ChaosFaction.AggregateArmy.Artifacts,\r\n    CommandTraits: ChaosFaction.AggregateArmy.CommandTraits,\r\n    Units: ChaosFaction.AggregateArmy.Units,\r\n  },\r\n  [DEATH]: {\r\n    Artifacts: DeathFaction.AggregateArmy.Artifacts,\r\n    CommandTraits: DeathFaction.AggregateArmy.CommandTraits,\r\n    Units: DeathFaction.AggregateArmy.Units,\r\n  },\r\n  [DESTRUCTION]: {\r\n    Artifacts: DestructionFaction.AggregateArmy.Artifacts,\r\n    CommandTraits: DestructionFaction.AggregateArmy.CommandTraits,\r\n    Units: DestructionFaction.AggregateArmy.Units,\r\n  },\r\n  [ORDER]: {\r\n    Artifacts: OrderFaction.AggregateArmy.Artifacts,\r\n    CommandTraits: OrderFaction.AggregateArmy.CommandTraits,\r\n    Units: OrderFaction.AggregateArmy.Units,\r\n  },\r\n}\r\n","import {\r\n  AvailableChaosUnits,\r\n  AvailableDeathUnits,\r\n  AvailableDestructionUnits,\r\n  AvailableOrderUnits,\r\n} from 'factions/grand_alliances'\r\nimport {\r\n  CoreBattalions,\r\n  GenericArtifacts,\r\n  GenericCommandAbilities,\r\n  GenericCommandTraits,\r\n  GenericEndlessSpells,\r\n  GenericGrandStrategies,\r\n  GenericIncarnates,\r\n  GenericMonstrousRampages,\r\n  GenericPrayers,\r\n  GenericScenery,\r\n  GenericSpells,\r\n  GenericTriumphs,\r\n  GenericManifestations,\r\n} from 'generic_rules'\r\nimport { sortBy, uniqBy } from 'lodash'\r\nimport { CHAOS, DEATH, DESTRUCTION, ORDER, TGrandAlliances } from 'meta/alliances'\r\nimport { TCollection } from 'types/army'\r\nimport { TEntry } from 'types/data'\r\nimport { GrandAllianceConfig } from 'utils/getArmy/grandAllianceConfig'\r\n\r\nconst modifyFlavors = (flavors: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(sortBy(flavors.concat(Collection.Flavors), 'name'), 'name')\r\n}\r\nconst modifyBattalions = (battalions: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(CoreBattalions, 'name')\r\n      .concat(sortBy(battalions.concat(Collection.Battalions), 'name'))\r\n      .map(u => ({ ...u, battalion: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyBattleTactics = (battle_tactics: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(battle_tactics.concat(Collection.BattleTactics), 'name').map(u => ({ ...u, battle_tactic: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyUnits = (\r\n  units: TEntry[],\r\n  alliedUnits: TEntry[],\r\n  alliance: TGrandAlliances,\r\n  Collection: TCollection\r\n): TEntry[] => {\r\n  const GrandAllianceUnits: TEntry[] = {\r\n    [CHAOS]: AvailableChaosUnits,\r\n    [DEATH]: AvailableDeathUnits,\r\n    [DESTRUCTION]: AvailableDestructionUnits,\r\n    [ORDER]: AvailableOrderUnits,\r\n  }[alliance]\r\n\r\n  return uniqBy(\r\n    sortBy(units.concat(Collection.Units), 'name')\r\n      .concat(sortBy(alliedUnits, 'name'))\r\n      .concat(sortBy(GrandAllianceUnits, 'name'))\r\n      .map(u => ({ ...u, unit: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyArtifacts = (\r\n  artifacts: TEntry[],\r\n  alliance: TGrandAlliances,\r\n  Collection: TCollection\r\n): TEntry[] => {\r\n  const { Artifacts } = GrandAllianceConfig[alliance]\r\n  return uniqBy(\r\n    sortBy(artifacts.concat(Collection.Artifacts), 'name')\r\n      .concat(sortBy(GenericArtifacts, 'name'))\r\n      .concat(sortBy(Artifacts, 'name'))\r\n      .map(a => ({ ...a, artifact: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyCommandTraits = (\r\n  command_traits: TEntry[],\r\n  alliance: TGrandAlliances,\r\n  Collection: TCollection\r\n): TEntry[] => {\r\n  const { CommandTraits } = GrandAllianceConfig[alliance]\r\n  return uniqBy(\r\n    sortBy(command_traits.concat(Collection.CommandTraits), 'name')\r\n      .concat(sortBy(GenericCommandTraits, 'name'))\r\n      .concat(sortBy(CommandTraits, 'name'))\r\n      .map(t => ({ ...t, command_trait: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyCoreRules = (core_rules: TEntry[]): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(core_rules, 'name').map(t => ({ ...t, core_rule: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyMonstrousRampages = (monstrous_rampages: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(monstrous_rampages.concat(Collection.MonstrousRampages), 'name')\r\n      .concat(sortBy(GenericMonstrousRampages, 'name'))\r\n      .map(t => ({ ...t, monstrous_rampage: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyMountTraits = (mount_traits: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(mount_traits.concat(Collection.MountTraits), 'name').map(t => ({ ...t, mount_trait: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyCommandAbilities = (command_abilities: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(command_abilities.concat(Collection.CommandAbilities), 'name')\r\n      .concat(sortBy(GenericCommandAbilities, 'name'))\r\n      .map(c => ({ ...c, command_ability: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyTriumphs = (triumphs: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(triumphs, 'name')\r\n      .concat(sortBy(GenericTriumphs.concat(Collection.Triumphs), 'name'))\r\n      .map(t => ({ ...t, triumph: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyGrandStrategies = (grand_strategies: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(grand_strategies, 'name')\r\n      .concat(sortBy(GenericGrandStrategies.concat(Collection.GrandStrategies), 'name'))\r\n      .map(t => ({ ...t, grand_strategy: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifySpells = (spells: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(spells.concat(Collection.Spells), 'name')\r\n      .concat(sortBy(GenericSpells, 'name'))\r\n      .map(s => ({ ...s, spell: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyManifestations = (manifestations: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(manifestations.concat(Collection.Manifestations), 'name')\r\n      .concat(sortBy(GenericManifestations, 'name'))\r\n      .map(s => ({ ...s, manifestations: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyPrayers = (prayers: TEntry[], Collection: TCollection): TEntry[] => {\r\n  const Prayers = prayers.concat(Collection.Prayers)\r\n  return uniqBy(\r\n    sortBy(Prayers, 'name')\r\n      .concat(sortBy(GenericPrayers, 'name'))\r\n      .map(s => ({ ...s, prayer: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyScenery = (scenery: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return sortBy(scenery.concat(Collection.Scenery), 'name')\r\n    .concat(sortBy(GenericScenery, 'name'))\r\n    .map(s => ({ ...s, scenery: true }))\r\n}\r\n\r\nconst modifyEndlessSpells = (\r\n  endless_spells: TEntry[],\r\n  grandAllianceEndlessSpells: TEntry[],\r\n  Collection: TCollection\r\n): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(endless_spells.concat(Collection.EndlessSpells), 'name')\r\n      .concat(sortBy(grandAllianceEndlessSpells, 'name'))\r\n      .concat(sortBy(GenericEndlessSpells, 'name'))\r\n      .map(e => ({ ...e, endless_spell: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nconst modifyIncarnates = (incarnates: TEntry[], Collection: TCollection): TEntry[] => {\r\n  return uniqBy(\r\n    sortBy(incarnates.concat(Collection.Incarnates), 'name')\r\n      .concat(sortBy(GenericIncarnates, 'name'))\r\n      .map(t => ({ ...t, incarnate: true })),\r\n    'name'\r\n  )\r\n}\r\n\r\nexport const modify = {\r\n  Artifacts: modifyArtifacts,\r\n  Battalions: modifyBattalions,\r\n  BattleTactics: modifyBattleTactics,\r\n  CommandAbilities: modifyCommandAbilities,\r\n  CommandTraits: modifyCommandTraits,\r\n  CoreRules: modifyCoreRules,\r\n  EndlessSpells: modifyEndlessSpells,\r\n  Flavors: modifyFlavors,\r\n  GrandStrategies: modifyGrandStrategies,\r\n  Incarnates: modifyIncarnates,\r\n  MonstrousRampages: modifyMonstrousRampages,\r\n  MountTraits: modifyMountTraits,\r\n  Prayers: modifyPrayers,\r\n  Scenery: modifyScenery,\r\n  Spells: modifySpells,\r\n  Triumphs: modifyTriumphs,\r\n  Units: modifyUnits,\r\n  Manifestations: modifyManifestations,\r\n}\r\n","import { flatten } from 'lodash'\r\nimport { Game, TGameStructure } from 'meta/game_structure'\r\nimport { ENTRY_PROPERTIES, TEffects, TEntry, TTurnAction } from 'types/data'\r\nimport { TTurnWhen } from 'types/phases'\r\nimport { hashReminder } from 'utils/reminderUtils'\r\n\r\nexport const processGame = (allEntries: TEntry[][]): TGameStructure => {\r\n  const entries = flatten(allEntries)\r\n\r\n  return entries.reduce(\r\n    (game, entry: TEntry) => {\r\n      const withEntry = addProps(entry)\r\n      entry.effects.forEach(effect => {\r\n        effect.when.forEach(phase => {\r\n          const action = withEntry(effect, phase)\r\n          game[phase] = game[phase] ? game[phase].concat(action) : [action]\r\n        })\r\n      })\r\n      return game\r\n    },\r\n    { ...Game } as TGameStructure\r\n  )\r\n}\r\n\r\n/**\r\n * Using this function, we avoid attaching two or more Props to an action\r\n * @param entry\r\n * @param effect\r\n */\r\nconst addProps = (entry: TEntry) => {\r\n  // Figure out if an entry key is true and store it for now\r\n  const entryProp = ENTRY_PROPERTIES.find(k => entry[k] === true)\r\n\r\n  return (effect: TEffects, when: TTurnWhen): TTurnAction => {\r\n    const action: TTurnAction = {\r\n      id: hashReminder(when, effect.name, effect.desc),\r\n      condition: [entry.name],\r\n      name: effect.name,\r\n      desc: effect.desc,\r\n      rule_sources: effect.rule_sources,\r\n      when,\r\n    }\r\n\r\n    // Figure out if an effects key is true\r\n    const effectProp = ENTRY_PROPERTIES.find(k => effect[k] === true)\r\n    if (effectProp) {\r\n      return {\r\n        ...action,\r\n        [effectProp]: true,\r\n      }\r\n    }\r\n\r\n    // It's probably a unit or battalion if there's no entryProp\r\n    if (!entryProp) return action\r\n\r\n    // Add the entryProp and return\r\n    return {\r\n      ...action,\r\n      [entryProp]: true,\r\n    }\r\n  }\r\n}\r\n","import { CoreRules } from 'generic_rules'\r\nimport produce from 'immer'\r\nimport { GRAND_ALLIANCE_FACTIONS, TGrandAllianceFactions, TGrandAlliances } from 'meta/alliances'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport { getFactionFromList } from 'meta/faction_list'\r\nimport { IArmy, TCollection, TSubfactionArmy } from 'types/army'\r\nimport { RealmscapesEnum } from 'types/realmscapes'\r\nimport { isValidFactionName } from 'utils/armyUtils'\r\nimport { isDev } from 'utils/env'\r\nimport { getAllianceItems, getGrandAllianceEndlessSpells } from 'utils/getArmy/getAllianceItems'\r\nimport { getCollection } from 'utils/getArmy/getCollection'\r\nimport { modify } from 'utils/getArmy/modify'\r\nimport { processGame } from 'utils/processGame'\r\n\r\n/**\r\n *\r\n * @param factionName\r\n * @param subFactionName - If null, returns AggregateArmy\r\n * @param originRealm\r\n * @param realmscape\r\n */\r\nexport const getArmy = (\r\n  factionName: TSupportedFaction | null,\r\n  subFactionName: string | null = null,\r\n  originRealm: RealmscapesEnum | null = null,\r\n  realmscape: RealmscapesEnum | null = null\r\n): IArmy | null => {\r\n  if (!isValidFactionName(factionName)) return null\r\n\r\n  const { GrandAlliance, subFactionArmies, AggregateArmy } = getFactionFromList(factionName)\r\n\r\n  if (isDev && subFactionName && !subFactionArmies[subFactionName]) {\r\n    console.warn(`Invalid subFactionName: '${subFactionName}'. Please fix this.`)\r\n    debugger // If you've arrived here (as a dev), you need to fix the above error - no excuses.\r\n  }\r\n\r\n  const Army: TSubfactionArmy = (subFactionName && subFactionArmies?.[subFactionName]) || AggregateArmy\r\n\r\n  const Collection = getCollection(Army)\r\n\r\n  const army = modifyArmy(Army, {\r\n    Collection,\r\n    factionName,\r\n    GrandAlliance,\r\n    originRealm,\r\n    realmscape,\r\n  })\r\n\r\n  return army as unknown as IArmy\r\n}\r\n\r\ninterface IModifyArmyMeta {\r\n  Collection: TCollection\r\n  factionName: TSupportedFaction\r\n  GrandAlliance: TGrandAlliances\r\n  originRealm: RealmscapesEnum | null\r\n  realmscape: RealmscapesEnum | null\r\n}\r\n\r\nconst modifyArmy = produce((Army: TSubfactionArmy, meta: IModifyArmyMeta) => {\r\n  let {\r\n    AlliedUnits = [],\r\n    Artifacts = [],\r\n    Battalions = [],\r\n    BattleTactics = [],\r\n    CommandAbilities = [],\r\n    CommandTraits = [],\r\n    EndlessSpells = [],\r\n    Flavors = [],\r\n    GrandStrategies = [],\r\n    Incarnates = [],\r\n    MonstrousRampages = [],\r\n    MountTraits = [],\r\n    Prayers = [],\r\n    Scenery = [],\r\n    Spells = [],\r\n    Triumphs = [],\r\n    Units = [],\r\n    Manifestations = [],\r\n  } = Army\r\n  const { GrandAlliance, Collection, factionName } = meta\r\n\r\n  // TODO: Make sure this works\r\n  const GrandAllianceEndlessSpells = getGrandAllianceEndlessSpells(GrandAlliance, EndlessSpells, factionName)\r\n\r\n  if (GRAND_ALLIANCE_FACTIONS.includes(factionName as TGrandAllianceFactions)) {\r\n    // TODO: Make sure all of this works\r\n    Artifacts = getAllianceItems(GrandAlliance, 'Artifacts', Artifacts)\r\n    Battalions = getAllianceItems(GrandAlliance, 'Battalions', Battalions)\r\n    CommandAbilities = getAllianceItems(GrandAlliance, 'CommandAbilities', CommandAbilities)\r\n    CommandTraits = getAllianceItems(GrandAlliance, 'CommandTraits', CommandTraits)\r\n    EndlessSpells = GrandAllianceEndlessSpells\r\n    MonstrousRampages = getAllianceItems(GrandAlliance, 'MonstrousRampages', MonstrousRampages)\r\n    MountTraits = getAllianceItems(GrandAlliance, 'MountTraits', MountTraits) // new\r\n    Prayers = getAllianceItems(GrandAlliance, 'Prayers', Prayers) // new\r\n    Spells = getAllianceItems(GrandAlliance, 'Spells', Spells)\r\n    Units = getAllianceItems(GrandAlliance, 'Units', Units)\r\n    Manifestations = getAllianceItems(GrandAlliance, 'Manifestations')\r\n  }\r\n\r\n  Army.Artifacts = modify.Artifacts(Artifacts, GrandAlliance, Collection)\r\n  Army.Battalions = modify.Battalions(Battalions, Collection)\r\n  Army.BattleTactics = modify.BattleTactics(BattleTactics, Collection)\r\n  Army.CommandAbilities = modify.CommandAbilities(CommandAbilities, Collection)\r\n  Army.CommandTraits = modify.CommandTraits(CommandTraits, GrandAlliance, Collection)\r\n  Army.CoreRules = modify.CoreRules(CoreRules)\r\n  Army.EndlessSpells = modify.EndlessSpells(EndlessSpells, GrandAllianceEndlessSpells, Collection)\r\n  Army.Flavors = modify.Flavors(Flavors, Collection)\r\n  Army.GrandStrategies = modify.GrandStrategies(GrandStrategies, Collection)\r\n  Army.Incarnates = modify.Incarnates(Incarnates, Collection)\r\n  Army.MonstrousRampages = modify.MonstrousRampages(MonstrousRampages, Collection)\r\n  Army.MountTraits = modify.MountTraits(MountTraits, Collection)\r\n  Army.Prayers = modify.Prayers(Prayers, Collection)\r\n  Army.Scenery = modify.Scenery(Scenery, Collection)\r\n  Army.Spells = modify.Spells(Spells, Collection)\r\n  Army.Triumphs = modify.Triumphs(Triumphs, Collection)\r\n  Army.Units = modify.Units(Units, AlliedUnits, GrandAlliance, Collection)\r\n  Army.Manifestations = modify.Manifestations(Manifestations, Collection)\r\n\r\n  // @ts-expect-error\r\n  Army.Game = processGame([\r\n    Army.Artifacts,\r\n    Army.Battalions,\r\n    Army.BattleTactics,\r\n    Army.CommandAbilities,\r\n    Army.CommandTraits,\r\n    Army.CoreRules,\r\n    Army.EndlessSpells,\r\n    Army.Flavors,\r\n    Army.GrandStrategies,\r\n    Army.Incarnates,\r\n    Army.MonstrousRampages,\r\n    Army.MountTraits,\r\n    Army.Prayers,\r\n    Army.Scenery,\r\n    Army.Spells,\r\n    Army.Triumphs,\r\n    Army.Units,\r\n    Army.Manifestations\r\n  ])\r\n\r\n  return Army\r\n})\r\n"],"sourceRoot":""}