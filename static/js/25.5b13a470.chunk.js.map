{"version":3,"sources":["components/modals/generic/generic_modal.tsx","components/modals/generic/generic_two_button_modal.tsx","utils/reorder.ts","types/pdf.ts","components/modals/download_pdf_modal.tsx","utils/pdf/generate/layouts/layoutUtils.ts","utils/pdf/generate/logo.ts","utils/pdf/generate/layouts/compact.ts","utils/pdf/generate/layouts/default.ts","components/print/pdfButton.tsx","utils/pdf/generate/generatePdf.ts"],"names":["Modal","setAppElement","GenericModal","props","children","closeModal","isOpen","label","isProcessing","isDark","useTheme","modalClassName","concat","_jsx","className","contentLabel","onRequestClose","overlayClassName","_jsxs","ModalSpinner","hidden","_ref","variant","Spinner","size","GenericTwoButtonModal","theme","setIsProcessing","useState","bodyText","confirmBtnClass","modalDangerClass","confirmText","denyBtnClass","modalConfirmClass","denyText","disableConfirmIcon","headerText","onConfirm","onConfirmAsync","onDeny","ConfirmIcon","confirmIcon","FaCheck","text","GenericButton","onClick","async","e","preventDefault","err","console","error","reorderViaIndex","list","ids","reduce","a","id","entry","find","l","push","reorder","startIndex","endIndex","result","Array","from","removed","splice","reorderReminders","reminders","Object","keys","accum","when","actions","currentIds","sortBy","map","x","storedIds","LocalReminderOrder","getWhen","length","difference","reordered","EMPTY_NOTE_TEXT","DownloadPDFModal","modalIsOpen","factionName","pdf","isOnline","useAppStatus","loadedArmy","useSavedArmies","defaultName","name","armyName","isValidFactionName","titleCase","stripPunctuation","trim","split","join","fileName","setFileName","layout","setLayout","useEffect","handleSaveClick","save","logDownloadEvent","MdFileDownload","htmlFor","placeholder","defaultValue","onKeyDown","key","stopPropagation","onChange","_e$preventDefault","call","target","value","type","checked","CompactPdfLayout","constructor","_type","_doc","_opts","_style","_army","_this","_pages","_pageIdx","_currentPage","this","_pageY","_phases","_phaseHeight","_resetY","yMargin","_willOverrunY","val","pageBottom","_goToNextPage","_addToCurrentPage","obj","position","spacing","_getRuleHeight","rule","sum","y","_getRulesHeight","rules","flat","_getTitle","action","title","getActionTitle","titleStr","_addSpacerToPage","_fullToCol","r","lineW","colTitleLineWidth","colLineWidth","splitTextToSize","_addPhaseToPages_Compact","phase","Cols","full","heightOfAllRules","pop","forEach","line","rule1Height","rule2Height","halfHeight","col0H","col1H","col0IsFull","ri","ruleHeight","remainingRules","slice","remainingRulesHeight","toCol","colRuleHeight","fullRuleHeight","_addPhaseToPages_Default","_ref2","_addArmyTextToPages","armyText","_getArmyText","splitTextToPages","addPhases","getReminderText","notes","Phases","phaseObj","numRulesInPhase","i","ruleObj","isLastRuleAndOdd","titleWidth","maxTitleLineWidth","lineWidth","maxLineWidth","noteLintWidth","maxNoteLineWidth","colNoteLineWidth","addBreak","desc","trimmed","note","linked_hash","content","_getSelections","items","pluralize","arguments","undefined","str","replace","allyFactionNames","allySelections","subFactionName","realmscape","selections","artifacts","battalions","command_abilities","command_traits","endless_spells","flavors","grand_strategies","mount_traits","prayers","scenery","spells","triumphs","units","manifestations","realm","getFactionTitle","getText","selectionText","n","factionTitle","subFactionTitle","suffix","Logo","Styles","army","fontSize","style","armyEnd","armyFooter","break","textColor","spacer","titlespacer","PageOpts","xMargin","saveCompactPdf","data","hiddenReminders","currentArmy","orderedReminders","getVisibleReminders","doc","jsPDF","unit","lineHeight","Layout","CompactPDFLayout","setFont","setTextColor","setProperties","pageWidth","internal","pageSize","getWidth","centerX","pages","page","pageNum","addPage","colY","t","includes","isPhase","isArmy","startsWith","textX","textAlign","textY","setFontSize","setFontStyle","setLineWidth","setDrawColor","roundedRect","lineY","watermarkY","logoW","logoH","addImage","logoSpacer","saveDefaultPdf","PdfLayout","DownloadPDFButton","useGetReminders","saveArmyToS3","isMobile","useWindowSize","useSelector","selectors","selectCurrentArmy","selectReminders","selectNotes","setPdf","setModalIsOpen","handleDownload","useCallback","pdfs","default","compact","_Fragment"],"mappings":"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","file":"static/js/25.5b13a470.chunk.js","sourcesContent":["import Spinner from 'components/helpers/spinner'\r\nimport { useTheme } from 'context/useTheme'\r\nimport React from 'react'\r\nimport Modal from 'react-modal'\r\n\r\ninterface IGenericModalProps {\r\n  isProcessing?: boolean\r\n  isOpen: boolean\r\n  closeModal: () => void\r\n  label: string\r\n}\r\n\r\nModal.setAppElement('#root')\r\n\r\nconst GenericModal = (props: React.PropsWithChildren<IGenericModalProps>) => {\r\n  const { children, closeModal, isOpen, label, isProcessing = false } = props\r\n  const { isDark } = useTheme()\r\n\r\n  const themeType = isDark ? 'Dark' : 'Light'\r\n  const modalClassName = `Modal-${isProcessing ? `Transparent` : themeType}`\r\n\r\n  return (\r\n    <Modal\r\n      className={modalClassName}\r\n      contentLabel={label}\r\n      isOpen={isOpen}\r\n      onRequestClose={closeModal}\r\n      overlayClassName={'Modal-Overlay'}\r\n    >\r\n      <div className={`container`}>\r\n        {isProcessing && <ModalSpinner />}\r\n        <div hidden={isProcessing}>{children}</div>\r\n      </div>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default GenericModal\r\n\r\nconst ModalSpinner = ({ isDark = false }) => {\r\n  const variant = isDark ? 'light-gray' : 'dark'\r\n  return (\r\n    <div className={`d-flex flex-row justify-content-center`}>\r\n      <Spinner variant={variant} size=\"large\" />\r\n    </div>\r\n  )\r\n}\r\n","import GenericButton from 'components/input/generic_button'\r\nimport GenericModal from 'components/modals/generic/generic_modal'\r\nimport { useTheme } from 'context/useTheme'\r\nimport React, { useState } from 'react'\r\nimport { IconType } from 'react-icons'\r\nimport { FaCheck } from 'react-icons/fa'\r\n\r\ninterface IModalComponentProps {\r\n  bodyText?: string\r\n  closeModal: () => any\r\n  confirmIcon?: IconType\r\n  confirmText?: string\r\n  confirmBtnClass?: string\r\n  denyBtnClass?: string\r\n  denyText?: string\r\n  disableConfirmIcon?: boolean\r\n  headerText?: string\r\n  isOpen: boolean\r\n  onConfirm?: () => any\r\n  onConfirmAsync?: () => Promise<any>\r\n  onDeny?: () => any\r\n}\r\n\r\n/**\r\n * A re-usable generic modal component\r\n *\r\n * Ask if we really want to do an action.\r\n *\r\n * @param props\r\n */\r\nconst GenericTwoButtonModal = (props: React.PropsWithChildren<IModalComponentProps>) => {\r\n  const { theme } = useTheme()\r\n  const [isProcessing, setIsProcessing] = useState(false)\r\n\r\n  const {\r\n    bodyText = '',\r\n    children = null,\r\n    closeModal,\r\n    confirmBtnClass = theme.modalDangerClass,\r\n    confirmText = 'Confirm',\r\n    denyBtnClass = theme.modalConfirmClass,\r\n    denyText = 'Cancel',\r\n    disableConfirmIcon = false,\r\n    headerText = '',\r\n    isOpen = false,\r\n    onConfirm = null,\r\n    onConfirmAsync = null,\r\n    onDeny = null,\r\n  } = props\r\n\r\n  const ConfirmIcon = props.confirmIcon || FaCheck\r\n\r\n  const handleConfirm = async (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n\r\n    if (onConfirmAsync) {\r\n      try {\r\n        setIsProcessing(true)\r\n        await onConfirmAsync()\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    }\r\n\r\n    if (onConfirm) onConfirm()\r\n\r\n    closeModal()\r\n  }\r\n\r\n  const handleDeny = async (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n    if (onDeny) onDeny()\r\n    closeModal()\r\n  }\r\n\r\n  return (\r\n    <GenericModal\r\n      isOpen={isOpen}\r\n      isProcessing={isProcessing}\r\n      closeModal={closeModal}\r\n      label={`${headerText} Confirmation Modal`}\r\n    >\r\n      <div className=\"flex-row\">\r\n        <div className={`col ${theme.text} text-center`}>\r\n          <h4 className=\"mb-3\">{headerText}</h4>\r\n          {bodyText && <p className=\"mb-3\">{bodyText}</p>}\r\n          {children ? <div className={`mb-3`}>{children}</div> : null}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"d-flex flex-row justify-content-around\">\r\n        <GenericButton className={confirmBtnClass} onClick={handleConfirm}>\r\n          {!disableConfirmIcon && <ConfirmIcon className=\"mr-2\" />} {confirmText}\r\n        </GenericButton>\r\n        <GenericButton className={denyBtnClass} onClick={handleDeny}>\r\n          {denyText}\r\n        </GenericButton>\r\n      </div>\r\n    </GenericModal>\r\n  )\r\n}\r\n\r\nexport default GenericTwoButtonModal\r\n","import { difference, sortBy } from 'lodash'\r\nimport { IReminder } from 'types/data'\r\nimport { TTurnWhen } from 'types/phases'\r\nimport { LocalReminderOrder } from 'utils/localStore'\r\n\r\ninterface WithId {\r\n  id: string\r\n}\r\n\r\nexport const reorderViaIndex = <T extends WithId>(list: T[], ids: string[]) => {\r\n  return ids.reduce((a, id) => {\r\n    const entry = list.find(l => l.id && l.id === id)\r\n    if (entry) a.push(entry)\r\n    return a\r\n  }, [] as T[])\r\n}\r\n\r\n// Used for drag and drop by react-beautiful-dnd\r\nexport const reorder = <T>(list: T[], startIndex: number, endIndex: number) => {\r\n  const result = Array.from(list)\r\n  const [removed] = result.splice(startIndex, 1)\r\n  result.splice(endIndex, 0, removed)\r\n\r\n  return result\r\n}\r\n\r\nexport const reorderReminders = (reminders: IReminder): IReminder => {\r\n  return Object.keys(reminders).reduce((accum, when) => {\r\n    const actions = reminders[when]\r\n    const currentIds = sortBy(actions.map(x => x.id))\r\n    const storedIds = LocalReminderOrder.getWhen(when as TTurnWhen)\r\n\r\n    if (storedIds.length > 0 && difference(currentIds, sortBy(storedIds)).length === 0) {\r\n      const reordered = reorderViaIndex(actions, storedIds)\r\n      accum[when] = reordered\r\n    } else {\r\n      accum[when] = actions\r\n    }\r\n\r\n    return accum\r\n  }, {} as IReminder)\r\n}\r\n","import { ICurrentArmy } from 'types/army'\r\nimport { IReminder } from 'types/data'\r\nimport { INote } from 'types/notes'\r\n\r\nexport const EMPTY_NOTE_TEXT = `Empty note`\r\n\r\ntype TPdfStylePdf =\r\n  | 'army'\r\n  | 'armyEnd'\r\n  | 'armyFooter'\r\n  | 'armyName'\r\n  | 'break'\r\n  | 'desc'\r\n  | 'note'\r\n  | 'phase'\r\n  | 'spacer'\r\n  | 'title'\r\n  | 'titlespacer'\r\n\r\ntype TPdfTextStyle = 'bold' | 'normal' | 'italic'\r\n\r\nexport type TPdfStyles = Record<\r\n  TPdfStylePdf,\r\n  {\r\n    fontSize: number\r\n    spacing: number\r\n    style: TPdfTextStyle\r\n    /**\r\n     * Optional R, G, B values\r\n     * Default is [0, 0, 0] (black)\r\n     */\r\n    textColor?: number[]\r\n  }\r\n>\r\n\r\nexport type TSavePdfType = 'default' | 'compact'\r\n\r\nexport interface ICompactPdfTextObj {\r\n  type: TPdfStylePdf\r\n  text: string\r\n  position: 'col' | 'full' | 'col0' | 'col1'\r\n}\r\n\r\nexport interface IPrintPdf extends ICurrentArmy {\r\n  hiddenReminders: string[]\r\n  reminders: IReminder\r\n  notes: INote[]\r\n}\r\n","import GenericTwoButtonModal from 'components/modals/generic/generic_two_button_modal'\r\nimport { useAppStatus } from 'context/useAppStatus'\r\nimport { useSavedArmies } from 'context/useSavedArmies'\r\nimport { useTheme } from 'context/useTheme'\r\nimport jsPDF from 'jspdf'\r\nimport { TSupportedFaction } from 'meta/factions'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { MdFileDownload } from 'react-icons/md'\r\nimport { TSavePdfType } from 'types/pdf'\r\nimport { logDownloadEvent } from 'utils/analytics'\r\nimport { isValidFactionName } from 'utils/armyUtils'\r\nimport { stripPunctuation, titleCase } from 'utils/textUtils'\r\n\r\ninterface IModalComponentProps {\r\n  modalIsOpen: boolean\r\n  closeModal: () => void\r\n  factionName: TSupportedFaction\r\n  pdf: { default: jsPDF; compact: jsPDF }\r\n}\r\n\r\nconst getDefaultName = (name: string) => {\r\n  name = isValidFactionName(name) ? titleCase(name) : stripPunctuation(name)\r\n  return `${name.trim().split(' ').join('_')}_Reminders`\r\n}\r\n\r\nexport const DownloadPDFModal = (props: IModalComponentProps) => {\r\n  const { closeModal, modalIsOpen, factionName, pdf } = props\r\n  const { isOnline } = useAppStatus()\r\n  const { loadedArmy } = useSavedArmies()\r\n  const { theme } = useTheme()\r\n  const defaultName = getDefaultName(loadedArmy ? loadedArmy.armyName : factionName)\r\n  const [fileName, setFileName] = useState(defaultName)\r\n  const [layout, setLayout] = useState<TSavePdfType>('compact')\r\n\r\n  useEffect(() => {\r\n    setFileName(defaultName)\r\n  }, [factionName, defaultName])\r\n\r\n  const handleUpdateName = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    e?.preventDefault?.()\r\n    setFileName(e.target.value)\r\n  }\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      handleSaveClick()\r\n    }\r\n  }\r\n\r\n  const handleSaveClick = async () => {\r\n    pdf[layout].save(`${fileName}.pdf`)\r\n    if (isOnline) logDownloadEvent(factionName, layout)\r\n    setFileName('')\r\n  }\r\n\r\n  return (\r\n    <GenericTwoButtonModal\r\n      closeModal={closeModal}\r\n      confirmBtnClass={theme.modalConfirmClass}\r\n      confirmIcon={MdFileDownload}\r\n      confirmText={'Download'}\r\n      denyBtnClass={theme.modalDangerClass}\r\n      isOpen={modalIsOpen}\r\n      onConfirmAsync={handleSaveClick}\r\n    >\r\n      <div className=\"row mx-3\">\r\n        <div className=\"col\">\r\n          <form>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"nameInput\">\r\n                <strong className={theme.text}>File Name</strong>\r\n              </label>\r\n              <input\r\n                className=\"form-control form-control-sm\"\r\n                aria-describedby=\"nameHelp\"\r\n                placeholder=\"Enter file name\"\r\n                defaultValue={defaultName}\r\n                onKeyDown={handleKeyDown}\r\n                onChange={handleUpdateName}\r\n              />\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={`row ${theme.text} justify-content-center text-center`}>\r\n        <div className=\"col px-0\">\r\n          <div className=\"custom-control custom-radio custom-control-inline\">\r\n            <input\r\n              type=\"radio\"\r\n              id=\"defaultLayout\"\r\n              name=\"defaultLayout\"\r\n              className=\"custom-control-input\"\r\n              checked={layout === 'default'}\r\n              onChange={() => setLayout('default')}\r\n            />\r\n            <label className=\"custom-control-label\" htmlFor=\"defaultLayout\">\r\n              Standard\r\n            </label>\r\n          </div>\r\n          <div className=\"custom-control custom-radio custom-control-inline\">\r\n            <input\r\n              type=\"radio\"\r\n              id=\"compactLayout\"\r\n              name=\"compactLayout\"\r\n              className=\"custom-control-input\"\r\n              checked={layout === 'compact'}\r\n              onChange={() => setLayout('compact')}\r\n            />\r\n            <label className=\"custom-control-label\" htmlFor=\"compactLayout\">\r\n              Compact\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={`row ${theme.text} justify-content-center text-center`}>\r\n        <div className=\"col px-0 pb-3 pt-1\">\r\n          <span className={`small ${theme.text}`}>\r\n            {layout === 'compact' ? 'Smaller font, two columns, fewer pages' : 'Larger font, more whitespace'}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </GenericTwoButtonModal>\r\n  )\r\n}\r\n","import jsPDF from 'jspdf'\r\nimport { slice, sum } from 'lodash'\r\nimport { ICurrentArmy } from 'types/army'\r\nimport { IReminder, TTurnAction } from 'types/data'\r\nimport { INote } from 'types/notes'\r\nimport { EMPTY_NOTE_TEXT, ICompactPdfTextObj, TPdfStyles, TSavePdfType } from 'types/pdf'\r\nimport { IAllySelections } from 'types/selections'\r\nimport { getActionTitle, titleCase } from 'utils/textUtils'\r\n\r\ninterface IPhaseAndRuleObj {\r\n  phase: ICompactPdfTextObj\r\n  rules: ICompactPdfTextObj[][]\r\n}\r\n\r\nexport interface IPageOpts {\r\n  colLineWidth: number\r\n  colNoteLineWidth: number\r\n  colTitleLineWidth: number\r\n  maxLineWidth: number\r\n  maxNoteLineWidth: number\r\n  maxTitleLineWidth: number\r\n  pageBottom: number\r\n  xMargin: number\r\n  yMargin: number\r\n}\r\n\r\nexport default class CompactPdfLayout {\r\n  readonly _army: ICurrentArmy\r\n  readonly _doc: jsPDF\r\n  readonly _opts: IPageOpts\r\n  readonly _style: TPdfStyles\r\n  readonly _type: TSavePdfType\r\n\r\n  // Keeping track of pages here\r\n  _pages: ICompactPdfTextObj[][] = [[]]\r\n  _pageIdx: number = 0\r\n  _currentPage = this._pages[0]\r\n  _pageY: number\r\n\r\n  // Phase information\r\n  _phases: IPhaseAndRuleObj[] = []\r\n  readonly _phaseHeight: number\r\n\r\n  constructor(_type: TSavePdfType, _doc: jsPDF, _opts: IPageOpts, _style: TPdfStyles, _army: ICurrentArmy) {\r\n    this._army = _army\r\n    this._doc = _doc\r\n    this._opts = _opts\r\n    this._style = _style\r\n    this._type = _type\r\n    this._pageY = this._opts.yMargin\r\n    this._phaseHeight = this._style.phase.spacing\r\n  }\r\n\r\n  // Utilities\r\n  private _resetY = () => {\r\n    this._pageY = this._opts.yMargin\r\n  }\r\n  private _willOverrunY = (val: number) => this._pageY + val > this._opts.pageBottom\r\n  private _goToNextPage = () => {\r\n    this._resetY()\r\n    this._pages.push([])\r\n    this._pageIdx = this._pageIdx + 1\r\n    this._currentPage = this._pages[this._pageIdx]\r\n  }\r\n  private _addToCurrentPage = (obj: ICompactPdfTextObj) => {\r\n    this._currentPage.push(obj)\r\n    if (obj.position === 'col1') return // Don't adjust spacing for col1\r\n    this._pageY = this._pageY + this._style[obj.type].spacing\r\n  }\r\n  private _getRuleHeight = (rule: ICompactPdfTextObj[]) => sum(rule.map(y => this._style[y.type].spacing))\r\n  private _getRulesHeight = (rules: ICompactPdfTextObj[][]) =>\r\n    sum(rules.map(x => x.map(y => this._style[y.type].spacing)).flat())\r\n  private _getTitle = (action: TTurnAction) => {\r\n    const title = getActionTitle(action)\r\n    const titleStr = title ? `${title} - ` : ``\r\n    return `${titleStr}${action.name}`\r\n  }\r\n  private _addSpacerToPage = () => {\r\n    this._addToCurrentPage({\r\n      type: 'spacer',\r\n      text: '',\r\n      position: 'full',\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Converts a full-width rule to a column\r\n   */\r\n  private _fullToCol = (rule: ICompactPdfTextObj[], position: 'col0' | 'col1'): ICompactPdfTextObj[] => {\r\n    return rule\r\n      .map(r => {\r\n        if (r.type === 'titlespacer') return { ...r, position }\r\n        const lineW = r.type === 'title' ? this._opts.colTitleLineWidth : this._opts.colLineWidth\r\n        const lines: string[] = this._doc.splitTextToSize(r.text, lineW)\r\n        return lines.map(text => ({\r\n          type: r.type,\r\n          text: text.trim(),\r\n          position,\r\n        }))\r\n      })\r\n      .flat()\r\n  }\r\n\r\n  private _addPhaseToPages_Compact = ({ rules, phase }: IPhaseAndRuleObj): void => {\r\n    const Cols = {\r\n      full: [] as ICompactPdfTextObj[],\r\n    }\r\n\r\n    const heightOfAllRules = this._getRulesHeight(rules)\r\n\r\n    // If there's an odd number of rules, add the last rule 'full'\r\n    if (rules.length % 2 === 1) {\r\n      Cols.full = rules.pop() as ICompactPdfTextObj[]\r\n      // If there was only one rule and it'll fit with the phase, we're done now\r\n      if (!rules.length) {\r\n        if (this._willOverrunY(heightOfAllRules + this._phaseHeight)) {\r\n          this._goToNextPage() // If it won't fit on this page, go to the next one\r\n        }\r\n        this._addToCurrentPage(phase) // Add the phase and rules to the page\r\n        Cols.full.forEach(line => this._addToCurrentPage(line))\r\n        return this._addSpacerToPage()\r\n      }\r\n    }\r\n\r\n    // See if we should start on this page, or the next one\r\n    const rule1Height = this._getRuleHeight(rules[0])\r\n    const rule2Height = this._getRuleHeight(rules[1])\r\n    if (\r\n      this._willOverrunY(rule1Height + this._phaseHeight) ||\r\n      this._willOverrunY(rule2Height + this._phaseHeight)\r\n    ) {\r\n      // We need to go to the next page\r\n      this._goToNextPage()\r\n    }\r\n\r\n    // Okay, we know that at least the first two rules will fit\r\n    this._addToCurrentPage(phase) // Add the phase\r\n\r\n    const halfHeight = this._getRulesHeight(rules) / 2\r\n\r\n    let col0H = 0\r\n    let col1H = 0\r\n    let col0IsFull = false\r\n\r\n    rules.forEach((r, ri) => {\r\n      const ruleHeight = this._getRuleHeight(r)\r\n      const remainingRules = slice(rules, ri)\r\n      const remainingRulesHeight = this._getRulesHeight(remainingRules)\r\n\r\n      if (col0H < halfHeight && !col0IsFull) {\r\n        if (this._willOverrunY(ruleHeight)) {\r\n          // We can't add this because it would go over the page\r\n          // So we need to check if we can add it to column 1\r\n          if (this._willOverrunY(ruleHeight - col0H)) {\r\n            // We need to go to the next page and start fresh\r\n            this._goToNextPage()\r\n            this._addToCurrentPage({ ...phase, text: `${phase.text} (continued)` })\r\n            col0IsFull = false\r\n            col0H = 0 + ruleHeight // Update the column height\r\n            col1H = 0\r\n            return r.forEach(line => this._addToCurrentPage({ ...line, position: 'col0' }))\r\n          } else {\r\n            // We can add it to column 1\r\n            col0IsFull = true\r\n            col1H = 0 + ruleHeight\r\n            return r.forEach(line => this._addToCurrentPage({ ...line, position: 'col1' }))\r\n          }\r\n        } else if (remainingRulesHeight <= col0H) {\r\n          // If the remaining height of all the rules we have left is less than col0\r\n          // Let's just assign them to col1 so we can a fairly even distribution\r\n          col0IsFull = true\r\n        } else if (ri === rules.length - 1) {\r\n          // If it's the last rule and we still haven't switched columns, we need to force the switch\r\n          col0IsFull = true // Set this to true, and our col1 logic below will handle it\r\n        } else {\r\n          // Okay column 0 is not full yet and we can fit it on the page, add it to there\r\n          col0H = col0H + ruleHeight // Update the column height\r\n          return r.forEach(line => this._addToCurrentPage({ ...line, position: 'col0' }))\r\n        }\r\n      }\r\n\r\n      if (col0IsFull || col0H >= halfHeight) {\r\n        col0IsFull = true\r\n        // Okay column 0 is full, let's see if we can add it to column 1\r\n        // Removing the height of col0 because it's already been added to the Y axis\r\n        if (this._willOverrunY(col1H - col0H + ruleHeight)) {\r\n          // Oh shit, it's gonna overrun, we need to go to the next page and start this whole cycle over\r\n          this._goToNextPage()\r\n          this._addToCurrentPage({ ...phase, text: `${phase.text} (continued)` })\r\n          col0IsFull = false\r\n          col0H = 0 + ruleHeight // Update the column height\r\n          col1H = 0\r\n          return r.forEach(line => this._addToCurrentPage({ ...line, position: 'col0' }))\r\n        } else {\r\n          col1H = col1H + ruleHeight\r\n          return r.forEach(line => this._addToCurrentPage({ ...line, position: 'col1' }))\r\n        }\r\n      }\r\n    })\r\n\r\n    // We have a remaining full width rule to add!\r\n    if (Cols.full.length > 0) {\r\n      const toCol = this._fullToCol(Cols.full, 'col1')\r\n      const colRuleHeight = this._getRuleHeight(toCol)\r\n      const fullRuleHeight = this._getRuleHeight(Cols.full)\r\n\r\n      // Can we shoehorn this into col1? If so, convert to a column layout and stick it in there\r\n      if (col1H + colRuleHeight <= col0H) {\r\n        col1H = col1H + colRuleHeight\r\n        toCol.forEach(line => this._addToCurrentPage(line))\r\n        return this._addSpacerToPage()\r\n      } else if (this._willOverrunY(fullRuleHeight)) {\r\n        // Go to next page before adding it\r\n        this._goToNextPage()\r\n        this._addToCurrentPage({ ...phase, text: `${phase.text} (continued)` })\r\n      }\r\n      // Drop it on this page, and we're done :D\r\n      Cols.full.forEach(line => this._addToCurrentPage(line))\r\n      return this._addSpacerToPage()\r\n    } else {\r\n      // Add a spacer to the end of each phase\r\n      this._addSpacerToPage()\r\n      // And we're all done now!\r\n    }\r\n  }\r\n\r\n  private _addPhaseToPages_Default = ({ rules, phase }: IPhaseAndRuleObj): void => {\r\n    // See if we should start on this page, or the next one\r\n    if (this._willOverrunY(this._getRuleHeight(rules[0]) + this._phaseHeight)) {\r\n      this._goToNextPage() // We need to go to the next page\r\n    }\r\n\r\n    // Okay, we know that at least the first rule will fit\r\n    this._addToCurrentPage(phase) // Add the phase\r\n\r\n    rules.forEach(rule => {\r\n      if (this._willOverrunY(this._getRuleHeight(rule))) {\r\n        this._goToNextPage()\r\n        this._addToCurrentPage({ ...phase, text: `${phase.text} (continued)` })\r\n      }\r\n      return rule.forEach(line => this._addToCurrentPage(line))\r\n    })\r\n\r\n    return this._addSpacerToPage()\r\n  }\r\n\r\n  private _addArmyTextToPages = () => {\r\n    const armyText = this._getArmyText()\r\n    if (this._willOverrunY(this._getRuleHeight(armyText))) {\r\n      this._goToNextPage() // Place on next page\r\n    }\r\n    armyText.forEach(x => this._addToCurrentPage(x)) // Then add the armyText\r\n  }\r\n\r\n  splitTextToPages = () => {\r\n    const addPhases = this._type === 'compact' ? this._addPhaseToPages_Compact : this._addPhaseToPages_Default\r\n\r\n    // Add the reminder text to the pages\r\n    this._phases.forEach(addPhases)\r\n\r\n    // Add the army text to the end of the document\r\n    this._addArmyTextToPages()\r\n\r\n    return this._pages\r\n  }\r\n\r\n  getReminderText = (reminders: IReminder, notes: INote[]): void => {\r\n    const Phases: IPhaseAndRuleObj[] = []\r\n\r\n    Object.keys(reminders).forEach(phase => {\r\n      const phaseObj = {\r\n        // Handle phase title (Start of Round)\r\n        phase: {\r\n          type: 'phase',\r\n          text: titleCase(phase),\r\n          position: 'full',\r\n        },\r\n        rules: [],\r\n      } as IPhaseAndRuleObj\r\n\r\n      const numRulesInPhase = reminders[phase].length\r\n\r\n      reminders[phase].forEach((action, i) => {\r\n        const ruleObj: ICompactPdfTextObj[] = []\r\n\r\n        // Display last rules in full since they won't have a matching partner\r\n        const isLastRuleAndOdd = i + 1 === numRulesInPhase && (i + 1) % 2 === 1\r\n\r\n        const position = this._type === 'default' || isLastRuleAndOdd ? 'full' : 'col'\r\n\r\n        const titleWidth = position === 'full' ? this._opts.maxTitleLineWidth : this._opts.colTitleLineWidth\r\n        const lineWidth = position === 'full' ? this._opts.maxLineWidth : this._opts.colLineWidth\r\n        const noteLintWidth = position === 'full' ? this._opts.maxNoteLineWidth : this._opts.colNoteLineWidth\r\n\r\n        const addBreak = () => ruleObj.push({ type: 'break', text: '', position })\r\n\r\n        // Add a titlespacer\r\n        ruleObj.push({ type: 'titlespacer', text: '', position })\r\n\r\n        // Add the title itself\r\n        const titleLines: string[] = this._doc.splitTextToSize(this._getTitle(action), titleWidth)\r\n        titleLines.forEach(text => {\r\n          ruleObj.push({ type: 'title', text: text.trim(), position })\r\n        })\r\n\r\n        // Handle description\r\n        const descLines: string[] = this._doc.splitTextToSize(action.desc, lineWidth)\r\n        descLines.forEach(text => {\r\n          const trimmed = text.trim()\r\n          if (!trimmed) addBreak()\r\n          ruleObj.push({ type: 'desc', text: trimmed, position })\r\n        })\r\n\r\n        // Handle note\r\n        const note = notes.find(x => x.linked_hash === action.id)\r\n        if (note && note.content && note.content !== EMPTY_NOTE_TEXT) {\r\n          addBreak() // Add spacer before the note\r\n\r\n          const noteLines: string[] = this._doc.splitTextToSize(note.content, noteLintWidth)\r\n          noteLines.forEach(text => {\r\n            const trimmed = text.trim()\r\n            if (!trimmed) addBreak()\r\n            // Add tabbed prefix to emulate the UI\r\n            ruleObj.push({ type: 'note', text: `     ${trimmed}`, position })\r\n          })\r\n\r\n          addBreak() // Add spacer after the note\r\n        }\r\n\r\n        phaseObj.rules.push(ruleObj)\r\n      })\r\n\r\n      Phases.push(phaseObj)\r\n    })\r\n\r\n    this._phases = Phases\r\n  }\r\n\r\n  private _getSelections =\r\n    () =>\r\n    (name: string, items: string[], pluralize: boolean = true): ICompactPdfTextObj[] => {\r\n      if (!items?.length) return []\r\n      const title = !pluralize ? name : items.length > 1 ? `${name}s` : name\r\n      const str = `${title}: ${items.join(' | ')}`\r\n\r\n      const lines: string[] = this._doc.splitTextToSize(str, this._opts.maxLineWidth)\r\n\r\n      return lines.map(text => ({\r\n        type: 'army',\r\n        text: text.trim().replace(/\\|$/g, ''), // remove trailing pipe from EOL\r\n        position: 'full',\r\n      }))\r\n    }\r\n\r\n  private _getArmyText = (): ICompactPdfTextObj[] => {\r\n    const { allyFactionNames, allySelections, factionName, subFactionName, realmscape, selections } =\r\n      this._army\r\n\r\n    const {\r\n      artifacts,\r\n      battalions,\r\n      command_abilities,\r\n      command_traits,\r\n      endless_spells,\r\n      flavors,\r\n      grand_strategies,\r\n      mount_traits,\r\n      prayers,\r\n      scenery,\r\n      spells,\r\n      triumphs,\r\n      units,\r\n      manifestations,\r\n    } = selections\r\n\r\n    const realm = realmscape ? [realmscape] : []\r\n\r\n    let text: ICompactPdfTextObj[] = [\r\n      { text: '', type: 'spacer', position: 'full' },\r\n      { text: '', type: 'spacer', position: 'full' },\r\n      { text: getFactionTitle(factionName, subFactionName), type: 'armyName', position: 'full' },\r\n    ]\r\n\r\n    const getText = this._getSelections()\r\n\r\n    const selectionText = [\r\n      getText('Flavor', flavors),\r\n      getText('Battalion', battalions),\r\n      getText('Unit', units),\r\n      ...allyFactionNames.map(n =>\r\n        getText(`Allied ${titleCase(n)} Battalion`, (allySelections[n] as IAllySelections).battalions || [])\r\n      ),\r\n      ...allyFactionNames.map(n =>\r\n        getText(`Allied ${titleCase(n)} Unit`, (allySelections[n] as IAllySelections).units)\r\n      ),\r\n      getText('Artifact', artifacts),\r\n      getText('Command Trait', command_traits),\r\n      getText('Mount Trait', mount_traits),\r\n      getText('Command Abilities', command_abilities, false),\r\n      getText('Prayer', prayers),\r\n      getText('Spell', spells),\r\n      getText('Endless Spell', endless_spells),\r\n      getText('Scenery', scenery, false),\r\n      getText('Grand Strategy', grand_strategies, false),\r\n      getText('Triumph', triumphs),\r\n      getText('General\\' Handbook', realm, false),\r\n    ].flat()\r\n\r\n    const endText: ICompactPdfTextObj[] = [\r\n      { text: '', type: 'spacer', position: 'full' },\r\n      { text: 'Generated by AoS Reminders', type: 'armyFooter', position: 'full' },\r\n      { text: 'aosreminders.com', type: 'armyEnd', position: 'full' },\r\n    ]\r\n\r\n    return text.concat(selectionText, endText)\r\n  }\r\n}\r\n\r\nexport const getFactionTitle = (factionName: string, subFactionName = '') => {\r\n  const factionTitle = titleCase(factionName)\r\n  const subFactionTitle = titleCase(subFactionName)\r\n  const suffix = !!subFactionTitle && subFactionTitle !== factionTitle ? ` - ${subFactionTitle}` : ''\r\n  return `${factionTitle}${suffix}`\r\n}\r\n","export const Logo =\r\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABICAYAAADru+saAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAVUUlEQVR42u1dCVgUx7buGVQ0edEs16jggCJEg2iiRk3y3n1JzIv3ZTXxRuPdEvc9cUFEEBCvmvsUVzZRZBFBBaOJRnHfFzRx341b3Pd9xWmsd071qaammRlRB5H7TX3f+bq7urqWs/5VPV2jKIXJLJ3XBRoKtBnoHhADuguUBxQGVMvBc+5UAsmDjpWARpMwkC4CrQSaB7Qa6Crl3weKkp5zC6iEkmDsS0AbiPnrgT4Ges5Q9nmgL4F2ULllQP/hFlDJpookEGT4Pw33WgL9DBQk5ZmA4qj8IrpWpKM7uTCNIkYPk5jsSeez6F6EJEiREuheiME9upOLUgAxOE8SjFli9DS6HyoJQLiwckAHgG4Cvey2HtenSGL+ZxLDZSvIpPuDDPnl6diR7vcwPO9OLkgbga4AVTZovhBClgPhiHJedH+227W5Pt0CWmPHHRVXOOjiDgLtlKzG7dpclJDxC+zAYWcxRzEgty1Ah4EquIXj2nSdYLTZgVvLIeFEOrAcvD4CtM3OPXd6zLSa0NYLDoTzfyScrx0Ix5fuT3fHHNenYGJuWwPaEsyvAtTGzkRToLXeBuG50ZoLE6KtfKBdkmuT5zIJBqgs38PlnfNAF0iIbpdWAmkACSBByhMrBHMMyzqekoCy6d7f3S6tZNNcYvRkSTDCrX3owF39Ts+85XZpJZPMkkXMJmYfJTdWW7KGCrTUg+9zcL3tfaCmQJcU7dVCHbf1lKyAMPUkhot3OieA9gGdlvIEbaUJLJ7vkVYZ3K8PXJxMUjB/HqgDwWOcvxyiiSauFvxF0V4fYAw6YxDWPLKccm56aCoWkPKwc13egTXgm9MvaYXhBgmoq1vPH8tAilWonANBCaRmDP4NgfoCdVe0V93xivZCzk3OKRboXzSZf6SpiMlJvofBqsbQkhDCcnzdkOEmh5ROPLIC/U9Rz5WT4/HYFB1dTnm3vfaGtPwz8Ur5SrFuD/Uwqu+xSXnR6wN+3ia6gs7XEkgxNFdyp+J7JUS9zYvc8Q5JbOMK8uo3oV2tEdl/qtis5QLPxu+sqD1sVkvMc/pcfwOFPD3k46iP/Q33H5UGxLf1Dk760qt/3Fdmn3pHX2z7XaRPxNRP8FqUUSwRqcwlNHgK8x2ayV5o3ZNV+bQTP8c8R+V9gAKHpLMG0eksKFo71otK0+9ZSolE23UiU1kQ9U+jqfp5IPTTL9I1bfkMTmGeb3zAanwbw3yGZADPUvT7Ss2QBKsryHtAnNUSPtn6fKuuBZU/+qYAz0E77JcF8hmYaFV6jLEqHUdalc6jrEoHOPYaZ60dmmj1Com3uqpfDzUGIN+BCdaGYROt5YLjrErX0Vr/dIJ+dgLqOdb6fHC8tQGUqzcokT/38G3BGAdqR8/GLe5X6zZctQxK0vKpDAqHuYQGxDOfsGQGwmGVP/yaWcKTeZ69srUHJjJz31g2fuYiNmvJBpaZu5b9sDSPRafOZcq341lAaCJzWb+KSV5A2K7XgAQGgmAfRSWzsTMXsx9X/MJWbNrJVv+6m+Wu3cqmzl/LIlJ+Yu8PngTlRjGl+xjm85htezZpwap3H85AODY8KyHhfONQOH4gGKVfLGszIp3dvWdlcjp36Srz7RfHLFDG9wkLpi4IRgGFqQvnS/J2sKs3bjFH6f59xi5du8G27D3MRmTMZ0r/eFC4R20//ukRTlBYEte4mYs38IGqagErgNEWFBTw6xFTf+baWG/QxCcmnDqkMO+Ctfx++rwuBNEnYyoouK+f7zt6kildRrNXH6O/T4VwfMh1KD3HscMnz5IWagMtoOPGnb8xiD+sAQjxUfuC7fjS8UFlLaJPPcay3YeO6woj0uVrN9nhE2fZoeNn2JmLV9itO/k2ghoPrg+FE1jWhfMKMqH3ODYgYRZTSSvzwbUdgsEL4Vy7eYu1HJLMKvaP47GpuO2juwwKm8ggmHNm+8I1HhuCkOtDXi0HddUFpqJg/gnxTlYW7F82WHddjEG9xvEyCrjcv32fziZkL2bb9h9hR0+dZ41CJ7KXcexlPea8hi4NrGLpxp265qFvH5G5QNNW8hYpc1cxpXMMZ2pxNB+FgvGCB2gkYGad7yaAhY7VrqGuKsFxXLu9Dc+j8JT2I1nu+m02VrMcQIDyxVCuUBiP8FgLGYbtQH1KF+gf1FcVxmgp64CgFgTM6nB8Hej85Wu6cPYfPcUAsnIwINLeIyd4HvpxRwP35qgP4gVaIwig7fA0iGPr2VbQ6EMnzrBjEDvwuBmCdvr81eydiEmcoYGGOhuSwmzc9ZtNnBkDCoNCDpQUxEIWikLBvtWA8bkCuJS6cHAwSrcxLCZroe42MP2wfBNTWkawVVv26G4FXV3XMVlMAe33dwCr0eWhsNE6flr1K7t9N585S2ihk39coQXv0IlFrHnttn02/UrGsp1GsaYgVG8nsa3mv4NwGhBKQ/gp0t38e6zz6EzOhGiYO6C7F0hoLjAcmdbQDjBADfanIL5x54FioKvC/Dkrf9VcJrk40a9sgR6pLKI2nHOh8BuGJ5UoeixV4WhzmzjWelgqu3Hrji0M7abB5upw//T5y/q9k+cusZf6TOCB3NceHAeB/rjylyLM3wWIawa4txTQ/JxlG9lBQFnCIkWwj81ewt0mujgOo6Gd9qOmcYuVkSMG/P7xObwtVASMOxgHLf9OwsEB4QAzFqy10c5pcI35b0VO5layKG+7DbOHgDWh5taVtJYzE4LyV4CahCsTTM9auI4pf/seLGMUjy8cDEC9ueu22tSL8e3VAdrk01fq3yICBdq8qxC1bd13hA3F1QtEbWB16FJRobzKunAsIt7AxPLgsdO6ht+6c5e1HZHGGY0ajAMPnfgDZ4pg9jqIA0bXJtzQbIhVMrrafuB3LphG4IIwjmCdr8N5QKjG+CMnztooRuLsZTri8uGARYP5G3YUukmsW/RFs6RzPG5VBEtTeozhKNG7LAuHz23Ad/eJncmsVlUf7O7Dx7mraBIxGRBREmsAjKwBcBfdmT4BvH6TvTd4EnsuOJ5rKwoamYkuCV2ibA0TcDLYTWOYjOgwXqC2pwurJWHmgRBQyPWhbW8CGDWQIVBHJljg9Vu3C4VUYCukk+cusuHpP/N6A10Qi0pFON6Q14DQUO66bTaaOw5Qm/JxFGc0dz/AFERtOUtsA/PE2cs1CIwTyRANjr8JdBZm6zqwgFiBMQNjh59hssnXzNAqk2Yzq8RkHvB7j+fKIwSJcJ9PSsHSPo2ewuav3couXLlmAyzk+DZjSZ6+dONdloTjA8LxwTyci8Bs/4zETKuqss27D7J1W/ayDeC61gPhcc3mPWzngaMwFy10bbsOHePCQYvgwALqag2Mkxcmr9+8zf4YlcwqwL1aA+2sm/WJZV1GZnBXKtKFK9e5sC12IDEqlBnqQqVqDMJDV3bszAUbSxJpHFlsmVpbw/N6qLUQa77PmF+ImKQA7njV975YLGB3AG53IKvgsQtXtAH1XbtZ6HaugPtrAu6vMrg/o3D8CED8fUQ6u3G7ECniqnIjMZEcWHSCi89hrONzKQQXYH0p81axmyRgIaBT5y/pFmspM24NzhsgM8Fl4WKmDFGLm0R5PlGFejDAo+W0AivBBUmREJ63GDKFa7txPY7Ph4B53UDAt6VFS1ylqE5rYs4mkyhsRHN8iQgAx+DkH7nli3QP4mj/uGzuIh/1PdQTF44fuDUP0PKPgGlXb96ymXjuO3KSL9sUod9Psb1wD1eB5XnJcXApCCowfiDz/aFe1FiR8q1W1n3sdL6iUMfAIG69AMcjgKkFUp1HTp7l+RhzLOT+LA9Y6W6OS0DtR7LdB4/bgJGYzNzHcm1PWDhfs6DIFB5YU8EV2KAkmNErn0dri5IIBozURTueuXBZd3HI1PDJc/gzTekNJM49ZPcilmZeC0/SgzO+1WwUrpWfCcFb7ocG0zW0Vg36jq4PkSBaCVqbvTUzdJ2I0HRPgAADjqOmLSg7wnkOhFM/YgowOaYI5B09faHOZM4MA70J0BqFunD9dhtmrtq8mwfo5jhhhRiAKE4WDi5y4n10Q+j+EJ43hiPGIWxPWJoOvXO0VQJEZ4GDElm7f03VFKNTDHeDWE/QIO0VhEZJ2nIOWKe8SJsPbu278TP4Pf+y4Na8P+nAlOBEcDVZ+pIIpotXr7M3Qu0HYWfvfMSzb/IAnsAR4CtQh4DTotzKX3dr7106jtSWXPAITBMTS1EOrdKXx6cE9jK0+Ra4NITW6G6T5qxg7WMyWV1wnVxY4jUEWEYrQIm46i3XdfzsBV0wTz0gqPJZF+b/eScYzHi+eClr/xqAzqjdQWFJTucFASQg8cpYaHssaTuuFCvdRrOYrNwii5unzl9myzftYnNX/sJWgLDOXrpSZP1tJL4OABSJLgwnnq+DdQk3KhAiWtqewyfYL3sOccJ4ePP23SJQmnuC7mUESr8AllP9k/YAeRPZibMXCpdB8PcBOKvu8eDfBwTRxHX2ik2EiDTrwzijCXcin5Si/5+xaL3dd/uO3vlPX7xBf5GHcaUaUDOwxosw77G3GmAP5os0c2kZm4T6/bkHUxq0YqOzl9oMCid9vjRJfNB7EA5/wbd3GZ1lo6XI5G74nqeP9p4HhYyMxnmUvOxjL+GK90hEVdLrArGm9iK4sCUbd9pMUp3Be3yR9/3U+Tz24bsh7xJbvhmQoLqCvIPjVUvYZNX78673lbfb3A+ZMk/NWZanZuSu5ccRGfNV8M0qQFbV+0F1AdUOSVCVfnFqwuxlKiAtddrCdWr20jy1/ZgsFQSn+oVo9QCjVYgH6rOQB6hJXZK3QwULU/ccPKZu2XtYXQzXMZkL1Bf6xvJyWN5bascCVB1I6TpG/TBqijpu+kJ17urN6vrt+9Vt+7V6dhw4qkLcUsGS1cGTZqswIVXBldnU9dD8wmMIHuNV7UeFwwosoUn8WpRRfMTPQh+TxM9xK7fuyaq36syUsDSID4BuesWBT4bg2m8iC4hKYzWLWx9Q7chUsCDQoB7wfE+qJzSZ1YksrAeP9YekMz/IU/okamV6AUL7NkFru9sEno914c9/LXba8QV6Fe49EzZFaw/rwDZ7Uz147EF5/ZP4OLCumq7gHf4ct6n2c1xf/DluRIp+T/EZPCXHhsIN18WhiJTsmmHJs3yHZWXAHGd/xffbHqk/fEZGsyGps5pGp+U0G5qW81pUWo53uJ02nLRngXuN6XlRj39kao63sRxQLSBsA8u9BhREx2bRU3l+LSpn0264bR11BqfmvB6Fz6TxdhtQPXhsEq3VHRSV+nB8clYuPCUbx1g+6O3L1boPXw7CyZL7WBKfNOBXbcnuLzuKnTzoe9s/Fr0VHW12CXXtqm234uEZp3hUSOPnH37rqbTJ8dAJP7LCcq5q0xG1kT480tp9/HoYM5VIH5s3r6yYTDuUKi9/QPIop5dxYaJvRM34VVtqMT5XLNmPXitVsiiF+18/Sntm2n2hoWI2h9PHya7su1ZP1aq4u/B2pVy590tyHwdRKX6EOkUbnnk6aMUaoBVEP0BuOyfPe9gZvPwJvr0yZsN3qdrRZFoOlCc9ZzZ8x+rhgNHivtjF5B9QD254/qJBOGY738Ma+2s2tGMyfPSMSROOtulGie3hUFQ4JtMtENAM2rugG5wnQB6jTxNFR8zF+NzensbaY4xZKvcnoI/sMNTZBhn27reDPp+gvRkc9dnePnMexRhTqQrnslK4aRE1be4D+fj1cFUD498D+gKopqGT+Am42AsOvzjGjWK9pWdxi5c/A9U39Ac1/SVp65h6dI67+H6uaPtly/uamqVtZD6gOjHvY+jvOUk4cru4B0OgQTBeRJiaUD3C6moAfUJjCKRnSk04uLFrb0lDeAiE/HsSM2vB9XagI0Cbga7abDRhNicC5XCXiIHTZPoNCD+lbw35k+D8ANAWqnO49NwMyJtHV6/COX4UO5gfTaZNQMeAcAeSN6QxBELeIW4pWl82QR62sR+Of6AyFeH6J/6sybSRxjhBajcBCK+D4d5RINwqzR+hCZxfBNpG/b0O5cS+qbtKQzjX7FgOurZTithMT2OWvO1+Z3J9Tah8LF330jXUbM7keWYzQvZnqVx3KicsZBZcz6dzfzi/wQWJghK7j2hMWqnXazLtAVoH589Q3pvc+lGQwtLN5hRycwJsvE3tdqT7I+k6RbK2ysSLLrqAFaUR1YGWuqM0hHMOCLdewZ2mhkLHZ8L1cXJhmFrA9W3Fdpd3hWuXiEtmcxpc7zW00QryCgzurTJp8WeScH6mcz+yrK8l5ig8DppMJ+n8LWJqkOQKObglxj7LrQeFjAKxVbgkyF9LVyN5rC3cjFbhwjaZLkC5EU9TzDnDXZambWto8I2kZ3pA3n1uOYW0kKxiJpXJgOvFBoa1o3gmx4Gq3G3YF04dYvC7UlxRuPs0mU5rvff4Bs5xtyzx5xpim8y/csZq103gXAVaD7SEEOECrhToDjVBjSfrk9Eln/WRFeI2z+jOqulKVUrCucahaKFF7ITOT5M0ri/Fj36KttdofzrvJ1lXOpRZZGDqV2QlVaT2/0DMdSQcLP+OE+F0hPPzkksTe/u0JUCA183IAtEC+lCfg6m/bWhM47jw7KNEVKbveAzTxv0OldlZWoCgp1TmPbIewaTW5AKcTexS7Qin7SMI56pT4SASRKtQFB/dFWmpJ7VViSNHkwn3Q23seOpaRDgmB+UyCGh4llbMucz9uswQk2kOBWbNTSE40CancqohQW10ibl2hHPJjnAuSMLJhuu5knCw/H8b6ulCMdBMKOwigQxF13QNDZ7SYTkqitb/KgbYbiGmj5Xij1kStJ9hjJHkCiuWlnDuSFBa+PDaFFOi9fkCaq9m6rlAqzgEFbsoaZB4tYGpfyUgYYw5d7k1amkeXC+l8wByRy0M9fQkBRIA4VNuGRrczeVI0mzOJmFUpzLVCGafJkEtIfTWl/o7iWC7zOiqHFJrUwasdwO5/FZPGkrLa2ufSRoj/+3L2zQJFB1BLexA8xT04f8l+Xych/ynoY2aNPuvILkOT5rgeenzKYTCWnqOM75wruKhozhF+V9D3zBvAEdpWtvlqa8VDUtEXyja/9qFU1/EVKChBDzk1YQgmg4MI0EGSGN/ooDA/cqg+AmFv+1JCWe8ou2yW4WWKAIUbedcmV4hEtc4g64rkfxMgKGsKP+Kg3r97Tznb7jnrO4AQz/8nbQvyjlq11G9ou7adL5HcrklKhx0TYjIEIXde0jKJ7r3iM8Wt0z+Y5ZxVjb/IcaIR4yTVnLlNsL5f0RTKKgY1JpKAAAAAElFTkSuQmCC'\r\n","import jsPDF from 'jspdf'\r\nimport { IPrintPdf, TPdfStyles } from 'types/pdf'\r\nimport CompactPDFLayout, { getFactionTitle, IPageOpts } from 'utils/pdf/generate/layouts/layoutUtils'\r\nimport { Logo } from 'utils/pdf/generate/logo'\r\nimport { getVisibleReminders } from 'utils/reminderUtils'\r\nimport { reorderReminders } from 'utils/reorder'\r\n\r\nconst Styles: TPdfStyles = {\r\n  army: {\r\n    fontSize: 6,\r\n    spacing: 0.14,\r\n    style: 'normal',\r\n  },\r\n  armyEnd: {\r\n    fontSize: 8,\r\n    spacing: 0.14,\r\n    style: 'bold',\r\n  },\r\n  armyFooter: {\r\n    fontSize: 8,\r\n    spacing: 0.2,\r\n    style: 'bold',\r\n  },\r\n  armyName: {\r\n    fontSize: 8,\r\n    spacing: 0.2,\r\n    style: 'bold',\r\n  },\r\n  break: {\r\n    fontSize: 0,\r\n    spacing: 0.03,\r\n    style: 'normal',\r\n  },\r\n  desc: {\r\n    fontSize: 7,\r\n    spacing: 0.14,\r\n    style: 'normal',\r\n  },\r\n  note: {\r\n    fontSize: 7,\r\n    spacing: 0.14,\r\n    style: 'italic',\r\n    textColor: [18, 55, 199], // $themeRoyalBlue: #1237c7;\r\n  },\r\n  phase: {\r\n    fontSize: 8,\r\n    spacing: 0.2,\r\n    style: 'bold',\r\n  },\r\n  spacer: {\r\n    fontSize: 0,\r\n    spacing: 0.1,\r\n    style: 'normal',\r\n  },\r\n  title: {\r\n    fontSize: 7,\r\n    spacing: 0.14,\r\n    style: 'bold',\r\n  },\r\n  titlespacer: {\r\n    fontSize: 0.04,\r\n    spacing: 0.01,\r\n    style: 'normal',\r\n  },\r\n}\r\n\r\nconst PageOpts: IPageOpts = {\r\n  colLineWidth: 8.5,\r\n  colNoteLineWidth: 8,\r\n  colTitleLineWidth: 8,\r\n  maxLineWidth: 17,\r\n  maxNoteLineWidth: 17 - 0.5,\r\n  maxTitleLineWidth: 17 - 2,\r\n  pageBottom: 9,\r\n  xMargin: 0.3,\r\n  yMargin: 0.75,\r\n}\r\n\r\nexport const saveCompactPdf = (data: IPrintPdf): jsPDF => {\r\n  const { factionName, subFactionName, hiddenReminders, reminders, notes, ...currentArmy } = data\r\n\r\n  const orderedReminders = reorderReminders(getVisibleReminders(reminders, hiddenReminders))\r\n\r\n  const doc = new jsPDF({\r\n    unit: 'in',\r\n    lineHeight: 1.2,\r\n  })\r\n\r\n  const Layout = new CompactPDFLayout('compact', doc, PageOpts, Styles, {\r\n    factionName,\r\n    subFactionName,\r\n    ...currentArmy,\r\n  })\r\n\r\n  doc\r\n    .setFont('helvetica')\r\n    .setTextColor(0, 0, 0)\r\n    .setProperties({ title: `AoS Reminders - ${getFactionTitle(factionName, subFactionName)}` })\r\n\r\n  const pageWidth = doc.internal.pageSize.getWidth()\r\n  const centerX = pageWidth / 2\r\n  Layout.getReminderText(orderedReminders, notes) // Get the reminders into the class\r\n  const pages = Layout.splitTextToPages() // And now extract the pages\r\n\r\n  const col1X = 4.2\r\n\r\n  pages.forEach((page, pageNum) => {\r\n    if (pageNum !== 0) doc.addPage()\r\n    let [x, y, colY] = [PageOpts.xMargin, PageOpts.yMargin, PageOpts.yMargin]\r\n\r\n    page.forEach((t, i) => {\r\n      // Don't add spacers to the start or end of page\r\n      if ((i === 0 || i === page.length - 1) && ['spacer', 'titlespacer', 'break'].includes(t.type)) return\r\n\r\n      const isPhase = t.type === 'phase'\r\n      const isArmy = t.type.startsWith('army')\r\n      const style = Styles[t.type]\r\n      const textX = isPhase || isArmy ? centerX : t.position === 'col1' ? col1X : x\r\n      const textAlign = isPhase || isArmy ? 'center' : 'left'\r\n      const textY = t.position === 'col1' ? colY : y\r\n\r\n      doc.setFontSize(style.fontSize).setFontStyle(style.style)\r\n\r\n      if (style.textColor) {\r\n        doc.setTextColor(style.textColor[0], style.textColor[1], style.textColor[2])\r\n      }\r\n\r\n      doc.text(t.text, textX, textY, null, null, textAlign)\r\n\r\n      if (style.textColor) doc.setTextColor(0, 0, 0) // reset to black\r\n\r\n      if (isPhase) {\r\n        doc\r\n          .setLineWidth(0.0001)\r\n          .setDrawColor(28, 117, 149)\r\n          .roundedRect(\r\n            x - 0.1,\r\n            y - style.spacing + 0.04,\r\n            pageWidth - PageOpts.xMargin * 2 + 0.1,\r\n            style.spacing + 0.015,\r\n            0.05,\r\n            0.05,\r\n            'S'\r\n          )\r\n      }\r\n\r\n      if (t.type === 'armyName') {\r\n        const lineY = y - style.spacing\r\n        doc\r\n          .setLineWidth(0.0001)\r\n          .setDrawColor(28, 117, 149)\r\n          .line(x - 0.1, lineY, pageWidth - PageOpts.xMargin + 0.1, lineY)\r\n      }\r\n\r\n      if (t.type === 'armyEnd') {\r\n        const lineY = y + style.spacing\r\n        doc\r\n          .setLineWidth(0.0001)\r\n          .setDrawColor(28, 117, 149)\r\n          .line(x - 0.1, lineY, pageWidth - PageOpts.xMargin + 0.1, lineY)\r\n      }\r\n\r\n      if (t.position === 'col1') {\r\n        colY = colY + style.spacing\r\n        if (colY > y) y = colY\r\n      } else {\r\n        y = y + style.spacing\r\n        if (t.position !== 'col0') colY = y\r\n      }\r\n\r\n      // Add page numbers and watermark on the first pass of a page\r\n      if (i === 0) {\r\n        const watermarkY = 0.33\r\n        doc\r\n          .setTextColor(128, 128, 128)\r\n          .setFontSize(Styles.desc.fontSize)\r\n          .setFontStyle(Styles.desc.style)\r\n          .text(`${pageNum + 1}`, pageWidth - PageOpts.xMargin - 0.11, watermarkY)\r\n          .setFontStyle(Styles.title.style)\r\n          .text(`aosreminders.com`, centerX, watermarkY, null, null, 'center')\r\n          .setTextColor(0, 0, 0) // Set color back to black\r\n\r\n        const [logoW, logoH] = [1.43 / 3.5, 1 / 3.5]\r\n        doc.addImage(Logo, 'png', PageOpts.xMargin + 0.11, watermarkY - logoH / 2 - 0.05, logoW, logoH)\r\n      }\r\n\r\n      // If there's enough room on the last page, add the fullsize logo to it\r\n      if (pageNum === pages.length - 1 && i === page.length - 1) {\r\n        const [logoW, logoH, logoSpacer] = [1.43, 1, 0.4]\r\n\r\n        if (y + logoH + logoSpacer <= PageOpts.pageBottom) {\r\n          doc.addImage(Logo, 'png', centerX - logoW / 2 + 0.15, y + logoSpacer)\r\n        }\r\n      }\r\n    })\r\n  })\r\n\r\n  return doc\r\n}\r\n","import jsPDF from 'jspdf'\r\nimport { IPrintPdf, TPdfStyles } from 'types/pdf'\r\nimport PdfLayout, { getFactionTitle, IPageOpts } from 'utils/pdf/generate/layouts/layoutUtils'\r\nimport { Logo } from 'utils/pdf/generate/logo'\r\nimport { getVisibleReminders } from 'utils/reminderUtils'\r\nimport { reorderReminders } from 'utils/reorder'\r\n\r\nconst Styles: TPdfStyles = {\r\n  army: {\r\n    fontSize: 11,\r\n    spacing: 0.22,\r\n    style: 'normal',\r\n  },\r\n  armyEnd: {\r\n    fontSize: 12,\r\n    spacing: 0.18,\r\n    style: 'bold',\r\n  },\r\n  armyFooter: {\r\n    fontSize: 12,\r\n    spacing: 0.24,\r\n    style: 'bold',\r\n  },\r\n  armyName: {\r\n    fontSize: 14,\r\n    spacing: 0.28,\r\n    style: 'bold',\r\n  },\r\n  break: {\r\n    fontSize: 0,\r\n    spacing: 0.14,\r\n    style: 'normal',\r\n  },\r\n  desc: {\r\n    fontSize: 9.5,\r\n    spacing: 0.18,\r\n    style: 'normal',\r\n  },\r\n  note: {\r\n    fontSize: 9.5,\r\n    spacing: 0.18,\r\n    style: 'italic',\r\n    textColor: [18, 55, 199], // $themeRoyalBlue: #1237c7;\r\n  },\r\n  phase: {\r\n    fontSize: 12,\r\n    spacing: 0.24,\r\n    style: 'bold',\r\n  },\r\n  spacer: {\r\n    fontSize: 0,\r\n    spacing: 0.28,\r\n    style: 'normal',\r\n  },\r\n  title: {\r\n    fontSize: 10,\r\n    spacing: 0.2,\r\n    style: 'bold',\r\n  },\r\n  titlespacer: {\r\n    fontSize: 0,\r\n    spacing: 0.1,\r\n    style: 'normal',\r\n  },\r\n}\r\n\r\nconst PageOpts: IPageOpts = {\r\n  colLineWidth: 0,\r\n  colNoteLineWidth: 0,\r\n  colTitleLineWidth: 0,\r\n  maxLineWidth: 10.8,\r\n  maxNoteLineWidth: 10.8 - 2,\r\n  maxTitleLineWidth: 10.8 - 2,\r\n  pageBottom: 12.4 - 0.75,\r\n  xMargin: 0.5,\r\n  yMargin: 0.75,\r\n}\r\n\r\nexport const saveDefaultPdf = (data: IPrintPdf): jsPDF => {\r\n  const { factionName, subFactionName, hiddenReminders, reminders, notes, ...currentArmy } = data\r\n\r\n  const orderedReminders = reorderReminders(getVisibleReminders(reminders, hiddenReminders))\r\n\r\n  const doc = new jsPDF({\r\n    unit: 'in',\r\n    lineHeight: 1.2,\r\n  })\r\n\r\n  const Layout = new PdfLayout('default', doc, PageOpts, Styles, {\r\n    factionName,\r\n    subFactionName,\r\n    ...currentArmy,\r\n  })\r\n\r\n  doc\r\n    .setFont('helvetica')\r\n    .setTextColor(0, 0, 0)\r\n    .setProperties({ title: `AoS Reminders - ${getFactionTitle(factionName, subFactionName)}` })\r\n\r\n  const pageWidth = doc.internal.pageSize.getWidth()\r\n  const centerX = pageWidth / 2\r\n\r\n  Layout.getReminderText(orderedReminders, notes)\r\n  const pages = Layout.splitTextToPages()\r\n\r\n  pages.forEach((page, pageNum) => {\r\n    if (pageNum !== 0) doc.addPage()\r\n    let [x, y] = [PageOpts.xMargin, PageOpts.yMargin]\r\n\r\n    page.forEach((t, i) => {\r\n      // Don't add spacers to the start or end of page\r\n      if ((i === 0 || i === page.length - 1) && ['spacer', 'titlespacer', 'break'].includes(t.type)) return\r\n\r\n      const isPhase = t.type === 'phase'\r\n      const isArmy = t.type.startsWith('army')\r\n      const style = Styles[t.type]\r\n      const textX = isPhase || isArmy ? centerX : x\r\n      const textAlign = isPhase || isArmy ? 'center' : 'left'\r\n\r\n      doc.setFontSize(style.fontSize).setFontStyle(style.style)\r\n\r\n      if (style.textColor) {\r\n        doc.setTextColor(style.textColor[0], style.textColor[1], style.textColor[2])\r\n      }\r\n\r\n      doc.text(t.text, textX, y, null, null, textAlign)\r\n\r\n      if (style.textColor) doc.setTextColor(0, 0, 0) // reset to black\r\n\r\n      if (isPhase) {\r\n        doc\r\n          .setLineWidth(0.00055)\r\n          .setDrawColor(28, 117, 149)\r\n          .roundedRect(\r\n            x - 0.1,\r\n            y - style.spacing + 0.02,\r\n            pageWidth - PageOpts.xMargin * 2 + 0.1,\r\n            style.spacing + 0.08,\r\n            0.05,\r\n            0.05,\r\n            'S'\r\n          )\r\n      }\r\n      if (t.type === 'armyName') {\r\n        doc\r\n          .setLineWidth(0.00055)\r\n          .setDrawColor(28, 117, 149)\r\n          .line(x - 0.1, y - style.spacing, pageWidth - PageOpts.xMargin + 0.1, y - style.spacing)\r\n      }\r\n\r\n      if (t.type === 'armyEnd') {\r\n        doc\r\n          .setLineWidth(0.00055)\r\n          .setDrawColor(28, 117, 149)\r\n          .line(x - 0.1, y + style.spacing, pageWidth - PageOpts.xMargin + 0.1, y + style.spacing)\r\n      }\r\n\r\n      y = y + style.spacing\r\n\r\n      // Add page numbers and watermark on the first pass of a page\r\n      if (i === 0) {\r\n        const watermarkY = 0.33\r\n        doc\r\n          .setTextColor(128, 128, 128)\r\n          .setFontSize(Styles.desc.fontSize)\r\n          .setFontStyle(Styles.desc.style)\r\n          .text(`${pageNum + 1}`, pageWidth - PageOpts.xMargin - 0.11, watermarkY)\r\n          .setFontStyle(Styles.title.style)\r\n          .text(`aosreminders.com`, centerX, watermarkY, null, null, 'center')\r\n          .setTextColor(0, 0, 0) // Set color back to black\r\n\r\n        const [logoW, logoH] = [1.43 / 3.5, 1 / 3.5]\r\n        doc.addImage(Logo, 'png', PageOpts.xMargin + 0.11, watermarkY - logoH / 2 - 0.05, logoW, logoH)\r\n      }\r\n\r\n      // If there's enough room on the last page, add the logo to it\r\n      if (pageNum === pages.length - 1 && i === page.length - 1) {\r\n        const [logoW, logoH, logoSpacer] = [1.43, 1, 0.25]\r\n\r\n        if (y + logoH + logoSpacer <= PageOpts.pageBottom) {\r\n          doc.addImage(Logo, 'png', centerX - logoW / 2 + 0.15, y + logoSpacer)\r\n        }\r\n      }\r\n    })\r\n  })\r\n\r\n  return doc\r\n}\r\n","import GenericButton from 'components/input/generic_button'\r\nimport { DownloadPDFModal } from 'components/modals/download_pdf_modal'\r\nimport { useSavedArmies } from 'context/useSavedArmies'\r\nimport { selectors } from 'ducks'\r\nimport jsPDF from 'jspdf'\r\nimport React, { useCallback, useState } from 'react'\r\nimport { MdFileDownload } from 'react-icons/md'\r\nimport { useSelector } from 'react-redux'\r\nimport useGetReminders from 'utils/hooks/useGetReminders'\r\nimport useWindowSize from 'utils/hooks/useWindowSize'\r\nimport { savePdf } from 'utils/pdf/generate/generatePdf'\r\n\r\nconst DownloadPDFButton = () => {\r\n  const { reminders } = useGetReminders()\r\n  const { saveArmyToS3 } = useSavedArmies()\r\n  const { isMobile } = useWindowSize()\r\n\r\n  const currentArmy = useSelector(selectors.selectCurrentArmy)\r\n  const hiddenReminders = useSelector(selectors.selectReminders)\r\n  const notes = useSelector(selectors.selectNotes)\r\n\r\n  const [pdf, setPdf] = useState<{ default: jsPDF; compact: jsPDF } | null>(null)\r\n  const [modalIsOpen, setModalIsOpen] = useState(false)\r\n\r\n  const handleDownload = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.preventDefault()\r\n\r\n      // Get the PDF ready to be saved\r\n      const pdfs = savePdf({ ...currentArmy, hiddenReminders, reminders, notes })\r\n\r\n      setPdf(pdfs)\r\n      saveArmyToS3(currentArmy)\r\n      setModalIsOpen(true)\r\n    },\r\n    [currentArmy, hiddenReminders, reminders, notes, saveArmyToS3]\r\n  )\r\n\r\n  const text = `Download${isMobile ? `` : ` PDF`}`\r\n\r\n  return (\r\n    <>\r\n      <GenericButton onClick={handleDownload}>\r\n        <MdFileDownload className=\"mr-2\" /> {text}\r\n      </GenericButton>\r\n      {modalIsOpen && pdf && (\r\n        <DownloadPDFModal\r\n          factionName={currentArmy.factionName}\r\n          pdf={pdf}\r\n          modalIsOpen={modalIsOpen}\r\n          closeModal={() => setModalIsOpen(false)}\r\n        />\r\n      )}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default DownloadPDFButton\r\n","import jsPDF from 'jspdf'\r\nimport { IPrintPdf } from 'types/pdf'\r\nimport { saveCompactPdf } from 'utils/pdf/generate/layouts/compact'\r\nimport { saveDefaultPdf } from 'utils/pdf/generate/layouts/default'\r\n\r\ntype TSavePdf = (data: IPrintPdf) => {\r\n  default: jsPDF\r\n  compact: jsPDF\r\n}\r\n\r\nexport const savePdf: TSavePdf = data => {\r\n  return {\r\n    default: saveDefaultPdf(data),\r\n    compact: saveCompactPdf(data),\r\n  }\r\n}\r\n"],"sourceRoot":""}